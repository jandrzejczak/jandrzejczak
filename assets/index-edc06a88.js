(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();function gb(n,e){const t=Object.create(null),i=n.split(",");for(let o=0;o<i.length;o++)t[i[o]]=!0;return e?o=>!!t[o.toLowerCase()]:o=>!!t[o]}function ya(n){if(Ki(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],o=Pr(i)?fN(i):ya(i);if(o)for(const u in o)e[u]=o[u]}return e}else{if(Pr(n))return n;if(cr(n))return n}}const uN=/;(?![^(]*\))/g,hN=/:([^]+)/,dN=/\/\*.*?\*\//gs;function fN(n){const e={};return n.replace(dN,"").split(uN).forEach(t=>{if(t){const i=t.split(hN);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function mn(n){let e="";if(Pr(n))e=n;else if(Ki(n))for(let t=0;t<n.length;t++){const i=mn(n[t]);i&&(e+=i+" ")}else if(cr(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const pN="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AN=gb(pN);function X3(n){return!!n||n===""}const Vd=n=>Pr(n)?n:n==null?"":Ki(n)||cr(n)&&(n.toString===tR||!on(n.toString))?JSON.stringify(n,Z3,2):String(n),Z3=(n,e)=>e&&e.__v_isRef?Z3(n,e.value):Kp(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[i,o])=>(t[`${i} =>`]=o,t),{})}:$3(e)?{[`Set(${e.size})`]:[...e.values()]}:cr(e)&&!Ki(e)&&!iR(e)?String(e):e,ar={},qp=[],$a=()=>{},gN=()=>!1,mN=/^on[^a-z]/,jx=n=>mN.test(n),mb=n=>n.startsWith("onUpdate:"),fs=Object.assign,_b=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},_N=Object.prototype.hasOwnProperty,bn=(n,e)=>_N.call(n,e),Ki=Array.isArray,Kp=n=>qx(n)==="[object Map]",$3=n=>qx(n)==="[object Set]",on=n=>typeof n=="function",Pr=n=>typeof n=="string",yb=n=>typeof n=="symbol",cr=n=>n!==null&&typeof n=="object",eR=n=>cr(n)&&on(n.then)&&on(n.catch),tR=Object.prototype.toString,qx=n=>tR.call(n),yN=n=>qx(n).slice(8,-1),iR=n=>qx(n)==="[object Object]",vb=n=>Pr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Kv=gb(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kx=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},vN=/-(\w)/g,Dl=Kx(n=>n.replace(vN,(e,t)=>t?t.toUpperCase():"")),xN=/\B([A-Z])/g,NA=Kx(n=>n.replace(xN,"-$1").toLowerCase()),Jx=Kx(n=>n.charAt(0).toUpperCase()+n.slice(1)),AC=Kx(n=>n?`on${Jx(n)}`:""),F_=(n,e)=>!Object.is(n,e),Jv=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},mx=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},VE=n=>{const e=parseFloat(n);return isNaN(e)?n:e},IN=n=>{const e=Pr(n)?Number(n):NaN;return isNaN(e)?n:e};let EM;const CN=()=>EM||(EM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Mo;class nR{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Mo,!e&&Mo&&(this.index=(Mo.scopes||(Mo.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=Mo;try{return Mo=this,e()}finally{Mo=t}}}on(){Mo=this}off(){Mo=this.parent}stop(e){if(this._active){let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this._active=!1}}}function rR(n){return new nR(n)}function EN(n,e=Mo){e&&e.active&&e.effects.push(n)}function xb(){return Mo}function sR(n){Mo&&Mo.cleanups.push(n)}const Ib=n=>{const e=new Set(n);return e.w=0,e.n=0,e},oR=n=>(n.w&ih)>0,aR=n=>(n.n&ih)>0,wN=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=ih},bN=n=>{const{deps:e}=n;if(e.length){let t=0;for(let i=0;i<e.length;i++){const o=e[i];oR(o)&&!aR(o)?o.delete(n):e[t++]=o,o.w&=~ih,o.n&=~ih}e.length=t}},_x=new WeakMap;let qm=0,ih=1;const WE=30;let Ka;const Td=Symbol(""),YE=Symbol("");class Cb{constructor(e,t=null,i){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,EN(this,i)}run(){if(!this.active)return this.fn();let e=Ka,t=qu;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ka,Ka=this,qu=!0,ih=1<<++qm,qm<=WE?wN(this):wM(this),this.fn()}finally{qm<=WE&&bN(this),ih=1<<--qm,Ka=this.parent,qu=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ka===this?this.deferStop=!0:this.active&&(wM(this),this.onStop&&this.onStop(),this.active=!1)}}function wM(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let qu=!0;const lR=[];function zA(){lR.push(qu),qu=!1}function UA(){const n=lR.pop();qu=n===void 0?!0:n}function yo(n,e,t){if(qu&&Ka){let i=_x.get(n);i||_x.set(n,i=new Map);let o=i.get(t);o||i.set(t,o=Ib()),cR(o)}}function cR(n,e){let t=!1;qm<=WE?aR(n)||(n.n|=ih,t=!oR(n)):t=!n.has(Ka),t&&(n.add(Ka),Ka.deps.push(n))}function Qc(n,e,t,i,o,u){const h=_x.get(n);if(!h)return;let r=[];if(e==="clear")r=[...h.values()];else if(t==="length"&&Ki(n)){const p=Number(i);h.forEach((g,v)=>{(v==="length"||v>=p)&&r.push(g)})}else switch(t!==void 0&&r.push(h.get(t)),e){case"add":Ki(n)?vb(t)&&r.push(h.get("length")):(r.push(h.get(Td)),Kp(n)&&r.push(h.get(YE)));break;case"delete":Ki(n)||(r.push(h.get(Td)),Kp(n)&&r.push(h.get(YE)));break;case"set":Kp(n)&&r.push(h.get(Td));break}if(r.length===1)r[0]&&jE(r[0]);else{const p=[];for(const g of r)g&&p.push(...g);jE(Ib(p))}}function jE(n,e){const t=Ki(n)?n:[...n];for(const i of t)i.computed&&bM(i);for(const i of t)i.computed||bM(i)}function bM(n,e){(n!==Ka||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function BN(n,e){var t;return(t=_x.get(n))===null||t===void 0?void 0:t.get(e)}const SN=gb("__proto__,__v_isRef,__isVue"),uR=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(yb)),MN=Eb(),TN=Eb(!1,!0),DN=Eb(!0),BM=QN();function QN(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const i=rn(this);for(let u=0,h=this.length;u<h;u++)yo(i,"get",u+"");const o=i[e](...t);return o===-1||o===!1?i[e](...t.map(rn)):o}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){zA();const i=rn(this)[e].apply(this,t);return UA(),i}}),n}function RN(n){const e=rn(this);return yo(e,"has",n),e.hasOwnProperty(n)}function Eb(n=!1,e=!1){return function(i,o,u){if(o==="__v_isReactive")return!n;if(o==="__v_isReadonly")return n;if(o==="__v_isShallow")return e;if(o==="__v_raw"&&u===(n?e?KN:AR:e?pR:fR).get(i))return i;const h=Ki(i);if(!n){if(h&&bn(BM,o))return Reflect.get(BM,o,u);if(o==="hasOwnProperty")return RN}const r=Reflect.get(i,o,u);return(yb(o)?uR.has(o):SN(o))||(n||yo(i,"get",o),e)?r:lr(r)?h&&vb(o)?r:r.value:cr(r)?n?Zx(r):Ql(r):r}}const LN=hR(),PN=hR(!0);function hR(n=!1){return function(t,i,o,u){let h=t[i];if(dA(h)&&lr(h)&&!lr(o))return!1;if(!n&&(!yx(o)&&!dA(o)&&(h=rn(h),o=rn(o)),!Ki(t)&&lr(h)&&!lr(o)))return h.value=o,!0;const r=Ki(t)&&vb(i)?Number(i)<t.length:bn(t,i),p=Reflect.set(t,i,o,u);return t===rn(u)&&(r?F_(o,h)&&Qc(t,"set",i,o):Qc(t,"add",i,o)),p}}function kN(n,e){const t=bn(n,e);n[e];const i=Reflect.deleteProperty(n,e);return i&&t&&Qc(n,"delete",e,void 0),i}function FN(n,e){const t=Reflect.has(n,e);return(!yb(e)||!uR.has(e))&&yo(n,"has",e),t}function NN(n){return yo(n,"iterate",Ki(n)?"length":Td),Reflect.ownKeys(n)}const dR={get:MN,set:LN,deleteProperty:kN,has:FN,ownKeys:NN},zN={get:DN,set(n,e){return!0},deleteProperty(n,e){return!0}},UN=fs({},dR,{get:TN,set:PN}),wb=n=>n,Xx=n=>Reflect.getPrototypeOf(n);function Vy(n,e,t=!1,i=!1){n=n.__v_raw;const o=rn(n),u=rn(e);t||(e!==u&&yo(o,"get",e),yo(o,"get",u));const{has:h}=Xx(o),r=i?wb:t?Sb:N_;if(h.call(o,e))return r(n.get(e));if(h.call(o,u))return r(n.get(u));n!==o&&n.get(e)}function Wy(n,e=!1){const t=this.__v_raw,i=rn(t),o=rn(n);return e||(n!==o&&yo(i,"has",n),yo(i,"has",o)),n===o?t.has(n):t.has(n)||t.has(o)}function Yy(n,e=!1){return n=n.__v_raw,!e&&yo(rn(n),"iterate",Td),Reflect.get(n,"size",n)}function SM(n){n=rn(n);const e=rn(this);return Xx(e).has.call(e,n)||(e.add(n),Qc(e,"add",n,n)),this}function MM(n,e){e=rn(e);const t=rn(this),{has:i,get:o}=Xx(t);let u=i.call(t,n);u||(n=rn(n),u=i.call(t,n));const h=o.call(t,n);return t.set(n,e),u?F_(e,h)&&Qc(t,"set",n,e):Qc(t,"add",n,e),this}function TM(n){const e=rn(this),{has:t,get:i}=Xx(e);let o=t.call(e,n);o||(n=rn(n),o=t.call(e,n)),i&&i.call(e,n);const u=e.delete(n);return o&&Qc(e,"delete",n,void 0),u}function DM(){const n=rn(this),e=n.size!==0,t=n.clear();return e&&Qc(n,"clear",void 0,void 0),t}function jy(n,e){return function(i,o){const u=this,h=u.__v_raw,r=rn(h),p=e?wb:n?Sb:N_;return!n&&yo(r,"iterate",Td),h.forEach((g,v)=>i.call(o,p(g),p(v),u))}}function qy(n,e,t){return function(...i){const o=this.__v_raw,u=rn(o),h=Kp(u),r=n==="entries"||n===Symbol.iterator&&h,p=n==="keys"&&h,g=o[n](...i),v=t?wb:e?Sb:N_;return!e&&yo(u,"iterate",p?YE:Td),{next(){const{value:I,done:C}=g.next();return C?{value:I,done:C}:{value:r?[v(I[0]),v(I[1])]:v(I),done:C}},[Symbol.iterator](){return this}}}}function mu(n){return function(...e){return n==="delete"?!1:this}}function ON(){const n={get(u){return Vy(this,u)},get size(){return Yy(this)},has:Wy,add:SM,set:MM,delete:TM,clear:DM,forEach:jy(!1,!1)},e={get(u){return Vy(this,u,!1,!0)},get size(){return Yy(this)},has:Wy,add:SM,set:MM,delete:TM,clear:DM,forEach:jy(!1,!0)},t={get(u){return Vy(this,u,!0)},get size(){return Yy(this,!0)},has(u){return Wy.call(this,u,!0)},add:mu("add"),set:mu("set"),delete:mu("delete"),clear:mu("clear"),forEach:jy(!0,!1)},i={get(u){return Vy(this,u,!0,!0)},get size(){return Yy(this,!0)},has(u){return Wy.call(this,u,!0)},add:mu("add"),set:mu("set"),delete:mu("delete"),clear:mu("clear"),forEach:jy(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{n[u]=qy(u,!1,!1),t[u]=qy(u,!0,!1),e[u]=qy(u,!1,!0),i[u]=qy(u,!0,!0)}),[n,t,e,i]}const[GN,HN,VN,WN]=ON();function bb(n,e){const t=e?n?WN:VN:n?HN:GN;return(i,o,u)=>o==="__v_isReactive"?!n:o==="__v_isReadonly"?n:o==="__v_raw"?i:Reflect.get(bn(t,o)&&o in i?t:i,o,u)}const YN={get:bb(!1,!1)},jN={get:bb(!1,!0)},qN={get:bb(!0,!1)},fR=new WeakMap,pR=new WeakMap,AR=new WeakMap,KN=new WeakMap;function JN(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function XN(n){return n.__v_skip||!Object.isExtensible(n)?0:JN(yN(n))}function Ql(n){return dA(n)?n:Bb(n,!1,dR,YN,fR)}function ZN(n){return Bb(n,!1,UN,jN,pR)}function Zx(n){return Bb(n,!0,zN,qN,AR)}function Bb(n,e,t,i,o){if(!cr(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const u=o.get(n);if(u)return u;const h=XN(n);if(h===0)return n;const r=new Proxy(n,h===2?i:t);return o.set(n,r),r}function Bc(n){return dA(n)?Bc(n.__v_raw):!!(n&&n.__v_isReactive)}function dA(n){return!!(n&&n.__v_isReadonly)}function yx(n){return!!(n&&n.__v_isShallow)}function gR(n){return Bc(n)||dA(n)}function rn(n){const e=n&&n.__v_raw;return e?rn(e):n}function fA(n){return mx(n,"__v_skip",!0),n}const N_=n=>cr(n)?Ql(n):n,Sb=n=>cr(n)?Zx(n):n;function Mb(n){qu&&Ka&&(n=rn(n),cR(n.dep||(n.dep=Ib())))}function Tb(n,e){n=rn(n);const t=n.dep;t&&jE(t)}function lr(n){return!!(n&&n.__v_isRef===!0)}function Gt(n){return _R(n,!1)}function mR(n){return _R(n,!0)}function _R(n,e){return lr(n)?n:new $N(n,e)}class $N{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:rn(e),this._value=t?e:N_(e)}get value(){return Mb(this),this._value}set value(e){const t=this.__v_isShallow||yx(e)||dA(e);e=t?e:rn(e),F_(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:N_(e),Tb(this))}}function Bi(n){return lr(n)?n.value:n}const ez={get:(n,e,t)=>Bi(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const o=n[e];return lr(o)&&!lr(t)?(o.value=t,!0):Reflect.set(n,e,t,i)}};function yR(n){return Bc(n)?n:new Proxy(n,ez)}class tz{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:i}=e(()=>Mb(this),()=>Tb(this));this._get=t,this._set=i}get value(){return this._get()}set value(e){this._set(e)}}function iz(n){return new tz(n)}function vR(n){const e=Ki(n)?new Array(n.length):{};for(const t in n)e[t]=Db(n,t);return e}class nz{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return BN(rn(this._object),this._key)}}function Db(n,e,t){const i=n[e];return lr(i)?i:new nz(n,e,t)}var xR;class rz{constructor(e,t,i,o){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[xR]=!1,this._dirty=!0,this.effect=new Cb(e,()=>{this._dirty||(this._dirty=!0,Tb(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=i}get value(){const e=rn(this);return Mb(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}xR="__v_isReadonly";function sz(n,e,t=!1){let i,o;const u=on(n);return u?(i=n,o=$a):(i=n.get,o=n.set),new rz(i,o,u||!o,t)}function Ku(n,e,t,i){let o;try{o=i?n(...i):n()}catch(u){$x(u,e,t)}return o}function pa(n,e,t,i){if(on(n)){const u=Ku(n,e,t,i);return u&&eR(u)&&u.catch(h=>{$x(h,e,t)}),u}const o=[];for(let u=0;u<n.length;u++)o.push(pa(n[u],e,t,i));return o}function $x(n,e,t,i=!0){const o=e?e.vnode:null;if(e){let u=e.parent;const h=e.proxy,r=t;for(;u;){const g=u.ec;if(g){for(let v=0;v<g.length;v++)if(g[v](n,h,r)===!1)return}u=u.parent}const p=e.appContext.config.errorHandler;if(p){Ku(p,null,10,[n,h,r]);return}}oz(n,t,o,i)}function oz(n,e,t,i=!0){console.error(n)}let z_=!1,qE=!1;const Ps=[];let wl=0;const Jp=[];let fc=null,_d=0;const IR=Promise.resolve();let Qb=null;function Gr(n){const e=Qb||IR;return n?e.then(this?n.bind(this):n):e}function az(n){let e=wl+1,t=Ps.length;for(;e<t;){const i=e+t>>>1;U_(Ps[i])<n?e=i+1:t=i}return e}function Rb(n){(!Ps.length||!Ps.includes(n,z_&&n.allowRecurse?wl+1:wl))&&(n.id==null?Ps.push(n):Ps.splice(az(n.id),0,n),CR())}function CR(){!z_&&!qE&&(qE=!0,Qb=IR.then(wR))}function lz(n){const e=Ps.indexOf(n);e>wl&&Ps.splice(e,1)}function cz(n){Ki(n)?Jp.push(...n):(!fc||!fc.includes(n,n.allowRecurse?_d+1:_d))&&Jp.push(n),CR()}function QM(n,e=z_?wl+1:0){for(;e<Ps.length;e++){const t=Ps[e];t&&t.pre&&(Ps.splice(e,1),e--,t())}}function ER(n){if(Jp.length){const e=[...new Set(Jp)];if(Jp.length=0,fc){fc.push(...e);return}for(fc=e,fc.sort((t,i)=>U_(t)-U_(i)),_d=0;_d<fc.length;_d++)fc[_d]();fc=null,_d=0}}const U_=n=>n.id==null?1/0:n.id,uz=(n,e)=>{const t=U_(n)-U_(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function wR(n){qE=!1,z_=!0,Ps.sort(uz);const e=$a;try{for(wl=0;wl<Ps.length;wl++){const t=Ps[wl];t&&t.active!==!1&&Ku(t,null,14)}}finally{wl=0,Ps.length=0,ER(),z_=!1,Qb=null,(Ps.length||Jp.length)&&wR()}}function hz(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||ar;let o=t;const u=e.startsWith("update:"),h=u&&e.slice(7);if(h&&h in i){const v=`${h==="modelValue"?"model":h}Modifiers`,{number:I,trim:C}=i[v]||ar;C&&(o=t.map(E=>Pr(E)?E.trim():E)),I&&(o=t.map(VE))}let r,p=i[r=AC(e)]||i[r=AC(Dl(e))];!p&&u&&(p=i[r=AC(NA(e))]),p&&pa(p,n,6,o);const g=i[r+"Once"];if(g){if(!n.emitted)n.emitted={};else if(n.emitted[r])return;n.emitted[r]=!0,pa(g,n,6,o)}}function bR(n,e,t=!1){const i=e.emitsCache,o=i.get(n);if(o!==void 0)return o;const u=n.emits;let h={},r=!1;if(!on(n)){const p=g=>{const v=bR(g,e,!0);v&&(r=!0,fs(h,v))};!t&&e.mixins.length&&e.mixins.forEach(p),n.extends&&p(n.extends),n.mixins&&n.mixins.forEach(p)}return!u&&!r?(cr(n)&&i.set(n,null),null):(Ki(u)?u.forEach(p=>h[p]=null):fs(h,u),cr(n)&&i.set(n,h),h)}function e1(n,e){return!n||!jx(e)?!1:(e=e.slice(2).replace(/Once$/,""),bn(n,e[0].toLowerCase()+e.slice(1))||bn(n,NA(e))||bn(n,e))}let xs=null,t1=null;function vx(n){const e=xs;return xs=n,t1=n&&n.type.__scopeId||null,e}function OA(n){t1=n}function GA(){t1=null}function Fs(n,e=xs,t){if(!e||n._n)return n;const i=(...o)=>{i._d&&HM(-1);const u=vx(e);let h;try{h=n(...o)}finally{vx(u),i._d&&HM(1)}return h};return i._n=!0,i._c=!0,i._d=!0,i}function gC(n){const{type:e,vnode:t,proxy:i,withProxy:o,props:u,propsOptions:[h],slots:r,attrs:p,emit:g,render:v,renderCache:I,data:C,setupState:E,ctx:Q,inheritAttrs:M}=n;let D,P;const O=vx(n);try{if(t.shapeFlag&4){const N=o||i;D=xl(v.call(N,N,I,u,E,C,Q)),P=p}else{const N=e;D=xl(N.length>1?N(u,{attrs:p,slots:r,emit:g}):N(u,null)),P=e.props?p:dz(p)}}catch(N){p_.length=0,$x(N,n,1),D=Di(ga)}let F=D;if(P&&M!==!1){const N=Object.keys(P),{shapeFlag:z}=F;N.length&&z&7&&(h&&N.some(mb)&&(P=fz(P,h)),F=nh(F,P))}return t.dirs&&(F=nh(F),F.dirs=F.dirs?F.dirs.concat(t.dirs):t.dirs),t.transition&&(F.transition=t.transition),D=F,vx(O),D}const dz=n=>{let e;for(const t in n)(t==="class"||t==="style"||jx(t))&&((e||(e={}))[t]=n[t]);return e},fz=(n,e)=>{const t={};for(const i in n)(!mb(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function pz(n,e,t){const{props:i,children:o,component:u}=n,{props:h,children:r,patchFlag:p}=e,g=u.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&p>=0){if(p&1024)return!0;if(p&16)return i?RM(i,h,g):!!h;if(p&8){const v=e.dynamicProps;for(let I=0;I<v.length;I++){const C=v[I];if(h[C]!==i[C]&&!e1(g,C))return!0}}}else return(o||r)&&(!r||!r.$stable)?!0:i===h?!1:i?h?RM(i,h,g):!0:!!h;return!1}function RM(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let o=0;o<i.length;o++){const u=i[o];if(e[u]!==n[u]&&!e1(t,u))return!0}return!1}function Az({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const gz=n=>n.__isSuspense;function mz(n,e){e&&e.pendingBranch?Ki(n)?e.effects.push(...n):e.effects.push(n):cz(n)}function c_(n,e){if(Rr){let t=Rr.provides;const i=Rr.parent&&Rr.parent.provides;i===t&&(t=Rr.provides=Object.create(i)),t[n]=e}}function Aa(n,e,t=!1){const i=Rr||xs;if(i){const o=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(o&&n in o)return o[n];if(arguments.length>1)return t&&on(e)?e.call(i.proxy):e}}function Lb(n,e){return i1(n,null,e)}function _z(n,e){return i1(n,null,{flush:"post"})}const Ky={};function qi(n,e,t){return i1(n,e,t)}function i1(n,e,{immediate:t,deep:i,flush:o,onTrack:u,onTrigger:h}=ar){const r=xb()===(Rr==null?void 0:Rr.scope)?Rr:null;let p,g=!1,v=!1;if(lr(n)?(p=()=>n.value,g=yx(n)):Bc(n)?(p=()=>n,i=!0):Ki(n)?(v=!0,g=n.some(F=>Bc(F)||yx(F)),p=()=>n.map(F=>{if(lr(F))return F.value;if(Bc(F))return Ed(F);if(on(F))return Ku(F,r,2)})):on(n)?e?p=()=>Ku(n,r,2):p=()=>{if(!(r&&r.isUnmounted))return I&&I(),pa(n,r,3,[C])}:p=$a,e&&i){const F=p;p=()=>Ed(F())}let I,C=F=>{I=P.onStop=()=>{Ku(F,r,4)}},E;if(W_)if(C=$a,e?t&&pa(e,r,3,[p(),v?[]:void 0,C]):p(),o==="sync"){const F=fU();E=F.__watcherHandles||(F.__watcherHandles=[])}else return $a;let Q=v?new Array(n.length).fill(Ky):Ky;const M=()=>{if(P.active)if(e){const F=P.run();(i||g||(v?F.some((N,z)=>F_(N,Q[z])):F_(F,Q)))&&(I&&I(),pa(e,r,3,[F,Q===Ky?void 0:v&&Q[0]===Ky?[]:Q,C]),Q=F)}else P.run()};M.allowRecurse=!!e;let D;o==="sync"?D=M:o==="post"?D=()=>co(M,r&&r.suspense):(M.pre=!0,r&&(M.id=r.uid),D=()=>Rb(M));const P=new Cb(p,D);e?t?M():Q=P.run():o==="post"?co(P.run.bind(P),r&&r.suspense):P.run();const O=()=>{P.stop(),r&&r.scope&&_b(r.scope.effects,P)};return E&&E.push(O),O}function yz(n,e,t){const i=this.proxy,o=Pr(n)?n.includes(".")?BR(i,n):()=>i[n]:n.bind(i,i);let u;on(e)?u=e:(u=e.handler,t=e);const h=Rr;pA(this);const r=i1(o,u.bind(i),t);return h?pA(h):Dd(),r}function BR(n,e){const t=e.split(".");return()=>{let i=n;for(let o=0;o<t.length&&i;o++)i=i[t[o]];return i}}function Ed(n,e){if(!cr(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),lr(n))Ed(n.value,e);else if(Ki(n))for(let t=0;t<n.length;t++)Ed(n[t],e);else if($3(n)||Kp(n))n.forEach(t=>{Ed(t,e)});else if(iR(n))for(const t in n)Ed(n[t],e);return n}function SR(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Br(()=>{n.isMounted=!0}),p0(()=>{n.isUnmounting=!0}),n}const Xo=[Function,Array],vz={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Xo,onEnter:Xo,onAfterEnter:Xo,onEnterCancelled:Xo,onBeforeLeave:Xo,onLeave:Xo,onAfterLeave:Xo,onLeaveCancelled:Xo,onBeforeAppear:Xo,onAppear:Xo,onAfterAppear:Xo,onAppearCancelled:Xo},setup(n,{slots:e}){const t=hh(),i=SR();let o;return()=>{const u=e.default&&Pb(e.default(),!0);if(!u||!u.length)return;let h=u[0];if(u.length>1){for(const M of u)if(M.type!==ga){h=M;break}}const r=rn(n),{mode:p}=r;if(i.isLeaving)return mC(h);const g=LM(h);if(!g)return mC(h);const v=O_(g,r,i,t);G_(g,v);const I=t.subTree,C=I&&LM(I);let E=!1;const{getTransitionKey:Q}=g.type;if(Q){const M=Q();o===void 0?o=M:M!==o&&(o=M,E=!0)}if(C&&C.type!==ga&&(!yd(g,C)||E)){const M=O_(C,r,i,t);if(G_(C,M),p==="out-in")return i.isLeaving=!0,M.afterLeave=()=>{i.isLeaving=!1,t.update.active!==!1&&t.update()},mC(h);p==="in-out"&&g.type!==ga&&(M.delayLeave=(D,P,O)=>{const F=TR(i,C);F[String(C.key)]=C,D._leaveCb=()=>{P(),D._leaveCb=void 0,delete v.delayedLeave},v.delayedLeave=O})}return h}}},MR=vz;function TR(n,e){const{leavingVNodes:t}=n;let i=t.get(e.type);return i||(i=Object.create(null),t.set(e.type,i)),i}function O_(n,e,t,i){const{appear:o,mode:u,persisted:h=!1,onBeforeEnter:r,onEnter:p,onAfterEnter:g,onEnterCancelled:v,onBeforeLeave:I,onLeave:C,onAfterLeave:E,onLeaveCancelled:Q,onBeforeAppear:M,onAppear:D,onAfterAppear:P,onAppearCancelled:O}=e,F=String(n.key),N=TR(t,n),z=(H,W)=>{H&&pa(H,i,9,W)},X=(H,W)=>{const se=W[1];z(H,W),Ki(H)?H.every(de=>de.length<=1)&&se():H.length<=1&&se()},q={mode:u,persisted:h,beforeEnter(H){let W=r;if(!t.isMounted)if(o)W=M||r;else return;H._leaveCb&&H._leaveCb(!0);const se=N[F];se&&yd(n,se)&&se.el._leaveCb&&se.el._leaveCb(),z(W,[H])},enter(H){let W=p,se=g,de=v;if(!t.isMounted)if(o)W=D||p,se=P||g,de=O||v;else return;let te=!1;const ce=H._enterCb=Ee=>{te||(te=!0,Ee?z(de,[H]):z(se,[H]),q.delayedLeave&&q.delayedLeave(),H._enterCb=void 0)};W?X(W,[H,ce]):ce()},leave(H,W){const se=String(n.key);if(H._enterCb&&H._enterCb(!0),t.isUnmounting)return W();z(I,[H]);let de=!1;const te=H._leaveCb=ce=>{de||(de=!0,W(),ce?z(Q,[H]):z(E,[H]),H._leaveCb=void 0,N[se]===n&&delete N[se])};N[se]=n,C?X(C,[H,te]):te()},clone(H){return O_(H,e,t,i)}};return q}function mC(n){if(n1(n))return n=nh(n),n.children=null,n}function LM(n){return n1(n)?n.children?n.children[0]:void 0:n}function G_(n,e){n.shapeFlag&6&&n.component?G_(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Pb(n,e=!1,t){let i=[],o=0;for(let u=0;u<n.length;u++){let h=n[u];const r=t==null?h.key:String(t)+String(h.key!=null?h.key:u);h.type===ir?(h.patchFlag&128&&o++,i=i.concat(Pb(h.children,e,r))):(e||h.type!==ga)&&i.push(r!=null?nh(h,{key:r}):h)}if(o>1)for(let u=0;u<i.length;u++)i[u].patchFlag=-2;return i}function kn(n){return on(n)?{setup:n,name:n.name}:n}const u_=n=>!!n.type.__asyncLoader,n1=n=>n.type.__isKeepAlive;function xz(n,e){DR(n,"a",e)}function Iz(n,e){DR(n,"da",e)}function DR(n,e,t=Rr){const i=n.__wdc||(n.__wdc=()=>{let o=t;for(;o;){if(o.isDeactivated)return;o=o.parent}return n()});if(r1(e,i,t),t){let o=t.parent;for(;o&&o.parent;)n1(o.parent.vnode)&&Cz(i,e,t,o),o=o.parent}}function Cz(n,e,t,i){const o=r1(e,n,i,!0);of(()=>{_b(i[e],o)},t)}function r1(n,e,t=Rr,i=!1){if(t){const o=t[n]||(t[n]=[]),u=e.__weh||(e.__weh=(...h)=>{if(t.isUnmounted)return;zA(),pA(t);const r=pa(e,t,n,h);return Dd(),UA(),r});return i?o.unshift(u):o.push(u),u}}const kc=n=>(e,t=Rr)=>(!W_||n==="sp")&&r1(n,(...i)=>e(...i),t),QR=kc("bm"),Br=kc("m"),Ez=kc("bu"),kb=kc("u"),p0=kc("bum"),of=kc("um"),wz=kc("sp"),bz=kc("rtg"),Bz=kc("rtc");function Sz(n,e=Rr){r1("ec",n,e)}function H_(n,e){const t=xs;if(t===null)return n;const i=l1(t)||t.proxy,o=n.dirs||(n.dirs=[]);for(let u=0;u<e.length;u++){let[h,r,p,g=ar]=e[u];h&&(on(h)&&(h={mounted:h,updated:h}),h.deep&&Ed(r),o.push({dir:h,instance:i,value:r,oldValue:void 0,arg:p,modifiers:g}))}return n}function id(n,e,t,i){const o=n.dirs,u=e&&e.dirs;for(let h=0;h<o.length;h++){const r=o[h];u&&(r.oldValue=u[h].value);let p=r.dir[i];p&&(zA(),pa(p,t,8,[n.el,r,n,e]),UA())}}const RR="components";function HA(n,e){return Tz(RR,n,!0,e)||n}const Mz=Symbol();function Tz(n,e,t=!0,i=!1){const o=xs||Rr;if(o){const u=o.type;if(n===RR){const r=lU(u,!1);if(r&&(r===e||r===Dl(e)||r===Jx(Dl(e))))return u}const h=PM(o[n]||u[n],e)||PM(o.appContext[n],e);return!h&&i?u:h}}function PM(n,e){return n&&(n[e]||n[Dl(e)]||n[Jx(Dl(e))])}function s1(n,e,t,i){let o;const u=t&&t[i];if(Ki(n)||Pr(n)){o=new Array(n.length);for(let h=0,r=n.length;h<r;h++)o[h]=e(n[h],h,void 0,u&&u[h])}else if(typeof n=="number"){o=new Array(n);for(let h=0;h<n;h++)o[h]=e(h+1,h,void 0,u&&u[h])}else if(cr(n))if(n[Symbol.iterator])o=Array.from(n,(h,r)=>e(h,r,void 0,u&&u[r]));else{const h=Object.keys(n);o=new Array(h.length);for(let r=0,p=h.length;r<p;r++){const g=h[r];o[r]=e(n[g],g,r,u&&u[r])}}else o=[];return t&&(t[i]=o),o}function VA(n,e,t={},i,o){if(xs.isCE||xs.parent&&u_(xs.parent)&&xs.parent.isCE)return e!=="default"&&(t.name=e),Di("slot",t,i&&i());let u=n[e];u&&u._c&&(u._d=!1),Qi();const h=u&&LR(u(t)),r=ys(ir,{key:t.key||h&&h.key||`_${e}`},h||(i?i():[]),h&&n._===1?64:-2);return!o&&r.scopeId&&(r.slotScopeIds=[r.scopeId+"-s"]),u&&u._c&&(u._d=!0),r}function LR(n){return n.some(e=>Ix(e)?!(e.type===ga||e.type===ir&&!LR(e.children)):!0)?n:null}const KE=n=>n?YR(n)?l1(n)||n.proxy:KE(n.parent):null,h_=fs(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>KE(n.parent),$root:n=>KE(n.root),$emit:n=>n.emit,$options:n=>Fb(n),$forceUpdate:n=>n.f||(n.f=()=>Rb(n.update)),$nextTick:n=>n.n||(n.n=Gr.bind(n.proxy)),$watch:n=>yz.bind(n)}),_C=(n,e)=>n!==ar&&!n.__isScriptSetup&&bn(n,e),Dz={get({_:n},e){const{ctx:t,setupState:i,data:o,props:u,accessCache:h,type:r,appContext:p}=n;let g;if(e[0]!=="$"){const E=h[e];if(E!==void 0)switch(E){case 1:return i[e];case 2:return o[e];case 4:return t[e];case 3:return u[e]}else{if(_C(i,e))return h[e]=1,i[e];if(o!==ar&&bn(o,e))return h[e]=2,o[e];if((g=n.propsOptions[0])&&bn(g,e))return h[e]=3,u[e];if(t!==ar&&bn(t,e))return h[e]=4,t[e];JE&&(h[e]=0)}}const v=h_[e];let I,C;if(v)return e==="$attrs"&&yo(n,"get",e),v(n);if((I=r.__cssModules)&&(I=I[e]))return I;if(t!==ar&&bn(t,e))return h[e]=4,t[e];if(C=p.config.globalProperties,bn(C,e))return C[e]},set({_:n},e,t){const{data:i,setupState:o,ctx:u}=n;return _C(o,e)?(o[e]=t,!0):i!==ar&&bn(i,e)?(i[e]=t,!0):bn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(u[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:o,propsOptions:u}},h){let r;return!!t[h]||n!==ar&&bn(n,h)||_C(e,h)||(r=u[0])&&bn(r,h)||bn(i,h)||bn(h_,h)||bn(o.config.globalProperties,h)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:bn(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};let JE=!0;function Qz(n){const e=Fb(n),t=n.proxy,i=n.ctx;JE=!1,e.beforeCreate&&kM(e.beforeCreate,n,"bc");const{data:o,computed:u,methods:h,watch:r,provide:p,inject:g,created:v,beforeMount:I,mounted:C,beforeUpdate:E,updated:Q,activated:M,deactivated:D,beforeDestroy:P,beforeUnmount:O,destroyed:F,unmounted:N,render:z,renderTracked:X,renderTriggered:q,errorCaptured:H,serverPrefetch:W,expose:se,inheritAttrs:de,components:te,directives:ce,filters:Ee}=e;if(g&&Rz(g,i,null,n.appContext.config.unwrapInjectedRef),h)for(const Re in h){const ye=h[Re];on(ye)&&(i[Re]=ye.bind(t))}if(o){const Re=o.call(t,t);cr(Re)&&(n.data=Ql(Re))}if(JE=!0,u)for(const Re in u){const ye=u[Re],ht=on(ye)?ye.bind(t,t):on(ye.get)?ye.get.bind(t,t):$a,oe=!on(ye)&&on(ye.set)?ye.set.bind(t):$a,Tt=cn({get:ht,set:oe});Object.defineProperty(i,Re,{enumerable:!0,configurable:!0,get:()=>Tt.value,set:Fe=>Tt.value=Fe})}if(r)for(const Re in r)PR(r[Re],i,t,Re);if(p){const Re=on(p)?p.call(t):p;Reflect.ownKeys(Re).forEach(ye=>{c_(ye,Re[ye])})}v&&kM(v,n,"c");function De(Re,ye){Ki(ye)?ye.forEach(ht=>Re(ht.bind(t))):ye&&Re(ye.bind(t))}if(De(QR,I),De(Br,C),De(Ez,E),De(kb,Q),De(xz,M),De(Iz,D),De(Sz,H),De(Bz,X),De(bz,q),De(p0,O),De(of,N),De(wz,W),Ki(se))if(se.length){const Re=n.exposed||(n.exposed={});se.forEach(ye=>{Object.defineProperty(Re,ye,{get:()=>t[ye],set:ht=>t[ye]=ht})})}else n.exposed||(n.exposed={});z&&n.render===$a&&(n.render=z),de!=null&&(n.inheritAttrs=de),te&&(n.components=te),ce&&(n.directives=ce)}function Rz(n,e,t=$a,i=!1){Ki(n)&&(n=XE(n));for(const o in n){const u=n[o];let h;cr(u)?"default"in u?h=Aa(u.from||o,u.default,!0):h=Aa(u.from||o):h=Aa(u),lr(h)&&i?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>h.value,set:r=>h.value=r}):e[o]=h}}function kM(n,e,t){pa(Ki(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function PR(n,e,t,i){const o=i.includes(".")?BR(t,i):()=>t[i];if(Pr(n)){const u=e[n];on(u)&&qi(o,u)}else if(on(n))qi(o,n.bind(t));else if(cr(n))if(Ki(n))n.forEach(u=>PR(u,e,t,i));else{const u=on(n.handler)?n.handler.bind(t):e[n.handler];on(u)&&qi(o,u,n)}}function Fb(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:o,optionsCache:u,config:{optionMergeStrategies:h}}=n.appContext,r=u.get(e);let p;return r?p=r:!o.length&&!t&&!i?p=e:(p={},o.length&&o.forEach(g=>xx(p,g,h,!0)),xx(p,e,h)),cr(e)&&u.set(e,p),p}function xx(n,e,t,i=!1){const{mixins:o,extends:u}=e;u&&xx(n,u,t,!0),o&&o.forEach(h=>xx(n,h,t,!0));for(const h in e)if(!(i&&h==="expose")){const r=Lz[h]||t&&t[h];n[h]=r?r(n[h],e[h]):e[h]}return n}const Lz={data:FM,props:fd,emits:fd,methods:fd,computed:fd,beforeCreate:Ys,created:Ys,beforeMount:Ys,mounted:Ys,beforeUpdate:Ys,updated:Ys,beforeDestroy:Ys,beforeUnmount:Ys,destroyed:Ys,unmounted:Ys,activated:Ys,deactivated:Ys,errorCaptured:Ys,serverPrefetch:Ys,components:fd,directives:fd,watch:kz,provide:FM,inject:Pz};function FM(n,e){return e?n?function(){return fs(on(n)?n.call(this,this):n,on(e)?e.call(this,this):e)}:e:n}function Pz(n,e){return fd(XE(n),XE(e))}function XE(n){if(Ki(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Ys(n,e){return n?[...new Set([].concat(n,e))]:e}function fd(n,e){return n?fs(fs(Object.create(null),n),e):e}function kz(n,e){if(!n)return e;if(!e)return n;const t=fs(Object.create(null),n);for(const i in e)t[i]=Ys(n[i],e[i]);return t}function Fz(n,e,t,i=!1){const o={},u={};mx(u,a1,1),n.propsDefaults=Object.create(null),kR(n,e,o,u);for(const h in n.propsOptions[0])h in o||(o[h]=void 0);t?n.props=i?o:ZN(o):n.type.props?n.props=o:n.props=u,n.attrs=u}function Nz(n,e,t,i){const{props:o,attrs:u,vnode:{patchFlag:h}}=n,r=rn(o),[p]=n.propsOptions;let g=!1;if((i||h>0)&&!(h&16)){if(h&8){const v=n.vnode.dynamicProps;for(let I=0;I<v.length;I++){let C=v[I];if(e1(n.emitsOptions,C))continue;const E=e[C];if(p)if(bn(u,C))E!==u[C]&&(u[C]=E,g=!0);else{const Q=Dl(C);o[Q]=ZE(p,r,Q,E,n,!1)}else E!==u[C]&&(u[C]=E,g=!0)}}}else{kR(n,e,o,u)&&(g=!0);let v;for(const I in r)(!e||!bn(e,I)&&((v=NA(I))===I||!bn(e,v)))&&(p?t&&(t[I]!==void 0||t[v]!==void 0)&&(o[I]=ZE(p,r,I,void 0,n,!0)):delete o[I]);if(u!==r)for(const I in u)(!e||!bn(e,I))&&(delete u[I],g=!0)}g&&Qc(n,"set","$attrs")}function kR(n,e,t,i){const[o,u]=n.propsOptions;let h=!1,r;if(e)for(let p in e){if(Kv(p))continue;const g=e[p];let v;o&&bn(o,v=Dl(p))?!u||!u.includes(v)?t[v]=g:(r||(r={}))[v]=g:e1(n.emitsOptions,p)||(!(p in i)||g!==i[p])&&(i[p]=g,h=!0)}if(u){const p=rn(t),g=r||ar;for(let v=0;v<u.length;v++){const I=u[v];t[I]=ZE(o,p,I,g[I],n,!bn(g,I))}}return h}function ZE(n,e,t,i,o,u){const h=n[t];if(h!=null){const r=bn(h,"default");if(r&&i===void 0){const p=h.default;if(h.type!==Function&&on(p)){const{propsDefaults:g}=o;t in g?i=g[t]:(pA(o),i=g[t]=p.call(null,e),Dd())}else i=p}h[0]&&(u&&!r?i=!1:h[1]&&(i===""||i===NA(t))&&(i=!0))}return i}function FR(n,e,t=!1){const i=e.propsCache,o=i.get(n);if(o)return o;const u=n.props,h={},r=[];let p=!1;if(!on(n)){const v=I=>{p=!0;const[C,E]=FR(I,e,!0);fs(h,C),E&&r.push(...E)};!t&&e.mixins.length&&e.mixins.forEach(v),n.extends&&v(n.extends),n.mixins&&n.mixins.forEach(v)}if(!u&&!p)return cr(n)&&i.set(n,qp),qp;if(Ki(u))for(let v=0;v<u.length;v++){const I=Dl(u[v]);NM(I)&&(h[I]=ar)}else if(u)for(const v in u){const I=Dl(v);if(NM(I)){const C=u[v],E=h[I]=Ki(C)||on(C)?{type:C}:Object.assign({},C);if(E){const Q=OM(Boolean,E.type),M=OM(String,E.type);E[0]=Q>-1,E[1]=M<0||Q<M,(Q>-1||bn(E,"default"))&&r.push(I)}}}const g=[h,r];return cr(n)&&i.set(n,g),g}function NM(n){return n[0]!=="$"}function zM(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function UM(n,e){return zM(n)===zM(e)}function OM(n,e){return Ki(e)?e.findIndex(t=>UM(t,n)):on(e)&&UM(e,n)?0:-1}const NR=n=>n[0]==="_"||n==="$stable",Nb=n=>Ki(n)?n.map(xl):[xl(n)],zz=(n,e,t)=>{if(e._n)return e;const i=Fs((...o)=>Nb(e(...o)),t);return i._c=!1,i},zR=(n,e,t)=>{const i=n._ctx;for(const o in n){if(NR(o))continue;const u=n[o];if(on(u))e[o]=zz(o,u,i);else if(u!=null){const h=Nb(u);e[o]=()=>h}}},UR=(n,e)=>{const t=Nb(e);n.slots.default=()=>t},Uz=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=rn(e),mx(e,"_",t)):zR(e,n.slots={})}else n.slots={},e&&UR(n,e);mx(n.slots,a1,1)},Oz=(n,e,t)=>{const{vnode:i,slots:o}=n;let u=!0,h=ar;if(i.shapeFlag&32){const r=e._;r?t&&r===1?u=!1:(fs(o,e),!t&&r===1&&delete o._):(u=!e.$stable,zR(e,o)),h=e}else e&&(UR(n,e),h={default:1});if(u)for(const r in o)!NR(r)&&!(r in h)&&delete o[r]};function OR(){return{app:null,config:{isNativeTag:gN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Gz=0;function Hz(n,e){return function(i,o=null){on(i)||(i=Object.assign({},i)),o!=null&&!cr(o)&&(o=null);const u=OR(),h=new Set;let r=!1;const p=u.app={_uid:Gz++,_component:i,_props:o,_container:null,_context:u,_instance:null,version:pU,get config(){return u.config},set config(g){},use(g,...v){return h.has(g)||(g&&on(g.install)?(h.add(g),g.install(p,...v)):on(g)&&(h.add(g),g(p,...v))),p},mixin(g){return u.mixins.includes(g)||u.mixins.push(g),p},component(g,v){return v?(u.components[g]=v,p):u.components[g]},directive(g,v){return v?(u.directives[g]=v,p):u.directives[g]},mount(g,v,I){if(!r){const C=Di(i,o);return C.appContext=u,v&&e?e(C,g):n(C,g,I),r=!0,p._container=g,g.__vue_app__=p,l1(C.component)||C.component.proxy}},unmount(){r&&(n(null,p._container),delete p._container.__vue_app__)},provide(g,v){return u.provides[g]=v,p}};return p}}function $E(n,e,t,i,o=!1){if(Ki(n)){n.forEach((C,E)=>$E(C,e&&(Ki(e)?e[E]:e),t,i,o));return}if(u_(i)&&!o)return;const u=i.shapeFlag&4?l1(i.component)||i.component.proxy:i.el,h=o?null:u,{i:r,r:p}=n,g=e&&e.r,v=r.refs===ar?r.refs={}:r.refs,I=r.setupState;if(g!=null&&g!==p&&(Pr(g)?(v[g]=null,bn(I,g)&&(I[g]=null)):lr(g)&&(g.value=null)),on(p))Ku(p,r,12,[h,v]);else{const C=Pr(p),E=lr(p);if(C||E){const Q=()=>{if(n.f){const M=C?bn(I,p)?I[p]:v[p]:p.value;o?Ki(M)&&_b(M,u):Ki(M)?M.includes(u)||M.push(u):C?(v[p]=[u],bn(I,p)&&(I[p]=v[p])):(p.value=[u],n.k&&(v[n.k]=p.value))}else C?(v[p]=h,bn(I,p)&&(I[p]=h)):E&&(p.value=h,n.k&&(v[n.k]=h))};h?(Q.id=-1,co(Q,t)):Q()}}}const co=mz;function Vz(n){return Wz(n)}function Wz(n,e){const t=CN();t.__VUE__=!0;const{insert:i,remove:o,patchProp:u,createElement:h,createText:r,createComment:p,setText:g,setElementText:v,parentNode:I,nextSibling:C,setScopeId:E=$a,insertStaticContent:Q}=n,M=(ae,_e,Ze,nt=null,ut=null,ze=null,Qt=!1,mt=null,Ut=!!_e.dynamicChildren)=>{if(ae===_e)return;ae&&!yd(ae,_e)&&(nt=dt(ae),Fe(ae,ut,ze,!0),ae=null),_e.patchFlag===-2&&(Ut=!1,_e.dynamicChildren=null);const{type:Dt,ref:Ie,shapeFlag:ue}=_e;switch(Dt){case o1:D(ae,_e,Ze,nt);break;case ga:P(ae,_e,Ze,nt);break;case f_:ae==null&&O(_e,Ze,nt,Qt);break;case ir:te(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut);break;default:ue&1?z(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut):ue&6?ce(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut):(ue&64||ue&128)&&Dt.process(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut,ft)}Ie!=null&&ut&&$E(Ie,ae&&ae.ref,ze,_e||ae,!_e)},D=(ae,_e,Ze,nt)=>{if(ae==null)i(_e.el=r(_e.children),Ze,nt);else{const ut=_e.el=ae.el;_e.children!==ae.children&&g(ut,_e.children)}},P=(ae,_e,Ze,nt)=>{ae==null?i(_e.el=p(_e.children||""),Ze,nt):_e.el=ae.el},O=(ae,_e,Ze,nt)=>{[ae.el,ae.anchor]=Q(ae.children,_e,Ze,nt,ae.el,ae.anchor)},F=({el:ae,anchor:_e},Ze,nt)=>{let ut;for(;ae&&ae!==_e;)ut=C(ae),i(ae,Ze,nt),ae=ut;i(_e,Ze,nt)},N=({el:ae,anchor:_e})=>{let Ze;for(;ae&&ae!==_e;)Ze=C(ae),o(ae),ae=Ze;o(_e)},z=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut)=>{Qt=Qt||_e.type==="svg",ae==null?X(_e,Ze,nt,ut,ze,Qt,mt,Ut):W(ae,_e,ut,ze,Qt,mt,Ut)},X=(ae,_e,Ze,nt,ut,ze,Qt,mt)=>{let Ut,Dt;const{type:Ie,props:ue,shapeFlag:at,transition:St,dirs:yt}=ae;if(Ut=ae.el=h(ae.type,ze,ue&&ue.is,ue),at&8?v(Ut,ae.children):at&16&&H(ae.children,Ut,null,nt,ut,ze&&Ie!=="foreignObject",Qt,mt),yt&&id(ae,null,nt,"created"),q(Ut,ae,ae.scopeId,Qt,nt),ue){for(const Ot in ue)Ot!=="value"&&!Kv(Ot)&&u(Ut,Ot,null,ue[Ot],ze,ae.children,nt,ut,Ne);"value"in ue&&u(Ut,"value",null,ue.value),(Dt=ue.onVnodeBeforeMount)&&ml(Dt,nt,ae)}yt&&id(ae,null,nt,"beforeMount");const Pt=(!ut||ut&&!ut.pendingBranch)&&St&&!St.persisted;Pt&&St.beforeEnter(Ut),i(Ut,_e,Ze),((Dt=ue&&ue.onVnodeMounted)||Pt||yt)&&co(()=>{Dt&&ml(Dt,nt,ae),Pt&&St.enter(Ut),yt&&id(ae,null,nt,"mounted")},ut)},q=(ae,_e,Ze,nt,ut)=>{if(Ze&&E(ae,Ze),nt)for(let ze=0;ze<nt.length;ze++)E(ae,nt[ze]);if(ut){let ze=ut.subTree;if(_e===ze){const Qt=ut.vnode;q(ae,Qt,Qt.scopeId,Qt.slotScopeIds,ut.parent)}}},H=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut=0)=>{for(let Dt=Ut;Dt<ae.length;Dt++){const Ie=ae[Dt]=mt?Ru(ae[Dt]):xl(ae[Dt]);M(null,Ie,_e,Ze,nt,ut,ze,Qt,mt)}},W=(ae,_e,Ze,nt,ut,ze,Qt)=>{const mt=_e.el=ae.el;let{patchFlag:Ut,dynamicChildren:Dt,dirs:Ie}=_e;Ut|=ae.patchFlag&16;const ue=ae.props||ar,at=_e.props||ar;let St;Ze&&nd(Ze,!1),(St=at.onVnodeBeforeUpdate)&&ml(St,Ze,_e,ae),Ie&&id(_e,ae,Ze,"beforeUpdate"),Ze&&nd(Ze,!0);const yt=ut&&_e.type!=="foreignObject";if(Dt?se(ae.dynamicChildren,Dt,mt,Ze,nt,yt,ze):Qt||ye(ae,_e,mt,null,Ze,nt,yt,ze,!1),Ut>0){if(Ut&16)de(mt,_e,ue,at,Ze,nt,ut);else if(Ut&2&&ue.class!==at.class&&u(mt,"class",null,at.class,ut),Ut&4&&u(mt,"style",ue.style,at.style,ut),Ut&8){const Pt=_e.dynamicProps;for(let Ot=0;Ot<Pt.length;Ot++){const Ue=Pt[Ot],ot=ue[Ue],ni=at[Ue];(ni!==ot||Ue==="value")&&u(mt,Ue,ot,ni,ut,ae.children,Ze,nt,Ne)}}Ut&1&&ae.children!==_e.children&&v(mt,_e.children)}else!Qt&&Dt==null&&de(mt,_e,ue,at,Ze,nt,ut);((St=at.onVnodeUpdated)||Ie)&&co(()=>{St&&ml(St,Ze,_e,ae),Ie&&id(_e,ae,Ze,"updated")},nt)},se=(ae,_e,Ze,nt,ut,ze,Qt)=>{for(let mt=0;mt<_e.length;mt++){const Ut=ae[mt],Dt=_e[mt],Ie=Ut.el&&(Ut.type===ir||!yd(Ut,Dt)||Ut.shapeFlag&70)?I(Ut.el):Ze;M(Ut,Dt,Ie,null,nt,ut,ze,Qt,!0)}},de=(ae,_e,Ze,nt,ut,ze,Qt)=>{if(Ze!==nt){if(Ze!==ar)for(const mt in Ze)!Kv(mt)&&!(mt in nt)&&u(ae,mt,Ze[mt],null,Qt,_e.children,ut,ze,Ne);for(const mt in nt){if(Kv(mt))continue;const Ut=nt[mt],Dt=Ze[mt];Ut!==Dt&&mt!=="value"&&u(ae,mt,Dt,Ut,Qt,_e.children,ut,ze,Ne)}"value"in nt&&u(ae,"value",Ze.value,nt.value)}},te=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut)=>{const Dt=_e.el=ae?ae.el:r(""),Ie=_e.anchor=ae?ae.anchor:r("");let{patchFlag:ue,dynamicChildren:at,slotScopeIds:St}=_e;St&&(mt=mt?mt.concat(St):St),ae==null?(i(Dt,Ze,nt),i(Ie,Ze,nt),H(_e.children,Ze,Ie,ut,ze,Qt,mt,Ut)):ue>0&&ue&64&&at&&ae.dynamicChildren?(se(ae.dynamicChildren,at,Ze,ut,ze,Qt,mt),(_e.key!=null||ut&&_e===ut.subTree)&&zb(ae,_e,!0)):ye(ae,_e,Ze,Ie,ut,ze,Qt,mt,Ut)},ce=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut)=>{_e.slotScopeIds=mt,ae==null?_e.shapeFlag&512?ut.ctx.activate(_e,Ze,nt,Qt,Ut):Ee(_e,Ze,nt,ut,ze,Qt,Ut):Be(ae,_e,Ut)},Ee=(ae,_e,Ze,nt,ut,ze,Qt)=>{const mt=ae.component=rU(ae,nt,ut);if(n1(ae)&&(mt.ctx.renderer=ft),sU(mt),mt.asyncDep){if(ut&&ut.registerDep(mt,De),!ae.el){const Ut=mt.subTree=Di(ga);P(null,Ut,_e,Ze)}return}De(mt,ae,_e,Ze,ut,ze,Qt)},Be=(ae,_e,Ze)=>{const nt=_e.component=ae.component;if(pz(ae,_e,Ze))if(nt.asyncDep&&!nt.asyncResolved){Re(nt,_e,Ze);return}else nt.next=_e,lz(nt.update),nt.update();else _e.el=ae.el,nt.vnode=_e},De=(ae,_e,Ze,nt,ut,ze,Qt)=>{const mt=()=>{if(ae.isMounted){let{next:Ie,bu:ue,u:at,parent:St,vnode:yt}=ae,Pt=Ie,Ot;nd(ae,!1),Ie?(Ie.el=yt.el,Re(ae,Ie,Qt)):Ie=yt,ue&&Jv(ue),(Ot=Ie.props&&Ie.props.onVnodeBeforeUpdate)&&ml(Ot,St,Ie,yt),nd(ae,!0);const Ue=gC(ae),ot=ae.subTree;ae.subTree=Ue,M(ot,Ue,I(ot.el),dt(ot),ae,ut,ze),Ie.el=Ue.el,Pt===null&&Az(ae,Ue.el),at&&co(at,ut),(Ot=Ie.props&&Ie.props.onVnodeUpdated)&&co(()=>ml(Ot,St,Ie,yt),ut)}else{let Ie;const{el:ue,props:at}=_e,{bm:St,m:yt,parent:Pt}=ae,Ot=u_(_e);if(nd(ae,!1),St&&Jv(St),!Ot&&(Ie=at&&at.onVnodeBeforeMount)&&ml(Ie,Pt,_e),nd(ae,!0),ue&&Ye){const Ue=()=>{ae.subTree=gC(ae),Ye(ue,ae.subTree,ae,ut,null)};Ot?_e.type.__asyncLoader().then(()=>!ae.isUnmounted&&Ue()):Ue()}else{const Ue=ae.subTree=gC(ae);M(null,Ue,Ze,nt,ae,ut,ze),_e.el=Ue.el}if(yt&&co(yt,ut),!Ot&&(Ie=at&&at.onVnodeMounted)){const Ue=_e;co(()=>ml(Ie,Pt,Ue),ut)}(_e.shapeFlag&256||Pt&&u_(Pt.vnode)&&Pt.vnode.shapeFlag&256)&&ae.a&&co(ae.a,ut),ae.isMounted=!0,_e=Ze=nt=null}},Ut=ae.effect=new Cb(mt,()=>Rb(Dt),ae.scope),Dt=ae.update=()=>Ut.run();Dt.id=ae.uid,nd(ae,!0),Dt()},Re=(ae,_e,Ze)=>{_e.component=ae;const nt=ae.vnode.props;ae.vnode=_e,ae.next=null,Nz(ae,_e.props,nt,Ze),Oz(ae,_e.children,Ze),zA(),QM(),UA()},ye=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut=!1)=>{const Dt=ae&&ae.children,Ie=ae?ae.shapeFlag:0,ue=_e.children,{patchFlag:at,shapeFlag:St}=_e;if(at>0){if(at&128){oe(Dt,ue,Ze,nt,ut,ze,Qt,mt,Ut);return}else if(at&256){ht(Dt,ue,Ze,nt,ut,ze,Qt,mt,Ut);return}}St&8?(Ie&16&&Ne(Dt,ut,ze),ue!==Dt&&v(Ze,ue)):Ie&16?St&16?oe(Dt,ue,Ze,nt,ut,ze,Qt,mt,Ut):Ne(Dt,ut,ze,!0):(Ie&8&&v(Ze,""),St&16&&H(ue,Ze,nt,ut,ze,Qt,mt,Ut))},ht=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut)=>{ae=ae||qp,_e=_e||qp;const Dt=ae.length,Ie=_e.length,ue=Math.min(Dt,Ie);let at;for(at=0;at<ue;at++){const St=_e[at]=Ut?Ru(_e[at]):xl(_e[at]);M(ae[at],St,Ze,null,ut,ze,Qt,mt,Ut)}Dt>Ie?Ne(ae,ut,ze,!0,!1,ue):H(_e,Ze,nt,ut,ze,Qt,mt,Ut,ue)},oe=(ae,_e,Ze,nt,ut,ze,Qt,mt,Ut)=>{let Dt=0;const Ie=_e.length;let ue=ae.length-1,at=Ie-1;for(;Dt<=ue&&Dt<=at;){const St=ae[Dt],yt=_e[Dt]=Ut?Ru(_e[Dt]):xl(_e[Dt]);if(yd(St,yt))M(St,yt,Ze,null,ut,ze,Qt,mt,Ut);else break;Dt++}for(;Dt<=ue&&Dt<=at;){const St=ae[ue],yt=_e[at]=Ut?Ru(_e[at]):xl(_e[at]);if(yd(St,yt))M(St,yt,Ze,null,ut,ze,Qt,mt,Ut);else break;ue--,at--}if(Dt>ue){if(Dt<=at){const St=at+1,yt=St<Ie?_e[St].el:nt;for(;Dt<=at;)M(null,_e[Dt]=Ut?Ru(_e[Dt]):xl(_e[Dt]),Ze,yt,ut,ze,Qt,mt,Ut),Dt++}}else if(Dt>at)for(;Dt<=ue;)Fe(ae[Dt],ut,ze,!0),Dt++;else{const St=Dt,yt=Dt,Pt=new Map;for(Dt=yt;Dt<=at;Dt++){const si=_e[Dt]=Ut?Ru(_e[Dt]):xl(_e[Dt]);si.key!=null&&Pt.set(si.key,Dt)}let Ot,Ue=0;const ot=at-yt+1;let ni=!1,fi=0;const Xt=new Array(ot);for(Dt=0;Dt<ot;Dt++)Xt[Dt]=0;for(Dt=St;Dt<=ue;Dt++){const si=ae[Dt];if(Ue>=ot){Fe(si,ut,ze,!0);continue}let wt;if(si.key!=null)wt=Pt.get(si.key);else for(Ot=yt;Ot<=at;Ot++)if(Xt[Ot-yt]===0&&yd(si,_e[Ot])){wt=Ot;break}wt===void 0?Fe(si,ut,ze,!0):(Xt[wt-yt]=Dt+1,wt>=fi?fi=wt:ni=!0,M(si,_e[wt],Ze,null,ut,ze,Qt,mt,Ut),Ue++)}const _i=ni?Yz(Xt):qp;for(Ot=_i.length-1,Dt=ot-1;Dt>=0;Dt--){const si=yt+Dt,wt=_e[si],kt=si+1<Ie?_e[si+1].el:nt;Xt[Dt]===0?M(null,wt,Ze,kt,ut,ze,Qt,mt,Ut):ni&&(Ot<0||Dt!==_i[Ot]?Tt(wt,Ze,kt,2):Ot--)}}},Tt=(ae,_e,Ze,nt,ut=null)=>{const{el:ze,type:Qt,transition:mt,children:Ut,shapeFlag:Dt}=ae;if(Dt&6){Tt(ae.component.subTree,_e,Ze,nt);return}if(Dt&128){ae.suspense.move(_e,Ze,nt);return}if(Dt&64){Qt.move(ae,_e,Ze,ft);return}if(Qt===ir){i(ze,_e,Ze);for(let ue=0;ue<Ut.length;ue++)Tt(Ut[ue],_e,Ze,nt);i(ae.anchor,_e,Ze);return}if(Qt===f_){F(ae,_e,Ze);return}if(nt!==2&&Dt&1&&mt)if(nt===0)mt.beforeEnter(ze),i(ze,_e,Ze),co(()=>mt.enter(ze),ut);else{const{leave:ue,delayLeave:at,afterLeave:St}=mt,yt=()=>i(ze,_e,Ze),Pt=()=>{ue(ze,()=>{yt(),St&&St()})};at?at(ze,yt,Pt):Pt()}else i(ze,_e,Ze)},Fe=(ae,_e,Ze,nt=!1,ut=!1)=>{const{type:ze,props:Qt,ref:mt,children:Ut,dynamicChildren:Dt,shapeFlag:Ie,patchFlag:ue,dirs:at}=ae;if(mt!=null&&$E(mt,null,Ze,ae,!0),Ie&256){_e.ctx.deactivate(ae);return}const St=Ie&1&&at,yt=!u_(ae);let Pt;if(yt&&(Pt=Qt&&Qt.onVnodeBeforeUnmount)&&ml(Pt,_e,ae),Ie&6)Ke(ae.component,Ze,nt);else{if(Ie&128){ae.suspense.unmount(Ze,nt);return}St&&id(ae,null,_e,"beforeUnmount"),Ie&64?ae.type.remove(ae,_e,Ze,ut,ft,nt):Dt&&(ze!==ir||ue>0&&ue&64)?Ne(Dt,_e,Ze,!1,!0):(ze===ir&&ue&384||!ut&&Ie&16)&&Ne(Ut,_e,Ze),nt&&st(ae)}(yt&&(Pt=Qt&&Qt.onVnodeUnmounted)||St)&&co(()=>{Pt&&ml(Pt,_e,ae),St&&id(ae,null,_e,"unmounted")},Ze)},st=ae=>{const{type:_e,el:Ze,anchor:nt,transition:ut}=ae;if(_e===ir){Et(Ze,nt);return}if(_e===f_){N(ae);return}const ze=()=>{o(Ze),ut&&!ut.persisted&&ut.afterLeave&&ut.afterLeave()};if(ae.shapeFlag&1&&ut&&!ut.persisted){const{leave:Qt,delayLeave:mt}=ut,Ut=()=>Qt(Ze,ze);mt?mt(ae.el,ze,Ut):Ut()}else ze()},Et=(ae,_e)=>{let Ze;for(;ae!==_e;)Ze=C(ae),o(ae),ae=Ze;o(_e)},Ke=(ae,_e,Ze)=>{const{bum:nt,scope:ut,update:ze,subTree:Qt,um:mt}=ae;nt&&Jv(nt),ut.stop(),ze&&(ze.active=!1,Fe(Qt,ae,_e,Ze)),mt&&co(mt,_e),co(()=>{ae.isUnmounted=!0},_e),_e&&_e.pendingBranch&&!_e.isUnmounted&&ae.asyncDep&&!ae.asyncResolved&&ae.suspenseId===_e.pendingId&&(_e.deps--,_e.deps===0&&_e.resolve())},Ne=(ae,_e,Ze,nt=!1,ut=!1,ze=0)=>{for(let Qt=ze;Qt<ae.length;Qt++)Fe(ae[Qt],_e,Ze,nt,ut)},dt=ae=>ae.shapeFlag&6?dt(ae.component.subTree):ae.shapeFlag&128?ae.suspense.next():C(ae.anchor||ae.el),xt=(ae,_e,Ze)=>{ae==null?_e._vnode&&Fe(_e._vnode,null,null,!0):M(_e._vnode||null,ae,_e,null,null,null,Ze),QM(),ER(),_e._vnode=ae},ft={p:M,um:Fe,m:Tt,r:st,mt:Ee,mc:H,pc:ye,pbc:se,n:dt,o:n};let Ve,Ye;return e&&([Ve,Ye]=e(ft)),{render:xt,hydrate:Ve,createApp:Hz(xt,Ve)}}function nd({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function zb(n,e,t=!1){const i=n.children,o=e.children;if(Ki(i)&&Ki(o))for(let u=0;u<i.length;u++){const h=i[u];let r=o[u];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=o[u]=Ru(o[u]),r.el=h.el),t||zb(h,r)),r.type===o1&&(r.el=h.el)}}function Yz(n){const e=n.slice(),t=[0];let i,o,u,h,r;const p=n.length;for(i=0;i<p;i++){const g=n[i];if(g!==0){if(o=t[t.length-1],n[o]<g){e[i]=o,t.push(i);continue}for(u=0,h=t.length-1;u<h;)r=u+h>>1,n[t[r]]<g?u=r+1:h=r;g<n[t[u]]&&(u>0&&(e[i]=t[u-1]),t[u]=i)}}for(u=t.length,h=t[u-1];u-- >0;)t[u]=h,h=e[h];return t}const jz=n=>n.__isTeleport,d_=n=>n&&(n.disabled||n.disabled===""),GM=n=>typeof SVGElement<"u"&&n instanceof SVGElement,ew=(n,e)=>{const t=n&&n.to;return Pr(t)?e?e(t):null:t},qz={__isTeleport:!0,process(n,e,t,i,o,u,h,r,p,g){const{mc:v,pc:I,pbc:C,o:{insert:E,querySelector:Q,createText:M,createComment:D}}=g,P=d_(e.props);let{shapeFlag:O,children:F,dynamicChildren:N}=e;if(n==null){const z=e.el=M(""),X=e.anchor=M("");E(z,t,i),E(X,t,i);const q=e.target=ew(e.props,Q),H=e.targetAnchor=M("");q&&(E(H,q),h=h||GM(q));const W=(se,de)=>{O&16&&v(F,se,de,o,u,h,r,p)};P?W(t,X):q&&W(q,H)}else{e.el=n.el;const z=e.anchor=n.anchor,X=e.target=n.target,q=e.targetAnchor=n.targetAnchor,H=d_(n.props),W=H?t:X,se=H?z:q;if(h=h||GM(X),N?(C(n.dynamicChildren,N,W,o,u,h,r),zb(n,e,!0)):p||I(n,e,W,se,o,u,h,r,!1),P)H||Jy(e,t,z,g,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const de=e.target=ew(e.props,Q);de&&Jy(e,de,null,g,0)}else H&&Jy(e,X,q,g,1)}GR(e)},remove(n,e,t,i,{um:o,o:{remove:u}},h){const{shapeFlag:r,children:p,anchor:g,targetAnchor:v,target:I,props:C}=n;if(I&&u(v),(h||!d_(C))&&(u(g),r&16))for(let E=0;E<p.length;E++){const Q=p[E];o(Q,e,t,!0,!!Q.dynamicChildren)}},move:Jy,hydrate:Kz};function Jy(n,e,t,{o:{insert:i},m:o},u=2){u===0&&i(n.targetAnchor,e,t);const{el:h,anchor:r,shapeFlag:p,children:g,props:v}=n,I=u===2;if(I&&i(h,e,t),(!I||d_(v))&&p&16)for(let C=0;C<g.length;C++)o(g[C],e,t,2);I&&i(r,e,t)}function Kz(n,e,t,i,o,u,{o:{nextSibling:h,parentNode:r,querySelector:p}},g){const v=e.target=ew(e.props,p);if(v){const I=v._lpa||v.firstChild;if(e.shapeFlag&16)if(d_(e.props))e.anchor=g(h(n),e,r(n),t,i,o,u),e.targetAnchor=I;else{e.anchor=h(n);let C=I;for(;C;)if(C=h(C),C&&C.nodeType===8&&C.data==="teleport anchor"){e.targetAnchor=C,v._lpa=e.targetAnchor&&h(e.targetAnchor);break}g(I,e,v,t,i,o,u)}GR(e)}return e.anchor&&h(e.anchor)}const Jz=qz;function GR(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const ir=Symbol(void 0),o1=Symbol(void 0),ga=Symbol(void 0),f_=Symbol(void 0),p_=[];let Xa=null;function Qi(n=!1){p_.push(Xa=n?null:[])}function Xz(){p_.pop(),Xa=p_[p_.length-1]||null}let V_=1;function HM(n){V_+=n}function HR(n){return n.dynamicChildren=V_>0?Xa||qp:null,Xz(),V_>0&&Xa&&Xa.push(n),n}function tn(n,e,t,i,o,u){return HR(Yt(n,e,t,i,o,u,!0))}function ys(n,e,t,i,o){return HR(Di(n,e,t,i,o,!0))}function Ix(n){return n?n.__v_isVNode===!0:!1}function yd(n,e){return n.type===e.type&&n.key===e.key}const a1="__vInternal",VR=({key:n})=>n??null,Xv=({ref:n,ref_key:e,ref_for:t})=>n!=null?Pr(n)||lr(n)||on(n)?{i:xs,r:n,k:e,f:!!t}:n:null;function Yt(n,e=null,t=null,i=0,o=null,u=n===ir?0:1,h=!1,r=!1){const p={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&VR(e),ref:e&&Xv(e),scopeId:t1,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:xs};return r?(Ub(p,t),u&128&&n.normalize(p)):t&&(p.shapeFlag|=Pr(t)?8:16),V_>0&&!h&&Xa&&(p.patchFlag>0||u&6)&&p.patchFlag!==32&&Xa.push(p),p}const Di=Zz;function Zz(n,e=null,t=null,i=0,o=null,u=!1){if((!n||n===Mz)&&(n=ga),Ix(n)){const r=nh(n,e,!0);return t&&Ub(r,t),V_>0&&!u&&Xa&&(r.shapeFlag&6?Xa[Xa.indexOf(n)]=r:Xa.push(r)),r.patchFlag|=-2,r}if(cU(n)&&(n=n.__vccOpts),e){e=$z(e);let{class:r,style:p}=e;r&&!Pr(r)&&(e.class=mn(r)),cr(p)&&(gR(p)&&!Ki(p)&&(p=fs({},p)),e.style=ya(p))}const h=Pr(n)?1:gz(n)?128:jz(n)?64:cr(n)?4:on(n)?2:0;return Yt(n,e,t,i,o,h,u,!0)}function $z(n){return n?gR(n)||a1 in n?fs({},n):n:null}function nh(n,e,t=!1){const{props:i,ref:o,patchFlag:u,children:h}=n,r=e?tU(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:r,key:r&&VR(r),ref:e&&e.ref?t&&o?Ki(o)?o.concat(Xv(e)):[o,Xv(e)]:Xv(e):o,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:h,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==ir?u===-1?16:u|16:u,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&nh(n.ssContent),ssFallback:n.ssFallback&&nh(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function eU(n=" ",e=0){return Di(o1,null,n,e)}function WR(n,e){const t=Di(f_,null,n);return t.staticCount=e,t}function rh(n="",e=!1){return e?(Qi(),ys(ga,null,n)):Di(ga,null,n)}function xl(n){return n==null||typeof n=="boolean"?Di(ga):Ki(n)?Di(ir,null,n.slice()):typeof n=="object"?Ru(n):Di(o1,null,String(n))}function Ru(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:nh(n)}function Ub(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if(Ki(e))t=16;else if(typeof e=="object")if(i&65){const o=e.default;o&&(o._c&&(o._d=!1),Ub(n,o()),o._c&&(o._d=!0));return}else{t=32;const o=e._;!o&&!(a1 in e)?e._ctx=xs:o===3&&xs&&(xs.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else on(e)?(e={default:e,_ctx:xs},t=32):(e=String(e),i&64?(t=16,e=[eU(e)]):t=8);n.children=e,n.shapeFlag|=t}function tU(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const o in i)if(o==="class")e.class!==i.class&&(e.class=mn([e.class,i.class]));else if(o==="style")e.style=ya([e.style,i.style]);else if(jx(o)){const u=e[o],h=i[o];h&&u!==h&&!(Ki(u)&&u.includes(h))&&(e[o]=u?[].concat(u,h):h)}else o!==""&&(e[o]=i[o])}return e}function ml(n,e,t,i=null){pa(n,e,7,[t,i])}const iU=OR();let nU=0;function rU(n,e,t){const i=n.type,o=(e?e.appContext:n.appContext)||iU,u={uid:nU++,vnode:n,type:i,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new nR(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:FR(i,o),emitsOptions:bR(i,o),emit:null,emitted:null,propsDefaults:ar,inheritAttrs:i.inheritAttrs,ctx:ar,data:ar,props:ar,attrs:ar,slots:ar,refs:ar,setupState:ar,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=e?e.root:u,u.emit=hz.bind(null,u),n.ce&&n.ce(u),u}let Rr=null;const hh=()=>Rr||xs,pA=n=>{Rr=n,n.scope.on()},Dd=()=>{Rr&&Rr.scope.off(),Rr=null};function YR(n){return n.vnode.shapeFlag&4}let W_=!1;function sU(n,e=!1){W_=e;const{props:t,children:i}=n.vnode,o=YR(n);Fz(n,t,o,e),Uz(n,i);const u=o?oU(n,e):void 0;return W_=!1,u}function oU(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=fA(new Proxy(n.ctx,Dz));const{setup:i}=t;if(i){const o=n.setupContext=i.length>1?qR(n):null;pA(n),zA();const u=Ku(i,n,0,[n.props,o]);if(UA(),Dd(),eR(u)){if(u.then(Dd,Dd),e)return u.then(h=>{VM(n,h,e)}).catch(h=>{$x(h,n,0)});n.asyncDep=u}else VM(n,u,e)}else jR(n,e)}function VM(n,e,t){on(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:cr(e)&&(n.setupState=yR(e)),jR(n,t)}let WM;function jR(n,e,t){const i=n.type;if(!n.render){if(!e&&WM&&!i.render){const o=i.template||Fb(n).template;if(o){const{isCustomElement:u,compilerOptions:h}=n.appContext.config,{delimiters:r,compilerOptions:p}=i,g=fs(fs({isCustomElement:u,delimiters:r},h),p);i.render=WM(o,g)}}n.render=i.render||$a}pA(n),zA(),Qz(n),UA(),Dd()}function aU(n){return new Proxy(n.attrs,{get(e,t){return yo(n,"get","$attrs"),e[t]}})}function qR(n){const e=i=>{n.exposed=i||{}};let t;return{get attrs(){return t||(t=aU(n))},slots:n.slots,emit:n.emit,expose:e}}function l1(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(yR(fA(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in h_)return h_[t](n)},has(e,t){return t in e||t in h_}}))}function lU(n,e=!0){return on(n)?n.displayName||n.name:n.name||e&&n.__name}function cU(n){return on(n)&&"__vccOpts"in n}const cn=(n,e)=>sz(n,e,W_);function uU(){return hU().slots}function hU(){const n=hh();return n.setupContext||(n.setupContext=qR(n))}function Qd(n,e,t){const i=arguments.length;return i===2?cr(e)&&!Ki(e)?Ix(e)?Di(n,null,[e]):Di(n,e):Di(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&Ix(t)&&(t=[t]),Di(n,e,t))}const dU=Symbol(""),fU=()=>Aa(dU),pU="3.2.47",AU="http://www.w3.org/2000/svg",vd=typeof document<"u"?document:null,YM=vd&&vd.createElement("template"),gU={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const o=e?vd.createElementNS(AU,n):vd.createElement(n,t?{is:t}:void 0);return n==="select"&&i&&i.multiple!=null&&o.setAttribute("multiple",i.multiple),o},createText:n=>vd.createTextNode(n),createComment:n=>vd.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>vd.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,o,u){const h=t?t.previousSibling:e.lastChild;if(o&&(o===u||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),t),!(o===u||!(o=o.nextSibling)););else{YM.innerHTML=i?`<svg>${n}</svg>`:n;const r=YM.content;if(i){const p=r.firstChild;for(;p.firstChild;)r.appendChild(p.firstChild);r.removeChild(p)}e.insertBefore(r,t)}return[h?h.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function mU(n,e,t){const i=n._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function _U(n,e,t){const i=n.style,o=Pr(t);if(t&&!o){if(e&&!Pr(e))for(const u in e)t[u]==null&&tw(i,u,"");for(const u in t)tw(i,u,t[u])}else{const u=i.display;o?e!==t&&(i.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(i.display=u)}}const jM=/\s*!important$/;function tw(n,e,t){if(Ki(t))t.forEach(i=>tw(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=yU(n,e);jM.test(t)?n.setProperty(NA(i),t.replace(jM,""),"important"):n[i]=t}}const qM=["Webkit","Moz","ms"],yC={};function yU(n,e){const t=yC[e];if(t)return t;let i=Dl(e);if(i!=="filter"&&i in n)return yC[e]=i;i=Jx(i);for(let o=0;o<qM.length;o++){const u=qM[o]+i;if(u in n)return yC[e]=u}return e}const KM="http://www.w3.org/1999/xlink";function vU(n,e,t,i,o){if(i&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(KM,e.slice(6,e.length)):n.setAttributeNS(KM,e,t);else{const u=AN(e);t==null||u&&!X3(t)?n.removeAttribute(e):n.setAttribute(e,u?"":t)}}function xU(n,e,t,i,o,u,h){if(e==="innerHTML"||e==="textContent"){i&&h(i,o,u),n[e]=t??"";return}if(e==="value"&&n.tagName!=="PROGRESS"&&!n.tagName.includes("-")){n._value=t;const p=t??"";(n.value!==p||n.tagName==="OPTION")&&(n.value=p),t==null&&n.removeAttribute(e);return}let r=!1;if(t===""||t==null){const p=typeof n[e];p==="boolean"?t=X3(t):t==null&&p==="string"?(t="",r=!0):p==="number"&&(t=0,r=!0)}try{n[e]=t}catch{}r&&n.removeAttribute(e)}function Lp(n,e,t,i){n.addEventListener(e,t,i)}function IU(n,e,t,i){n.removeEventListener(e,t,i)}function CU(n,e,t,i,o=null){const u=n._vei||(n._vei={}),h=u[e];if(i&&h)h.value=i;else{const[r,p]=EU(e);if(i){const g=u[e]=BU(i,o);Lp(n,r,g,p)}else h&&(IU(n,r,h,p),u[e]=void 0)}}const JM=/(?:Once|Passive|Capture)$/;function EU(n){let e;if(JM.test(n)){e={};let i;for(;i=n.match(JM);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):NA(n.slice(2)),e]}let vC=0;const wU=Promise.resolve(),bU=()=>vC||(wU.then(()=>vC=0),vC=Date.now());function BU(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;pa(SU(i,t.value),e,5,[i])};return t.value=n,t.attached=bU(),t}function SU(n,e){if(Ki(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>o=>!o._stopped&&i&&i(o))}else return e}const XM=/^on[a-z]/,MU=(n,e,t,i,o=!1,u,h,r,p)=>{e==="class"?mU(n,i,o):e==="style"?_U(n,t,i):jx(e)?mb(e)||CU(n,e,t,i,h):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):TU(n,e,i,o))?xU(n,e,i,u,h,r,p):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),vU(n,e,i,o))};function TU(n,e,t,i){return i?!!(e==="innerHTML"||e==="textContent"||e in n&&XM.test(e)&&on(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||XM.test(e)&&Pr(t)?!1:e in n}function DU(n){const e=hh();if(!e)return;const t=e.ut=(o=n(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(u=>nw(u,o))},i=()=>{const o=n(e.proxy);iw(e.subTree,o),t(o)};_z(i),Br(()=>{const o=new MutationObserver(i);o.observe(e.subTree.el.parentNode,{childList:!0}),of(()=>o.disconnect())})}function iw(n,e){if(n.shapeFlag&128){const t=n.suspense;n=t.activeBranch,t.pendingBranch&&!t.isHydrating&&t.effects.push(()=>{iw(t.activeBranch,e)})}for(;n.component;)n=n.component.subTree;if(n.shapeFlag&1&&n.el)nw(n.el,e);else if(n.type===ir)n.children.forEach(t=>iw(t,e));else if(n.type===f_){let{el:t,anchor:i}=n;for(;t&&(nw(t,e),t!==i);)t=t.nextSibling}}function nw(n,e){if(n.nodeType===1){const t=n.style;for(const i in e)t.setProperty(`--${i}`,e[i])}}const _u="transition",Im="animation",AA=(n,{slots:e})=>Qd(MR,JR(n),e);AA.displayName="Transition";const KR={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},QU=AA.props=fs({},MR.props,KR),rd=(n,e=[])=>{Ki(n)?n.forEach(t=>t(...e)):n&&n(...e)},ZM=n=>n?Ki(n)?n.some(e=>e.length>1):n.length>1:!1;function JR(n){const e={};for(const te in n)te in KR||(e[te]=n[te]);if(n.css===!1)return e;const{name:t="v",type:i,duration:o,enterFromClass:u=`${t}-enter-from`,enterActiveClass:h=`${t}-enter-active`,enterToClass:r=`${t}-enter-to`,appearFromClass:p=u,appearActiveClass:g=h,appearToClass:v=r,leaveFromClass:I=`${t}-leave-from`,leaveActiveClass:C=`${t}-leave-active`,leaveToClass:E=`${t}-leave-to`}=n,Q=RU(o),M=Q&&Q[0],D=Q&&Q[1],{onBeforeEnter:P,onEnter:O,onEnterCancelled:F,onLeave:N,onLeaveCancelled:z,onBeforeAppear:X=P,onAppear:q=O,onAppearCancelled:H=F}=e,W=(te,ce,Ee)=>{Du(te,ce?v:r),Du(te,ce?g:h),Ee&&Ee()},se=(te,ce)=>{te._isLeaving=!1,Du(te,I),Du(te,E),Du(te,C),ce&&ce()},de=te=>(ce,Ee)=>{const Be=te?q:O,De=()=>W(ce,te,Ee);rd(Be,[ce,De]),$M(()=>{Du(ce,te?p:u),cc(ce,te?v:r),ZM(Be)||eT(ce,i,M,De)})};return fs(e,{onBeforeEnter(te){rd(P,[te]),cc(te,u),cc(te,h)},onBeforeAppear(te){rd(X,[te]),cc(te,p),cc(te,g)},onEnter:de(!1),onAppear:de(!0),onLeave(te,ce){te._isLeaving=!0;const Ee=()=>se(te,ce);cc(te,I),ZR(),cc(te,C),$M(()=>{te._isLeaving&&(Du(te,I),cc(te,E),ZM(N)||eT(te,i,D,Ee))}),rd(N,[te,Ee])},onEnterCancelled(te){W(te,!1),rd(F,[te])},onAppearCancelled(te){W(te,!0),rd(H,[te])},onLeaveCancelled(te){se(te),rd(z,[te])}})}function RU(n){if(n==null)return null;if(cr(n))return[xC(n.enter),xC(n.leave)];{const e=xC(n);return[e,e]}}function xC(n){return IN(n)}function cc(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n._vtc||(n._vtc=new Set)).add(e)}function Du(n,e){e.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const{_vtc:t}=n;t&&(t.delete(e),t.size||(n._vtc=void 0))}function $M(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let LU=0;function eT(n,e,t,i){const o=n._endId=++LU,u=()=>{o===n._endId&&i()};if(t)return setTimeout(u,t);const{type:h,timeout:r,propCount:p}=XR(n,e);if(!h)return i();const g=h+"end";let v=0;const I=()=>{n.removeEventListener(g,C),u()},C=E=>{E.target===n&&++v>=p&&I()};setTimeout(()=>{v<p&&I()},r+1),n.addEventListener(g,C)}function XR(n,e){const t=window.getComputedStyle(n),i=Q=>(t[Q]||"").split(", "),o=i(`${_u}Delay`),u=i(`${_u}Duration`),h=tT(o,u),r=i(`${Im}Delay`),p=i(`${Im}Duration`),g=tT(r,p);let v=null,I=0,C=0;e===_u?h>0&&(v=_u,I=h,C=u.length):e===Im?g>0&&(v=Im,I=g,C=p.length):(I=Math.max(h,g),v=I>0?h>g?_u:Im:null,C=v?v===_u?u.length:p.length:0);const E=v===_u&&/\b(transform|all)(,|$)/.test(i(`${_u}Property`).toString());return{type:v,timeout:I,propCount:C,hasTransform:E}}function tT(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,i)=>iT(t)+iT(n[i])))}function iT(n){return Number(n.slice(0,-1).replace(",","."))*1e3}function ZR(){return document.body.offsetHeight}const $R=new WeakMap,eL=new WeakMap,tL={name:"TransitionGroup",props:fs({},QU,{tag:String,moveClass:String}),setup(n,{slots:e}){const t=hh(),i=SR();let o,u;return kb(()=>{if(!o.length)return;const h=n.moveClass||`${n.name||"v"}-move`;if(!UU(o[0].el,t.vnode.el,h))return;o.forEach(FU),o.forEach(NU);const r=o.filter(zU);ZR(),r.forEach(p=>{const g=p.el,v=g.style;cc(g,h),v.transform=v.webkitTransform=v.transitionDuration="";const I=g._moveCb=C=>{C&&C.target!==g||(!C||/transform$/.test(C.propertyName))&&(g.removeEventListener("transitionend",I),g._moveCb=null,Du(g,h))};g.addEventListener("transitionend",I)})}),()=>{const h=rn(n),r=JR(h);let p=h.tag||ir;o=u,u=e.default?Pb(e.default()):[];for(let g=0;g<u.length;g++){const v=u[g];v.key!=null&&G_(v,O_(v,r,i,t))}if(o)for(let g=0;g<o.length;g++){const v=o[g];G_(v,O_(v,r,i,t)),$R.set(v,v.el.getBoundingClientRect())}return Di(p,null,u)}}},PU=n=>delete n.mode;tL.props;const kU=tL;function FU(n){const e=n.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function NU(n){eL.set(n,n.el.getBoundingClientRect())}function zU(n){const e=$R.get(n),t=eL.get(n),i=e.left-t.left,o=e.top-t.top;if(i||o){const u=n.el.style;return u.transform=u.webkitTransform=`translate(${i}px,${o}px)`,u.transitionDuration="0s",n}}function UU(n,e,t){const i=n.cloneNode();n._vtc&&n._vtc.forEach(h=>{h.split(/\s+/).forEach(r=>r&&i.classList.remove(r))}),t.split(/\s+/).forEach(h=>h&&i.classList.add(h)),i.style.display="none";const o=e.nodeType===1?e:e.parentNode;o.appendChild(i);const{hasTransform:u}=XR(i);return o.removeChild(i),u}const nT=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Ki(e)?t=>Jv(e,t):e};function OU(n){n.target.composing=!0}function rT(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const sT={created(n,{modifiers:{lazy:e,trim:t,number:i}},o){n._assign=nT(o);const u=i||o.props&&o.props.type==="number";Lp(n,e?"change":"input",h=>{if(h.target.composing)return;let r=n.value;t&&(r=r.trim()),u&&(r=VE(r)),n._assign(r)}),t&&Lp(n,"change",()=>{n.value=n.value.trim()}),e||(Lp(n,"compositionstart",OU),Lp(n,"compositionend",rT),Lp(n,"change",rT))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,modifiers:{lazy:t,trim:i,number:o}},u){if(n._assign=nT(u),n.composing||document.activeElement===n&&n.type!=="range"&&(t||i&&n.value.trim()===e||(o||n.type==="number")&&VE(n.value)===e))return;const h=e??"";n.value!==h&&(n.value=h)}},GU=["ctrl","shift","alt","meta"],HU={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>GU.some(t=>n[`${t}Key`]&&!e.includes(t))},Cx=(n,e)=>(t,...i)=>{for(let o=0;o<e.length;o++){const u=HU[e[o]];if(u&&u(t,e))return}return n(t,...i)},Ob={beforeMount(n,{value:e},{transition:t}){n._vod=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Cm(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),Cm(n,!0),i.enter(n)):i.leave(n,()=>{Cm(n,!1)}):Cm(n,e))},beforeUnmount(n,{value:e}){Cm(n,e)}};function Cm(n,e){n.style.display=e?n._vod:"none"}const VU=fs({patchProp:MU},gU);let oT;function WU(){return oT||(oT=Vz(VU))}const YU=(...n)=>{const e=WU().createApp(...n),{mount:t}=e;return e.mount=i=>{const o=jU(i);if(!o)return;const u=e._component;!on(u)&&!u.render&&!u.template&&(u.template=o.innerHTML),o.innerHTML="";const h=t(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),h},e};function jU(n){return Pr(n)?document.querySelector(n):n}var qU=!1;/*!
  * pinia v2.0.30
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let iL;const c1=n=>iL=n,nL=Symbol();function rw(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var A_;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(A_||(A_={}));function KU(){const n=rR(!0),e=n.run(()=>Gt({}));let t=[],i=[];const o=fA({install(u){c1(o),o._a=u,u.provide(nL,o),u.config.globalProperties.$pinia=o,i.forEach(h=>t.push(h)),i=[]},use(u){return!this._a&&!qU?i.push(u):t.push(u),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return o}const rL=()=>{};function aT(n,e,t,i=rL){n.push(e);const o=()=>{const u=n.indexOf(e);u>-1&&(n.splice(u,1),i())};return!t&&xb()&&sR(o),o}function lp(n,...e){n.slice().forEach(t=>{t(...e)})}function sw(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,i)=>n.set(i,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t],o=n[t];rw(o)&&rw(i)&&n.hasOwnProperty(t)&&!lr(i)&&!Bc(i)?n[t]=sw(o,i):n[t]=i}return n}const JU=Symbol();function XU(n){return!rw(n)||!n.hasOwnProperty(JU)}const{assign:Lu}=Object;function ZU(n){return!!(lr(n)&&n.effect)}function $U(n,e,t,i){const{state:o,actions:u,getters:h}=e,r=t.state.value[n];let p;function g(){r||(t.state.value[n]=o?o():{});const v=vR(t.state.value[n]);return Lu(v,u,Object.keys(h||{}).reduce((I,C)=>(I[C]=fA(cn(()=>{c1(t);const E=t._s.get(n);return h[C].call(E,E)})),I),{}))}return p=sL(n,g,e,t,i,!0),p.$reset=function(){const I=o?o():{};this.$patch(C=>{Lu(C,I)})},p}function sL(n,e,t={},i,o,u){let h;const r=Lu({actions:{}},t),p={deep:!0};let g,v,I=fA([]),C=fA([]),E;const Q=i.state.value[n];!u&&!Q&&(i.state.value[n]={}),Gt({});let M;function D(q){let H;g=v=!1,typeof q=="function"?(q(i.state.value[n]),H={type:A_.patchFunction,storeId:n,events:E}):(sw(i.state.value[n],q),H={type:A_.patchObject,payload:q,storeId:n,events:E});const W=M=Symbol();Gr().then(()=>{M===W&&(g=!0)}),v=!0,lp(I,H,i.state.value[n])}const P=rL;function O(){h.stop(),I=[],C=[],i._s.delete(n)}function F(q,H){return function(){c1(i);const W=Array.from(arguments),se=[],de=[];function te(Be){se.push(Be)}function ce(Be){de.push(Be)}lp(C,{args:W,name:q,store:z,after:te,onError:ce});let Ee;try{Ee=H.apply(this&&this.$id===n?this:z,W)}catch(Be){throw lp(de,Be),Be}return Ee instanceof Promise?Ee.then(Be=>(lp(se,Be),Be)).catch(Be=>(lp(de,Be),Promise.reject(Be))):(lp(se,Ee),Ee)}}const N={_p:i,$id:n,$onAction:aT.bind(null,C),$patch:D,$reset:P,$subscribe(q,H={}){const W=aT(I,q,H.detached,()=>se()),se=h.run(()=>qi(()=>i.state.value[n],de=>{(H.flush==="sync"?v:g)&&q({storeId:n,type:A_.direct,events:E},de)},Lu({},p,H)));return W},$dispose:O},z=Ql(N);i._s.set(n,z);const X=i._e.run(()=>(h=rR(),h.run(()=>e())));for(const q in X){const H=X[q];if(lr(H)&&!ZU(H)||Bc(H))u||(Q&&XU(H)&&(lr(H)?H.value=Q[q]:sw(H,Q[q])),i.state.value[n][q]=H);else if(typeof H=="function"){const W=F(q,H);X[q]=W,r.actions[q]=H}}return Lu(z,X),Lu(rn(z),X),Object.defineProperty(z,"$state",{get:()=>i.state.value[n],set:q=>{D(H=>{Lu(H,q)})}}),i._p.forEach(q=>{Lu(z,h.run(()=>q({store:z,app:i._a,pinia:i,options:r})))}),Q&&u&&t.hydrate&&t.hydrate(z.$state,Q),g=!0,v=!0,z}function Gb(n,e,t){let i,o;const u=typeof e=="function";typeof n=="string"?(i=n,o=u?t:e):(o=n,i=n.id);function h(r,p){const g=hh();return r=r||g&&Aa(nL,null),r&&c1(r),r=iL,r._s.has(i)||(u?sL(i,e,o,r):$U(i,o,r)),r._s.get(i)}return h.$id=i,h}function No(n){{n=rn(n);const e={};for(const t in n){const i=n[t];(lr(i)||Bc(i))&&(e[t]=Db(n,t))}return e}}function eO(n){return typeof n=="object"&&n!==null}function lT(n,e){return n=eO(n)?n:Object.create(null),new Proxy(n,{get(t,i,o){return i==="key"?Reflect.get(t,i,o):Reflect.get(t,i,o)||Reflect.get(e,i,o)}})}function tO(n,e){return e.reduce((t,i)=>t==null?void 0:t[i],n)}function iO(n,e,t){return e.slice(0,-1).reduce((i,o)=>/^(__proto__)$/.test(o)?{}:i[o]=i[o]||{},n)[e[e.length-1]]=t,n}function nO(n,e){return e.reduce((t,i)=>{const o=i.split(".");return iO(t,o,tO(n,o))},{})}function cT(n,{storage:e,serializer:t,key:i,debug:o}){try{const u=e==null?void 0:e.getItem(i);u&&n.$patch(t==null?void 0:t.deserialize(u))}catch(u){o&&console.error(u)}}function uT(n,{storage:e,serializer:t,key:i,paths:o,debug:u}){try{const h=Array.isArray(o)?nO(n,o):n;e.setItem(i,t.serialize(h))}catch(h){u&&console.error(h)}}function rO(n={}){return e=>{const{auto:t=!1}=n,{options:{persist:i=t},store:o,pinia:u}=e;if(!i)return;if(!(o.$id in u.state.value)){const r=u._s.get(o.$id.replace("__hot:",""));r&&Promise.resolve().then(()=>r.$persist());return}const h=(Array.isArray(i)?i.map(r=>lT(r,n)):[lT(i,n)]).map(({storage:r=localStorage,beforeRestore:p=null,afterRestore:g=null,serializer:v={serialize:JSON.stringify,deserialize:JSON.parse},key:I=o.$id,paths:C=null,debug:E=!1})=>{var Q;return{storage:r,beforeRestore:p,afterRestore:g,serializer:v,key:((Q=n.key)!=null?Q:M=>M)(typeof I=="string"?I:I(o.$id)),paths:C,debug:E}});o.$persist=()=>{h.forEach(r=>{uT(o.$state,r)})},o.$hydrate=({runHooks:r=!0}={})=>{h.forEach(p=>{const{beforeRestore:g,afterRestore:v}=p;r&&(g==null||g(e)),cT(o,p),r&&(v==null||v(e))})},h.forEach(r=>{const{beforeRestore:p,afterRestore:g}=r;p==null||p(e),cT(o,r),g==null||g(e),o.$subscribe((v,I)=>{uT(I,r)},{detached:!0})})}}var sO=rO();const oO={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","&":"&amp;"};let aO=0;var lO=n=>n.replace(/[<>"&]/g,e=>oO[e]||e),cO=n=>n+aO++;const xd={},uO=n=>{const{name:e,paths:t=[],d:i,polygons:o=[],points:u}=n;i&&t.push({d:i}),u&&o.push({points:u}),xd[e]=Object.assign({},n,{paths:t,polygons:o}),xd[e].minX||(xd[e].minX=0),xd[e].minY||(xd[e].minY=0)},hO=(...n)=>{for(const e of n)uO(e)},dO=kn({name:"OhVueIcon",props:{name:{type:String,validator:n=>!n||n in xd||(console.warn(`Invalid prop: prop "name" is referring to an unregistered icon "${n}".
Please make sure you have imported this icon before using it.`),!1)},title:String,fill:String,scale:{type:[Number,String],default:1},animation:{validator:n=>["spin","spin-pulse","wrench","ring","pulse","flash","float"].includes(n)},hover:Boolean,flip:{validator:n=>["horizontal","vertical","both"].includes(n)},speed:{validator:n=>n==="fast"||n==="slow"},label:String,inverse:Boolean},setup(n){const e=Gt([]),t=Ql({outerScale:1.2,x:null,y:null}),i=Ql({width:0,height:0}),o=cn(()=>{const M=Number(n.scale);return isNaN(M)||M<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.'),t.outerScale):M*t.outerScale}),u=cn(()=>({"ov-icon":!0,"ov-inverse":n.inverse,"ov-flip-horizontal":n.flip==="horizontal","ov-flip-vertical":n.flip==="vertical","ov-flip-both":n.flip==="both","ov-spin":n.animation==="spin","ov-spin-pulse":n.animation==="spin-pulse","ov-wrench":n.animation==="wrench","ov-ring":n.animation==="ring","ov-pulse":n.animation==="pulse","ov-flash":n.animation==="flash","ov-float":n.animation==="float","ov-hover":n.hover,"ov-fast":n.speed==="fast","ov-slow":n.speed==="slow"})),h=cn(()=>n.name?xd[n.name]:null),r=cn(()=>h.value?`${h.value.minX} ${h.value.minY} ${h.value.width} ${h.value.height}`:`0 0 ${g.value} ${v.value}`),p=cn(()=>{if(!h.value)return 1;const{width:M,height:D}=h.value;return Math.max(M,D)/16}),g=cn(()=>i.width||h.value&&h.value.width/p.value*o.value||0),v=cn(()=>i.height||h.value&&h.value.height/p.value*o.value||0),I=cn(()=>o.value!==1&&{fontSize:o.value+"em"}),C=cn(()=>{if(!h.value||!h.value.raw)return null;const M={};let D=h.value.raw;return D=D.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,(P,O,F)=>{const N=cO("vat-");return M[F]=N,` id="${N}"`}),D=D.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,(P,O,F,N)=>{const z=O||N;return z&&M[z]?`#${M[z]}`:P}),D}),E=cn(()=>h.value&&h.value.attr?h.value.attr:{}),Q=()=>{if(!n.name&&n.name!==null&&e.value.length===0)return void console.warn('Invalid prop: prop "name" is required.');if(h.value)return;let M=0,D=0;e.value.forEach(P=>{P.outerScale=o.value,M=Math.max(M,P.width),D=Math.max(D,P.height)}),i.width=M,i.height=D,e.value.forEach(P=>{P.x=(M-P.width)/2,P.y=(D-P.height)/2})};return Br(()=>{Q()}),kb(()=>{Q()}),{...vR(t),children:e,icon:h,klass:u,style:I,width:g,height:v,box:r,attribs:E,raw:C}},created(){const n=this.$parent;n&&n.children&&n.children.push(this)},render(){const n=Object.assign({role:this.$attrs.role||(this.label||this.title?"img":null),"aria-label":this.label||null,"aria-hidden":!(this.label||this.title),width:this.width,height:this.height,viewBox:this.box},this.attribs);this.attribs.stroke?n.stroke=this.fill?this.fill:"currentColor":n.fill=this.fill?this.fill:"currentColor",this.x&&(n.x=this.x.toString()),this.y&&(n.y=this.y.toString());let e={class:this.klass,style:this.style};if(e=Object.assign(e,n),this.raw){const o=this.title?`<title>${lO(this.title)}</title>${this.raw}`:this.raw;e.innerHTML=o}const t=this.title?[Qd("title",this.title)]:[],i=(o,u,h)=>Qd(o,{...u,key:`${o}-${h}`});return Qd("svg",e,this.raw?void 0:t.concat([this.$slots.default?this.$slots.default():this.icon?[...this.icon.paths.map((o,u)=>i("path",o,u)),...this.icon.polygons.map((o,u)=>i("polygon",o,u))]:[]]))}});function Hb(n,e){e===void 0&&(e={});var t=e.insertAt;if(n&&typeof document<"u"){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",t==="top"&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n))}}Hb(`.ov-icon {
  display: inline-block;
  overflow: visible;
  vertical-align: -0.2em;
}
`);Hb(`/* ---------------- spin ---------------- */
.ov-spin:not(.ov-hover),
.ov-spin.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-spin {
  animation: ov-spin 1s linear infinite;
}

.ov-spin:not(.ov-hover).ov-fast,
.ov-spin.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-spin.ov-fast {
  animation: ov-spin 0.7s linear infinite;
}

.ov-spin:not(.ov-hover).ov-slow,
.ov-spin.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-spin.ov-slow {
  animation: ov-spin 2s linear infinite;
}

/* ---------------- spin-pulse ---------------- */

.ov-spin-pulse:not(.ov-hover),
.ov-spin-pulse.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse {
  animation: ov-spin 1s infinite steps(8);
}

.ov-spin-pulse:not(.ov-hover).ov-fast,
.ov-spin-pulse.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse.ov-fast {
  animation: ov-spin 0.7s infinite steps(8);
}

.ov-spin-pulse:not(.ov-hover).ov-slow,
.ov-spin-pulse.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse.ov-slow {
  animation: ov-spin 2s infinite steps(8);
}

@keyframes ov-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* ---------------- wrench ---------------- */
.ov-wrench:not(.ov-hover),
.ov-wrench.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-wrench {
  animation: ov-wrench 2.5s ease infinite;
}

.ov-wrench:not(.ov-hover).ov-fast,
.ov-wrench.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-wrench.ov-fast {
  animation: ov-wrench 1.2s ease infinite;
}

.ov-wrench:not(.ov-hover).ov-slow,
.ov-wrench.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-wrench.ov-slow {
  animation: ov-wrench 3.7s ease infinite;
}

@keyframes ov-wrench {
  0% {
    transform: rotate(-12deg);
  }

  8% {
    transform: rotate(12deg);
  }

  10%, 28%, 30%, 48%, 50%, 68% {
    transform: rotate(24deg);
  }

  18%, 20%, 38%, 40%, 58%, 60% {
    transform: rotate(-24deg);
  }

  75%, 100% {
    transform: rotate(0deg);
  }
}

/* ---------------- ring ---------------- */
.ov-ring:not(.ov-hover),
.ov-ring.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-ring {
  animation: ov-ring 2s ease infinite;
}

.ov-ring:not(.ov-hover).ov-fast,
.ov-ring.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-ring.ov-fast {
  animation: ov-ring 1s ease infinite;
}

.ov-ring:not(.ov-hover).ov-slow,
.ov-ring.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-ring.ov-slow {
  animation: ov-ring 3s ease infinite;
}

@keyframes ov-ring {
  0% {
    transform: rotate(-15deg);
  }

  2% {
    transform: rotate(15deg);
  }

  4%, 12% {
    transform: rotate(-18deg);
  }

  6% {
    transform: rotate(18deg);
  }

  8% {
    transform: rotate(-22deg);
  }

  10% {
    transform: rotate(22deg);
  }

  12% {
    transform: rotate(-18deg);
  }

  14% {
    transform: rotate(18deg);
  }

  16% {
    transform: rotate(-12deg);
  }

  18% {
    transform: rotate(12deg);
  }

  20%, 100% {
    transform: rotate(0deg);
  }
}

/* ---------------- pulse ---------------- */
.ov-pulse:not(.ov-hover),
.ov-pulse.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-pulse {
  animation: ov-pulse 2s linear infinite;
}

.ov-pulse:not(.ov-hover).ov-fast,
.ov-pulse.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-pulse.ov-fast {
  animation: ov-pulse 1s linear infinite;
}

.ov-pulse:not(.ov-hover).ov-slow,
.ov-pulse.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-pulse.ov-slow {
  animation: ov-pulse 3s linear infinite;
}

@keyframes ov-pulse {
  0% {
    transform: scale(1.1);
  }

  50% {
    transform: scale(0.8);
  }

  100% {
    transform: scale(1.1);
  }
}

/* ---------------- flash ---------------- */
.ov-flash:not(.ov-hover),
.ov-flash.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-flash {
  animation: ov-flash 2s ease infinite;
}

.ov-flash:not(.ov-hover).ov-fast,
.ov-flash.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-flash.ov-fast {
  animation: ov-flash 1s ease infinite;
}

.ov-flash:not(.ov-hover).ov-slow,
.ov-flash.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-flash.ov-slow {
  animation: ov-flash 3s ease infinite;
}

@keyframes ov-flash {
  0%, 100%, 50%{
    opacity: 1;
  }
  25%, 75%{
    opacity: 0;
  }
}

/* ---------------- float ---------------- */
.ov-float:not(.ov-hover),
.ov-float.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-float {
  animation: ov-float 2s linear infinite;
}

.ov-float:not(.ov-hover).ov-fast,
.ov-float.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-float.ov-fast {
  animation: ov-float 1s linear infinite;
}

.ov-float:not(.ov-hover).ov-slow,
.ov-float.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-float.ov-slow {
  animation: ov-float 3s linear infinite;
}

@keyframes ov-float {
  0%, 100% {
    transform: translateY(-3px);
  }
  50% {
    transform: translateY(3px);
  }
}
`);Hb(`.ov-flip-horizontal {
  transform: scale(-1, 1);
}

.ov-flip-vertical {
  transform: scale(1, -1);
}

.ov-flip-both {
  transform: scale(-1, -1);
}

.ov-inverse {
  color: #fff;
}
`);const fO={name:"bi-battery-charging",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M9.585 2.568a.5.5 0 01.226.58L8.677 6.832h1.99a.5.5 0 01.364.843l-5.334 5.667a.5.5 0 01-.842-.49L5.99 9.167H4a.5.5 0 01-.364-.843l5.333-5.667a.5.5 0 01.616-.09z"/><path d="M2 4h4.332l-.94 1H2a1 1 0 00-1 1v4a1 1 0 001 1h2.38l-.308 1H2a2 2 0 01-2-2V6a2 2 0 012-2z"/><path d="M2 6h2.45L2.908 7.639A1.5 1.5 0 003.313 10H2V6zm8.595-2l-.308 1H12a1 1 0 011 1v4a1 1 0 01-1 1H9.276l-.942 1H12a2 2 0 002-2V6a2 2 0 00-2-2h-1.405z"/><path d="M12 10h-1.783l1.542-1.639c.097-.103.178-.218.241-.34V10zm0-3.354V6h-.646a1.5 1.5 0 01.646.646zM16 8a1.5 1.5 0 01-1.5 1.5v-3A1.5 1.5 0 0116 8z"/>'},pO={name:"bi-battery-full",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M2 6h10v4H2V6z"/><path d="M2 4a2 2 0 00-2 2v4a2 2 0 002 2h10a2 2 0 002-2V6a2 2 0 00-2-2H2zm10 1a1 1 0 011 1v4a1 1 0 01-1 1H2a1 1 0 01-1-1V6a1 1 0 011-1h10zm4 3a1.5 1.5 0 01-1.5 1.5v-3A1.5 1.5 0 0116 8z"/>'},AO={name:"bi-battery-half",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M2 6h5v4H2V6z"/><path d="M2 4a2 2 0 00-2 2v4a2 2 0 002 2h10a2 2 0 002-2V6a2 2 0 00-2-2H2zm10 1a1 1 0 011 1v4a1 1 0 01-1 1H2a1 1 0 01-1-1V6a1 1 0 011-1h10zm4 3a1.5 1.5 0 01-1.5 1.5v-3A1.5 1.5 0 0116 8z"/>'},gO={name:"bi-battery",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M0 6a2 2 0 012-2h10a2 2 0 012 2v4a2 2 0 01-2 2H2a2 2 0 01-2-2V6zm2-1a1 1 0 00-1 1v4a1 1 0 001 1h10a1 1 0 001-1V6a1 1 0 00-1-1H2zm14 3a1.5 1.5 0 01-1.5 1.5v-3A1.5 1.5 0 0116 8z"/>'},mO={name:"bi-behance",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M4.654 3c.461 0 .887.035 1.278.14.39.07.711.216.996.391.286.176.497.426.641.747.14.32.216.711.216 1.137 0 .496-.106.922-.356 1.242-.215.32-.566.606-.997.817.606.176 1.067.496 1.348.922.281.426.461.957.461 1.563 0 .496-.105.922-.285 1.278a2.317 2.317 0 01-.782.887c-.32.215-.711.39-1.137.496a5.329 5.329 0 01-1.278.176L0 12.803V3h4.654zm-.285 3.978c.39 0 .71-.105.957-.285.246-.18.355-.497.355-.887 0-.216-.035-.426-.105-.567a.981.981 0 00-.32-.355 1.84 1.84 0 00-.461-.176c-.176-.035-.356-.035-.567-.035H2.17v2.31c0-.005 2.2-.005 2.2-.005zm.105 4.193c.215 0 .426-.035.606-.07.176-.035.356-.106.496-.216s.25-.215.356-.39c.07-.176.14-.391.14-.641 0-.496-.14-.852-.426-1.102-.285-.215-.676-.32-1.137-.32H2.17v2.734h2.305v.005zm6.858-.035c.286.285.711.426 1.278.426.39 0 .746-.106 1.032-.286.285-.215.46-.426.53-.64h1.74c-.286.851-.712 1.457-1.278 1.848-.566.355-1.243.566-2.06.566a4.135 4.135 0 01-1.527-.285 2.827 2.827 0 01-1.137-.782 2.851 2.851 0 01-.712-1.172c-.175-.461-.25-.957-.25-1.528 0-.531.07-1.032.25-1.493.18-.46.426-.852.747-1.207.32-.32.711-.606 1.137-.782a4.018 4.018 0 011.493-.285c.606 0 1.137.105 1.598.355.46.25.817.532 1.102.958.285.39.496.851.641 1.348.07.496.105.996.07 1.563h-5.15c0 .58.21 1.11.496 1.396zm2.24-3.732c-.25-.25-.642-.391-1.103-.391-.32 0-.566.07-.781.176-.215.105-.356.25-.496.39a.957.957 0 00-.25.497c-.036.175-.07.32-.07.46h3.196c-.07-.526-.25-.882-.497-1.132zm-3.127-3.728h3.978v.957h-3.978v-.957z"/>'},_O={name:"bi-github",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0016 8c0-4.42-3.58-8-8-8z"/>'},yO={name:"bi-instagram",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 00-1.417.923A3.927 3.927 0 00.42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 001.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 00-.923-1.417A3.911 3.911 0 0013.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 01-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 01-.92-.598 2.48 2.48 0 01-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 100 1.92.96.96 0 000-1.92zm-4.27 1.122a4.109 4.109 0 100 8.217 4.109 4.109 0 000-8.217zm0 1.441a2.667 2.667 0 110 5.334 2.667 2.667 0 010-5.334z"/>'},vO={name:"bi-linkedin",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 01.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>'},xO={name:"co-docker",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M6.427 23.031c-.911 0-1.739-.744-1.739-1.651s.744-1.656 1.739-1.656c1 0 1.751.745 1.751 1.656 0 .907-.833 1.651-1.745 1.651zm21.349-9.015c-.183-1.323-1-2.401-2.079-3.224l-.421-.333-.339.411c-.656.745-.921 2.068-.839 3.057.079.751.317 1.495.74 2.073-.344.177-.76.333-1.084.505-.76.249-1.5.333-2.239.333H.13l-.084.489a9.388 9.388 0 00.751 4.724l.328.579v.077c2 3.313 5.557 4.803 9.437 4.803 7.459 0 13.573-3.224 16.473-10.177 1.901.083 3.819-.412 4.719-2.235l.24-.411-.396-.251c-1.083-.661-2.563-.749-3.801-.416l-.027.005zm-10.677-1.323H13.86v3.228h3.239zm0-4.057H13.86v3.228h3.239zm0-4.141H13.86v3.229h3.239zm3.958 8.198h-3.219v3.228h3.229v-3.228zm-11.994 0H5.844v3.228h3.229v-3.228zm4.036 0H9.902v3.228h3.219v-3.228zm-8.036 0H1.864v3.228h3.24v-3.228zm8.036-4.057H9.902v3.228h3.219V8.64zm-4.058 0H5.849v3.228h3.219V8.64l-.021-.004z"/>'},IO={name:"co-graphql",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M18.734 3.667l6.578 3.802A2.863 2.863 0 0129.859 8a2.859 2.859 0 01-1.808 4.203v7.599A2.842 2.842 0 0129.853 24a2.859 2.859 0 01-4.604.474l-6.542 3.776A2.854 2.854 0 0115.998 32a2.85 2.85 0 01-2.734-3.662l-6.583-3.797a2.85 2.85 0 01-4.036.094 2.859 2.859 0 011.302-4.838v-7.599a2.852 2.852 0 112.094-5.24c.234.135.453.302.641.5l6.583-3.797A2.85 2.85 0 0115.187.119a2.85 2.85 0 013.547 3.547zm-.687 1.172c-.026.026-.047.052-.078.078l8.615 14.917c.036-.01.078-.021.109-.031v-7.609a2.84 2.84 0 01-2.073-3.448c.005-.031.016-.068.021-.099zm-4.021.078l-.078-.078-6.594 3.802a2.85 2.85 0 01-1.948 3.526l-.104.026v7.609l.115.031 8.615-14.917zm2.771.677a2.937 2.937 0 01-1.589 0L6.593 20.511c.391.375.667.859.802 1.391h17.214c.13-.531.406-1.016.802-1.396zm1.312 21.635l6.552-3.786c-.021-.063-.036-.125-.052-.188H7.39l-.031.109 6.589 3.802a2.84 2.84 0 012.052-.87c.839 0 1.589.359 2.109.932z"/>'},CO={name:"co-jest",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M29.667 15.76a4.155 4.155 0 00-3.104-4.015L30.547 0h-19.74l3.996 11.787a4.156 4.156 0 00-2.996 3.979c0 1.391.693 2.625 1.751 3.385a10.813 10.813 0 01-1.443 1.656 10.92 10.92 0 01-3.401 2.199c-1.115-.751-1.593-2.079-1.161-3.26 4.531-1.412 3.531-8.089-1.208-8.109a4.154 4.154 0 00-4.151 4.151c0 1.131.457 2.167 1.203 2.911-.068.125-.131.261-.199.396-.619 1.281-1.323 2.724-1.593 4.344-.536 3.245.344 5.849 2.469 7.323a6.778 6.778 0 003.927 1.24c2.432 0 4.907-1.224 7.297-2.412 1.708-.839 3.468-1.719 5.197-2.145.641-.156 1.308-.249 2.011-.355 1.427-.203 2.901-.416 4.224-1.187a5.966 5.966 0 002.911-4.12 6.144 6.144 0 00-.593-3.828c.401-.641.62-1.385.62-2.193zm-1.807 0a2.336 2.336 0 01-2.333 2.333c-2.209-.005-3.177-2.791-1.444-4.167l.005-.009c.079-.057.163-.115.24-.168 0 0 .016 0 .016-.009.036-.021.072-.047.109-.068.011 0 .016-.005.025-.005.037-.021.084-.036.131-.057s.093-.036.131-.057c.009 0 .015-.005.025-.005.037-.011.079-.031.115-.036.005 0 .027-.011.037-.011.047-.011.083-.021.129-.027h.005l.141-.031c.009 0 .025 0 .036-.011.036 0 .073-.011.115-.011h.041c.047 0 .093-.005.151-.005h.12c.037 0 .068 0 .104.005h.016c.073.011.151.021.224.043a2.347 2.347 0 011.86 2.296zM13.391 1.855h14.573l-3.344 9.864c-.141.027-.276.073-.417.12l-3.52-7.177-3.532 7.131a3.367 3.367 0 00-.437-.099zm6.625 13.098a4.117 4.117 0 00-1.251-2.224l1.917-3.869 1.937 3.952a4.151 4.151 0 00-1.161 2.141zm-4.641-1.464a.845.845 0 01.131-.025h.025c.037-.011.073-.011.109-.021h.037c.036 0 .068-.011.104-.011h.359c.037 0 .068.011.095.011.02 0 .025 0 .047.011.036.011.063.011.099.016.011 0 .021 0 .041.009l.125.027h.011c.036.011.079.021.115.041.005 0 .016.005.036.005.027.011.063.021.095.036.004 0 .015.011.025.011.036.021.073.032.109.047h.011a.425.425 0 01.12.068h.011c.036.016.072.041.109.063.009 0 .009.011.02.011.037.016.063.047.099.063l.011.011c.109.083.213.176.319.271l.004.005c.417.437.647 1.015.641 1.613-.099 3.011-4.568 3.011-4.667 0-.005-1.067.724-2 1.76-2.26zm-9.12-.068a2.336 2.336 0 010 4.672c-1.285 0-2.333-1.047-2.333-2.333s1.048-2.339 2.333-2.339zm21.552 8.038a4.114 4.114 0 01-2.009 2.844c-1.011.583-2.256.771-3.557.952a22.36 22.36 0 00-2.188.391c-1.927.475-3.781 1.396-5.579 2.287-2.296 1.141-4.463 2.213-6.473 2.213a4.873 4.873 0 01-2.875-.916c-2.037-1.407-1.937-4.047-1.693-5.495.219-1.355.839-2.62 1.432-3.833.043-.073.068-.141.105-.213.203.072.416.129.64.167-.355 1.963.645 3.995 2.593 4.995l.349.181.38-.135c1.62-.579 3.125-1.511 4.448-2.76a12.28 12.28 0 001.927-2.292 4.157 4.157 0 004.652-3.057h1.557a4.143 4.143 0 004.011 3.104c.771 0 1.484-.213 2.093-.573.24.693.317 1.417.187 2.141z"/>'},EO={name:"co-mysql",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M21.875 7.568c-.156 0-.26.021-.365.047v.016h.016c.073.135.193.24.286.365.073.141.135.286.203.427l.021-.021c.125-.089.188-.229.188-.443-.052-.063-.063-.13-.109-.188-.052-.089-.167-.135-.24-.203zM7.693 25.161H6.459a70.224 70.224 0 00-.359-5.88h-.01l-1.88 5.88h-.943l-1.865-5.88h-.016a98.982 98.982 0 00-.26 5.88H.001a74.98 74.98 0 01.547-7.375h1.531l1.781 5.417h.01l1.797-5.417h1.458c.323 2.688.516 5.146.573 7.375zm5.354-5.442c-.5 2.729-1.167 4.714-1.984 5.948-.646.953-1.349 1.432-2.115 1.432-.203 0-.453-.063-.755-.188v-.656c.151.021.323.036.516.036.359 0 .646-.104.865-.297.26-.24.391-.51.391-.807 0-.208-.099-.625-.307-1.26l-1.349-4.208h1.214l.969 3.146c.219.719.313 1.214.271 1.5.536-1.417.906-2.969 1.115-4.646zm16.437 5.442h-3.51v-7.375h1.182v6.469h2.328zm-4.427.178l-1.354-.667c.12-.099.234-.208.339-.333.578-.672.865-1.677.865-3 0-2.443-.958-3.661-2.875-3.661-.938 0-1.672.307-2.198.927-.573.677-.865 1.677-.865 2.995 0 1.297.255 2.245.766 2.854.469.542 1.172.818 2.115.818.349 0 .672-.042.964-.13l1.766 1.031.484-.833zm-4.39-1.657c-.302-.479-.448-1.25-.448-2.313 0-1.859.563-2.786 1.693-2.786.589 0 1.026.224 1.302.667.297.484.448 1.245.448 2.297 0 1.87-.568 2.813-1.693 2.813-.594 0-1.026-.224-1.307-.667zm-2.209-.562c0 .625-.229 1.141-.693 1.536-.458.401-1.068.604-1.844.604-.724 0-1.417-.229-2.099-.688l.318-.635c.583.292 1.109.438 1.589.438.443 0 .792-.099 1.042-.292.25-.198.401-.474.401-.823 0-.438-.307-.813-.865-1.125-.516-.286-1.552-.875-1.552-.875-.563-.411-.839-.849-.839-1.573 0-.599.208-1.078.625-1.443.422-.375.958-.557 1.625-.557a3.37 3.37 0 011.87.547l-.286.635a3.623 3.623 0 00-1.417-.307c-.38 0-.672.094-.875.276s-.328.411-.328.698c0 .438.313.813.885 1.135.526.286 1.583.891 1.583.891.578.406.865.844.865 1.557zm12.506-7.807c-.714-.016-1.266.057-1.729.255-.13.052-.344.052-.365.219.073.073.083.188.146.286.109.177.292.417.464.542.188.146.375.292.568.417.349.214.74.339 1.083.552.193.125.391.286.583.417.099.068.161.188.286.229v-.026c-.063-.078-.078-.193-.141-.286-.089-.089-.177-.167-.266-.255a4.212 4.212 0 00-.927-.901c-.286-.193-.911-.464-1.026-.792l-.016-.021c.193-.016.422-.089.609-.141.302-.078.583-.063.896-.141a7.21 7.21 0 00.427-.125v-.078c-.161-.161-.281-.38-.448-.531a11.645 11.645 0 00-1.469-1.094c-.281-.182-.635-.297-.932-.448-.104-.052-.286-.078-.344-.167-.161-.198-.255-.453-.37-.688a23.772 23.772 0 01-.729-1.552c-.161-.349-.255-.693-.453-1.016-.917-1.516-1.917-2.432-3.448-3.333-.328-.188-.724-.266-1.141-.365-.224-.01-.443-.026-.667-.036-.146-.063-.286-.229-.411-.313-.51-.323-1.823-1.016-2.193-.099-.24.583.354 1.151.563 1.443.151.208.344.438.453.667.063.156.078.318.141.479.141.391.276.828.464 1.193.099.188.203.385.328.552.073.099.198.141.224.302-.125.182-.135.448-.203.667-.323 1.01-.198 2.255.255 3 .146.224.484.714.938.526.401-.161.313-.667.427-1.115.026-.109.01-.177.063-.25v.021c.13.25.255.49.37.74.271.438.755.891 1.156 1.193.214.161.38.438.646.536v-.026h-.021c-.057-.078-.13-.115-.203-.177a4.999 4.999 0 01-.469-.536c-.37-.5-.703-1.052-.995-1.62a10.88 10.88 0 01-.385-.859c-.052-.104-.052-.266-.141-.318-.135.193-.333.359-.427.604-.172.38-.188.854-.255 1.344-.031.01-.016 0-.031.021-.286-.073-.385-.365-.49-.615-.271-.635-.313-1.651-.083-2.38.063-.188.328-.776.224-.953-.057-.172-.234-.271-.328-.406-.12-.167-.24-.38-.323-.568-.214-.5-.318-1.052-.552-1.552-.104-.229-.292-.469-.443-.682-.172-.24-.359-.411-.49-.693-.047-.099-.109-.26-.036-.365.016-.073.052-.099.125-.12.115-.099.448.026.563.083.328.13.604.255.88.443.125.089.26.255.422.302h.188c.286.063.604.016.87.099.474.151.901.37 1.286.609a7.963 7.963 0 012.776 3.052c.109.203.156.391.255.604.182.443.417.885.604 1.307s.365.849.635 1.198c.135.188.667.286.911.38.177.083.453.156.609.25.307.188.609.401.896.609.146.099.589.323.615.5z"/>'},wO={name:"co-sass-alt",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M15.092 22.146c-.015.03-.03.054 0 0zm12.456-4.35c-1.006 0-1.998.23-2.9.675-.295-.595-.6-1.115-.65-1.505-.06-.455-.125-.725-.055-1.265s.385-1.305.38-1.36c-.005-.055-.07-.33-.715-.335s-1.2.125-1.265.295a6.09 6.09 0 00-.265.955c-.115.585-1.289 2.675-1.954 3.765-.22-.425-.405-.8-.445-1.1-.06-.455-.125-.725-.055-1.265s.385-1.305.38-1.36c-.005-.055-.07-.33-.714-.335s-1.2.125-1.265.295c-.065.17-.135.57-.265.955s-1.695 3.865-2.104 4.77c-.21.46-.39.83-.52 1.08-.02.04-.035.065-.045.085.015-.025.025-.05.025-.04-.11.215-.175.335-.175.335v.005c-.085.16-.18.305-.225.305-.03 0-.095-.42.015-.995.235-1.21.79-3.09.785-3.155-.005-.035.105-.36-.365-.535-.455-.165-.62.11-.66.11s-.07.1-.07.1.505-2.12-.97-2.12c-.92 0-2.2 1.01-2.829 1.925-.395.215-1.25.68-2.15 1.175l-1.035.57c-.025-.025-.045-.05-.07-.075-1.79-1.91-5.094-3.26-4.954-5.825.05-.935.375-3.39 6.354-6.37 4.9-2.44 8.817-1.77 9.492-.28.97 2.125-2.095 6.08-7.183 6.65-1.94.215-2.959-.535-3.214-.815-.265-.295-.305-.31-.405-.255-.165.09-.06.35 0 .505.15.395.775 1.095 1.84 1.445.935.305 3.209.475 5.958-.59 3.089-1.19 5.494-4.505 4.788-7.28-.718-2.82-5.394-3.745-9.815-2.175-2.635.935-5.484 2.405-7.533 4.32C.26 11.361-.129 13.346.031 14.176c.57 2.945 4.629 4.865 6.253 6.285l-.225.125c-.815.405-3.909 2.025-4.684 3.735-.875 1.94.145 3.33.814 3.52 2.09.58 4.229-.465 5.379-2.18s1.01-3.955.48-4.975c-.005-.015-.015-.025-.02-.04a72.558 72.558 0 011.815-1.04c-.2.54-.345 1.19-.42 2.13-.09 1.1.365 2.525.955 3.085.26.245.574.25.77.25.69 0 1-.57 1.345-1.25.425-.83.8-1.795.8-1.795s-.47 2.61.815 2.61c.47 0 .94-.605 1.15-.915v.005s.01-.02.035-.06c.05-.075.075-.12.075-.12v-.015c.19-.325.605-1.07 1.23-2.3.81-1.59 1.584-3.575 1.584-3.575.075.436.179.867.31 1.29.14.475.435.995.67 1.5-.19.26-.305.41-.305.41 0 .004.002.007.005.01-.15.2-.32.415-.495.625-.639.76-1.4 1.63-1.5 1.88-.12.295-.09.515.14.685.17.13.47.15.785.125.575-.04.98-.18 1.175-.27a4.11 4.11 0 001.01-.53c.625-.46 1.005-1.12.97-1.99-.02-.48-.175-.96-.365-1.41.055-.08.115-.165.17-.25a26.716 26.716 0 001.755-3.031c.075.436.178.867.31 1.29.12.405.355.85.57 1.285-.93.755-1.505 1.63-1.704 2.205-.37 1.065-.08 1.545.465 1.655.245.05.595-.065.855-.175.386-.129.75-.316 1.079-.555.625-.46 1.23-1.105 1.189-1.98-.015-.395-.125-.79-.27-1.17.785-.33 1.805-.51 3.105-.36 2.784.325 3.329 2.065 3.224 2.79s-.69 1.13-.885 1.25c-.195.12-.255.165-.24.255.025.13.115.125.28.095.23-.04 1.46-.59 1.515-1.935.08-1.7-1.555-3.57-4.45-3.555zM6.089 25.031c-.92 1.005-2.209 1.385-2.764 1.065-.595-.346-.36-1.825.774-2.896.69-.65 1.58-1.25 2.17-1.62.135-.08.33-.2.57-.345a.828.828 0 01.06-.035c.045-.03.095-.055.145-.085.414 1.52.015 2.86-.955 3.915zm6.718-4.57c-.32.785-.994 2.785-1.405 2.68-.35-.09-.565-1.615-.07-3.115.25-.755.78-1.655 1.095-2.005.505-.565 1.06-.745 1.19-.52.175.295-.61 2.47-.81 2.96zm5.55 2.65c-.135.07-.26.115-.32.08-.045-.025.055-.12.055-.12s.695-.745.97-1.085c.16-.2.345-.435.545-.695 0 .025.005.05.005.08-.006.895-.866 1.5-1.256 1.74zm4.28-.975c-.1-.07-.085-.305.25-1.035.13-.285.43-.765.95-1.225.059.174.091.356.095.54-.005 1.125-.81 1.545-1.295 1.72z"/>'},bO={name:"co-typescript",minX:-3.2,minY:-3.2,width:38.4,height:38.4,raw:'<path d="M0 16v16h32V0H0zm25.786-1.276a4.023 4.023 0 012.005 1.156c.292.312.729.885.766 1.026.01.042-1.38.974-2.224 1.495-.031.021-.156-.109-.292-.313-.411-.599-.844-.859-1.505-.906-.969-.063-1.594.443-1.589 1.292a1.26 1.26 0 00.135.599c.214.443.615.708 1.854 1.245 2.292.984 3.271 1.635 3.88 2.557.682 1.031.833 2.677.375 3.906-.51 1.328-1.771 2.234-3.542 2.531-.547.099-1.849.083-2.438-.026-1.286-.229-2.505-.865-3.255-1.698-.297-.323-.87-1.172-.833-1.229.016-.021.146-.104.292-.188l1.188-.688.922-.536.193.286c.271.411.859.974 1.214 1.161 1.021.542 2.422.464 3.115-.156.281-.234.438-.594.417-.958 0-.37-.047-.536-.24-.813-.25-.354-.755-.656-2.198-1.281-1.651-.714-2.365-1.151-3.01-1.854a4.236 4.236 0 01-.88-1.599c-.12-.453-.151-1.589-.057-2.042.339-1.599 1.547-2.708 3.281-3.036.563-.109 1.875-.068 2.427.068zm-7.51 1.339l.01 1.307h-4.167v11.839h-2.948V17.37H7.01v-1.281c0-.714.016-1.307.036-1.323.016-.021 2.547-.031 5.62-.026l5.594.016z"/>'},BO={name:"hi-arrow-sm-left",minX:0,minY:0,width:24,height:24,raw:'<path stroke-linecap="round" stroke-linejoin="round" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>',attr:{fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"}},SO={name:"io-language",minX:0,minY:0,width:512,height:512,raw:'<path d="M478.33 433.6l-90-218a22 22 0 00-40.67 0l-90 218a22 22 0 1040.67 16.79L316.66 406h102.67l18.33 44.39A22 22 0 00458 464a22 22 0 0020.32-30.4zM334.83 362L368 281.65 401.17 362zM267.84 342.92a22 22 0 00-4.89-30.7c-.2-.15-15-11.13-36.49-34.73 39.65-53.68 62.11-114.75 71.27-143.49H330a22 22 0 000-44H214V70a22 22 0 00-44 0v20H54a22 22 0 000 44h197.25c-9.52 26.95-27.05 69.5-53.79 108.36-31.41-41.68-43.08-68.65-43.17-68.87a22 22 0 00-40.58 17c.58 1.38 14.55 34.23 52.86 83.93.92 1.19 1.83 2.35 2.74 3.51-39.24 44.35-77.74 71.86-93.85 80.74a22 22 0 1021.07 38.63c2.16-1.18 48.6-26.89 101.63-85.59 22.52 24.08 38 35.44 38.93 36.1a22 22 0 0030.75-4.9z"/>'},MO={name:"io-logo-vue",minX:0,minY:0,width:512,height:512,raw:'<path d="M256 144.03l-55.49-96.11h-79.43L256 281.61 390.92 47.92h-79.43L256 144.03z"/><path d="M409.4 47.92L256 313.61 102.6 47.92H15.74L256 464.08 496.26 47.92H409.4z"/>'},TO={name:"la-node",minX:0,minY:0,width:32,height:32,raw:'<path d="M21.3 6a.3.3 0 00-.3.3v5.497l-1.246-.727a.499.499 0 00-.508 0l-2.994 1.746a.504.504 0 00-.252.436v3.496c0 .18.096.346.252.436l2.994 1.746a.499.499 0 00.508 0l2.994-1.746a.504.504 0 00.252-.436V7.23a.501.501 0 00-.248-.431l-1.303-.758A.295.295 0 0021.301 6zm-9.8 5.002a.506.506 0 00-.254.068l-2.994 1.746a.504.504 0 00-.252.436v3.496c0 .18.096.346.252.436l2.994 1.746c.157.09.35.09.508 0l2.994-1.746a.504.504 0 00.252-.436v-3.496a.502.502 0 00-.252-.436l-2.994-1.746a.506.506 0 00-.254-.068zm16 0a.499.499 0 00-.254.068l-2.994 1.746a.504.504 0 00-.252.436v3.496c0 .18.096.346.252.436l2.904 1.755a.498.498 0 00.51.004l1.428-.83a.224.224 0 000-.386L26 15.904V14.11l1.5-.873 1.5.873v1.25c0 .167.14.193.234.137a544.12 544.12 0 011.518-.883.5.5 0 00.248-.431v-.93a.502.502 0 00-.252-.436l-2.994-1.746a.502.502 0 00-.254-.068zm-24 .002a.499.499 0 00-.254.068L.252 12.816a.507.507 0 00-.252.438v4.463c0 .218.236.353.424.244l1.328-.773A.501.501 0 002 16.756v-2.643l1.5-.875 1.5.875v2.643c0 .178.095.341.248.431l1.328.774A.282.282 0 007 17.717v-4.463a.507.507 0 00-.252-.438l-2.994-1.744a.499.499 0 00-.254-.068zm16 2.232l1.5.875v1.778l-1.5.875-1.5-.875V14.11l1.5-.875zm8 .768l-.857.5v.998L27.5 16l.857-.498v-.998l-.857-.5zm-12.094 3.994a.605.605 0 00-.297.076L12.297 19.7a.586.586 0 00-.297.512v3.246c0 .209.117.406.297.512l.74.422c.355.175.486.175.647.175.53 0 .832-.317.832-.877v-3.207a.082.082 0 00-.082-.084h-.356a.084.084 0 00-.084.084v3.207c0 .243-.257.493-.676.284l-.77-.444a.09.09 0 01-.042-.074V20.21c0-.029.014-.063.043-.078l2.812-1.621a.091.091 0 01.088 0l2.815 1.62c.029.016.043.045.043.079v3.246a.093.093 0 01-.043.078l-2.815 1.627a.091.091 0 01-.088 0l-.718-.428c-.02-.01-.05-.015-.069-.005a1.684 1.684 0 01-.424.195c-.049.015-.115.045.026.123l.933.555a.642.642 0 00.297.078.545.545 0 00.293-.082l2.813-1.627a.586.586 0 00.297-.512v-3.246a.603.603 0 00-.297-.512l-2.813-1.625a.584.584 0 00-.293-.076zm4.387 1.498a.54.54 0 10.002 1.08.54.54 0 00-.002-1.08zm-.006.086c.254 0 .46.2.46.453a.467.467 0 01-.46.46.456.456 0 01-.451-.46c0-.253.203-.453.451-.453zm-.197.147v.607h.115v-.242h.108c.044 0 .054.018.064.052 0 .005.018.163.023.192h.125a.715.715 0 01-.029-.162c-.014-.078-.018-.132-.101-.137.044-.015.117-.038.117-.15 0-.161-.14-.16-.213-.16h-.21zm.115.097h.098c.03 0 .088 0 .088.082 0 .034-.015.09-.094.088h-.092v-.17zm-3.545.496c-.803 0-1.28.343-1.28.907 0 .618.478.783 1.247.86.92.093.992.225.992.405 0 .316-.254.447-.848.447-.745 0-.908-.184-.962-.554-.005-.04-.04-.069-.084-.069h-.366a.082.082 0 00-.082.084c0 .472.258 1.037 1.489 1.037.903 0 1.414-.35 1.414-.964 0-.608-.41-.77-1.276-.887-.876-.117-.963-.176-.963-.381 0-.17.072-.393.72-.393.578 0 .794.127.882.516.01.04.037.063.076.063h.365c.024 0 .045-.01.059-.024.015-.019.024-.038.02-.062-.058-.672-.502-.985-1.403-.985z"/>'},DO={name:"md-route",minX:.48,minY:.48,width:23.04,height:23.04,raw:'<path fill="none" d="M0 0h24v24H0z"/><path d="M19 15.18V7c0-2.21-1.79-4-4-4s-4 1.79-4 4v10c0 1.1-.9 2-2 2s-2-.9-2-2V8.82C8.16 8.4 9 7.3 9 6c0-1.66-1.34-3-3-3S3 4.34 3 6c0 1.3.84 2.4 2 2.82V17c0 2.21 1.79 4 4 4s4-1.79 4-4V7c0-1.1.9-2 2-2s2 .9 2 2v8.18A2.996 2.996 0 0018 21c1.66 0 3-1.34 3-3 0-1.3-.84-2.4-2-2.82z"/>'},QO={name:"oi-file-code",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path fill-rule="evenodd" d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0114.25 15h-9a.75.75 0 010-1.5h9a.25.25 0 00.25-.25V6h-2.75A1.75 1.75 0 0110 4.25V1.5H5.75a.25.25 0 00-.25.25v2.5a.75.75 0 01-1.5 0v-2.5zm7.5-.188V4.25c0 .138.112.25.25.25h2.688a.252.252 0 00-.011-.013l-2.914-2.914a.272.272 0 00-.013-.011zM5.72 6.72a.75.75 0 000 1.06l1.47 1.47-1.47 1.47a.75.75 0 101.06 1.06l2-2a.75.75 0 000-1.06l-2-2a.75.75 0 00-1.06 0zM3.28 7.78a.75.75 0 00-1.06-1.06l-2 2a.75.75 0 000 1.06l2 2a.75.75 0 001.06-1.06L1.81 9.25l1.47-1.47z"/>'},RO={name:"oi-file-directory-fill",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M1.75 1A1.75 1.75 0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0016 13.25v-8.5A1.75 1.75 0 0014.25 3H7.5a.25.25 0 01-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75z"/>'},LO={name:"oi-file-directory-open-fill",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M.513 1.513A1.75 1.75 0 011.75 1h3.5c.55 0 1.07.26 1.4.7l.9 1.2a.25.25 0 00.2.1H13a1 1 0 011 1v.5H2.75a.75.75 0 000 1.5h11.978a1 1 0 01.994 1.117L15 13.25A1.75 1.75 0 0113.25 15H1.75A1.75 1.75 0 010 13.25V2.75c0-.464.184-.91.513-1.237z"/>'},PO={name:"si-adobeaftereffects",minX:-3,minY:-3,width:30,height:30,raw:'<path d="M8.54 10.73c-.1-.31-.19-.61-.29-.92s-.19-.6-.27-.89c-.08-.28-.15-.54-.22-.78h-.02c-.09.43-.2.86-.34 1.29-.15.48-.3.98-.46 1.48-.13.51-.29.98-.44 1.4h2.54c-.06-.21-.14-.46-.23-.72-.09-.27-.18-.56-.27-.86zm8.58-.29c-.55-.03-1.07.26-1.33.76-.12.23-.19.47-.22.72h2.109c.26 0 .45 0 .57-.01.08-.01.16-.03.23-.08v-.1a1.32 1.32 0 00-1.359-1.29zM19.75.3H4.25C1.9.3 0 2.2 0 4.55v14.9c0 2.35 1.9 4.25 4.25 4.25h15.5c2.35 0 4.25-1.9 4.25-4.25V4.55C24 2.2 22.1.3 19.75.3zm-7.04 16.511h-2.09c-.07.01-.14-.041-.16-.11l-.82-2.4H5.92l-.76 2.36c-.02.09-.1.15-.19.14H3.09c-.11 0-.14-.06-.11-.18L6.2 7.39c.03-.1.06-.19.1-.31.04-.21.06-.43.06-.65-.01-.05.03-.1.08-.11h2.59c.07 0 .12.03.13.08l3.65 10.25c.03.11.001.161-.1.161zm7.851-3.991c-.021.189-.031.33-.041.42-.01.07-.069.13-.14.13-.06 0-.17.01-.33.021-.159.02-.35.029-.579.029-.23 0-.471-.04-.73-.04h-3.17c.039.31.14.62.31.89a1.6 1.6 0 00.729.601c.4.17.841.26 1.281.25.35-.011.699-.04 1.039-.11a3.67 3.67 0 00.891-.23c.05-.039.08-.02.08.08v1.531c0 .039-.01.08-.021.119a.242.242 0 01-.069.07c-.32.14-.65.24-1 .3-.471.09-.94.13-1.42.12-.761 0-1.4-.12-1.92-.35a3.391 3.391 0 01-1.261-.95c-.319-.39-.55-.83-.69-1.31a5.115 5.115 0 01-.209-1.461c0-.539.08-1.07.25-1.59.16-.5.41-.96.75-1.37.33-.4.739-.72 1.209-.95.471-.23 1.03-.31 1.67-.31a3.61 3.61 0 011.55.31c.41.18.77.45 1.05.8.26.34.47.72.601 1.14.129.4.189.81.189 1.22 0 .24-.01.45-.019.64z"/>'},kO={name:"si-adobephotoshop",minX:-3,minY:-3,width:30,height:30,raw:'<path d="M9.85 8.42c-.37-.15-.77-.21-1.18-.2-.26 0-.49 0-.68.01-.2-.01-.34 0-.41.01v3.36c.14.01.27.02.39.02h.53c.39 0 .78-.06 1.15-.18.32-.09.6-.28.82-.53.21-.25.31-.59.31-1.03.01-.31-.07-.62-.23-.89a1.45 1.45 0 00-.7-.57zM19.75.3H4.25C1.9.3 0 2.2 0 4.55v14.899c0 2.35 1.9 4.25 4.25 4.25h15.5c2.35 0 4.25-1.9 4.25-4.25V4.55C24 2.2 22.1.3 19.75.3zm-7.391 11.65c-.399.56-.959.98-1.609 1.22-.68.25-1.43.34-2.25.34-.24 0-.4 0-.5-.01s-.24-.01-.43-.01v3.209c.01.07-.04.131-.11.141H5.52c-.08 0-.12-.041-.12-.131V6.42c0-.07.03-.11.1-.11.17 0 .33 0 .56-.01.24-.01.49-.01.76-.02s.56-.01.87-.02c.31-.01.61-.01.91-.01.82 0 1.5.1 2.06.31.5.17.96.45 1.34.82.32.32.57.71.73 1.14.149.42.229.85.229 1.3.001.86-.199 1.57-.6 2.13zm7.091 3.89c-.28.4-.671.709-1.12.891-.49.209-1.09.318-1.811.318-.459 0-.91-.039-1.359-.129-.35-.061-.7-.17-1.02-.32-.07-.039-.121-.109-.111-.189v-1.74c0-.029.011-.07.041-.09.029-.02.06-.01.09.01.39.23.8.391 1.24.49.379.1.779.15 1.18.15.38 0 .65-.051.83-.141.16-.07.27-.24.27-.42 0-.141-.08-.27-.24-.4-.16-.129-.489-.279-.979-.471-.51-.18-.979-.42-1.42-.719a2.625 2.625 0 01-.761-.85 2.158 2.158 0 01-.229-1.021c0-.43.12-.84.341-1.21.25-.4.619-.72 1.049-.92.469-.239 1.059-.349 1.769-.349.41 0 .83.03 1.24.09.3.04.59.12.86.23.039.01.08.05.1.09.01.04.02.08.02.12v1.63c0 .04-.02.08-.05.1-.09.02-.14.02-.18 0-.3-.16-.62-.27-.96-.34-.37-.08-.74-.13-1.12-.13-.2-.01-.41.02-.601.07-.129.03-.24.1-.31.2-.05.08-.08.18-.08.27s.04.18.101.26c.09.11.209.2.34.27.229.12.47.23.709.33.541.18 1.061.43 1.541.73.33.209.6.49.789.83.16.318.24.67.23 1.029.011.471-.129.94-.389 1.331z"/>'},FO={name:"si-git",minX:-3,minY:-3,width:30,height:30,raw:'<path d="M23.546 10.93L13.067.452a1.55 1.55 0 00-2.188 0L8.708 2.627l2.76 2.76a1.838 1.838 0 012.327 2.341l2.658 2.66a1.838 1.838 0 011.9 3.039 1.837 1.837 0 01-2.6 0 1.846 1.846 0 01-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348a1.848 1.848 0 010 2.6 1.844 1.844 0 01-2.609 0 1.834 1.834 0 010-2.598c.182-.18.387-.316.605-.406V8.835a1.834 1.834 0 01-.996-2.41L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477a1.545 1.545 0 002.186 0l10.43-10.43a1.544 1.544 0 000-2.187"/>'},NO={name:"si-html5",minX:-3,minY:-3,width:30,height:30,raw:'<path d="M1.5 0h21l-1.91 21.563L11.977 24l-8.564-2.438L1.5 0zm7.031 9.75l-.232-2.718 10.059.003.23-2.622L5.412 4.41l.698 8.01h9.126l-.326 3.426-2.91.804-2.955-.81-.188-2.11H6.248l.33 4.171L12 19.351l5.379-1.443.744-8.157H8.531z"/>'};hO(SO,bO,MO,FO,kO,PO,EO,wO,NO,CO,xO,TO,IO,mO,_O,vO,yO,BO,RO,LO,QO,fO,pO,AO,gO,DO);/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Pp=typeof window<"u";function zO(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const Vn=Object.assign;function IC(n,e){const t={};for(const i in e){const o=e[i];t[i]=nl(o)?o.map(n):n(o)}return t}const g_=()=>{},nl=Array.isArray,UO=/\/$/,OO=n=>n.replace(UO,"");function CC(n,e,t="/"){let i,o={},u="",h="";const r=e.indexOf("#");let p=e.indexOf("?");return r<p&&r>=0&&(p=-1),p>-1&&(i=e.slice(0,p),u=e.slice(p+1,r>-1?r:e.length),o=n(u)),r>-1&&(i=i||e.slice(0,r),h=e.slice(r,e.length)),i=WO(i??e,t),{fullPath:i+(u&&"?")+u+h,path:i,query:o,hash:h}}function GO(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function hT(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function HO(n,e,t){const i=e.matched.length-1,o=t.matched.length-1;return i>-1&&i===o&&gA(e.matched[i],t.matched[o])&&oL(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function gA(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function oL(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!VO(n[t],e[t]))return!1;return!0}function VO(n,e){return nl(n)?dT(n,e):nl(e)?dT(e,n):n===e}function dT(n,e){return nl(e)?n.length===e.length&&n.every((t,i)=>t===e[i]):n.length===1&&n[0]===e}function WO(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),i=n.split("/");let o=t.length-1,u,h;for(u=0;u<i.length;u++)if(h=i[u],h!==".")if(h==="..")o>1&&o--;else break;return t.slice(0,o).join("/")+"/"+i.slice(u-(u===i.length?1:0)).join("/")}var Y_;(function(n){n.pop="pop",n.push="push"})(Y_||(Y_={}));var m_;(function(n){n.back="back",n.forward="forward",n.unknown=""})(m_||(m_={}));function YO(n){if(!n)if(Pp){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),OO(n)}const jO=/^[^#]+#/;function qO(n,e){return n.replace(jO,"#")+e}function KO(n,e){const t=document.documentElement.getBoundingClientRect(),i=n.getBoundingClientRect();return{behavior:e.behavior,left:i.left-t.left-(e.left||0),top:i.top-t.top-(e.top||0)}}const u1=()=>({left:window.pageXOffset,top:window.pageYOffset});function JO(n){let e;if("el"in n){const t=n.el,i=typeof t=="string"&&t.startsWith("#"),o=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!o)return;e=KO(o,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function fT(n,e){return(history.state?history.state.position-e:-1)+n}const ow=new Map;function XO(n,e){ow.set(n,e)}function ZO(n){const e=ow.get(n);return ow.delete(n),e}let $O=()=>location.protocol+"//"+location.host;function aL(n,e){const{pathname:t,search:i,hash:o}=e,u=n.indexOf("#");if(u>-1){let r=o.includes(n.slice(u))?n.slice(u).length:1,p=o.slice(r);return p[0]!=="/"&&(p="/"+p),hT(p,"")}return hT(t,n)+i+o}function eG(n,e,t,i){let o=[],u=[],h=null;const r=({state:C})=>{const E=aL(n,location),Q=t.value,M=e.value;let D=0;if(C){if(t.value=E,e.value=C,h&&h===Q){h=null;return}D=M?C.position-M.position:0}else i(E);o.forEach(P=>{P(t.value,Q,{delta:D,type:Y_.pop,direction:D?D>0?m_.forward:m_.back:m_.unknown})})};function p(){h=t.value}function g(C){o.push(C);const E=()=>{const Q=o.indexOf(C);Q>-1&&o.splice(Q,1)};return u.push(E),E}function v(){const{history:C}=window;C.state&&C.replaceState(Vn({},C.state,{scroll:u1()}),"")}function I(){for(const C of u)C();u=[],window.removeEventListener("popstate",r),window.removeEventListener("beforeunload",v)}return window.addEventListener("popstate",r),window.addEventListener("beforeunload",v),{pauseListeners:p,listen:g,destroy:I}}function pT(n,e,t,i=!1,o=!1){return{back:n,current:e,forward:t,replaced:i,position:window.history.length,scroll:o?u1():null}}function tG(n){const{history:e,location:t}=window,i={value:aL(n,t)},o={value:e.state};o.value||u(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function u(p,g,v){const I=n.indexOf("#"),C=I>-1?(t.host&&document.querySelector("base")?n:n.slice(I))+p:$O()+n+p;try{e[v?"replaceState":"pushState"](g,"",C),o.value=g}catch(E){console.error(E),t[v?"replace":"assign"](C)}}function h(p,g){const v=Vn({},e.state,pT(o.value.back,p,o.value.forward,!0),g,{position:o.value.position});u(p,v,!0),i.value=p}function r(p,g){const v=Vn({},o.value,e.state,{forward:p,scroll:u1()});u(v.current,v,!0);const I=Vn({},pT(i.value,p,null),{position:v.position+1},g);u(p,I,!1),i.value=p}return{location:i,state:o,push:r,replace:h}}function iG(n){n=YO(n);const e=tG(n),t=eG(n,e.state,e.location,e.replace);function i(u,h=!0){h||t.pauseListeners(),history.go(u)}const o=Vn({location:"",base:n,go:i,createHref:qO.bind(null,n)},e,t);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>e.state.value}),o}function nG(n){return typeof n=="string"||n&&typeof n=="object"}function lL(n){return typeof n=="string"||typeof n=="symbol"}const yu={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},cL=Symbol("");var AT;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(AT||(AT={}));function mA(n,e){return Vn(new Error,{type:n,[cL]:!0},e)}function ic(n,e){return n instanceof Error&&cL in n&&(e==null||!!(n.type&e))}const gT="[^/]+?",rG={sensitive:!1,strict:!1,start:!0,end:!0},sG=/[.+*?^${}()[\]/\\]/g;function oG(n,e){const t=Vn({},rG,e),i=[];let o=t.start?"^":"";const u=[];for(const g of n){const v=g.length?[]:[90];t.strict&&!g.length&&(o+="/");for(let I=0;I<g.length;I++){const C=g[I];let E=40+(t.sensitive?.25:0);if(C.type===0)I||(o+="/"),o+=C.value.replace(sG,"\\$&"),E+=40;else if(C.type===1){const{value:Q,repeatable:M,optional:D,regexp:P}=C;u.push({name:Q,repeatable:M,optional:D});const O=P||gT;if(O!==gT){E+=10;try{new RegExp(`(${O})`)}catch(N){throw new Error(`Invalid custom RegExp for param "${Q}" (${O}): `+N.message)}}let F=M?`((?:${O})(?:/(?:${O}))*)`:`(${O})`;I||(F=D&&g.length<2?`(?:/${F})`:"/"+F),D&&(F+="?"),o+=F,E+=20,D&&(E+=-8),M&&(E+=-20),O===".*"&&(E+=-50)}v.push(E)}i.push(v)}if(t.strict&&t.end){const g=i.length-1;i[g][i[g].length-1]+=.7000000000000001}t.strict||(o+="/?"),t.end?o+="$":t.strict&&(o+="(?:/|$)");const h=new RegExp(o,t.sensitive?"":"i");function r(g){const v=g.match(h),I={};if(!v)return null;for(let C=1;C<v.length;C++){const E=v[C]||"",Q=u[C-1];I[Q.name]=E&&Q.repeatable?E.split("/"):E}return I}function p(g){let v="",I=!1;for(const C of n){(!I||!v.endsWith("/"))&&(v+="/"),I=!1;for(const E of C)if(E.type===0)v+=E.value;else if(E.type===1){const{value:Q,repeatable:M,optional:D}=E,P=Q in g?g[Q]:"";if(nl(P)&&!M)throw new Error(`Provided param "${Q}" is an array but it is not repeatable (* or + modifiers)`);const O=nl(P)?P.join("/"):P;if(!O)if(D)C.length<2&&(v.endsWith("/")?v=v.slice(0,-1):I=!0);else throw new Error(`Missing required param "${Q}"`);v+=O}}return v||"/"}return{re:h,score:i,keys:u,parse:r,stringify:p}}function aG(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=e[t]-n[t];if(i)return i;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function lG(n,e){let t=0;const i=n.score,o=e.score;for(;t<i.length&&t<o.length;){const u=aG(i[t],o[t]);if(u)return u;t++}if(Math.abs(o.length-i.length)===1){if(mT(i))return 1;if(mT(o))return-1}return o.length-i.length}function mT(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const cG={type:0,value:""},uG=/[a-zA-Z0-9_]/;function hG(n){if(!n)return[[]];if(n==="/")return[[cG]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(E){throw new Error(`ERR (${t})/"${g}": ${E}`)}let t=0,i=t;const o=[];let u;function h(){u&&o.push(u),u=[]}let r=0,p,g="",v="";function I(){g&&(t===0?u.push({type:0,value:g}):t===1||t===2||t===3?(u.length>1&&(p==="*"||p==="+")&&e(`A repeatable param (${g}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:g,regexp:v,repeatable:p==="*"||p==="+",optional:p==="*"||p==="?"})):e("Invalid state to consume buffer"),g="")}function C(){g+=p}for(;r<n.length;){if(p=n[r++],p==="\\"&&t!==2){i=t,t=4;continue}switch(t){case 0:p==="/"?(g&&I(),h()):p===":"?(I(),t=1):C();break;case 4:C(),t=i;break;case 1:p==="("?t=2:uG.test(p)?C():(I(),t=0,p!=="*"&&p!=="?"&&p!=="+"&&r--);break;case 2:p===")"?v[v.length-1]=="\\"?v=v.slice(0,-1)+p:t=3:v+=p;break;case 3:I(),t=0,p!=="*"&&p!=="?"&&p!=="+"&&r--,v="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${g}"`),I(),h(),o}function dG(n,e,t){const i=oG(hG(n.path),t),o=Vn(i,{record:n,parent:e,children:[],alias:[]});return e&&!o.record.aliasOf==!e.record.aliasOf&&e.children.push(o),o}function fG(n,e){const t=[],i=new Map;e=vT({strict:!1,end:!0,sensitive:!1},e);function o(v){return i.get(v)}function u(v,I,C){const E=!C,Q=pG(v);Q.aliasOf=C&&C.record;const M=vT(e,v),D=[Q];if("alias"in v){const F=typeof v.alias=="string"?[v.alias]:v.alias;for(const N of F)D.push(Vn({},Q,{components:C?C.record.components:Q.components,path:N,aliasOf:C?C.record:Q}))}let P,O;for(const F of D){const{path:N}=F;if(I&&N[0]!=="/"){const z=I.record.path,X=z[z.length-1]==="/"?"":"/";F.path=I.record.path+(N&&X+N)}if(P=dG(F,I,M),C?C.alias.push(P):(O=O||P,O!==P&&O.alias.push(P),E&&v.name&&!yT(P)&&h(v.name)),Q.children){const z=Q.children;for(let X=0;X<z.length;X++)u(z[X],P,C&&C.children[X])}C=C||P,(P.record.components&&Object.keys(P.record.components).length||P.record.name||P.record.redirect)&&p(P)}return O?()=>{h(O)}:g_}function h(v){if(lL(v)){const I=i.get(v);I&&(i.delete(v),t.splice(t.indexOf(I),1),I.children.forEach(h),I.alias.forEach(h))}else{const I=t.indexOf(v);I>-1&&(t.splice(I,1),v.record.name&&i.delete(v.record.name),v.children.forEach(h),v.alias.forEach(h))}}function r(){return t}function p(v){let I=0;for(;I<t.length&&lG(v,t[I])>=0&&(v.record.path!==t[I].record.path||!uL(v,t[I]));)I++;t.splice(I,0,v),v.record.name&&!yT(v)&&i.set(v.record.name,v)}function g(v,I){let C,E={},Q,M;if("name"in v&&v.name){if(C=i.get(v.name),!C)throw mA(1,{location:v});M=C.record.name,E=Vn(_T(I.params,C.keys.filter(O=>!O.optional).map(O=>O.name)),v.params&&_T(v.params,C.keys.map(O=>O.name))),Q=C.stringify(E)}else if("path"in v)Q=v.path,C=t.find(O=>O.re.test(Q)),C&&(E=C.parse(Q),M=C.record.name);else{if(C=I.name?i.get(I.name):t.find(O=>O.re.test(I.path)),!C)throw mA(1,{location:v,currentLocation:I});M=C.record.name,E=Vn({},I.params,v.params),Q=C.stringify(E)}const D=[];let P=C;for(;P;)D.unshift(P.record),P=P.parent;return{name:M,path:Q,params:E,matched:D,meta:gG(D)}}return n.forEach(v=>u(v)),{addRoute:u,resolve:g,removeRoute:h,getRoutes:r,getRecordMatcher:o}}function _T(n,e){const t={};for(const i of e)i in n&&(t[i]=n[i]);return t}function pG(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:AG(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function AG(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const i in n.components)e[i]=typeof t=="boolean"?t:t[i];return e}function yT(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function gG(n){return n.reduce((e,t)=>Vn(e,t.meta),{})}function vT(n,e){const t={};for(const i in n)t[i]=i in e?e[i]:n[i];return t}function uL(n,e){return e.children.some(t=>t===n||uL(n,t))}const hL=/#/g,mG=/&/g,_G=/\//g,yG=/=/g,vG=/\?/g,dL=/\+/g,xG=/%5B/g,IG=/%5D/g,fL=/%5E/g,CG=/%60/g,pL=/%7B/g,EG=/%7C/g,AL=/%7D/g,wG=/%20/g;function Vb(n){return encodeURI(""+n).replace(EG,"|").replace(xG,"[").replace(IG,"]")}function bG(n){return Vb(n).replace(pL,"{").replace(AL,"}").replace(fL,"^")}function aw(n){return Vb(n).replace(dL,"%2B").replace(wG,"+").replace(hL,"%23").replace(mG,"%26").replace(CG,"`").replace(pL,"{").replace(AL,"}").replace(fL,"^")}function BG(n){return aw(n).replace(yG,"%3D")}function SG(n){return Vb(n).replace(hL,"%23").replace(vG,"%3F")}function MG(n){return n==null?"":SG(n).replace(_G,"%2F")}function Ex(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function TG(n){const e={};if(n===""||n==="?")return e;const i=(n[0]==="?"?n.slice(1):n).split("&");for(let o=0;o<i.length;++o){const u=i[o].replace(dL," "),h=u.indexOf("="),r=Ex(h<0?u:u.slice(0,h)),p=h<0?null:Ex(u.slice(h+1));if(r in e){let g=e[r];nl(g)||(g=e[r]=[g]),g.push(p)}else e[r]=p}return e}function xT(n){let e="";for(let t in n){const i=n[t];if(t=BG(t),i==null){i!==void 0&&(e+=(e.length?"&":"")+t);continue}(nl(i)?i.map(u=>u&&aw(u)):[i&&aw(i)]).forEach(u=>{u!==void 0&&(e+=(e.length?"&":"")+t,u!=null&&(e+="="+u))})}return e}function DG(n){const e={};for(const t in n){const i=n[t];i!==void 0&&(e[t]=nl(i)?i.map(o=>o==null?null:""+o):i==null?i:""+i)}return e}const QG=Symbol(""),IT=Symbol(""),h1=Symbol(""),gL=Symbol(""),lw=Symbol("");function Em(){let n=[];function e(i){return n.push(i),()=>{const o=n.indexOf(i);o>-1&&n.splice(o,1)}}function t(){n=[]}return{add:e,list:()=>n,reset:t}}function Pu(n,e,t,i,o){const u=i&&(i.enterCallbacks[o]=i.enterCallbacks[o]||[]);return()=>new Promise((h,r)=>{const p=I=>{I===!1?r(mA(4,{from:t,to:e})):I instanceof Error?r(I):nG(I)?r(mA(2,{from:e,to:I})):(u&&i.enterCallbacks[o]===u&&typeof I=="function"&&u.push(I),h())},g=n.call(i&&i.instances[o],e,t,p);let v=Promise.resolve(g);n.length<3&&(v=v.then(p)),v.catch(I=>r(I))})}function EC(n,e,t,i){const o=[];for(const u of n)for(const h in u.components){let r=u.components[h];if(!(e!=="beforeRouteEnter"&&!u.instances[h]))if(RG(r)){const g=(r.__vccOpts||r)[e];g&&o.push(Pu(g,t,i,u,h))}else{let p=r();o.push(()=>p.then(g=>{if(!g)return Promise.reject(new Error(`Couldn't resolve component "${h}" at "${u.path}"`));const v=zO(g)?g.default:g;u.components[h]=v;const C=(v.__vccOpts||v)[e];return C&&Pu(C,t,i,u,h)()}))}}return o}function RG(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function CT(n){const e=Aa(h1),t=Aa(gL),i=cn(()=>e.resolve(Bi(n.to))),o=cn(()=>{const{matched:p}=i.value,{length:g}=p,v=p[g-1],I=t.matched;if(!v||!I.length)return-1;const C=I.findIndex(gA.bind(null,v));if(C>-1)return C;const E=ET(p[g-2]);return g>1&&ET(v)===E&&I[I.length-1].path!==E?I.findIndex(gA.bind(null,p[g-2])):C}),u=cn(()=>o.value>-1&&FG(t.params,i.value.params)),h=cn(()=>o.value>-1&&o.value===t.matched.length-1&&oL(t.params,i.value.params));function r(p={}){return kG(p)?e[Bi(n.replace)?"replace":"push"](Bi(n.to)).catch(g_):Promise.resolve()}return{route:i,href:cn(()=>i.value.href),isActive:u,isExactActive:h,navigate:r}}const LG=kn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:CT,setup(n,{slots:e}){const t=Ql(CT(n)),{options:i}=Aa(h1),o=cn(()=>({[wT(n.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[wT(n.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const u=e.default&&e.default(t);return n.custom?u:Qd("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:o.value},u)}}}),PG=LG;function kG(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function FG(n,e){for(const t in e){const i=e[t],o=n[t];if(typeof i=="string"){if(i!==o)return!1}else if(!nl(o)||o.length!==i.length||i.some((u,h)=>u!==o[h]))return!1}return!0}function ET(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const wT=(n,e,t)=>n??e??t,NG=kn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const i=Aa(lw),o=cn(()=>n.route||i.value),u=Aa(IT,0),h=cn(()=>{let g=Bi(u);const{matched:v}=o.value;let I;for(;(I=v[g])&&!I.components;)g++;return g}),r=cn(()=>o.value.matched[h.value]);c_(IT,cn(()=>h.value+1)),c_(QG,r),c_(lw,o);const p=Gt();return qi(()=>[p.value,r.value,n.name],([g,v,I],[C,E,Q])=>{v&&(v.instances[I]=g,E&&E!==v&&g&&g===C&&(v.leaveGuards.size||(v.leaveGuards=E.leaveGuards),v.updateGuards.size||(v.updateGuards=E.updateGuards))),g&&v&&(!E||!gA(v,E)||!C)&&(v.enterCallbacks[I]||[]).forEach(M=>M(g))},{flush:"post"}),()=>{const g=o.value,v=n.name,I=r.value,C=I&&I.components[v];if(!C)return bT(t.default,{Component:C,route:g});const E=I.props[v],Q=E?E===!0?g.params:typeof E=="function"?E(g):E:null,D=Qd(C,Vn({},Q,e,{onVnodeUnmounted:P=>{P.component.isUnmounted&&(I.instances[v]=null)},ref:p}));return bT(t.default,{Component:D,route:g})||D}}});function bT(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const mL=NG;function zG(n){const e=fG(n.routes,n),t=n.parseQuery||TG,i=n.stringifyQuery||xT,o=n.history,u=Em(),h=Em(),r=Em(),p=mR(yu);let g=yu;Pp&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=IC.bind(null,Ke=>""+Ke),I=IC.bind(null,MG),C=IC.bind(null,Ex);function E(Ke,Ne){let dt,xt;return lL(Ke)?(dt=e.getRecordMatcher(Ke),xt=Ne):xt=Ke,e.addRoute(xt,dt)}function Q(Ke){const Ne=e.getRecordMatcher(Ke);Ne&&e.removeRoute(Ne)}function M(){return e.getRoutes().map(Ke=>Ke.record)}function D(Ke){return!!e.getRecordMatcher(Ke)}function P(Ke,Ne){if(Ne=Vn({},Ne||p.value),typeof Ke=="string"){const ae=CC(t,Ke,Ne.path),_e=e.resolve({path:ae.path},Ne),Ze=o.createHref(ae.fullPath);return Vn(ae,_e,{params:C(_e.params),hash:Ex(ae.hash),redirectedFrom:void 0,href:Ze})}let dt;if("path"in Ke)dt=Vn({},Ke,{path:CC(t,Ke.path,Ne.path).path});else{const ae=Vn({},Ke.params);for(const _e in ae)ae[_e]==null&&delete ae[_e];dt=Vn({},Ke,{params:I(Ke.params)}),Ne.params=I(Ne.params)}const xt=e.resolve(dt,Ne),ft=Ke.hash||"";xt.params=v(C(xt.params));const Ve=GO(i,Vn({},Ke,{hash:bG(ft),path:xt.path})),Ye=o.createHref(Ve);return Vn({fullPath:Ve,hash:ft,query:i===xT?DG(Ke.query):Ke.query||{}},xt,{redirectedFrom:void 0,href:Ye})}function O(Ke){return typeof Ke=="string"?CC(t,Ke,p.value.path):Vn({},Ke)}function F(Ke,Ne){if(g!==Ke)return mA(8,{from:Ne,to:Ke})}function N(Ke){return q(Ke)}function z(Ke){return N(Vn(O(Ke),{replace:!0}))}function X(Ke){const Ne=Ke.matched[Ke.matched.length-1];if(Ne&&Ne.redirect){const{redirect:dt}=Ne;let xt=typeof dt=="function"?dt(Ke):dt;return typeof xt=="string"&&(xt=xt.includes("?")||xt.includes("#")?xt=O(xt):{path:xt},xt.params={}),Vn({query:Ke.query,hash:Ke.hash,params:"path"in xt?{}:Ke.params},xt)}}function q(Ke,Ne){const dt=g=P(Ke),xt=p.value,ft=Ke.state,Ve=Ke.force,Ye=Ke.replace===!0,ae=X(dt);if(ae)return q(Vn(O(ae),{state:typeof ae=="object"?Vn({},ft,ae.state):ft,force:Ve,replace:Ye}),Ne||dt);const _e=dt;_e.redirectedFrom=Ne;let Ze;return!Ve&&HO(i,xt,dt)&&(Ze=mA(16,{to:_e,from:xt}),oe(xt,xt,!0,!1)),(Ze?Promise.resolve(Ze):W(_e,xt)).catch(nt=>ic(nt)?ic(nt,2)?nt:ht(nt):Re(nt,_e,xt)).then(nt=>{if(nt){if(ic(nt,2))return q(Vn({replace:Ye},O(nt.to),{state:typeof nt.to=="object"?Vn({},ft,nt.to.state):ft,force:Ve}),Ne||_e)}else nt=de(_e,xt,!0,Ye,ft);return se(_e,xt,nt),nt})}function H(Ke,Ne){const dt=F(Ke,Ne);return dt?Promise.reject(dt):Promise.resolve()}function W(Ke,Ne){let dt;const[xt,ft,Ve]=UG(Ke,Ne);dt=EC(xt.reverse(),"beforeRouteLeave",Ke,Ne);for(const ae of xt)ae.leaveGuards.forEach(_e=>{dt.push(Pu(_e,Ke,Ne))});const Ye=H.bind(null,Ke,Ne);return dt.push(Ye),cp(dt).then(()=>{dt=[];for(const ae of u.list())dt.push(Pu(ae,Ke,Ne));return dt.push(Ye),cp(dt)}).then(()=>{dt=EC(ft,"beforeRouteUpdate",Ke,Ne);for(const ae of ft)ae.updateGuards.forEach(_e=>{dt.push(Pu(_e,Ke,Ne))});return dt.push(Ye),cp(dt)}).then(()=>{dt=[];for(const ae of Ke.matched)if(ae.beforeEnter&&!Ne.matched.includes(ae))if(nl(ae.beforeEnter))for(const _e of ae.beforeEnter)dt.push(Pu(_e,Ke,Ne));else dt.push(Pu(ae.beforeEnter,Ke,Ne));return dt.push(Ye),cp(dt)}).then(()=>(Ke.matched.forEach(ae=>ae.enterCallbacks={}),dt=EC(Ve,"beforeRouteEnter",Ke,Ne),dt.push(Ye),cp(dt))).then(()=>{dt=[];for(const ae of h.list())dt.push(Pu(ae,Ke,Ne));return dt.push(Ye),cp(dt)}).catch(ae=>ic(ae,8)?ae:Promise.reject(ae))}function se(Ke,Ne,dt){for(const xt of r.list())xt(Ke,Ne,dt)}function de(Ke,Ne,dt,xt,ft){const Ve=F(Ke,Ne);if(Ve)return Ve;const Ye=Ne===yu,ae=Pp?history.state:{};dt&&(xt||Ye?o.replace(Ke.fullPath,Vn({scroll:Ye&&ae&&ae.scroll},ft)):o.push(Ke.fullPath,ft)),p.value=Ke,oe(Ke,Ne,dt,Ye),ht()}let te;function ce(){te||(te=o.listen((Ke,Ne,dt)=>{if(!Et.listening)return;const xt=P(Ke),ft=X(xt);if(ft){q(Vn(ft,{replace:!0}),xt).catch(g_);return}g=xt;const Ve=p.value;Pp&&XO(fT(Ve.fullPath,dt.delta),u1()),W(xt,Ve).catch(Ye=>ic(Ye,12)?Ye:ic(Ye,2)?(q(Ye.to,xt).then(ae=>{ic(ae,20)&&!dt.delta&&dt.type===Y_.pop&&o.go(-1,!1)}).catch(g_),Promise.reject()):(dt.delta&&o.go(-dt.delta,!1),Re(Ye,xt,Ve))).then(Ye=>{Ye=Ye||de(xt,Ve,!1),Ye&&(dt.delta&&!ic(Ye,8)?o.go(-dt.delta,!1):dt.type===Y_.pop&&ic(Ye,20)&&o.go(-1,!1)),se(xt,Ve,Ye)}).catch(g_)}))}let Ee=Em(),Be=Em(),De;function Re(Ke,Ne,dt){ht(Ke);const xt=Be.list();return xt.length?xt.forEach(ft=>ft(Ke,Ne,dt)):console.error(Ke),Promise.reject(Ke)}function ye(){return De&&p.value!==yu?Promise.resolve():new Promise((Ke,Ne)=>{Ee.add([Ke,Ne])})}function ht(Ke){return De||(De=!Ke,ce(),Ee.list().forEach(([Ne,dt])=>Ke?dt(Ke):Ne()),Ee.reset()),Ke}function oe(Ke,Ne,dt,xt){const{scrollBehavior:ft}=n;if(!Pp||!ft)return Promise.resolve();const Ve=!dt&&ZO(fT(Ke.fullPath,0))||(xt||!dt)&&history.state&&history.state.scroll||null;return Gr().then(()=>ft(Ke,Ne,Ve)).then(Ye=>Ye&&JO(Ye)).catch(Ye=>Re(Ye,Ke,Ne))}const Tt=Ke=>o.go(Ke);let Fe;const st=new Set,Et={currentRoute:p,listening:!0,addRoute:E,removeRoute:Q,hasRoute:D,getRoutes:M,resolve:P,options:n,push:N,replace:z,go:Tt,back:()=>Tt(-1),forward:()=>Tt(1),beforeEach:u.add,beforeResolve:h.add,afterEach:r.add,onError:Be.add,isReady:ye,install(Ke){const Ne=this;Ke.component("RouterLink",PG),Ke.component("RouterView",mL),Ke.config.globalProperties.$router=Ne,Object.defineProperty(Ke.config.globalProperties,"$route",{enumerable:!0,get:()=>Bi(p)}),Pp&&!Fe&&p.value===yu&&(Fe=!0,N(o.location).catch(ft=>{}));const dt={};for(const ft in yu)dt[ft]=cn(()=>p.value[ft]);Ke.provide(h1,Ne),Ke.provide(gL,Ql(dt)),Ke.provide(lw,p);const xt=Ke.unmount;st.add(Ke),Ke.unmount=function(){st.delete(Ke),st.size<1&&(g=yu,te&&te(),te=null,p.value=yu,Fe=!1,De=!1),xt()}}};return Et}function cp(n){return n.reduce((e,t)=>e.then(()=>t()),Promise.resolve())}function UG(n,e){const t=[],i=[],o=[],u=Math.max(e.matched.length,n.matched.length);for(let h=0;h<u;h++){const r=e.matched[h];r&&(n.matched.find(g=>gA(g,r))?i.push(r):t.push(r));const p=n.matched[h];p&&(e.matched.find(g=>gA(g,p))||o.push(p))}return[t,i,o]}function A0(){return Aa(h1)}const OG={class:"height--screen flex w-full flex-col"},GG=Yt("div",{class:"sticky top-0 min-h-[5rem] w-full py-4"},null,-1),HG=kn({__name:"DefaultLayout",setup(n){const e=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};return Br(()=>{window.addEventListener("resize",e),e()}),(t,i)=>(Qi(),tn("main",OG,[GG,VA(t.$slots,"default")]))}});function pc(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _L(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Fo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_A={duration:.5,overwrite:!1,delay:0},Wb,Ns,Hr,ca=1e8,$n=1/ca,cw=Math.PI*2,VG=cw/4,WG=0,yL=Math.sqrt,YG=Math.cos,jG=Math.sin,ps=function(e){return typeof e=="string"},br=function(e){return typeof e=="function"},Rc=function(e){return typeof e=="number"},Yb=function(e){return typeof e>"u"},Rl=function(e){return typeof e=="object"},Ao=function(e){return e!==!1},vL=function(){return typeof window<"u"},Xy=function(e){return br(e)||ps(e)},xL=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},zs=Array.isArray,uw=/(?:-?\.?\d|\.)+/gi,IL=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Op=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,wC=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,CL=/[+-]=-?[.\d]+/,EL=/[^,'"\[\]\s]+/gi,qG=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ir,ra,hw,jb,zo={},wx={},wL,bL=function(e){return(wx=Wd(e,zo))&&Uo},qb=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},bx=function(e,t){return!t&&console.warn(e)},BL=function(e,t){return e&&(zo[e]=t)&&wx&&(wx[e]=t)||zo},j_=function(){return 0},KG={suppressEvents:!0,isStart:!0,kill:!1},Zv={suppressEvents:!0,kill:!1},JG={suppressEvents:!0},Kb={},Ju=[],dw={},SL,Qo={},bC={},BT=30,$v=[],Jb="",Xb=function(e){var t=e[0],i,o;if(Rl(t)||br(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(o=$v.length;o--&&!$v[o].targetTest(t););i=$v[o]}for(o=e.length;o--;)e[o]&&(e[o]._gsap||(e[o]._gsap=new JL(e[o],i)))||e.splice(o,1);return e},Rd=function(e){return e._gsap||Xb(ua(e))[0]._gsap},ML=function(e,t,i){return(i=e[t])&&br(i)?e[t]():Yb(i)&&e.getAttribute&&e.getAttribute(t)||i},go=function(e,t){return(e=e.split(",")).forEach(t)||e},Qr=function(e){return Math.round(e*1e5)/1e5||0},vs=function(e){return Math.round(e*1e7)/1e7||0},Xp=function(e,t){var i=t.charAt(0),o=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+o:i==="-"?e-o:i==="*"?e*o:e/o},XG=function(e,t){for(var i=t.length,o=0;e.indexOf(t[o])<0&&++o<i;);return o<i},Bx=function(){var e=Ju.length,t=Ju.slice(0),i,o;for(dw={},Ju.length=0,i=0;i<e;i++)o=t[i],o&&o._lazy&&(o.render(o._lazy[0],o._lazy[1],!0)._lazy=0)},TL=function(e,t,i,o){Ju.length&&!Ns&&Bx(),e.render(t,i,o||Ns&&t<0&&(e._initted||e._startAt)),Ju.length&&!Ns&&Bx()},DL=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(EL).length<2?t:ps(e)?e.trim():e},QL=function(e){return e},va=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},ZG=function(e){return function(t,i){for(var o in i)o in t||o==="duration"&&e||o==="ease"||(t[o]=i[o])}},Wd=function(e,t){for(var i in t)e[i]=t[i];return e},ST=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Rl(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},Sx=function(e,t){var i={},o;for(o in e)o in t||(i[o]=e[o]);return i},__=function(e){var t=e.parent||Ir,i=e.keyframes?ZG(zs(e.keyframes)):va;if(Ao(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},$G=function(e,t){for(var i=e.length,o=i===t.length;o&&i--&&e[i]===t[i];);return i<0},RL=function(e,t,i,o,u){i===void 0&&(i="_first"),o===void 0&&(o="_last");var h=e[o],r;if(u)for(r=t[u];h&&h[u]>r;)h=h._prev;return h?(t._next=h._next,h._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[o]=t,t._prev=h,t.parent=t._dp=e,t},d1=function(e,t,i,o){i===void 0&&(i="_first"),o===void 0&&(o="_last");var u=t._prev,h=t._next;u?u._next=h:e[i]===t&&(e[i]=h),h?h._prev=u:e[o]===t&&(e[o]=u),t._next=t._prev=t.parent=null},sh=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Ld=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},e6=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},fw=function(e,t,i,o){return e._startAt&&(Ns?e._startAt.revert(Zv):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,o))},t6=function n(e){return!e||e._ts&&n(e.parent)},MT=function(e){return e._repeat?yA(e._tTime,e=e.duration()+e._rDelay)*e:0},yA=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},Mx=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},f1=function(e){return e._end=vs(e._start+(e._tDur/Math.abs(e._ts||e._rts||$n)||0))},p1=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=vs(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),f1(e),i._dirty||Ld(i,e)),e},LL=function(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=Mx(e.rawTime(),t),(!t._dur||g0(0,t.totalDuration(),i)-t._tTime>$n)&&t.render(i,!0)),Ld(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-$n}},bl=function(e,t,i,o){return t.parent&&sh(t),t._start=vs((Rc(i)?i:i||e!==Ir?na(e,i,t):e._time)+t._delay),t._end=vs(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),RL(e,t,"_first","_last",e._sort?"_start":0),pw(t)||(e._recent=t),o||LL(e,t),e._ts<0&&p1(e,e._tTime),e},PL=function(e,t){return(zo.ScrollTrigger||qb("scrollTrigger",t))&&zo.ScrollTrigger.create(t,e)},kL=function(e,t,i,o,u){if($b(e,t,u),!e._initted)return 1;if(!i&&e._pt&&!Ns&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&SL!==Ro.frame)return Ju.push(e),e._lazy=[u,o],1},i6=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},pw=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},n6=function(e,t,i,o){var u=e.ratio,h=t<0||!t&&(!e._start&&i6(e)&&!(!e._initted&&pw(e))||(e._ts<0||e._dp._ts<0)&&!pw(e))?0:1,r=e._rDelay,p=0,g,v,I;if(r&&e._repeat&&(p=g0(0,e._tDur,t),v=yA(p,r),e._yoyo&&v&1&&(h=1-h),v!==yA(e._tTime,r)&&(u=1-h,e.vars.repeatRefresh&&e._initted&&e.invalidate())),h!==u||Ns||o||e._zTime===$n||!t&&e._zTime){if(!e._initted&&kL(e,t,o,i,p))return;for(I=e._zTime,e._zTime=t||(i?$n:0),i||(i=t&&!I),e.ratio=h,e._from&&(h=1-h),e._time=0,e._tTime=p,g=e._pt;g;)g.r(h,g.d),g=g._next;t<0&&fw(e,t,i,!0),e._onUpdate&&!i&&ha(e,"onUpdate"),p&&e._repeat&&!i&&e.parent&&ha(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===h&&(h&&sh(e,1),!i&&!Ns&&(ha(e,h?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},r6=function(e,t,i){var o;if(i>t)for(o=e._first;o&&o._start<=i;){if(o.data==="isPause"&&o._start>t)return o;o=o._next}else for(o=e._last;o&&o._start>=i;){if(o.data==="isPause"&&o._start<t)return o;o=o._prev}},vA=function(e,t,i,o){var u=e._repeat,h=vs(t)||0,r=e._tTime/e._tDur;return r&&!o&&(e._time*=h/e._dur),e._dur=h,e._tDur=u?u<0?1e10:vs(h*(u+1)+e._rDelay*u):h,r>0&&!o&&p1(e,e._tTime=e._tDur*r),e.parent&&f1(e),i||Ld(e.parent,e),e},TT=function(e){return e instanceof fo?Ld(e):vA(e,e._dur)},s6={_start:0,endTime:j_,totalDuration:j_},na=function n(e,t,i){var o=e.labels,u=e._recent||s6,h=e.duration()>=ca?u.endTime(!1):e._dur,r,p,g;return ps(t)&&(isNaN(t)||t in o)?(p=t.charAt(0),g=t.substr(-1)==="%",r=t.indexOf("="),p==="<"||p===">"?(r>=0&&(t=t.replace(/=/,"")),(p==="<"?u._start:u.endTime(u._repeat>=0))+(parseFloat(t.substr(1))||0)*(g?(r<0?u:i).totalDuration()/100:1)):r<0?(t in o||(o[t]=h),o[t]):(p=parseFloat(t.charAt(r-1)+t.substr(r+1)),g&&i&&(p=p/100*(zs(i)?i[0]:i).totalDuration()),r>1?n(e,t.substr(0,r-1),i)+p:h+p)):t==null?h:+t},y_=function(e,t,i){var o=Rc(t[1]),u=(o?2:1)+(e<2?0:1),h=t[u],r,p;if(o&&(h.duration=t[1]),h.parent=i,e){for(r=h,p=i;p&&!("immediateRender"in r);)r=p.vars.defaults||{},p=Ao(p.vars.inherit)&&p.parent;h.immediateRender=Ao(r.immediateRender),e<2?h.runBackwards=1:h.startAt=t[u-1]}return new Xr(t[0],h,t[u+1])},dh=function(e,t){return e||e===0?t(e):t},g0=function(e,t,i){return i<e?e:i>t?t:i},ks=function(e,t){return!ps(e)||!(t=qG.exec(e))?"":t[1]},o6=function(e,t,i){return dh(i,function(o){return g0(e,t,o)})},Aw=[].slice,FL=function(e,t){return e&&Rl(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Rl(e[0]))&&!e.nodeType&&e!==ra},a6=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(o){var u;return ps(o)&&!t||FL(o,1)?(u=i).push.apply(u,ua(o)):i.push(o)})||i},ua=function(e,t,i){return Hr&&!t&&Hr.selector?Hr.selector(e):ps(e)&&!i&&(hw||!xA())?Aw.call((t||jb).querySelectorAll(e),0):zs(e)?a6(e,i):FL(e)?Aw.call(e,0):e?[e]:[]},gw=function(e){return e=ua(e)[0]||bx("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return ua(t,i.querySelectorAll?i:i===e?bx("Invalid scope")||jb.createElement("div"):e)}},NL=function(e){return e.sort(function(){return .5-Math.random()})},zL=function(e){if(br(e))return e;var t=Rl(e)?e:{each:e},i=Pd(t.ease),o=t.from||0,u=parseFloat(t.base)||0,h={},r=o>0&&o<1,p=isNaN(o)||r,g=t.axis,v=o,I=o;return ps(o)?v=I={center:.5,edges:.5,end:1}[o]||0:!r&&p&&(v=o[0],I=o[1]),function(C,E,Q){var M=(Q||t).length,D=h[M],P,O,F,N,z,X,q,H,W;if(!D){if(W=t.grid==="auto"?0:(t.grid||[1,ca])[1],!W){for(q=-ca;q<(q=Q[W++].getBoundingClientRect().left)&&W<M;);W--}for(D=h[M]=[],P=p?Math.min(W,M)*v-.5:o%W,O=W===ca?0:p?M*I/W-.5:o/W|0,q=0,H=ca,X=0;X<M;X++)F=X%W-P,N=O-(X/W|0),D[X]=z=g?Math.abs(g==="y"?N:F):yL(F*F+N*N),z>q&&(q=z),z<H&&(H=z);o==="random"&&NL(D),D.max=q-H,D.min=H,D.v=M=(parseFloat(t.amount)||parseFloat(t.each)*(W>M?M-1:g?g==="y"?M/W:W:Math.max(W,M/W))||0)*(o==="edges"?-1:1),D.b=M<0?u-M:u,D.u=ks(t.amount||t.each)||0,i=i&&M<0?jL(i):i}return M=(D[C]-D.min)/D.max||0,vs(D.b+(i?i(M):M)*D.v)+D.u}},mw=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var o=vs(Math.round(parseFloat(i)/e)*e*t);return(o-o%1)/t+(Rc(i)?0:ks(i))}},UL=function(e,t){var i=zs(e),o,u;return!i&&Rl(e)&&(o=i=e.radius||ca,e.values?(e=ua(e.values),(u=!Rc(e[0]))&&(o*=o)):e=mw(e.increment)),dh(t,i?br(e)?function(h){return u=e(h),Math.abs(u-h)<=o?u:h}:function(h){for(var r=parseFloat(u?h.x:h),p=parseFloat(u?h.y:0),g=ca,v=0,I=e.length,C,E;I--;)u?(C=e[I].x-r,E=e[I].y-p,C=C*C+E*E):C=Math.abs(e[I]-r),C<g&&(g=C,v=I);return v=!o||g<=o?e[v]:h,u||v===h||Rc(h)?v:v+ks(h)}:mw(e))},OL=function(e,t,i,o){return dh(zs(e)?!t:i===!0?!!(i=0):!o,function(){return zs(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(o=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*o)/o})},l6=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(o){return t.reduce(function(u,h){return h(u)},o)}},c6=function(e,t){return function(i){return e(parseFloat(i))+(t||ks(i))}},u6=function(e,t,i){return HL(e,t,0,1,i)},GL=function(e,t,i){return dh(i,function(o){return e[~~t(o)]})},h6=function n(e,t,i){var o=t-e;return zs(e)?GL(e,n(0,e.length),t):dh(i,function(u){return(o+(u-e)%o)%o+e})},d6=function n(e,t,i){var o=t-e,u=o*2;return zs(e)?GL(e,n(0,e.length-1),t):dh(i,function(h){return h=(u+(h-e)%u)%u||0,e+(h>o?u-h:h)})},q_=function(e){for(var t=0,i="",o,u,h,r;~(o=e.indexOf("random(",t));)h=e.indexOf(")",o),r=e.charAt(o+7)==="[",u=e.substr(o+7,h-o-7).match(r?EL:uw),i+=e.substr(t,o-t)+OL(r?u:+u[0],r?0:+u[1],+u[2]||1e-5),t=h+1;return i+e.substr(t,e.length-t)},HL=function(e,t,i,o,u){var h=t-e,r=o-i;return dh(u,function(p){return i+((p-e)/h*r||0)})},f6=function n(e,t,i,o){var u=isNaN(e+t)?0:function(E){return(1-E)*e+E*t};if(!u){var h=ps(e),r={},p,g,v,I,C;if(i===!0&&(o=1)&&(i=null),h)e={p:e},t={p:t};else if(zs(e)&&!zs(t)){for(v=[],I=e.length,C=I-2,g=1;g<I;g++)v.push(n(e[g-1],e[g]));I--,u=function(Q){Q*=I;var M=Math.min(C,~~Q);return v[M](Q-M)},i=t}else o||(e=Wd(zs(e)?[]:{},e));if(!v){for(p in t)Zb.call(r,e,p,"get",t[p]);u=function(Q){return iB(Q,r)||(h?e.p:e)}}}return dh(i,u)},DT=function(e,t,i){var o=e.labels,u=ca,h,r,p;for(h in o)r=o[h]-t,r<0==!!i&&r&&u>(r=Math.abs(r))&&(p=h,u=r);return p},ha=function(e,t,i){var o=e.vars,u=o[t],h=Hr,r=e._ctx,p,g,v;if(u)return p=o[t+"Params"],g=o.callbackScope||e,i&&Ju.length&&Bx(),r&&(Hr=r),v=p?u.apply(g,p):u.call(g),Hr=h,v},Km=function(e){return sh(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Ns),e.progress()<1&&ha(e,"onInterrupt"),e},Gp,p6=function(e){e=!e.name&&e.default||e;var t=e.name,i=br(e),o=t&&!i&&e.init?function(){this._props=[]}:e,u={init:j_,render:iB,add:Zb,kill:T6,modifier:M6,rawVars:0},h={targetTest:0,get:0,getSetter:tB,aliases:{},register:0};if(xA(),e!==o){if(Qo[t])return;va(o,va(Sx(e,u),h)),Wd(o.prototype,Wd(u,Sx(e,h))),Qo[o.prop=t]=o,e.targetTest&&($v.push(o),Kb[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}BL(t,o),e.register&&e.register(Uo,o,mo)},Jn=255,Jm={aqua:[0,Jn,Jn],lime:[0,Jn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Jn],navy:[0,0,128],white:[Jn,Jn,Jn],olive:[128,128,0],yellow:[Jn,Jn,0],orange:[Jn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Jn,0,0],pink:[Jn,192,203],cyan:[0,Jn,Jn],transparent:[Jn,Jn,Jn,0]},BC=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*Jn+.5|0},VL=function(e,t,i){var o=e?Rc(e)?[e>>16,e>>8&Jn,e&Jn]:0:Jm.black,u,h,r,p,g,v,I,C,E,Q;if(!o){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Jm[e])o=Jm[e];else if(e.charAt(0)==="#"){if(e.length<6&&(u=e.charAt(1),h=e.charAt(2),r=e.charAt(3),e="#"+u+u+h+h+r+r+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return o=parseInt(e.substr(1,6),16),[o>>16,o>>8&Jn,o&Jn,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),o=[e>>16,e>>8&Jn,e&Jn]}else if(e.substr(0,3)==="hsl"){if(o=Q=e.match(uw),!t)p=+o[0]%360/360,g=+o[1]/100,v=+o[2]/100,h=v<=.5?v*(g+1):v+g-v*g,u=v*2-h,o.length>3&&(o[3]*=1),o[0]=BC(p+1/3,u,h),o[1]=BC(p,u,h),o[2]=BC(p-1/3,u,h);else if(~e.indexOf("="))return o=e.match(IL),i&&o.length<4&&(o[3]=1),o}else o=e.match(uw)||Jm.transparent;o=o.map(Number)}return t&&!Q&&(u=o[0]/Jn,h=o[1]/Jn,r=o[2]/Jn,I=Math.max(u,h,r),C=Math.min(u,h,r),v=(I+C)/2,I===C?p=g=0:(E=I-C,g=v>.5?E/(2-I-C):E/(I+C),p=I===u?(h-r)/E+(h<r?6:0):I===h?(r-u)/E+2:(u-h)/E+4,p*=60),o[0]=~~(p+.5),o[1]=~~(g*100+.5),o[2]=~~(v*100+.5)),i&&o.length<4&&(o[3]=1),o},WL=function(e){var t=[],i=[],o=-1;return e.split(Xu).forEach(function(u){var h=u.match(Op)||[];t.push.apply(t,h),i.push(o+=h.length+1)}),t.c=i,t},QT=function(e,t,i){var o="",u=(e+o).match(Xu),h=t?"hsla(":"rgba(",r=0,p,g,v,I;if(!u)return e;if(u=u.map(function(C){return(C=VL(C,t,1))&&h+(t?C[0]+","+C[1]+"%,"+C[2]+"%,"+C[3]:C.join(","))+")"}),i&&(v=WL(e),p=i.c,p.join(o)!==v.c.join(o)))for(g=e.replace(Xu,"1").split(Op),I=g.length-1;r<I;r++)o+=g[r]+(~p.indexOf(r)?u.shift()||h+"0,0,0,0)":(v.length?v:u.length?u:i).shift());if(!g)for(g=e.split(Xu),I=g.length-1;r<I;r++)o+=g[r]+u[r];return o+g[I]},Xu=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Jm)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),A6=/hsl[a]?\(/,YL=function(e){var t=e.join(" "),i;if(Xu.lastIndex=0,Xu.test(t))return i=A6.test(t),e[1]=QT(e[1],i),e[0]=QT(e[0],i,WL(e[1])),!0},K_,Ro=function(){var n=Date.now,e=500,t=33,i=n(),o=i,u=1e3/240,h=u,r=[],p,g,v,I,C,E,Q=function M(D){var P=n()-o,O=D===!0,F,N,z,X;if(P>e&&(i+=P-t),o+=P,z=o-i,F=z-h,(F>0||O)&&(X=++I.frame,C=z-I.time*1e3,I.time=z=z/1e3,h+=F+(F>=u?4:u-F),N=1),O||(p=g(M)),N)for(E=0;E<r.length;E++)r[E](z,C,X,D)};return I={time:0,frame:0,tick:function(){Q(!0)},deltaRatio:function(D){return C/(1e3/(D||60))},wake:function(){wL&&(!hw&&vL()&&(ra=hw=window,jb=ra.document||{},zo.gsap=Uo,(ra.gsapVersions||(ra.gsapVersions=[])).push(Uo.version),bL(wx||ra.GreenSockGlobals||!ra.gsap&&ra||{}),v=ra.requestAnimationFrame),p&&I.sleep(),g=v||function(D){return setTimeout(D,h-I.time*1e3+1|0)},K_=1,Q(2))},sleep:function(){(v?ra.cancelAnimationFrame:clearTimeout)(p),K_=0,g=j_},lagSmoothing:function(D,P){e=D||1/0,t=Math.min(P||33,e)},fps:function(D){u=1e3/(D||240),h=I.time*1e3+u},add:function(D,P,O){var F=P?function(N,z,X,q){D(N,z,X,q),I.remove(F)}:D;return I.remove(D),r[O?"unshift":"push"](F),xA(),F},remove:function(D,P){~(P=r.indexOf(D))&&r.splice(P,1)&&E>=P&&E--},_listeners:r},I}(),xA=function(){return!K_&&Ro.wake()},xn={},g6=/^[\d.\-M][\d.\-,\s]/,m6=/["']/g,_6=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),o=i[0],u=1,h=i.length,r,p,g;u<h;u++)p=i[u],r=u!==h-1?p.lastIndexOf(","):p.length,g=p.substr(0,r),t[o]=isNaN(g)?g.replace(m6,"").trim():+g,o=p.substr(r+1).trim();return t},y6=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),o=e.indexOf("(",t);return e.substring(t,~o&&o<i?e.indexOf(")",i+1):i)},v6=function(e){var t=(e+"").split("("),i=xn[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[_6(t[1])]:y6(e).split(",").map(DL)):xn._CE&&g6.test(e)?xn._CE("",e):i},jL=function(e){return function(t){return 1-e(1-t)}},qL=function n(e,t){for(var i=e._first,o;i;)i instanceof fo?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(o=i._ease,i._ease=i._yEase,i._yEase=o,i._yoyo=t)),i=i._next},Pd=function(e,t){return e&&(br(e)?e:xn[e]||v6(e))||t},af=function(e,t,i,o){i===void 0&&(i=function(p){return 1-t(1-p)}),o===void 0&&(o=function(p){return p<.5?t(p*2)/2:1-t((1-p)*2)/2});var u={easeIn:t,easeOut:i,easeInOut:o},h;return go(e,function(r){xn[r]=zo[r]=u,xn[h=r.toLowerCase()]=i;for(var p in u)xn[h+(p==="easeIn"?".in":p==="easeOut"?".out":".inOut")]=xn[r+"."+p]=u[p]}),u},KL=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},SC=function n(e,t,i){var o=t>=1?t:1,u=(i||(e?.3:.45))/(t<1?t:1),h=u/cw*(Math.asin(1/o)||0),r=function(v){return v===1?1:o*Math.pow(2,-10*v)*jG((v-h)*u)+1},p=e==="out"?r:e==="in"?function(g){return 1-r(1-g)}:KL(r);return u=cw/u,p.config=function(g,v){return n(e,g,v)},p},MC=function n(e,t){t===void 0&&(t=1.70158);var i=function(h){return h?--h*h*((t+1)*h+t)+1:0},o=e==="out"?i:e==="in"?function(u){return 1-i(1-u)}:KL(i);return o.config=function(u){return n(e,u)},o};go("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;af(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});xn.Linear.easeNone=xn.none=xn.Linear.easeIn;af("Elastic",SC("in"),SC("out"),SC());(function(n,e){var t=1/e,i=2*t,o=2.5*t,u=function(r){return r<t?n*r*r:r<i?n*Math.pow(r-1.5/e,2)+.75:r<o?n*(r-=2.25/e)*r+.9375:n*Math.pow(r-2.625/e,2)+.984375};af("Bounce",function(h){return 1-u(1-h)},u)})(7.5625,2.75);af("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});af("Circ",function(n){return-(yL(1-n*n)-1)});af("Sine",function(n){return n===1?1:-YG(n*VG)+1});af("Back",MC("in"),MC("out"),MC());xn.SteppedEase=xn.steps=zo.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,o=e+(t?0:1),u=t?1:0,h=1-$n;return function(r){return((o*g0(0,h,r)|0)+u)*i}}};_A.ease=xn["quad.out"];go("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return Jb+=n+","+n+"Params,"});var JL=function(e,t){this.id=WG++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:ML,this.set=t?t.getSetter:tB},IA=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,vA(this,+t.duration,1,1),this.data=t.data,Hr&&(this._ctx=Hr,Hr.data.push(this)),K_||Ro.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,vA(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,o){if(xA(),!arguments.length)return this._tTime;var u=this._dp;if(u&&u.smoothChildTiming&&this._ts){for(p1(this,i),!u._dp||u.parent||LL(u,this);u&&u.parent;)u.parent._time!==u._start+(u._ts>=0?u._tTime/u._ts:(u.totalDuration()-u._tTime)/-u._ts)&&u.totalTime(u._tTime,!0),u=u.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&bl(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!o||this._initted&&Math.abs(this._zTime)===$n||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),TL(this,i,o)),this},e.time=function(i,o){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+MT(this))%(this._dur+this._rDelay)||(i?this._dur:0),o):this._time},e.totalProgress=function(i,o){return arguments.length?this.totalTime(this.totalDuration()*i,o):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,o){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+MT(this),o):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,o){var u=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*u,o):this._repeat?yA(this._tTime,u)+1:1},e.timeScale=function(i){if(!arguments.length)return this._rts===-$n?0:this._rts;if(this._rts===i)return this;var o=this.parent&&this._ts?Mx(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-$n?0:this._rts,this.totalTime(g0(-this._delay,this._tDur,o),!0),f1(this),e6(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(xA(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==$n&&(this._tTime-=$n)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var o=this.parent||this._dp;return o&&(o._sort||!this.parent)&&bl(o,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(Ao(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var o=this.parent||this._dp;return o?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Mx(o.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=JG);var o=Ns;return Ns=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),Ns=o,this},e.globalTime=function(i){for(var o=this,u=arguments.length?i:o.rawTime();o;)u=o._start+u/(o._ts||1),o=o._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(i):u},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,TT(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var o=this._time;return this._rDelay=i,TT(this),o?this.time(o):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,o){return this.totalTime(na(this,i),Ao(o))},e.restart=function(i,o){return this.play().totalTime(i?-this._delay:0,Ao(o))},e.play=function(i,o){return i!=null&&this.seek(i,o),this.reversed(!1).paused(!1)},e.reverse=function(i,o){return i!=null&&this.seek(i||this.totalDuration(),o),this.reversed(!0).paused(!1)},e.pause=function(i,o){return i!=null&&this.seek(i,o),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-$n:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-$n,this},e.isActive=function(){var i=this.parent||this._dp,o=this._start,u;return!!(!i||this._ts&&this._initted&&i.isActive()&&(u=i.rawTime(!0))>=o&&u<this.endTime(!0)-$n)},e.eventCallback=function(i,o,u){var h=this.vars;return arguments.length>1?(o?(h[i]=o,u&&(h[i+"Params"]=u),i==="onUpdate"&&(this._onUpdate=o)):delete h[i],this):h[i]},e.then=function(i){var o=this;return new Promise(function(u){var h=br(i)?i:QL,r=function(){var g=o.then;o.then=null,br(h)&&(h=h(o))&&(h.then||h===o)&&(o.then=g),u(h),o.then=g};o._initted&&o.totalProgress()===1&&o._ts>=0||!o._tTime&&o._ts<0?r():o._prom=r})},e.kill=function(){Km(this)},n}();va(IA.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-$n,_prom:0,_ps:!1,_rts:1});var fo=function(n){_L(e,n);function e(i,o){var u;return i===void 0&&(i={}),u=n.call(this,i)||this,u.labels={},u.smoothChildTiming=!!i.smoothChildTiming,u.autoRemoveChildren=!!i.autoRemoveChildren,u._sort=Ao(i.sortChildren),Ir&&bl(i.parent||Ir,pc(u),o),i.reversed&&u.reverse(),i.paused&&u.paused(!0),i.scrollTrigger&&PL(pc(u),i.scrollTrigger),u}var t=e.prototype;return t.to=function(o,u,h){return y_(0,arguments,this),this},t.from=function(o,u,h){return y_(1,arguments,this),this},t.fromTo=function(o,u,h,r){return y_(2,arguments,this),this},t.set=function(o,u,h){return u.duration=0,u.parent=this,__(u).repeatDelay||(u.repeat=0),u.immediateRender=!!u.immediateRender,new Xr(o,u,na(this,h),1),this},t.call=function(o,u,h){return bl(this,Xr.delayedCall(0,o,u),h)},t.staggerTo=function(o,u,h,r,p,g,v){return h.duration=u,h.stagger=h.stagger||r,h.onComplete=g,h.onCompleteParams=v,h.parent=this,new Xr(o,h,na(this,p)),this},t.staggerFrom=function(o,u,h,r,p,g,v){return h.runBackwards=1,__(h).immediateRender=Ao(h.immediateRender),this.staggerTo(o,u,h,r,p,g,v)},t.staggerFromTo=function(o,u,h,r,p,g,v,I){return r.startAt=h,__(r).immediateRender=Ao(r.immediateRender),this.staggerTo(o,u,r,p,g,v,I)},t.render=function(o,u,h){var r=this._time,p=this._dirty?this.totalDuration():this._tDur,g=this._dur,v=o<=0?0:vs(o),I=this._zTime<0!=o<0&&(this._initted||!g),C,E,Q,M,D,P,O,F,N,z,X,q;if(this!==Ir&&v>p&&o>=0&&(v=p),v!==this._tTime||h||I){if(r!==this._time&&g&&(v+=this._time-r,o+=this._time-r),C=v,N=this._start,F=this._ts,P=!F,I&&(g||(r=this._zTime),(o||!u)&&(this._zTime=o)),this._repeat){if(X=this._yoyo,D=g+this._rDelay,this._repeat<-1&&o<0)return this.totalTime(D*100+o,u,h);if(C=vs(v%D),v===p?(M=this._repeat,C=g):(M=~~(v/D),M&&M===v/D&&(C=g,M--),C>g&&(C=g)),z=yA(this._tTime,D),!r&&this._tTime&&z!==M&&(z=M),X&&M&1&&(C=g-C,q=1),M!==z&&!this._lock){var H=X&&z&1,W=H===(X&&M&1);if(M<z&&(H=!H),r=H?0:g,this._lock=1,this.render(r||(q?0:vs(M*D)),u,!g)._lock=0,this._tTime=v,!u&&this.parent&&ha(this,"onRepeat"),this.vars.repeatRefresh&&!q&&(this.invalidate()._lock=1),r&&r!==this._time||P!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,p=this._tDur,W&&(this._lock=2,r=H?g:-1e-4,this.render(r,!0),this.vars.repeatRefresh&&!q&&this.invalidate()),this._lock=0,!this._ts&&!P)return this;qL(this,q)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(O=r6(this,vs(r),vs(C)),O&&(v-=C-(C=O._start))),this._tTime=v,this._time=C,this._act=!F,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=o,r=0),!r&&C&&!u&&(ha(this,"onStart"),this._tTime!==v))return this;if(C>=r&&o>=0)for(E=this._first;E;){if(Q=E._next,(E._act||C>=E._start)&&E._ts&&O!==E){if(E.parent!==this)return this.render(o,u,h);if(E.render(E._ts>0?(C-E._start)*E._ts:(E._dirty?E.totalDuration():E._tDur)+(C-E._start)*E._ts,u,h),C!==this._time||!this._ts&&!P){O=0,Q&&(v+=this._zTime=-$n);break}}E=Q}else{E=this._last;for(var se=o<0?o:C;E;){if(Q=E._prev,(E._act||se<=E._end)&&E._ts&&O!==E){if(E.parent!==this)return this.render(o,u,h);if(E.render(E._ts>0?(se-E._start)*E._ts:(E._dirty?E.totalDuration():E._tDur)+(se-E._start)*E._ts,u,h||Ns&&(E._initted||E._startAt)),C!==this._time||!this._ts&&!P){O=0,Q&&(v+=this._zTime=se?-$n:$n);break}}E=Q}}if(O&&!u&&(this.pause(),O.render(C>=r?0:-$n)._zTime=C>=r?1:-1,this._ts))return this._start=N,f1(this),this.render(o,u,h);this._onUpdate&&!u&&ha(this,"onUpdate",!0),(v===p&&this._tTime>=this.totalDuration()||!v&&r)&&(N===this._start||Math.abs(F)!==Math.abs(this._ts))&&(this._lock||((o||!g)&&(v===p&&this._ts>0||!v&&this._ts<0)&&sh(this,1),!u&&!(o<0&&!r)&&(v||r||!p)&&(ha(this,v===p&&o>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<p&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(o,u){var h=this;if(Rc(u)||(u=na(this,u,o)),!(o instanceof IA)){if(zs(o))return o.forEach(function(r){return h.add(r,u)}),this;if(ps(o))return this.addLabel(o,u);if(br(o))o=Xr.delayedCall(0,o);else return this}return this!==o?bl(this,o,u):this},t.getChildren=function(o,u,h,r){o===void 0&&(o=!0),u===void 0&&(u=!0),h===void 0&&(h=!0),r===void 0&&(r=-ca);for(var p=[],g=this._first;g;)g._start>=r&&(g instanceof Xr?u&&p.push(g):(h&&p.push(g),o&&p.push.apply(p,g.getChildren(!0,u,h)))),g=g._next;return p},t.getById=function(o){for(var u=this.getChildren(1,1,1),h=u.length;h--;)if(u[h].vars.id===o)return u[h]},t.remove=function(o){return ps(o)?this.removeLabel(o):br(o)?this.killTweensOf(o):(d1(this,o),o===this._recent&&(this._recent=this._last),Ld(this))},t.totalTime=function(o,u){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=vs(Ro.time-(this._ts>0?o/this._ts:(this.totalDuration()-o)/-this._ts))),n.prototype.totalTime.call(this,o,u),this._forcing=0,this):this._tTime},t.addLabel=function(o,u){return this.labels[o]=na(this,u),this},t.removeLabel=function(o){return delete this.labels[o],this},t.addPause=function(o,u,h){var r=Xr.delayedCall(0,u||j_,h);return r.data="isPause",this._hasPause=1,bl(this,r,na(this,o))},t.removePause=function(o){var u=this._first;for(o=na(this,o);u;)u._start===o&&u.data==="isPause"&&sh(u),u=u._next},t.killTweensOf=function(o,u,h){for(var r=this.getTweensOf(o,h),p=r.length;p--;)Uu!==r[p]&&r[p].kill(o,u);return this},t.getTweensOf=function(o,u){for(var h=[],r=ua(o),p=this._first,g=Rc(u),v;p;)p instanceof Xr?XG(p._targets,r)&&(g?(!Uu||p._initted&&p._ts)&&p.globalTime(0)<=u&&p.globalTime(p.totalDuration())>u:!u||p.isActive())&&h.push(p):(v=p.getTweensOf(r,u)).length&&h.push.apply(h,v),p=p._next;return h},t.tweenTo=function(o,u){u=u||{};var h=this,r=na(h,o),p=u,g=p.startAt,v=p.onStart,I=p.onStartParams,C=p.immediateRender,E,Q=Xr.to(h,va({ease:u.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:u.duration||Math.abs((r-(g&&"time"in g?g.time:h._time))/h.timeScale())||$n,onStart:function(){if(h.pause(),!E){var D=u.duration||Math.abs((r-(g&&"time"in g?g.time:h._time))/h.timeScale());Q._dur!==D&&vA(Q,D,0,1).render(Q._time,!0,!0),E=1}v&&v.apply(Q,I||[])}},u));return C?Q.render(0):Q},t.tweenFromTo=function(o,u,h){return this.tweenTo(u,va({startAt:{time:na(this,o)}},h))},t.recent=function(){return this._recent},t.nextLabel=function(o){return o===void 0&&(o=this._time),DT(this,na(this,o))},t.previousLabel=function(o){return o===void 0&&(o=this._time),DT(this,na(this,o),1)},t.currentLabel=function(o){return arguments.length?this.seek(o,!0):this.previousLabel(this._time+$n)},t.shiftChildren=function(o,u,h){h===void 0&&(h=0);for(var r=this._first,p=this.labels,g;r;)r._start>=h&&(r._start+=o,r._end+=o),r=r._next;if(u)for(g in p)p[g]>=h&&(p[g]+=o);return Ld(this)},t.invalidate=function(o){var u=this._first;for(this._lock=0;u;)u.invalidate(o),u=u._next;return n.prototype.invalidate.call(this,o)},t.clear=function(o){o===void 0&&(o=!0);for(var u=this._first,h;u;)h=u._next,this.remove(u),u=h;return this._dp&&(this._time=this._tTime=this._pTime=0),o&&(this.labels={}),Ld(this)},t.totalDuration=function(o){var u=0,h=this,r=h._last,p=ca,g,v,I;if(arguments.length)return h.timeScale((h._repeat<0?h.duration():h.totalDuration())/(h.reversed()?-o:o));if(h._dirty){for(I=h.parent;r;)g=r._prev,r._dirty&&r.totalDuration(),v=r._start,v>p&&h._sort&&r._ts&&!h._lock?(h._lock=1,bl(h,r,v-r._delay,1)._lock=0):p=v,v<0&&r._ts&&(u-=v,(!I&&!h._dp||I&&I.smoothChildTiming)&&(h._start+=v/h._ts,h._time-=v,h._tTime-=v),h.shiftChildren(-v,!1,-1/0),p=0),r._end>u&&r._ts&&(u=r._end),r=g;vA(h,h===Ir&&h._time>u?h._time:u,1,1),h._dirty=0}return h._tDur},e.updateRoot=function(o){if(Ir._ts&&(TL(Ir,Mx(o,Ir)),SL=Ro.frame),Ro.frame>=BT){BT+=Fo.autoSleep||120;var u=Ir._first;if((!u||!u._ts)&&Fo.autoSleep&&Ro._listeners.length<2){for(;u&&!u._ts;)u=u._next;u||Ro.sleep()}}},e}(IA);va(fo.prototype,{_lock:0,_hasPause:0,_forcing:0});var x6=function(e,t,i,o,u,h,r){var p=new mo(this._pt,e,t,0,1,iP,null,u),g=0,v=0,I,C,E,Q,M,D,P,O;for(p.b=i,p.e=o,i+="",o+="",(P=~o.indexOf("random("))&&(o=q_(o)),h&&(O=[i,o],h(O,e,t),i=O[0],o=O[1]),C=i.match(wC)||[];I=wC.exec(o);)Q=I[0],M=o.substring(g,I.index),E?E=(E+1)%5:M.substr(-5)==="rgba("&&(E=1),Q!==C[v++]&&(D=parseFloat(C[v-1])||0,p._pt={_next:p._pt,p:M||v===1?M:",",s:D,c:Q.charAt(1)==="="?Xp(D,Q)-D:parseFloat(Q)-D,m:E&&E<4?Math.round:0},g=wC.lastIndex);return p.c=g<o.length?o.substring(g,o.length):"",p.fp=r,(CL.test(o)||P)&&(p.e=0),this._pt=p,p},Zb=function(e,t,i,o,u,h,r,p,g,v){br(o)&&(o=o(u||0,e,h));var I=e[t],C=i!=="get"?i:br(I)?g?e[t.indexOf("set")||!br(e["get"+t.substr(3)])?t:"get"+t.substr(3)](g):e[t]():I,E=br(I)?g?b6:eP:eB,Q;if(ps(o)&&(~o.indexOf("random(")&&(o=q_(o)),o.charAt(1)==="="&&(Q=Xp(C,o)+(ks(C)||0),(Q||Q===0)&&(o=Q))),!v||C!==o||_w)return!isNaN(C*o)&&o!==""?(Q=new mo(this._pt,e,t,+C||0,o-(C||0),typeof I=="boolean"?S6:tP,0,E),g&&(Q.fp=g),r&&Q.modifier(r,this,e),this._pt=Q):(!I&&!(t in e)&&qb(t,o),x6.call(this,e,t,C,o,E,p||Fo.stringFilter,g))},I6=function(e,t,i,o,u){if(br(e)&&(e=v_(e,u,t,i,o)),!Rl(e)||e.style&&e.nodeType||zs(e)||xL(e))return ps(e)?v_(e,u,t,i,o):e;var h={},r;for(r in e)h[r]=v_(e[r],u,t,i,o);return h},XL=function(e,t,i,o,u,h){var r,p,g,v;if(Qo[e]&&(r=new Qo[e]).init(u,r.rawVars?t[e]:I6(t[e],o,u,h,i),i,o,h)!==!1&&(i._pt=p=new mo(i._pt,u,e,0,1,r.render,r,0,r.priority),i!==Gp))for(g=i._ptLookup[i._targets.indexOf(u)],v=r._props.length;v--;)g[r._props[v]]=p;return r},Uu,_w,$b=function n(e,t,i){var o=e.vars,u=o.ease,h=o.startAt,r=o.immediateRender,p=o.lazy,g=o.onUpdate,v=o.onUpdateParams,I=o.callbackScope,C=o.runBackwards,E=o.yoyoEase,Q=o.keyframes,M=o.autoRevert,D=e._dur,P=e._startAt,O=e._targets,F=e.parent,N=F&&F.data==="nested"?F.vars.targets:O,z=e._overwrite==="auto"&&!Wb,X=e.timeline,q,H,W,se,de,te,ce,Ee,Be,De,Re,ye,ht;if(X&&(!Q||!u)&&(u="none"),e._ease=Pd(u,_A.ease),e._yEase=E?jL(Pd(E===!0?u:E,_A.ease)):0,E&&e._yoyo&&!e._repeat&&(E=e._yEase,e._yEase=e._ease,e._ease=E),e._from=!X&&!!o.runBackwards,!X||Q&&!o.stagger){if(Ee=O[0]?Rd(O[0]).harness:0,ye=Ee&&o[Ee.prop],q=Sx(o,Kb),P&&(P._zTime<0&&P.progress(1),t<0&&C&&r&&!M?P.render(-1,!0):P.revert(C&&D?Zv:KG),P._lazy=0),h){if(sh(e._startAt=Xr.set(O,va({data:"isStart",overwrite:!1,parent:F,immediateRender:!0,lazy:!P&&Ao(p),startAt:null,delay:0,onUpdate:g,onUpdateParams:v,callbackScope:I,stagger:0},h))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ns||!r&&!M)&&e._startAt.revert(Zv),r&&D&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(C&&D&&!P){if(t&&(r=!1),W=va({overwrite:!1,data:"isFromStart",lazy:r&&!P&&Ao(p),immediateRender:r,stagger:0,parent:F},q),ye&&(W[Ee.prop]=ye),sh(e._startAt=Xr.set(O,W)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ns?e._startAt.revert(Zv):e._startAt.render(-1,!0)),e._zTime=t,!r)n(e._startAt,$n,$n);else if(!t)return}for(e._pt=e._ptCache=0,p=D&&Ao(p)||p&&!D,H=0;H<O.length;H++){if(de=O[H],ce=de._gsap||Xb(O)[H]._gsap,e._ptLookup[H]=De={},dw[ce.id]&&Ju.length&&Bx(),Re=N===O?H:N.indexOf(de),Ee&&(Be=new Ee).init(de,ye||q,e,Re,N)!==!1&&(e._pt=se=new mo(e._pt,de,Be.name,0,1,Be.render,Be,0,Be.priority),Be._props.forEach(function(oe){De[oe]=se}),Be.priority&&(te=1)),!Ee||ye)for(W in q)Qo[W]&&(Be=XL(W,q,e,Re,de,N))?Be.priority&&(te=1):De[W]=se=Zb.call(e,de,W,"get",q[W],Re,N,0,o.stringFilter);e._op&&e._op[H]&&e.kill(de,e._op[H]),z&&e._pt&&(Uu=e,Ir.killTweensOf(de,De,e.globalTime(t)),ht=!e.parent,Uu=0),e._pt&&p&&(dw[ce.id]=1)}te&&nP(e),e._onInit&&e._onInit(e)}e._onUpdate=g,e._initted=(!e._op||e._pt)&&!ht,Q&&t<=0&&X.render(ca,!0,!0)},C6=function(e,t,i,o,u,h,r){var p=(e._pt&&e._ptCache||(e._ptCache={}))[t],g,v,I,C;if(!p)for(p=e._ptCache[t]=[],I=e._ptLookup,C=e._targets.length;C--;){if(g=I[C][t],g&&g.d&&g.d._pt)for(g=g.d._pt;g&&g.p!==t&&g.fp!==t;)g=g._next;if(!g)return _w=1,e.vars[t]="+=0",$b(e,r),_w=0,1;p.push(g)}for(C=p.length;C--;)v=p[C],g=v._pt||v,g.s=(o||o===0)&&!u?o:g.s+(o||0)+h*g.c,g.c=i-g.s,v.e&&(v.e=Qr(i)+ks(v.e)),v.b&&(v.b=g.s+ks(v.b))},E6=function(e,t){var i=e[0]?Rd(e[0]).harness:0,o=i&&i.aliases,u,h,r,p;if(!o)return t;u=Wd({},t);for(h in o)if(h in u)for(p=o[h].split(","),r=p.length;r--;)u[p[r]]=u[h];return u},w6=function(e,t,i,o){var u=t.ease||o||"power1.inOut",h,r;if(zs(t))r=i[e]||(i[e]=[]),t.forEach(function(p,g){return r.push({t:g/(t.length-1)*100,v:p,e:u})});else for(h in t)r=i[h]||(i[h]=[]),h==="ease"||r.push({t:parseFloat(e),v:t[h],e:u})},v_=function(e,t,i,o,u){return br(e)?e.call(t,i,o,u):ps(e)&&~e.indexOf("random(")?q_(e):e},ZL=Jb+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",$L={};go(ZL+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return $L[n]=1});var Xr=function(n){_L(e,n);function e(i,o,u,h){var r;typeof o=="number"&&(u.duration=o,o=u,u=null),r=n.call(this,h?o:__(o))||this;var p=r.vars,g=p.duration,v=p.delay,I=p.immediateRender,C=p.stagger,E=p.overwrite,Q=p.keyframes,M=p.defaults,D=p.scrollTrigger,P=p.yoyoEase,O=o.parent||Ir,F=(zs(i)||xL(i)?Rc(i[0]):"length"in o)?[i]:ua(i),N,z,X,q,H,W,se,de;if(r._targets=F.length?Xb(F):bx("GSAP target "+i+" not found. https://greensock.com",!Fo.nullTargetWarn)||[],r._ptLookup=[],r._overwrite=E,Q||C||Xy(g)||Xy(v)){if(o=r.vars,N=r.timeline=new fo({data:"nested",defaults:M||{},targets:O&&O.data==="nested"?O.vars.targets:F}),N.kill(),N.parent=N._dp=pc(r),N._start=0,C||Xy(g)||Xy(v)){if(q=F.length,se=C&&zL(C),Rl(C))for(H in C)~ZL.indexOf(H)&&(de||(de={}),de[H]=C[H]);for(z=0;z<q;z++)X=Sx(o,$L),X.stagger=0,P&&(X.yoyoEase=P),de&&Wd(X,de),W=F[z],X.duration=+v_(g,pc(r),z,W,F),X.delay=(+v_(v,pc(r),z,W,F)||0)-r._delay,!C&&q===1&&X.delay&&(r._delay=v=X.delay,r._start+=v,X.delay=0),N.to(W,X,se?se(z,W,F):0),N._ease=xn.none;N.duration()?g=v=0:r.timeline=0}else if(Q){__(va(N.vars.defaults,{ease:"none"})),N._ease=Pd(Q.ease||o.ease||"none");var te=0,ce,Ee,Be;if(zs(Q))Q.forEach(function(De){return N.to(F,De,">")}),N.duration();else{X={};for(H in Q)H==="ease"||H==="easeEach"||w6(H,Q[H],X,Q.easeEach);for(H in X)for(ce=X[H].sort(function(De,Re){return De.t-Re.t}),te=0,z=0;z<ce.length;z++)Ee=ce[z],Be={ease:Ee.e,duration:(Ee.t-(z?ce[z-1].t:0))/100*g},Be[H]=Ee.v,N.to(F,Be,te),te+=Be.duration;N.duration()<g&&N.to({},{duration:g-N.duration()})}}g||r.duration(g=N.duration())}else r.timeline=0;return E===!0&&!Wb&&(Uu=pc(r),Ir.killTweensOf(F),Uu=0),bl(O,pc(r),u),o.reversed&&r.reverse(),o.paused&&r.paused(!0),(I||!g&&!Q&&r._start===vs(O._time)&&Ao(I)&&t6(pc(r))&&O.data!=="nested")&&(r._tTime=-$n,r.render(Math.max(0,-v)||0)),D&&PL(pc(r),D),r}var t=e.prototype;return t.render=function(o,u,h){var r=this._time,p=this._tDur,g=this._dur,v=o<0,I=o>p-$n&&!v?p:o<$n?0:o,C,E,Q,M,D,P,O,F,N;if(!g)n6(this,o,u,h);else if(I!==this._tTime||!o||h||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==v){if(C=I,F=this.timeline,this._repeat){if(M=g+this._rDelay,this._repeat<-1&&v)return this.totalTime(M*100+o,u,h);if(C=vs(I%M),I===p?(Q=this._repeat,C=g):(Q=~~(I/M),Q&&Q===I/M&&(C=g,Q--),C>g&&(C=g)),P=this._yoyo&&Q&1,P&&(N=this._yEase,C=g-C),D=yA(this._tTime,M),C===r&&!h&&this._initted)return this._tTime=I,this;Q!==D&&(F&&this._yEase&&qL(F,P),this.vars.repeatRefresh&&!P&&!this._lock&&(this._lock=h=1,this.render(vs(M*Q),!0).invalidate()._lock=0))}if(!this._initted){if(kL(this,v?o:C,h,u,I))return this._tTime=0,this;if(r!==this._time)return this;if(g!==this._dur)return this.render(o,u,h)}if(this._tTime=I,this._time=C,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=O=(N||this._ease)(C/g),this._from&&(this.ratio=O=1-O),C&&!r&&!u&&(ha(this,"onStart"),this._tTime!==I))return this;for(E=this._pt;E;)E.r(O,E.d),E=E._next;F&&F.render(o<0?o:!C&&P?-$n:F._dur*F._ease(C/this._dur),u,h)||this._startAt&&(this._zTime=o),this._onUpdate&&!u&&(v&&fw(this,o,u,h),ha(this,"onUpdate")),this._repeat&&Q!==D&&this.vars.onRepeat&&!u&&this.parent&&ha(this,"onRepeat"),(I===this._tDur||!I)&&this._tTime===I&&(v&&!this._onUpdate&&fw(this,o,!0,!0),(o||!g)&&(I===this._tDur&&this._ts>0||!I&&this._ts<0)&&sh(this,1),!u&&!(v&&!r)&&(I||r||P)&&(ha(this,I===p?"onComplete":"onReverseComplete",!0),this._prom&&!(I<p&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(o){return(!o||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(o),n.prototype.invalidate.call(this,o)},t.resetTo=function(o,u,h,r){K_||Ro.wake(),this._ts||this.play();var p=Math.min(this._dur,(this._dp._time-this._start)*this._ts),g;return this._initted||$b(this,p),g=this._ease(p/this._dur),C6(this,o,u,h,r,g,p)?this.resetTo(o,u,h,r):(p1(this,0),this.parent||RL(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(o,u){if(u===void 0&&(u="all"),!o&&(!u||u==="all"))return this._lazy=this._pt=0,this.parent?Km(this):this;if(this.timeline){var h=this.timeline.totalDuration();return this.timeline.killTweensOf(o,u,Uu&&Uu.vars.overwrite!==!0)._first||Km(this),this.parent&&h!==this.timeline.totalDuration()&&vA(this,this._dur*this.timeline._tDur/h,0,1),this}var r=this._targets,p=o?ua(o):r,g=this._ptLookup,v=this._pt,I,C,E,Q,M,D,P;if((!u||u==="all")&&$G(r,p))return u==="all"&&(this._pt=0),Km(this);for(I=this._op=this._op||[],u!=="all"&&(ps(u)&&(M={},go(u,function(O){return M[O]=1}),u=M),u=E6(r,u)),P=r.length;P--;)if(~p.indexOf(r[P])){C=g[P],u==="all"?(I[P]=u,Q=C,E={}):(E=I[P]=I[P]||{},Q=u);for(M in Q)D=C&&C[M],D&&((!("kill"in D.d)||D.d.kill(M)===!0)&&d1(this,D,"_pt"),delete C[M]),E!=="all"&&(E[M]=1)}return this._initted&&!this._pt&&v&&Km(this),this},e.to=function(o,u){return new e(o,u,arguments[2])},e.from=function(o,u){return y_(1,arguments)},e.delayedCall=function(o,u,h,r){return new e(u,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:o,onComplete:u,onReverseComplete:u,onCompleteParams:h,onReverseCompleteParams:h,callbackScope:r})},e.fromTo=function(o,u,h){return y_(2,arguments)},e.set=function(o,u){return u.duration=0,u.repeatDelay||(u.repeat=0),new e(o,u)},e.killTweensOf=function(o,u,h){return Ir.killTweensOf(o,u,h)},e}(IA);va(Xr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});go("staggerTo,staggerFrom,staggerFromTo",function(n){Xr[n]=function(){var e=new fo,t=Aw.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var eB=function(e,t,i){return e[t]=i},eP=function(e,t,i){return e[t](i)},b6=function(e,t,i,o){return e[t](o.fp,i)},B6=function(e,t,i){return e.setAttribute(t,i)},tB=function(e,t){return br(e[t])?eP:Yb(e[t])&&e.setAttribute?B6:eB},tP=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},S6=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},iP=function(e,t){var i=t._pt,o="";if(!e&&t.b)o=t.b;else if(e===1&&t.e)o=t.e;else{for(;i;)o=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+o,i=i._next;o+=t.c}t.set(t.t,t.p,o,t)},iB=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},M6=function(e,t,i,o){for(var u=this._pt,h;u;)h=u._next,u.p===o&&u.modifier(e,t,i),u=h},T6=function(e){for(var t=this._pt,i,o;t;)o=t._next,t.p===e&&!t.op||t.op===e?d1(this,t,"_pt"):t.dep||(i=1),t=o;return!i},D6=function(e,t,i,o){o.mSet(e,t,o.m.call(o.tween,i,o.mt),o)},nP=function(e){for(var t=e._pt,i,o,u,h;t;){for(i=t._next,o=u;o&&o.pr>t.pr;)o=o._next;(t._prev=o?o._prev:h)?t._prev._next=t:u=t,(t._next=o)?o._prev=t:h=t,t=i}e._pt=u},mo=function(){function n(t,i,o,u,h,r,p,g,v){this.t=i,this.s=u,this.c=h,this.p=o,this.r=r||tP,this.d=p||this,this.set=g||eB,this.pr=v||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,o,u){this.mSet=this.mSet||this.set,this.set=D6,this.m=i,this.mt=u,this.tween=o},n}();go(Jb+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return Kb[n]=1});zo.TweenMax=zo.TweenLite=Xr;zo.TimelineLite=zo.TimelineMax=fo;Ir=new fo({sortChildren:!1,defaults:_A,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Fo.stringFilter=YL;var CA=[],ex={},Q6=[],RT=0,TC=function(e){return(ex[e]||Q6).map(function(t){return t()})},yw=function(){var e=Date.now(),t=[];e-RT>2&&(TC("matchMediaInit"),CA.forEach(function(i){var o=i.queries,u=i.conditions,h,r,p,g;for(r in o)h=ra.matchMedia(o[r]).matches,h&&(p=1),h!==u[r]&&(u[r]=h,g=1);g&&(i.revert(),p&&t.push(i))}),TC("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i)}),RT=e,TC("matchMedia"))},rP=function(){function n(t,i){this.selector=i&&gw(i),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=n.prototype;return e.add=function(i,o,u){br(i)&&(u=o,o=i,i=br);var h=this,r=function(){var g=Hr,v=h.selector,I;return g&&g!==h&&g.data.push(h),u&&(h.selector=gw(u)),Hr=h,I=o.apply(h,arguments),br(I)&&h._r.push(I),Hr=g,h.selector=v,h.isReverted=!1,I};return h.last=r,i===br?r(h):i?h[i]=r:r},e.ignore=function(i){var o=Hr;Hr=null,i(this),Hr=o},e.getTweens=function(){var i=[];return this.data.forEach(function(o){return o instanceof n?i.push.apply(i,o.getTweens()):o instanceof Xr&&!(o.parent&&o.parent.data==="nested")&&i.push(o)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,o){var u=this;if(i){var h=this.getTweens();this.data.forEach(function(p){p.data==="isFlip"&&(p.revert(),p.getChildren(!0,!0,!1).forEach(function(g){return h.splice(h.indexOf(g),1)}))}),h.map(function(p){return{g:p.globalTime(0),t:p}}).sort(function(p,g){return g.g-p.g||-1}).forEach(function(p){return p.t.revert(i)}),this.data.forEach(function(p){return!(p instanceof IA)&&p.revert&&p.revert(i)}),this._r.forEach(function(p){return p(i,u)}),this.isReverted=!0}else this.data.forEach(function(p){return p.kill&&p.kill()});if(this.clear(),o){var r=CA.indexOf(this);~r&&CA.splice(r,1)}},e.revert=function(i){this.kill(i||{})},n}(),R6=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,o,u){Rl(i)||(i={matches:i});var h=new rP(0,u||this.scope),r=h.conditions={},p,g,v;this.contexts.push(h),o=h.add("onMatch",o),h.queries=i;for(g in i)g==="all"?v=1:(p=ra.matchMedia(i[g]),p&&(CA.indexOf(h)<0&&CA.push(h),(r[g]=p.matches)&&(v=1),p.addListener?p.addListener(yw):p.addEventListener("change",yw)));return v&&o(h),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(o){return o.kill(i,!0)})},n}(),Tx={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(o){return p6(o)})},timeline:function(e){return new fo(e)},getTweensOf:function(e,t){return Ir.getTweensOf(e,t)},getProperty:function(e,t,i,o){ps(e)&&(e=ua(e)[0]);var u=Rd(e||{}).get,h=i?QL:DL;return i==="native"&&(i=""),e&&(t?h((Qo[t]&&Qo[t].get||u)(e,t,i,o)):function(r,p,g){return h((Qo[r]&&Qo[r].get||u)(e,r,p,g))})},quickSetter:function(e,t,i){if(e=ua(e),e.length>1){var o=e.map(function(v){return Uo.quickSetter(v,t,i)}),u=o.length;return function(v){for(var I=u;I--;)o[I](v)}}e=e[0]||{};var h=Qo[t],r=Rd(e),p=r.harness&&(r.harness.aliases||{})[t]||t,g=h?function(v){var I=new h;Gp._pt=0,I.init(e,i?v+i:v,Gp,0,[e]),I.render(1,I),Gp._pt&&iB(1,Gp)}:r.set(e,p);return h?g:function(v){return g(e,p,i?v+i:v,r,1)}},quickTo:function(e,t,i){var o,u=Uo.to(e,Wd((o={},o[t]="+=0.1",o.paused=!0,o),i||{})),h=function(p,g,v){return u.resetTo(t,p,g,v)};return h.tween=u,h},isTweening:function(e){return Ir.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Pd(e.ease,_A.ease)),ST(_A,e||{})},config:function(e){return ST(Fo,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,o=e.plugins,u=e.defaults,h=e.extendTimeline;(o||"").split(",").forEach(function(r){return r&&!Qo[r]&&!zo[r]&&bx(t+" effect requires "+r+" plugin.")}),bC[t]=function(r,p,g){return i(ua(r),va(p||{},u),g)},h&&(fo.prototype[t]=function(r,p,g){return this.add(bC[t](r,Rl(p)?p:(g=p)&&{},this),g)})},registerEase:function(e,t){xn[e]=Pd(t)},parseEase:function(e,t){return arguments.length?Pd(e,t):xn},getById:function(e){return Ir.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new fo(e),o,u;for(i.smoothChildTiming=Ao(e.smoothChildTiming),Ir.remove(i),i._dp=0,i._time=i._tTime=Ir._time,o=Ir._first;o;)u=o._next,(t||!(!o._dur&&o instanceof Xr&&o.vars.onComplete===o._targets[0]))&&bl(i,o,o._start-o._delay),o=u;return bl(Ir,i,0),i},context:function(e,t){return e?new rP(e,t):Hr},matchMedia:function(e){return new R6(e)},matchMediaRefresh:function(){return CA.forEach(function(e){var t=e.conditions,i,o;for(o in t)t[o]&&(t[o]=!1,i=1);i&&e.revert()})||yw()},addEventListener:function(e,t){var i=ex[e]||(ex[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=ex[e],o=i&&i.indexOf(t);o>=0&&i.splice(o,1)},utils:{wrap:h6,wrapYoyo:d6,distribute:zL,random:OL,snap:UL,normalize:u6,getUnit:ks,clamp:o6,splitColor:VL,toArray:ua,selector:gw,mapRange:HL,pipe:l6,unitize:c6,interpolate:f6,shuffle:NL},install:bL,effects:bC,ticker:Ro,updateRoot:fo.updateRoot,plugins:Qo,globalTimeline:Ir,core:{PropTween:mo,globals:BL,Tween:Xr,Timeline:fo,Animation:IA,getCache:Rd,_removeLinkedListItem:d1,reverting:function(){return Ns},context:function(e){return e&&Hr&&(Hr.data.push(e),e._ctx=Hr),Hr},suppressOverwrites:function(e){return Wb=e}}};go("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return Tx[n]=Xr[n]});Ro.add(fo.updateRoot);Gp=Tx.to({},{duration:0});var L6=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},P6=function(e,t){var i=e._targets,o,u,h;for(o in t)for(u=i.length;u--;)h=e._ptLookup[u][o],h&&(h=h.d)&&(h._pt&&(h=L6(h,o)),h&&h.modifier&&h.modifier(t[o],e,i[u],o))},DC=function(e,t){return{name:e,rawVars:1,init:function(o,u,h){h._onInit=function(r){var p,g;if(ps(u)&&(p={},go(u,function(v){return p[v]=1}),u=p),t){p={};for(g in u)p[g]=t(u[g]);u=p}P6(r,u)}}}},Uo=Tx.registerPlugin({name:"attr",init:function(e,t,i,o,u){var h,r,p;this.tween=i;for(h in t)p=e.getAttribute(h)||"",r=this.add(e,"setAttribute",(p||0)+"",t[h],o,u,0,0,h),r.op=h,r.b=p,this._props.push(h)},render:function(e,t){for(var i=t._pt;i;)Ns?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},DC("roundProps",mw),DC("modifiers"),DC("snap",UL))||Tx;Xr.version=fo.version=Uo.version="3.11.4";wL=1;vL()&&xA();xn.Power0;xn.Power1;xn.Power2;xn.Power3;xn.Power4;xn.Linear;xn.Quad;xn.Cubic;xn.Quart;xn.Quint;xn.Strong;xn.Elastic;xn.Back;xn.SteppedEase;xn.Bounce;xn.Sine;xn.Expo;xn.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var LT,Ou,Zp,nB,wd,PT,rB,k6=function(){return typeof window<"u"},Lc={},pd=180/Math.PI,$p=Math.PI/180,up=Math.atan2,kT=1e8,sB=/([A-Z])/g,F6=/(left|right|width|margin|padding|x)/i,N6=/[\s,\(]\S/,vc={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},vw=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},z6=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},U6=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},O6=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},sP=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},oP=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},G6=function(e,t,i){return e.style[t]=i},H6=function(e,t,i){return e.style.setProperty(t,i)},V6=function(e,t,i){return e._gsap[t]=i},W6=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Y6=function(e,t,i,o,u){var h=e._gsap;h.scaleX=h.scaleY=i,h.renderTransform(u,h)},j6=function(e,t,i,o,u){var h=e._gsap;h[t]=i,h.renderTransform(u,h)},Cr="transform",el=Cr+"Origin",q6=function(e,t){var i=this,o=this.target,u=o.style;if(e in Lc){if(this.tfm=this.tfm||{},e!=="transform"&&(e=vc[e]||e,~e.indexOf(",")?e.split(",").forEach(function(h){return i.tfm[h]=Ac(o,h)}):this.tfm[e]=o._gsap.x?o._gsap[e]:Ac(o,e)),this.props.indexOf(Cr)>=0)return;o._gsap.svg&&(this.svgo=o.getAttribute("data-svg-origin"),this.props.push(el,t,"")),e=Cr}(u||t)&&this.props.push(e,t,u[e])},aP=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},K6=function(){var e=this.props,t=this.target,i=t.style,o=t._gsap,u,h;for(u=0;u<e.length;u+=3)e[u+1]?t[e[u]]=e[u+2]:e[u+2]?i[e[u]]=e[u+2]:i.removeProperty(e[u].replace(sB,"-$1").toLowerCase());if(this.tfm){for(h in this.tfm)o[h]=this.tfm[h];o.svg&&(o.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),u=rB(),u&&!u.isStart&&!i[Cr]&&(aP(i),o.uncache=1)}},lP=function(e,t){var i={target:e,props:[],revert:K6,save:q6};return t&&t.split(",").forEach(function(o){return i.save(o)}),i},cP,xw=function(e,t){var i=Ou.createElementNS?Ou.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ou.createElement(e);return i.style?i:Ou.createElement(e)},Ml=function n(e,t,i){var o=getComputedStyle(e);return o[t]||o.getPropertyValue(t.replace(sB,"-$1").toLowerCase())||o.getPropertyValue(t)||!i&&n(e,EA(t)||t,1)||""},FT="O,Moz,ms,Ms,Webkit".split(","),EA=function(e,t,i){var o=t||wd,u=o.style,h=5;if(e in u&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);h--&&!(FT[h]+e in u););return h<0?null:(h===3?"ms":h>=0?FT[h]:"")+e},Iw=function(){k6()&&window.document&&(LT=window,Ou=LT.document,Zp=Ou.documentElement,wd=xw("div")||{style:{}},xw("div"),Cr=EA(Cr),el=Cr+"Origin",wd.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",cP=!!EA("perspective"),rB=Uo.core.reverting,nB=1)},QC=function n(e){var t=xw("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,u=this.style.cssText,h;if(Zp.appendChild(t),t.appendChild(this),this.style.display="block",e)try{h=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(h=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),Zp.removeChild(t),this.style.cssText=u,h},NT=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},uP=function(e){var t;try{t=e.getBBox()}catch{t=QC.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===QC||(t=QC.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+NT(e,["x","cx","x1"])||0,y:+NT(e,["y","cy","y1"])||0,width:0,height:0}:t},hP=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&uP(e))},J_=function(e,t){if(t){var i=e.style;t in Lc&&t!==el&&(t=Cr),i.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(t.replace(sB,"-$1").toLowerCase())):i.removeAttribute(t)}},Gu=function(e,t,i,o,u,h){var r=new mo(e._pt,t,i,0,1,h?oP:sP);return e._pt=r,r.b=o,r.e=u,e._props.push(i),r},zT={deg:1,rad:1,turn:1},J6={grid:1,flex:1},oh=function n(e,t,i,o){var u=parseFloat(i)||0,h=(i+"").trim().substr((u+"").length)||"px",r=wd.style,p=F6.test(t),g=e.tagName.toLowerCase()==="svg",v=(g?"client":"offset")+(p?"Width":"Height"),I=100,C=o==="px",E=o==="%",Q,M,D,P;return o===h||!u||zT[o]||zT[h]?u:(h!=="px"&&!C&&(u=n(e,t,i,"px")),P=e.getCTM&&hP(e),(E||h==="%")&&(Lc[t]||~t.indexOf("adius"))?(Q=P?e.getBBox()[p?"width":"height"]:e[v],Qr(E?u/Q*I:u/100*Q)):(r[p?"width":"height"]=I+(C?h:o),M=~t.indexOf("adius")||o==="em"&&e.appendChild&&!g?e:e.parentNode,P&&(M=(e.ownerSVGElement||{}).parentNode),(!M||M===Ou||!M.appendChild)&&(M=Ou.body),D=M._gsap,D&&E&&D.width&&p&&D.time===Ro.time&&!D.uncache?Qr(u/D.width*I):((E||h==="%")&&!J6[Ml(M,"display")]&&(r.position=Ml(e,"position")),M===e&&(r.position="static"),M.appendChild(wd),Q=wd[v],M.removeChild(wd),r.position="absolute",p&&E&&(D=Rd(M),D.time=Ro.time,D.width=M[v]),Qr(C?Q*u/I:Q&&u?I/Q*u:0))))},Ac=function(e,t,i,o){var u;return nB||Iw(),t in vc&&t!=="transform"&&(t=vc[t],~t.indexOf(",")&&(t=t.split(",")[0])),Lc[t]&&t!=="transform"?(u=Z_(e,o),u=t!=="transformOrigin"?u[t]:u.svg?u.origin:Qx(Ml(e,el))+" "+u.zOrigin+"px"):(u=e.style[t],(!u||u==="auto"||o||~(u+"").indexOf("calc("))&&(u=Dx[t]&&Dx[t](e,t,i)||Ml(e,t)||ML(e,t)||(t==="opacity"?1:0))),i&&!~(u+"").trim().indexOf(" ")?oh(e,t,u,i)+i:u},X6=function(e,t,i,o){if(!i||i==="none"){var u=EA(t,e,1),h=u&&Ml(e,u,1);h&&h!==i?(t=u,i=h):t==="borderColor"&&(i=Ml(e,"borderTopColor"))}var r=new mo(this._pt,e.style,t,0,1,iP),p=0,g=0,v,I,C,E,Q,M,D,P,O,F,N,z;if(r.b=i,r.e=o,i+="",o+="",o==="auto"&&(e.style[t]=o,o=Ml(e,t)||o,e.style[t]=i),v=[i,o],YL(v),i=v[0],o=v[1],C=i.match(Op)||[],z=o.match(Op)||[],z.length){for(;I=Op.exec(o);)D=I[0],O=o.substring(p,I.index),Q?Q=(Q+1)%5:(O.substr(-5)==="rgba("||O.substr(-5)==="hsla(")&&(Q=1),D!==(M=C[g++]||"")&&(E=parseFloat(M)||0,N=M.substr((E+"").length),D.charAt(1)==="="&&(D=Xp(E,D)+N),P=parseFloat(D),F=D.substr((P+"").length),p=Op.lastIndex-F.length,F||(F=F||Fo.units[t]||N,p===o.length&&(o+=F,r.e+=F)),N!==F&&(E=oh(e,t,M,F)||0),r._pt={_next:r._pt,p:O||g===1?O:",",s:E,c:P-E,m:Q&&Q<4||t==="zIndex"?Math.round:0});r.c=p<o.length?o.substring(p,o.length):""}else r.r=t==="display"&&o==="none"?oP:sP;return CL.test(o)&&(r.e=0),this._pt=r,r},UT={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Z6=function(e){var t=e.split(" "),i=t[0],o=t[1]||"50%";return(i==="top"||i==="bottom"||o==="left"||o==="right")&&(e=i,i=o,o=e),t[0]=UT[i]||i,t[1]=UT[o]||o,t.join(" ")},$6=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,o=i.style,u=t.u,h=i._gsap,r,p,g;if(u==="all"||u===!0)o.cssText="",p=1;else for(u=u.split(","),g=u.length;--g>-1;)r=u[g],Lc[r]&&(p=1,r=r==="transformOrigin"?el:Cr),J_(i,r);p&&(J_(i,Cr),h&&(h.svg&&i.removeAttribute("transform"),Z_(i,1),h.uncache=1,aP(o)))}},Dx={clearProps:function(e,t,i,o,u){if(u.data!=="isFromStart"){var h=e._pt=new mo(e._pt,t,i,0,0,$6);return h.u=o,h.pr=-10,h.tween=u,e._props.push(i),1}}},X_=[1,0,0,1,0,0],dP={},fP=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},OT=function(e){var t=Ml(e,Cr);return fP(t)?X_:t.substr(7).match(IL).map(Qr)},oB=function(e,t){var i=e._gsap||Rd(e),o=e.style,u=OT(e),h,r,p,g;return i.svg&&e.getAttribute("transform")?(p=e.transform.baseVal.consolidate().matrix,u=[p.a,p.b,p.c,p.d,p.e,p.f],u.join(",")==="1,0,0,1,0,0"?X_:u):(u===X_&&!e.offsetParent&&e!==Zp&&!i.svg&&(p=o.display,o.display="block",h=e.parentNode,(!h||!e.offsetParent)&&(g=1,r=e.nextElementSibling,Zp.appendChild(e)),u=OT(e),p?o.display=p:J_(e,"display"),g&&(r?h.insertBefore(e,r):h?h.appendChild(e):Zp.removeChild(e))),t&&u.length>6?[u[0],u[1],u[4],u[5],u[12],u[13]]:u)},Cw=function(e,t,i,o,u,h){var r=e._gsap,p=u||oB(e,!0),g=r.xOrigin||0,v=r.yOrigin||0,I=r.xOffset||0,C=r.yOffset||0,E=p[0],Q=p[1],M=p[2],D=p[3],P=p[4],O=p[5],F=t.split(" "),N=parseFloat(F[0])||0,z=parseFloat(F[1])||0,X,q,H,W;i?p!==X_&&(q=E*D-Q*M)&&(H=N*(D/q)+z*(-M/q)+(M*O-D*P)/q,W=N*(-Q/q)+z*(E/q)-(E*O-Q*P)/q,N=H,z=W):(X=uP(e),N=X.x+(~F[0].indexOf("%")?N/100*X.width:N),z=X.y+(~(F[1]||F[0]).indexOf("%")?z/100*X.height:z)),o||o!==!1&&r.smooth?(P=N-g,O=z-v,r.xOffset=I+(P*E+O*M)-P,r.yOffset=C+(P*Q+O*D)-O):r.xOffset=r.yOffset=0,r.xOrigin=N,r.yOrigin=z,r.smooth=!!o,r.origin=t,r.originIsAbsolute=!!i,e.style[el]="0px 0px",h&&(Gu(h,r,"xOrigin",g,N),Gu(h,r,"yOrigin",v,z),Gu(h,r,"xOffset",I,r.xOffset),Gu(h,r,"yOffset",C,r.yOffset)),e.setAttribute("data-svg-origin",N+" "+z)},Z_=function(e,t){var i=e._gsap||new JL(e);if("x"in i&&!t&&!i.uncache)return i;var o=e.style,u=i.scaleX<0,h="px",r="deg",p=getComputedStyle(e),g=Ml(e,el)||"0",v,I,C,E,Q,M,D,P,O,F,N,z,X,q,H,W,se,de,te,ce,Ee,Be,De,Re,ye,ht,oe,Tt,Fe,st,Et,Ke;return v=I=C=M=D=P=O=F=N=0,E=Q=1,i.svg=!!(e.getCTM&&hP(e)),p.translate&&((p.translate!=="none"||p.scale!=="none"||p.rotate!=="none")&&(o[Cr]=(p.translate!=="none"?"translate3d("+(p.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(p.rotate!=="none"?"rotate("+p.rotate+") ":"")+(p.scale!=="none"?"scale("+p.scale.split(" ").join(",")+") ":"")+(p[Cr]!=="none"?p[Cr]:"")),o.scale=o.rotate=o.translate="none"),q=oB(e,i.svg),i.svg&&(i.uncache?(ye=e.getBBox(),g=i.xOrigin-ye.x+"px "+(i.yOrigin-ye.y)+"px",Re=""):Re=!t&&e.getAttribute("data-svg-origin"),Cw(e,Re||g,!!Re||i.originIsAbsolute,i.smooth!==!1,q)),z=i.xOrigin||0,X=i.yOrigin||0,q!==X_&&(de=q[0],te=q[1],ce=q[2],Ee=q[3],v=Be=q[4],I=De=q[5],q.length===6?(E=Math.sqrt(de*de+te*te),Q=Math.sqrt(Ee*Ee+ce*ce),M=de||te?up(te,de)*pd:0,O=ce||Ee?up(ce,Ee)*pd+M:0,O&&(Q*=Math.abs(Math.cos(O*$p))),i.svg&&(v-=z-(z*de+X*ce),I-=X-(z*te+X*Ee))):(Ke=q[6],st=q[7],oe=q[8],Tt=q[9],Fe=q[10],Et=q[11],v=q[12],I=q[13],C=q[14],H=up(Ke,Fe),D=H*pd,H&&(W=Math.cos(-H),se=Math.sin(-H),Re=Be*W+oe*se,ye=De*W+Tt*se,ht=Ke*W+Fe*se,oe=Be*-se+oe*W,Tt=De*-se+Tt*W,Fe=Ke*-se+Fe*W,Et=st*-se+Et*W,Be=Re,De=ye,Ke=ht),H=up(-ce,Fe),P=H*pd,H&&(W=Math.cos(-H),se=Math.sin(-H),Re=de*W-oe*se,ye=te*W-Tt*se,ht=ce*W-Fe*se,Et=Ee*se+Et*W,de=Re,te=ye,ce=ht),H=up(te,de),M=H*pd,H&&(W=Math.cos(H),se=Math.sin(H),Re=de*W+te*se,ye=Be*W+De*se,te=te*W-de*se,De=De*W-Be*se,de=Re,Be=ye),D&&Math.abs(D)+Math.abs(M)>359.9&&(D=M=0,P=180-P),E=Qr(Math.sqrt(de*de+te*te+ce*ce)),Q=Qr(Math.sqrt(De*De+Ke*Ke)),H=up(Be,De),O=Math.abs(H)>2e-4?H*pd:0,N=Et?1/(Et<0?-Et:Et):0),i.svg&&(Re=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!fP(Ml(e,Cr)),Re&&e.setAttribute("transform",Re))),Math.abs(O)>90&&Math.abs(O)<270&&(u?(E*=-1,O+=M<=0?180:-180,M+=M<=0?180:-180):(Q*=-1,O+=O<=0?180:-180)),t=t||i.uncache,i.x=v-((i.xPercent=v&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-v)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+h,i.y=I-((i.yPercent=I&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-I)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+h,i.z=C+h,i.scaleX=Qr(E),i.scaleY=Qr(Q),i.rotation=Qr(M)+r,i.rotationX=Qr(D)+r,i.rotationY=Qr(P)+r,i.skewX=O+r,i.skewY=F+r,i.transformPerspective=N+h,(i.zOrigin=parseFloat(g.split(" ")[2])||0)&&(o[el]=Qx(g)),i.xOffset=i.yOffset=0,i.force3D=Fo.force3D,i.renderTransform=i.svg?t8:cP?pP:e8,i.uncache=0,i},Qx=function(e){return(e=e.split(" "))[0]+" "+e[1]},RC=function(e,t,i){var o=ks(t);return Qr(parseFloat(t)+parseFloat(oh(e,"x",i+"px",o)))+o},e8=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,pP(e,t)},sd="0deg",wm="0px",od=") ",pP=function(e,t){var i=t||this,o=i.xPercent,u=i.yPercent,h=i.x,r=i.y,p=i.z,g=i.rotation,v=i.rotationY,I=i.rotationX,C=i.skewX,E=i.skewY,Q=i.scaleX,M=i.scaleY,D=i.transformPerspective,P=i.force3D,O=i.target,F=i.zOrigin,N="",z=P==="auto"&&e&&e!==1||P===!0;if(F&&(I!==sd||v!==sd)){var X=parseFloat(v)*$p,q=Math.sin(X),H=Math.cos(X),W;X=parseFloat(I)*$p,W=Math.cos(X),h=RC(O,h,q*W*-F),r=RC(O,r,-Math.sin(X)*-F),p=RC(O,p,H*W*-F+F)}D!==wm&&(N+="perspective("+D+od),(o||u)&&(N+="translate("+o+"%, "+u+"%) "),(z||h!==wm||r!==wm||p!==wm)&&(N+=p!==wm||z?"translate3d("+h+", "+r+", "+p+") ":"translate("+h+", "+r+od),g!==sd&&(N+="rotate("+g+od),v!==sd&&(N+="rotateY("+v+od),I!==sd&&(N+="rotateX("+I+od),(C!==sd||E!==sd)&&(N+="skew("+C+", "+E+od),(Q!==1||M!==1)&&(N+="scale("+Q+", "+M+od),O.style[Cr]=N||"translate(0, 0)"},t8=function(e,t){var i=t||this,o=i.xPercent,u=i.yPercent,h=i.x,r=i.y,p=i.rotation,g=i.skewX,v=i.skewY,I=i.scaleX,C=i.scaleY,E=i.target,Q=i.xOrigin,M=i.yOrigin,D=i.xOffset,P=i.yOffset,O=i.forceCSS,F=parseFloat(h),N=parseFloat(r),z,X,q,H,W;p=parseFloat(p),g=parseFloat(g),v=parseFloat(v),v&&(v=parseFloat(v),g+=v,p+=v),p||g?(p*=$p,g*=$p,z=Math.cos(p)*I,X=Math.sin(p)*I,q=Math.sin(p-g)*-C,H=Math.cos(p-g)*C,g&&(v*=$p,W=Math.tan(g-v),W=Math.sqrt(1+W*W),q*=W,H*=W,v&&(W=Math.tan(v),W=Math.sqrt(1+W*W),z*=W,X*=W)),z=Qr(z),X=Qr(X),q=Qr(q),H=Qr(H)):(z=I,H=C,X=q=0),(F&&!~(h+"").indexOf("px")||N&&!~(r+"").indexOf("px"))&&(F=oh(E,"x",h,"px"),N=oh(E,"y",r,"px")),(Q||M||D||P)&&(F=Qr(F+Q-(Q*z+M*q)+D),N=Qr(N+M-(Q*X+M*H)+P)),(o||u)&&(W=E.getBBox(),F=Qr(F+o/100*W.width),N=Qr(N+u/100*W.height)),W="matrix("+z+","+X+","+q+","+H+","+F+","+N+")",E.setAttribute("transform",W),O&&(E.style[Cr]=W)},i8=function(e,t,i,o,u){var h=360,r=ps(u),p=parseFloat(u)*(r&&~u.indexOf("rad")?pd:1),g=p-o,v=o+g+"deg",I,C;return r&&(I=u.split("_")[1],I==="short"&&(g%=h,g!==g%(h/2)&&(g+=g<0?h:-h)),I==="cw"&&g<0?g=(g+h*kT)%h-~~(g/h)*h:I==="ccw"&&g>0&&(g=(g-h*kT)%h-~~(g/h)*h)),e._pt=C=new mo(e._pt,t,i,o,g,z6),C.e=v,C.u="deg",e._props.push(i),C},GT=function(e,t){for(var i in t)e[i]=t[i];return e},n8=function(e,t,i){var o=GT({},i._gsap),u="perspective,force3D,transformOrigin,svgOrigin",h=i.style,r,p,g,v,I,C,E,Q;o.svg?(g=i.getAttribute("transform"),i.setAttribute("transform",""),h[Cr]=t,r=Z_(i,1),J_(i,Cr),i.setAttribute("transform",g)):(g=getComputedStyle(i)[Cr],h[Cr]=t,r=Z_(i,1),h[Cr]=g);for(p in Lc)g=o[p],v=r[p],g!==v&&u.indexOf(p)<0&&(E=ks(g),Q=ks(v),I=E!==Q?oh(i,p,g,Q):parseFloat(g),C=parseFloat(v),e._pt=new mo(e._pt,r,p,I,C-I,vw),e._pt.u=Q||0,e._props.push(p));GT(r,o)};go("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",o="Bottom",u="Left",h=(e<3?[t,i,o,u]:[t+u,t+i,o+i,o+u]).map(function(r){return e<2?n+r:"border"+r+n});Dx[e>1?"border"+n:n]=function(r,p,g,v,I){var C,E;if(arguments.length<4)return C=h.map(function(Q){return Ac(r,Q,g)}),E=C.join(" "),E.split(C[0]).length===5?C[0]:E;C=(v+"").split(" "),E={},h.forEach(function(Q,M){return E[Q]=C[M]=C[M]||C[(M-1)/2|0]}),r.init(p,E,I)}});var AP={name:"css",register:Iw,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,o,u){var h=this._props,r=e.style,p=i.vars.startAt,g,v,I,C,E,Q,M,D,P,O,F,N,z,X,q,H;nB||Iw(),this.styles=this.styles||lP(e),H=this.styles.props,this.tween=i;for(M in t)if(M!=="autoRound"&&(v=t[M],!(Qo[M]&&XL(M,t,i,o,e,u)))){if(E=typeof v,Q=Dx[M],E==="function"&&(v=v.call(i,o,e,u),E=typeof v),E==="string"&&~v.indexOf("random(")&&(v=q_(v)),Q)Q(this,e,M,v,i)&&(q=1);else if(M.substr(0,2)==="--")g=(getComputedStyle(e).getPropertyValue(M)+"").trim(),v+="",Xu.lastIndex=0,Xu.test(g)||(D=ks(g),P=ks(v)),P?D!==P&&(g=oh(e,M,g,P)+P):D&&(v+=D),this.add(r,"setProperty",g,v,o,u,0,0,M),h.push(M),H.push(M,0,r[M]);else if(E!=="undefined"){if(p&&M in p?(g=typeof p[M]=="function"?p[M].call(i,o,e,u):p[M],ps(g)&&~g.indexOf("random(")&&(g=q_(g)),ks(g+"")||(g+=Fo.units[M]||ks(Ac(e,M))||""),(g+"").charAt(1)==="="&&(g=Ac(e,M))):g=Ac(e,M),C=parseFloat(g),O=E==="string"&&v.charAt(1)==="="&&v.substr(0,2),O&&(v=v.substr(2)),I=parseFloat(v),M in vc&&(M==="autoAlpha"&&(C===1&&Ac(e,"visibility")==="hidden"&&I&&(C=0),H.push("visibility",0,r.visibility),Gu(this,r,"visibility",C?"inherit":"hidden",I?"inherit":"hidden",!I)),M!=="scale"&&M!=="transform"&&(M=vc[M],~M.indexOf(",")&&(M=M.split(",")[0]))),F=M in Lc,F){if(this.styles.save(M),N||(z=e._gsap,z.renderTransform&&!t.parseTransform||Z_(e,t.parseTransform),X=t.smoothOrigin!==!1&&z.smooth,N=this._pt=new mo(this._pt,r,Cr,0,1,z.renderTransform,z,0,-1),N.dep=1),M==="scale")this._pt=new mo(this._pt,z,"scaleY",z.scaleY,(O?Xp(z.scaleY,O+I):I)-z.scaleY||0,vw),this._pt.u=0,h.push("scaleY",M),M+="X";else if(M==="transformOrigin"){H.push(el,0,r[el]),v=Z6(v),z.svg?Cw(e,v,0,X,0,this):(P=parseFloat(v.split(" ")[2])||0,P!==z.zOrigin&&Gu(this,z,"zOrigin",z.zOrigin,P),Gu(this,r,M,Qx(g),Qx(v)));continue}else if(M==="svgOrigin"){Cw(e,v,1,X,0,this);continue}else if(M in dP){i8(this,z,M,C,O?Xp(C,O+v):v);continue}else if(M==="smoothOrigin"){Gu(this,z,"smooth",z.smooth,v);continue}else if(M==="force3D"){z[M]=v;continue}else if(M==="transform"){n8(this,v,e);continue}}else M in r||(M=EA(M)||M);if(F||(I||I===0)&&(C||C===0)&&!N6.test(v)&&M in r)D=(g+"").substr((C+"").length),I||(I=0),P=ks(v)||(M in Fo.units?Fo.units[M]:D),D!==P&&(C=oh(e,M,g,P)),this._pt=new mo(this._pt,F?z:r,M,C,(O?Xp(C,O+I):I)-C,!F&&(P==="px"||M==="zIndex")&&t.autoRound!==!1?O6:vw),this._pt.u=P||0,D!==P&&P!=="%"&&(this._pt.b=g,this._pt.r=U6);else if(M in r)X6.call(this,e,M,g,O?O+v:v);else if(M in e)this.add(e,M,g||e[M],O?O+v:v,o,u);else if(M!=="parseTransform"){qb(M,v);continue}F||(M in r?H.push(M,0,r[M]):H.push(M,1,g||e[M])),h.push(M)}}q&&nP(this)},render:function(e,t){if(t.tween._time||!rB())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Ac,aliases:vc,getSetter:function(e,t,i){var o=vc[t];return o&&o.indexOf(",")<0&&(t=o),t in Lc&&t!==el&&(e._gsap.x||Ac(e,"x"))?i&&PT===i?t==="scale"?W6:V6:(PT=i||{})&&(t==="scale"?Y6:j6):e.style&&!Yb(e.style[t])?G6:~t.indexOf("-")?H6:tB(e,t)},core:{_removeProperty:J_,_getMatrix:oB}};Uo.utils.checkPrefix=EA;Uo.core.getStyleSaver=lP;(function(n,e,t,i){var o=go(n+","+e+","+t,function(u){Lc[u]=1});go(e,function(u){Fo.units[u]="deg",dP[u]=1}),vc[o[13]]=n+","+e,go(i,function(u){var h=u.split(":");vc[h[1]]=o[h[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");go("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Fo.units[n]="px"});Uo.registerPlugin(AP);var pr=Uo.registerPlugin(AP)||Uo;pr.core.Tween;/*!
 * matrix 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var xc,kd,aB,eA,Xm,tx,Rx,x_,da="transform",Ew=da+"Origin",gP,mP=function(e){var t=e.ownerDocument||e;for(!(da in e.style)&&("msTransform"in e.style)&&(da="msTransform",Ew=da+"Origin");t.parentNode&&(t=t.parentNode););if(kd=window,Rx=new Yd,t){xc=t,aB=t.documentElement,eA=t.body,x_=xc.createElementNS("http://www.w3.org/2000/svg","g"),x_.style.transform="none";var i=t.createElement("div"),o=t.createElement("div");eA.appendChild(i),i.appendChild(o),i.style.position="static",i.style[da]="translate3d(0,0,1px)",gP=o.offsetParent!==i,eA.removeChild(i)}return t},r8=function(e){for(var t,i;e&&e!==eA;)i=e._gsap,i&&i.uncache&&i.get(e,"x"),i&&!i.scaleX&&!i.scaleY&&i.renderTransform&&(i.scaleX=i.scaleY=1e-4,i.renderTransform(1,i),t?t.push(i):t=[i]),e=e.parentNode;return t},_P=[],yP=[],s8=function(){return kd.pageYOffset||xc.scrollTop||aB.scrollTop||eA.scrollTop||0},o8=function(){return kd.pageXOffset||xc.scrollLeft||aB.scrollLeft||eA.scrollLeft||0},lB=function(e){return e.ownerSVGElement||((e.tagName+"").toLowerCase()==="svg"?e:null)},a8=function n(e){if(kd.getComputedStyle(e).position==="fixed")return!0;if(e=e.parentNode,e&&e.nodeType===1)return n(e)},LC=function n(e,t){if(e.parentNode&&(xc||mP(e))){var i=lB(e),o=i?i.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",u=i?t?"rect":"g":"div",h=t!==2?0:100,r=t===3?100:0,p="position:absolute;display:block;pointer-events:none;margin:0;padding:0;",g=xc.createElementNS?xc.createElementNS(o.replace(/^https/,"http"),u):xc.createElement(u);return t&&(i?(tx||(tx=n(e)),g.setAttribute("width",.01),g.setAttribute("height",.01),g.setAttribute("transform","translate("+h+","+r+")"),tx.appendChild(g)):(Xm||(Xm=n(e),Xm.style.cssText=p),g.style.cssText=p+"width:0.1px;height:0.1px;top:"+r+"px;left:"+h+"px",Xm.appendChild(g))),g}throw"Need document and parent."},l8=function(e){for(var t=new Yd,i=0;i<e.numberOfItems;i++)t.multiply(e.getItem(i).matrix);return t},c8=function(e){var t=e.getCTM(),i;return t||(i=e.style[da],e.style[da]="none",e.appendChild(x_),t=x_.getCTM(),e.removeChild(x_),i?e.style[da]=i:e.style.removeProperty(da.replace(/([A-Z])/g,"-$1").toLowerCase())),t||Rx.clone()},u8=function(e,t){var i=lB(e),o=e===i,u=i?_P:yP,h=e.parentNode,r,p,g,v,I,C;if(e===kd)return e;if(u.length||u.push(LC(e,1),LC(e,2),LC(e,3)),r=i?tx:Xm,i)o?(g=c8(e),v=-g.e/g.a,I=-g.f/g.d,p=Rx):e.getBBox?(g=e.getBBox(),p=e.transform?e.transform.baseVal:{},p=p.numberOfItems?p.numberOfItems>1?l8(p):p.getItem(0).matrix:Rx,v=p.a*g.x+p.c*g.y,I=p.b*g.x+p.d*g.y):(p=new Yd,v=I=0),t&&e.tagName.toLowerCase()==="g"&&(v=I=0),(o?i:h).appendChild(r),r.setAttribute("transform","matrix("+p.a+","+p.b+","+p.c+","+p.d+","+(p.e+v)+","+(p.f+I)+")");else{if(v=I=0,gP)for(p=e.offsetParent,g=e;g&&(g=g.parentNode)&&g!==p&&g.parentNode;)(kd.getComputedStyle(g)[da]+"").length>4&&(v=g.offsetLeft,I=g.offsetTop,g=0);if(C=kd.getComputedStyle(e),C.position!=="absolute"&&C.position!=="fixed")for(p=e.offsetParent;h&&h!==p;)v+=h.scrollLeft||0,I+=h.scrollTop||0,h=h.parentNode;g=r.style,g.top=e.offsetTop-I+"px",g.left=e.offsetLeft-v+"px",g[da]=C[da],g[Ew]=C[Ew],g.position=C.position==="fixed"?"fixed":"absolute",e.parentNode.appendChild(r)}return r},PC=function(e,t,i,o,u,h,r){return e.a=t,e.b=i,e.c=o,e.d=u,e.e=h,e.f=r,e},Yd=function(){function n(t,i,o,u,h,r){t===void 0&&(t=1),i===void 0&&(i=0),o===void 0&&(o=0),u===void 0&&(u=1),h===void 0&&(h=0),r===void 0&&(r=0),PC(this,t,i,o,u,h,r)}var e=n.prototype;return e.inverse=function(){var i=this.a,o=this.b,u=this.c,h=this.d,r=this.e,p=this.f,g=i*h-o*u||1e-10;return PC(this,h/g,-o/g,-u/g,i/g,(u*p-h*r)/g,-(i*p-o*r)/g)},e.multiply=function(i){var o=this.a,u=this.b,h=this.c,r=this.d,p=this.e,g=this.f,v=i.a,I=i.c,C=i.b,E=i.d,Q=i.e,M=i.f;return PC(this,v*o+C*h,v*u+C*r,I*o+E*h,I*u+E*r,p+Q*o+M*h,g+Q*u+M*r)},e.clone=function(){return new n(this.a,this.b,this.c,this.d,this.e,this.f)},e.equals=function(i){var o=this.a,u=this.b,h=this.c,r=this.d,p=this.e,g=this.f;return o===i.a&&u===i.b&&h===i.c&&r===i.d&&p===i.e&&g===i.f},e.apply=function(i,o){o===void 0&&(o={});var u=i.x,h=i.y,r=this.a,p=this.b,g=this.c,v=this.d,I=this.e,C=this.f;return o.x=u*r+h*g+I||0,o.y=u*p+h*v+C||0,o},n}();function Id(n,e,t,i){if(!n||!n.parentNode||(xc||mP(n)).documentElement===n)return new Yd;var o=r8(n),u=lB(n),h=u?_P:yP,r=u8(n,t),p=h[0].getBoundingClientRect(),g=h[1].getBoundingClientRect(),v=h[2].getBoundingClientRect(),I=r.parentNode,C=!i&&a8(n),E=new Yd((g.left-p.left)/100,(g.top-p.top)/100,(v.left-p.left)/100,(v.top-p.top)/100,p.left+(C?0:o8()),p.top+(C?0:s8()));if(I.removeChild(r),o)for(p=o.length;p--;)g=o[p],g.scaleX=g.scaleY=0,g.renderTransform(1,g);return e?E.inverse():E}function HT(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function h8(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var En,Xn,Lo,tl,Ic,kC,gc,ww,Zm,Hu,vP,bw,$_,cB,$m,Ha,e_,ix,xP,Lx=0,IP=function(){return typeof window<"u"},CP=function(){return En||IP()&&(En=window.gsap)&&En.registerPlugin&&En},ku=function(e){return typeof e=="function"},I_=function(e){return typeof e=="object"},ja=function(e){return typeof e>"u"},nx=function(){return!1},C_="transform",Bw="transformOrigin",vu=function(e){return Math.round(e*1e4)/1e4},bm=Array.isArray,Zy=function(e,t){var i=Lo.createElementNS?Lo.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Lo.createElement(e);return i.style?i:Lo.createElement(e)},VT=180/Math.PI,ad=1e20,d8=new Yd,xu=Date.now||function(){return new Date().getTime()},Fd=[],tA={},f8=0,p8=/^(?:a|input|textarea|button|select)$/i,WT=0,hp={},uc={},EP=function(e,t){var i={},o;for(o in e)i[o]=t?e[o]*t:e[o];return i},A8=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},YT=function n(e,t){for(var i=e.length,o;i--;)t?e[i].style.touchAction=t:e[i].style.removeProperty("touch-action"),o=e[i].children,o&&o.length&&n(o,t)},wP=function(){return Fd.forEach(function(e){return e()})},g8=function(e){Fd.push(e),Fd.length===1&&En.ticker.add(wP)},jT=function(){return!Fd.length&&En.ticker.remove(wP)},qT=function(e){for(var t=Fd.length;t--;)Fd[t]===e&&Fd.splice(t,1);En.to(jT,{overwrite:!0,delay:15,duration:0,onComplete:jT,data:"_draggable"})},m8=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Jr=function(e,t,i,o){if(e.addEventListener){var u=$_[t];o=o||(vP?{passive:!1}:null),e.addEventListener(u||t,i,o),u&&t!==u&&e.addEventListener(t,i,o)}},Or=function(e,t,i,o){if(e.removeEventListener){var u=$_[t];e.removeEventListener(u||t,i,o),u&&t!==u&&e.removeEventListener(t,i,o)}},Zo=function(e){e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation()},_8=function(e,t){for(var i=e.length;i--;)if(e[i].identifier===t)return!0},y8=function n(e){cB=e.touches&&Lx<e.touches.length,Or(e.target,"touchend",n)},KT=function(e){cB=e.touches&&Lx<e.touches.length,Jr(e.target,"touchend",y8)},iA=function(e){return Xn.pageYOffset||e.scrollTop||e.documentElement.scrollTop||e.body.scrollTop||0},nA=function(e){return Xn.pageXOffset||e.scrollLeft||e.documentElement.scrollLeft||e.body.scrollLeft||0},JT=function n(e,t){Jr(e,"scroll",t),wA(e.parentNode)||n(e.parentNode,t)},XT=function n(e,t){Or(e,"scroll",t),wA(e.parentNode)||n(e.parentNode,t)},wA=function(e){return!e||e===tl||e.nodeType===9||e===Lo.body||e===Xn||!e.nodeType||!e.parentNode},ZT=function(e,t){var i=t==="x"?"Width":"Height",o="scroll"+i,u="client"+i;return Math.max(0,wA(e)?Math.max(tl[o],Ic[o])-(Xn["inner"+i]||tl[u]||Ic[u]):e[o]-e[u])},FC=function n(e,t){var i=ZT(e,"x"),o=ZT(e,"y");wA(e)?e=uc:n(e.parentNode,t),e._gsMaxScrollX=i,e._gsMaxScrollY=o,t||(e._gsScrollX=e.scrollLeft||0,e._gsScrollY=e.scrollTop||0)},NC=function(e,t,i){var o=e.style;o&&(ja(o[t])&&(t=Zm(t,e)||t),i==null?o.removeProperty&&o.removeProperty(t.replace(/([A-Z])/g,"-$1").toLowerCase()):o[t]=i)},e0=function(e){return Xn.getComputedStyle(e instanceof Element?e:e.host||(e.parentNode||{}).host||e)},ld={},dp=function(e){if(e===Xn)return ld.left=ld.top=0,ld.width=ld.right=tl.clientWidth||e.innerWidth||Ic.clientWidth||0,ld.height=ld.bottom=(e.innerHeight||0)-20<tl.clientHeight?tl.clientHeight:e.innerHeight||Ic.clientHeight||0,ld;var t=e.ownerDocument||Lo,i=ja(e.pageX)?!e.nodeType&&!ja(e.left)&&!ja(e.top)?e:Hu(e)[0].getBoundingClientRect():{left:e.pageX-nA(t),top:e.pageY-iA(t),right:e.pageX-nA(t)+1,bottom:e.pageY-iA(t)+1};return ja(i.right)&&!ja(i.width)?(i.right=i.left+i.width,i.bottom=i.top+i.height):ja(i.width)&&(i={width:i.right-i.left,height:i.bottom-i.top,right:i.right,left:i.left,bottom:i.bottom,top:i.top}),i},Tr=function(e,t,i){var o=e.vars,u=o[i],h=e._listeners[t],r;return ku(u)&&(r=u.apply(o.callbackScope||e,o[i+"Params"]||[e.pointerEvent])),h&&e.dispatchEvent(t)===!1&&(r=!1),r},$T=function(e,t){var i=Hu(e)[0],o,u,h;return!i.nodeType&&i!==Xn?ja(e.left)?(u=e.min||e.minX||e.minRotation||0,o=e.min||e.minY||0,{left:u,top:o,width:(e.max||e.maxX||e.maxRotation||0)-u,height:(e.max||e.maxY||0)-o}):(h={x:0,y:0},{left:e.left-h.x,top:e.top-h.y,width:e.width,height:e.height}):v8(i,t)},$o={},v8=function(e,t){t=Hu(t)[0];var i=e.getBBox&&e.ownerSVGElement,o=e.ownerDocument||Lo,u,h,r,p,g,v,I,C,E,Q,M,D,P;if(e===Xn)r=iA(o),u=nA(o),h=u+(o.documentElement.clientWidth||e.innerWidth||o.body.clientWidth||0),p=r+((e.innerHeight||0)-20<o.documentElement.clientHeight?o.documentElement.clientHeight:e.innerHeight||o.body.clientHeight||0);else{if(t===Xn||ja(t))return e.getBoundingClientRect();u=r=0,i?(Q=e.getBBox(),M=Q.width,D=Q.height):(e.viewBox&&(Q=e.viewBox.baseVal)&&(u=Q.x||0,r=Q.y||0,M=Q.width,D=Q.height),M||(P=e0(e),Q=P.boxSizing==="border-box",M=(parseFloat(P.width)||e.clientWidth||0)+(Q?0:parseFloat(P.borderLeftWidth)+parseFloat(P.borderRightWidth)),D=(parseFloat(P.height)||e.clientHeight||0)+(Q?0:parseFloat(P.borderTopWidth)+parseFloat(P.borderBottomWidth)))),h=M,p=D}return e===t?{left:u,top:r,width:h-u,height:p-r}:(g=Id(t,!0).multiply(Id(e)),v=g.apply({x:u,y:r}),I=g.apply({x:h,y:r}),C=g.apply({x:h,y:p}),E=g.apply({x:u,y:p}),u=Math.min(v.x,I.x,C.x,E.x),r=Math.min(v.y,I.y,C.y,E.y),{left:u,top:r,width:Math.max(v.x,I.x,C.x,E.x)-u,height:Math.max(v.y,I.y,C.y,E.y)-r})},zC=function(e,t,i,o,u,h){var r={},p,g,v;if(t)if(u!==1&&t instanceof Array){if(r.end=p=[],v=t.length,I_(t[0]))for(g=0;g<v;g++)p[g]=EP(t[g],u);else for(g=0;g<v;g++)p[g]=t[g]*u;i+=1.1,o-=1.1}else ku(t)?r.end=function(I){var C=t.call(e,I),E,Q;if(u!==1)if(I_(C)){E={};for(Q in C)E[Q]=C[Q]*u;C=E}else C*=u;return C}:r.end=t;return(i||i===0)&&(r.max=i),(o||o===0)&&(r.min=o),h&&(r.velocity=0),r},x8=function n(e){var t;return!e||!e.getAttribute||e===Ic?!1:(t=e.getAttribute("data-clickable"))==="true"||t!=="false"&&(e.onclick||p8.test(e.nodeName+"")||e.getAttribute("contentEditable")==="true")?!0:n(e.parentNode)},$y=function(e,t){for(var i=e.length,o;i--;)o=e[i],o.ondragstart=o.onselectstart=t?null:nx,En.set(o,{lazy:!0,userSelect:t?"text":"none"})},I8=function n(e){if(e0(e).position==="fixed")return!0;if(e=e.parentNode,e&&e.nodeType===1)return n(e)},bP,Sw,C8=function(e,t){e=En.utils.toArray(e)[0],t=t||{};var i=document.createElement("div"),o=i.style,u=e.firstChild,h=0,r=0,p=e.scrollTop,g=e.scrollLeft,v=e.scrollWidth,I=e.scrollHeight,C=0,E=0,Q=0,M,D,P,O,F,N;bP&&t.force3D!==!1?(F="translate3d(",N="px,0px)"):C_&&(F="translate(",N="px)"),this.scrollTop=function(z,X){if(!arguments.length)return-this.top();this.top(-z,X)},this.scrollLeft=function(z,X){if(!arguments.length)return-this.left();this.left(-z,X)},this.left=function(z,X){if(!arguments.length)return-(e.scrollLeft+r);var q=e.scrollLeft-g,H=r;if((q>2||q<-2)&&!X){g=e.scrollLeft,En.killTweensOf(this,{left:1,scrollLeft:1}),this.left(-g),t.onKill&&t.onKill();return}z=-z,z<0?(r=z-.5|0,z=0):z>E?(r=z-E|0,z=E):r=0,(r||H)&&(this._skip||(o[C_]=F+-r+"px,"+-h+N),r+C>=0&&(o.paddingRight=r+C+"px")),e.scrollLeft=z|0,g=e.scrollLeft},this.top=function(z,X){if(!arguments.length)return-(e.scrollTop+h);var q=e.scrollTop-p,H=h;if((q>2||q<-2)&&!X){p=e.scrollTop,En.killTweensOf(this,{top:1,scrollTop:1}),this.top(-p),t.onKill&&t.onKill();return}z=-z,z<0?(h=z-.5|0,z=0):z>Q?(h=z-Q|0,z=Q):h=0,(h||H)&&(this._skip||(o[C_]=F+-r+"px,"+-h+N)),e.scrollTop=z|0,p=e.scrollTop},this.maxScrollTop=function(){return Q},this.maxScrollLeft=function(){return E},this.disable=function(){for(u=i.firstChild;u;)O=u.nextSibling,e.appendChild(u),u=O;e===i.parentNode&&e.removeChild(i)},this.enable=function(){if(u=e.firstChild,u!==i){for(;u;)O=u.nextSibling,i.appendChild(u),u=O;e.appendChild(i),this.calibrate()}},this.calibrate=function(z){var X=e.clientWidth===M,q,H,W;p=e.scrollTop,g=e.scrollLeft,!(X&&e.clientHeight===D&&i.offsetHeight===P&&v===e.scrollWidth&&I===e.scrollHeight&&!z)&&((h||r)&&(H=this.left(),W=this.top(),this.left(-e.scrollLeft),this.top(-e.scrollTop)),q=e0(e),(!X||z)&&(o.display="block",o.width="auto",o.paddingRight="0px",C=Math.max(0,e.scrollWidth-e.clientWidth),C&&(C+=parseFloat(q.paddingLeft)+(Sw?parseFloat(q.paddingRight):0))),o.display="inline-block",o.position="relative",o.overflow="visible",o.verticalAlign="top",o.boxSizing="content-box",o.width="100%",o.paddingRight=C+"px",Sw&&(o.paddingBottom=q.paddingBottom),M=e.clientWidth,D=e.clientHeight,v=e.scrollWidth,I=e.scrollHeight,E=e.scrollWidth-M,Q=e.scrollHeight-D,P=i.offsetHeight,o.display="block",(H||W)&&(this.left(H),this.top(W)))},this.content=i,this.element=e,this._skip=!1,this.enable()},UC=function(e){if(IP()&&document.body){var t=window&&window.navigator;Xn=window,Lo=document,tl=Lo.documentElement,Ic=Lo.body,kC=Zy("div"),ix=!!window.PointerEvent,gc=Zy("div"),gc.style.cssText="visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;cursor:grab",e_=gc.style.cursor==="grab"?"grab":"move",$m=t&&t.userAgent.toLowerCase().indexOf("android")!==-1,bw="ontouchstart"in tl&&"orientation"in Xn||t&&(t.MaxTouchPoints>0||t.msMaxTouchPoints>0),Sw=function(){var i=Zy("div"),o=Zy("div"),u=o.style,h=Ic,r;return u.display="inline-block",u.position="relative",i.style.cssText="width:90px;height:40px;padding:10px;overflow:auto;visibility:hidden",i.appendChild(o),h.appendChild(i),r=o.offsetHeight+18>i.scrollHeight,h.removeChild(i),r}(),$_=function(i){for(var o=i.split(","),u=("onpointerdown"in kC?"pointerdown,pointermove,pointerup,pointercancel":"onmspointerdown"in kC?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":i).split(","),h={},r=4;--r>-1;)h[o[r]]=u[r],h[u[r]]=o[r];try{tl.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){vP=1}}))}catch{}return h}("touchstart,touchmove,touchend,touchcancel"),Jr(Lo,"touchcancel",nx),Jr(Xn,"touchmove",nx),Ic&&Ic.addEventListener("touchstart",nx),Jr(Lo,"contextmenu",function(){for(var i in tA)tA[i].isPressed&&tA[i].endDrag()}),En=ww=CP()}En?(Ha=En.plugins.inertia,xP=En.core.context||function(){},Zm=En.utils.checkPrefix,C_=Zm(C_),Bw=Zm(Bw),Hu=En.utils.toArray,bP=!!Zm("perspective")):e&&console.warn("Please gsap.registerPlugin(Draggable)")},E8=function(){function n(t){this._listeners={},this.target=t||this}var e=n.prototype;return e.addEventListener=function(i,o){var u=this._listeners[i]||(this._listeners[i]=[]);~u.indexOf(o)||u.push(o)},e.removeEventListener=function(i,o){var u=this._listeners[i],h=u&&u.indexOf(o);h>=0&&u.splice(h,1)},e.dispatchEvent=function(i){var o=this,u;return(this._listeners[i]||[]).forEach(function(h){return h.call(o,{type:i,target:o.target})===!1&&(u=!1)}),u},n}(),bA=function(n){h8(e,n);function e(t,i){var o;o=n.call(this)||this,ww||UC(1),t=Hu(t)[0],Ha||(Ha=En.plugins.inertia),o.vars=i=EP(i||{}),o.target=t,o.x=o.y=o.rotation=0,o.dragResistance=parseFloat(i.dragResistance)||0,o.edgeResistance=isNaN(i.edgeResistance)?1:parseFloat(i.edgeResistance)||0,o.lockAxis=i.lockAxis,o.autoScroll=i.autoScroll||0,o.lockedAxis=null,o.allowEventDefault=!!i.allowEventDefault,En.getProperty(t,"x");var u=(i.type||"x,y").toLowerCase(),h=~u.indexOf("x")||~u.indexOf("y"),r=u.indexOf("rotation")!==-1,p=r?"rotation":h?"x":"left",g=h?"y":"top",v=!!(~u.indexOf("x")||~u.indexOf("left")||u==="scroll"),I=!!(~u.indexOf("y")||~u.indexOf("top")||u==="scroll"),C=i.minimumMovement||2,E=HT(o),Q=Hu(i.trigger||i.handle||t),M={},D=0,P=!1,O=i.autoScrollMarginTop||40,F=i.autoScrollMarginRight||40,N=i.autoScrollMarginBottom||40,z=i.autoScrollMarginLeft||40,X=i.clickableTest||x8,q=0,H=t._gsap||En.core.getCache(t),W=I8(t),se=function(le,me){return parseFloat(H.get(t,le,me))},de=t.ownerDocument||Lo,te,ce,Ee,Be,De,Re,ye,ht,oe,Tt,Fe,st,Et,Ke,Ne,dt,xt,ft,Ve,Ye,ae,_e,Ze,nt,ut,ze,Qt,mt,Ut,Dt,Ie,ue,at,St=function(le){return Zo(le),le.stopImmediatePropagation&&le.stopImmediatePropagation(),!1},yt=function Oe(le){if(E.autoScroll&&E.isDragging&&(P||xt)){var me=t,he=E.autoScroll*15,Qe,Je,Xe,Ft,Wt,qt,pe,je;for(P=!1,uc.scrollTop=Xn.pageYOffset!=null?Xn.pageYOffset:de.documentElement.scrollTop!=null?de.documentElement.scrollTop:de.body.scrollTop,uc.scrollLeft=Xn.pageXOffset!=null?Xn.pageXOffset:de.documentElement.scrollLeft!=null?de.documentElement.scrollLeft:de.body.scrollLeft,Ft=E.pointerX-uc.scrollLeft,Wt=E.pointerY-uc.scrollTop;me&&!Je;)Je=wA(me.parentNode),Qe=Je?uc:me.parentNode,Xe=Je?{bottom:Math.max(tl.clientHeight,Xn.innerHeight||0),right:Math.max(tl.clientWidth,Xn.innerWidth||0),left:0,top:0}:Qe.getBoundingClientRect(),qt=pe=0,I&&(je=Qe._gsMaxScrollY-Qe.scrollTop,je<0?pe=je:Wt>Xe.bottom-N&&je?(P=!0,pe=Math.min(je,he*(1-Math.max(0,Xe.bottom-Wt)/N)|0)):Wt<Xe.top+O&&Qe.scrollTop&&(P=!0,pe=-Math.min(Qe.scrollTop,he*(1-Math.max(0,Wt-Xe.top)/O)|0)),pe&&(Qe.scrollTop+=pe)),v&&(je=Qe._gsMaxScrollX-Qe.scrollLeft,je<0?qt=je:Ft>Xe.right-F&&je?(P=!0,qt=Math.min(je,he*(1-Math.max(0,Xe.right-Ft)/F)|0)):Ft<Xe.left+z&&Qe.scrollLeft&&(P=!0,qt=-Math.min(Qe.scrollLeft,he*(1-Math.max(0,Ft-Xe.left)/z)|0)),qt&&(Qe.scrollLeft+=qt)),Je&&(qt||pe)&&(Xn.scrollTo(Qe.scrollLeft,Qe.scrollTop),J(E.pointerX+qt,E.pointerY+pe)),me=Qe}if(xt){var pt=E.x,it=E.y;r?(E.deltaX=pt-parseFloat(H.rotation),E.rotation=pt,H.rotation=pt+"deg",H.renderTransform(1,H)):ce?(I&&(E.deltaY=it-ce.top(),ce.top(it)),v&&(E.deltaX=pt-ce.left(),ce.left(pt))):h?(I&&(E.deltaY=it-parseFloat(H.y),H.y=it+"px"),v&&(E.deltaX=pt-parseFloat(H.x),H.x=pt+"px"),H.renderTransform(1,H)):(I&&(E.deltaY=it-parseFloat(t.style.top||0),t.style.top=it+"px"),v&&(E.deltaX=pt-parseFloat(t.style.left||0),t.style.left=pt+"px")),ht&&!le&&!mt&&(mt=!0,Tr(E,"drag","onDrag")===!1&&(v&&(E.x-=E.deltaX),I&&(E.y-=E.deltaY),Oe(!0)),mt=!1)}xt=!1},Pt=function(le,me){var he=E.x,Qe=E.y,Je,Xe;t._gsap||(H=En.core.getCache(t)),H.uncache&&En.getProperty(t,"x"),h?(E.x=parseFloat(H.x),E.y=parseFloat(H.y)):r?E.x=E.rotation=parseFloat(H.rotation):ce?(E.y=ce.top(),E.x=ce.left()):(E.y=parseFloat(t.style.top||(Xe=e0(t))&&Xe.top)||0,E.x=parseFloat(t.style.left||(Xe||{}).left)||0),(Ve||Ye||ae)&&!me&&(E.isDragging||E.isThrowing)&&(ae&&(hp.x=E.x,hp.y=E.y,Je=ae(hp),Je.x!==E.x&&(E.x=Je.x,xt=!0),Je.y!==E.y&&(E.y=Je.y,xt=!0)),Ve&&(Je=Ve(E.x),Je!==E.x&&(E.x=Je,r&&(E.rotation=Je),xt=!0)),Ye&&(Je=Ye(E.y),Je!==E.y&&(E.y=Je),xt=!0)),xt&&yt(!0),le||(E.deltaX=E.x-he,E.deltaY=E.y-Qe,Tr(E,"throwupdate","onThrowUpdate"))},Ot=function(le,me,he,Qe){return me==null&&(me=-ad),he==null&&(he=ad),ku(le)?function(Je){var Xe=E.isPressed?1-E.edgeResistance:1;return le.call(E,(Je>he?he+(Je-he)*Xe:Je<me?me+(Je-me)*Xe:Je)*Qe)*Qe}:bm(le)?function(Je){for(var Xe=le.length,Ft=0,Wt=ad,qt,pe;--Xe>-1;)qt=le[Xe],pe=qt-Je,pe<0&&(pe=-pe),pe<Wt&&qt>=me&&qt<=he&&(Ft=Xe,Wt=pe);return le[Ft]}:isNaN(le)?function(Je){return Je}:function(){return le*Qe}},Ue=function(le,me,he,Qe,Je,Xe,Ft){return Xe=Xe&&Xe<ad?Xe*Xe:ad,ku(le)?function(Wt){var qt=E.isPressed?1-E.edgeResistance:1,pe=Wt.x,je=Wt.y,pt,it,Ct;return Wt.x=pe=pe>he?he+(pe-he)*qt:pe<me?me+(pe-me)*qt:pe,Wt.y=je=je>Je?Je+(je-Je)*qt:je<Qe?Qe+(je-Qe)*qt:je,pt=le.call(E,Wt),pt!==Wt&&(Wt.x=pt.x,Wt.y=pt.y),Ft!==1&&(Wt.x*=Ft,Wt.y*=Ft),Xe<ad&&(it=Wt.x-pe,Ct=Wt.y-je,it*it+Ct*Ct>Xe&&(Wt.x=pe,Wt.y=je)),Wt}:bm(le)?function(Wt){for(var qt=le.length,pe=0,je=ad,pt,it,Ct,li;--qt>-1;)Ct=le[qt],pt=Ct.x-Wt.x,it=Ct.y-Wt.y,li=pt*pt+it*it,li<je&&(pe=qt,je=li);return je<=Xe?le[pe]:Wt}:function(Wt){return Wt}},ot=function(){var le,me,he,Qe;ye=!1,ce?(ce.calibrate(),E.minX=Fe=-ce.maxScrollLeft(),E.minY=Et=-ce.maxScrollTop(),E.maxX=Tt=E.maxY=st=0,ye=!0):i.bounds&&(le=$T(i.bounds,t.parentNode),r?(E.minX=Fe=le.left,E.maxX=Tt=le.left+le.width,E.minY=Et=E.maxY=st=0):!ja(i.bounds.maxX)||!ja(i.bounds.maxY)?(le=i.bounds,E.minX=Fe=le.minX,E.minY=Et=le.minY,E.maxX=Tt=le.maxX,E.maxY=st=le.maxY):(me=$T(t,t.parentNode),E.minX=Fe=Math.round(se(p,"px")+le.left-me.left),E.minY=Et=Math.round(se(g,"px")+le.top-me.top),E.maxX=Tt=Math.round(Fe+(le.width-me.width)),E.maxY=st=Math.round(Et+(le.height-me.height))),Fe>Tt&&(E.minX=Tt,E.maxX=Tt=Fe,Fe=E.minX),Et>st&&(E.minY=st,E.maxY=st=Et,Et=E.minY),r&&(E.minRotation=Fe,E.maxRotation=Tt),ye=!0),i.liveSnap&&(he=i.liveSnap===!0?i.snap||{}:i.liveSnap,Qe=bm(he)||ku(he),r?(Ve=Ot(Qe?he:he.rotation,Fe,Tt,1),Ye=null):he.points?ae=Ue(Qe?he:he.points,Fe,Tt,Et,st,he.radius,ce?-1:1):(v&&(Ve=Ot(Qe?he:he.x||he.left||he.scrollLeft,Fe,Tt,ce?-1:1)),I&&(Ye=Ot(Qe?he:he.y||he.top||he.scrollTop,Et,st,ce?-1:1))))},ni=function(){E.isThrowing=!1,Tr(E,"throwcomplete","onThrowComplete")},fi=function(){E.isThrowing=!1},Xt=function(le,me){var he,Qe,Je,Xe;le&&Ha?(le===!0&&(he=i.snap||i.liveSnap||{},Qe=bm(he)||ku(he),le={resistance:(i.throwResistance||i.resistance||1e3)/(r?10:1)},r?le.rotation=zC(E,Qe?he:he.rotation,Tt,Fe,1,me):(v&&(le[p]=zC(E,Qe?he:he.points||he.x||he.left,Tt,Fe,ce?-1:1,me||E.lockedAxis==="x")),I&&(le[g]=zC(E,Qe?he:he.points||he.y||he.top,st,Et,ce?-1:1,me||E.lockedAxis==="y")),(he.points||bm(he)&&I_(he[0]))&&(le.linkedProps=p+","+g,le.radius=he.radius))),E.isThrowing=!0,Xe=isNaN(i.overshootTolerance)?i.edgeResistance===1?0:1-E.edgeResistance+.2:i.overshootTolerance,le.duration||(le.duration={max:Math.max(i.minDuration||0,"maxDuration"in i?i.maxDuration:2),min:isNaN(i.minDuration)?Xe===0||I_(le)&&le.resistance>1e3?0:.5:i.minDuration,overshoot:Xe}),E.tween=Je=En.to(ce||t,{inertia:le,data:"_draggable",onComplete:ni,onInterrupt:fi,onUpdate:i.fastMode?Tr:Pt,onUpdateParams:i.fastMode?[E,"onthrowupdate","onThrowUpdate"]:he&&he.radius?[!1,!0]:[]}),i.fastMode||(ce&&(ce._skip=!0),Je.render(1e9,!0,!0),Pt(!0,!0),E.endX=E.x,E.endY=E.y,r&&(E.endRotation=E.x),Je.play(0),Pt(!0,!0),ce&&(ce._skip=!1))):ye&&E.applyBounds()},_i=function(le){var me=nt,he;nt=Id(t.parentNode,!0),le&&E.isPressed&&!nt.equals(me||new Yd)&&(he=me.inverse().apply({x:Ee,y:Be}),nt.apply(he,he),Ee=he.x,Be=he.y),nt.equals(d8)&&(nt=null)},si=function(){var le=1-E.edgeResistance,me=W?nA(de):0,he=W?iA(de):0,Qe,Je,Xe;h&&(H.x=se(p,"px")+"px",H.y=se(g,"px")+"px",H.renderTransform()),_i(!1),$o.x=E.pointerX-me,$o.y=E.pointerY-he,nt&&nt.apply($o,$o),Ee=$o.x,Be=$o.y,xt&&(J(E.pointerX,E.pointerY),yt(!0)),ue=Id(t),ce?(ot(),Re=ce.top(),De=ce.left()):(wt()?(Pt(!0,!0),ot()):E.applyBounds(),r?(Qe=t.ownerSVGElement?[H.xOrigin-t.getBBox().x,H.yOrigin-t.getBBox().y]:(e0(t)[Bw]||"0 0").split(" "),dt=E.rotationOrigin=Id(t).apply({x:parseFloat(Qe[0])||0,y:parseFloat(Qe[1])||0}),Pt(!0,!0),Je=E.pointerX-dt.x-me,Xe=dt.y-E.pointerY+he,De=E.x,Re=E.y=Math.atan2(Xe,Je)*VT):(Re=se(g,"px"),De=se(p,"px"))),ye&&le&&(De>Tt?De=Tt+(De-Tt)/le:De<Fe&&(De=Fe-(Fe-De)/le),r||(Re>st?Re=st+(Re-st)/le:Re<Et&&(Re=Et-(Et-Re)/le))),E.startX=De=vu(De),E.startY=Re=vu(Re)},wt=function(){return E.tween&&E.tween.isActive()},kt=function(){gc.parentNode&&!wt()&&!E.isDragging&&gc.parentNode.removeChild(gc)},yi=function(le,me){var he;if(!te||E.isPressed||!le||(le.type==="mousedown"||le.type==="pointerdown")&&!me&&xu()-q<30&&$_[E.pointerEvent.type]){Ie&&le&&te&&Zo(le);return}if(ut=wt(),at=!1,E.pointerEvent=le,$_[le.type]?(Ze=~le.type.indexOf("touch")?le.currentTarget||le.target:de,Jr(Ze,"touchend",Z),Jr(Ze,"touchmove",ee),Jr(Ze,"touchcancel",Z),Jr(de,"touchstart",KT)):(Ze=null,Jr(de,"mousemove",ee)),Qt=null,(!ix||!Ze)&&(Jr(de,"mouseup",Z),le&&le.target&&Jr(le.target,"mouseup",Z)),_e=X.call(E,le.target)&&i.dragClickables===!1&&!me,_e){Jr(le.target,"change",Z),Tr(E,"pressInit","onPressInit"),Tr(E,"press","onPress"),$y(Q,!0),Ie=!1;return}if(ze=!Ze||v===I||E.vars.allowNativeTouchScrolling===!1||E.vars.allowContextMenu&&le&&(le.ctrlKey||le.which>2)?!1:v?"y":"x",Ie=!ze&&!E.allowEventDefault,Ie&&(Zo(le),Jr(Xn,"touchforcechange",Zo)),le.changedTouches?(le=Ke=le.changedTouches[0],Ne=le.identifier):le.pointerId?Ne=le.pointerId:Ke=Ne=null,Lx++,g8(yt),Be=E.pointerY=le.pageY,Ee=E.pointerX=le.pageX,Tr(E,"pressInit","onPressInit"),(ze||E.autoScroll)&&FC(t.parentNode),t.parentNode&&E.autoScroll&&!ce&&!r&&t.parentNode._gsMaxScrollX&&!gc.parentNode&&!t.getBBox&&(gc.style.width=t.parentNode.scrollWidth+"px",t.parentNode.appendChild(gc)),si(),E.tween&&E.tween.kill(),E.isThrowing=!1,En.killTweensOf(ce||t,M,!0),ce&&En.killTweensOf(t,{scrollTo:1},!0),E.tween=E.lockedAxis=null,(i.zIndexBoost||!r&&!ce&&i.zIndexBoost!==!1)&&(t.style.zIndex=e.zIndex++),E.isPressed=!0,ht=!!(i.onDrag||E._listeners.drag),oe=!!(i.onMove||E._listeners.move),i.cursor!==!1||i.activeCursor)for(he=Q.length;--he>-1;)En.set(Q[he],{cursor:i.activeCursor||i.cursor||(e_==="grab"?"grabbing":e_)});Tr(E,"press","onPress")},ee=function(le){var me=le,he,Qe,Je,Xe,Ft,Wt;if(!te||cB||!E.isPressed||!le){Ie&&le&&te&&Zo(le);return}if(E.pointerEvent=le,he=le.changedTouches,he){if(le=he[0],le!==Ke&&le.identifier!==Ne){for(Xe=he.length;--Xe>-1&&(le=he[Xe]).identifier!==Ne&&le.target!==t;);if(Xe<0)return}}else if(le.pointerId&&Ne&&le.pointerId!==Ne)return;if(Ze&&ze&&!Qt&&($o.x=le.pageX-(W?nA(de):0),$o.y=le.pageY-(W?iA(de):0),nt&&nt.apply($o,$o),Qe=$o.x,Je=$o.y,Ft=Math.abs(Qe-Ee),Wt=Math.abs(Je-Be),(Ft!==Wt&&(Ft>C||Wt>C)||$m&&ze===Qt)&&(Qt=Ft>Wt&&v?"x":"y",ze&&Qt!==ze&&Jr(Xn,"touchforcechange",Zo),E.vars.lockAxisOnTouchScroll!==!1&&v&&I&&(E.lockedAxis=Qt==="x"?"y":"x",ku(E.vars.onLockAxis)&&E.vars.onLockAxis.call(E,me)),$m&&ze===Qt))){Z(me);return}!E.allowEventDefault&&(!ze||Qt&&ze!==Qt)&&me.cancelable!==!1?(Zo(me),Ie=!0):Ie&&(Ie=!1),E.autoScroll&&(P=!0),J(le.pageX,le.pageY,oe)},J=function(le,me,he){var Qe=1-E.dragResistance,Je=1-E.edgeResistance,Xe=E.pointerX,Ft=E.pointerY,Wt=Re,qt=E.x,pe=E.y,je=E.endX,pt=E.endY,it=E.endRotation,Ct=xt,li,Ai,oi,ci,zi,Pi;E.pointerX=le,E.pointerY=me,W&&(le-=nA(de),me-=iA(de)),r?(ci=Math.atan2(dt.y-me,le-dt.x)*VT,zi=E.y-ci,zi>180?(Re-=360,E.y=ci):zi<-180&&(Re+=360,E.y=ci),E.x!==De||Math.abs(Re-ci)>C?(E.y=ci,oi=De+(Re-ci)*Qe):oi=De):(nt&&(Pi=le*nt.a+me*nt.c+nt.e,me=le*nt.b+me*nt.d+nt.f,le=Pi),Ai=me-Be,li=le-Ee,Ai<C&&Ai>-C&&(Ai=0),li<C&&li>-C&&(li=0),(E.lockAxis||E.lockedAxis)&&(li||Ai)&&(Pi=E.lockedAxis,Pi||(E.lockedAxis=Pi=v&&Math.abs(li)>Math.abs(Ai)?"y":I?"x":null,Pi&&ku(E.vars.onLockAxis)&&E.vars.onLockAxis.call(E,E.pointerEvent)),Pi==="y"?Ai=0:Pi==="x"&&(li=0)),oi=vu(De+li*Qe),ci=vu(Re+Ai*Qe)),(Ve||Ye||ae)&&(E.x!==oi||E.y!==ci&&!r)&&(ae&&(hp.x=oi,hp.y=ci,Pi=ae(hp),oi=vu(Pi.x),ci=vu(Pi.y)),Ve&&(oi=vu(Ve(oi))),Ye&&(ci=vu(Ye(ci)))),ye&&(oi>Tt?oi=Tt+Math.round((oi-Tt)*Je):oi<Fe&&(oi=Fe+Math.round((oi-Fe)*Je)),r||(ci>st?ci=Math.round(st+(ci-st)*Je):ci<Et&&(ci=Math.round(Et+(ci-Et)*Je)))),(E.x!==oi||E.y!==ci&&!r)&&(r?(E.endRotation=E.x=E.endX=oi,xt=!0):(I&&(E.y=E.endY=ci,xt=!0),v&&(E.x=E.endX=oi,xt=!0)),!he||Tr(E,"move","onMove")!==!1?!E.isDragging&&E.isPressed&&(E.isDragging=at=!0,Tr(E,"dragstart","onDragStart")):(E.pointerX=Xe,E.pointerY=Ft,Re=Wt,E.x=qt,E.y=pe,E.endX=je,E.endY=pt,E.endRotation=it,xt=Ct))},Z=function Oe(le,me){if(!te||!E.isPressed||le&&Ne!=null&&!me&&(le.pointerId&&le.pointerId!==Ne&&le.target!==t||le.changedTouches&&!_8(le.changedTouches,Ne))){Ie&&le&&te&&Zo(le);return}E.isPressed=!1;var he=le,Qe=E.isDragging,Je=E.vars.allowContextMenu&&le&&(le.ctrlKey||le.which>2),Xe=En.delayedCall(.001,kt),Ft,Wt,qt,pe,je;if(Ze?(Or(Ze,"touchend",Oe),Or(Ze,"touchmove",ee),Or(Ze,"touchcancel",Oe),Or(de,"touchstart",KT)):Or(de,"mousemove",ee),Or(Xn,"touchforcechange",Zo),(!ix||!Ze)&&(Or(de,"mouseup",Oe),le&&le.target&&Or(le.target,"mouseup",Oe)),xt=!1,Qe&&(D=WT=xu(),E.isDragging=!1),qT(yt),_e&&!Je){le&&(Or(le.target,"change",Oe),E.pointerEvent=he),$y(Q,!1),Tr(E,"release","onRelease"),Tr(E,"click","onClick"),_e=!1;return}for(Wt=Q.length;--Wt>-1;)NC(Q[Wt],"cursor",i.cursor||(i.cursor!==!1?e_:null));if(Lx--,le){if(Ft=le.changedTouches,Ft&&(le=Ft[0],le!==Ke&&le.identifier!==Ne)){for(Wt=Ft.length;--Wt>-1&&(le=Ft[Wt]).identifier!==Ne&&le.target!==t;);if(Wt<0&&!me)return}E.pointerEvent=he,E.pointerX=le.pageX,E.pointerY=le.pageY}return Je&&he?(Zo(he),Ie=!0,Tr(E,"release","onRelease")):he&&!Qe?(Ie=!1,ut&&(i.snap||i.bounds)&&Xt(i.inertia||i.throwProps),Tr(E,"release","onRelease"),(!$m||he.type!=="touchmove")&&he.type.indexOf("cancel")===-1&&(Tr(E,"click","onClick"),xu()-q<300&&Tr(E,"doubleclick","onDoubleClick"),pe=he.target||t,q=xu(),je=function(){q!==Ut&&E.enabled()&&!E.isPressed&&!he.defaultPrevented&&(pe.click?pe.click():de.createEvent&&(qt=de.createEvent("MouseEvents"),qt.initMouseEvent("click",!0,!0,Xn,1,E.pointerEvent.screenX,E.pointerEvent.screenY,E.pointerX,E.pointerY,!1,!1,!1,!1,0,null),pe.dispatchEvent(qt)))},!$m&&!he.defaultPrevented&&En.delayedCall(.05,je))):(Xt(i.inertia||i.throwProps),!E.allowEventDefault&&he&&(i.dragClickables!==!1||!X.call(E,he.target))&&Qe&&(!ze||Qt&&ze===Qt)&&he.cancelable!==!1?(Ie=!0,Zo(he)):Ie=!1,Tr(E,"release","onRelease")),wt()&&Xe.duration(E.tween.duration()),Qe&&Tr(E,"dragend","onDragEnd"),!0},Ae=function(le){if(le&&E.isDragging&&!ce){var me=le.target||t.parentNode,he=me.scrollLeft-me._gsScrollX,Qe=me.scrollTop-me._gsScrollY;(he||Qe)&&(nt?(Ee-=he*nt.a+Qe*nt.c,Be-=Qe*nt.d+he*nt.b):(Ee-=he,Be-=Qe),me._gsScrollX+=he,me._gsScrollY+=Qe,J(E.pointerX,E.pointerY))}},Ce=function(le){var me=xu(),he=me-q<100,Qe=me-D<50,Je=he&&Ut===q,Xe=E.pointerEvent&&E.pointerEvent.defaultPrevented,Ft=he&&Dt===q,Wt=le.isTrusted||le.isTrusted==null&&he&&Je;if((Je||Qe&&E.vars.suppressClickOnDrag!==!1)&&le.stopImmediatePropagation&&le.stopImmediatePropagation(),he&&!(E.pointerEvent&&E.pointerEvent.defaultPrevented)&&(!Je||Wt&&!Ft)){Wt&&Je&&(Dt=q),Ut=q;return}(E.isPressed||Qe||he)&&(!Wt||!le.detail||!he||Xe)&&Zo(le),!he&&!Qe&&!at&&(le&&le.target&&(E.pointerEvent=le),Tr(E,"click","onClick"))},Le=function(le){return nt?{x:le.x*nt.a+le.y*nt.c+nt.e,y:le.x*nt.b+le.y*nt.d+nt.f}:{x:le.x,y:le.y}};return ft=e.get(t),ft&&ft.kill(),o.startDrag=function(Oe,le){var me,he,Qe,Je;yi(Oe||E.pointerEvent,!0),le&&!E.hitTest(Oe||E.pointerEvent)&&(me=dp(Oe||E.pointerEvent),he=dp(t),Qe=Le({x:me.left+me.width/2,y:me.top+me.height/2}),Je=Le({x:he.left+he.width/2,y:he.top+he.height/2}),Ee-=Qe.x-Je.x,Be-=Qe.y-Je.y),E.isDragging||(E.isDragging=at=!0,Tr(E,"dragstart","onDragStart"))},o.drag=ee,o.endDrag=function(Oe){return Z(Oe||E.pointerEvent,!0)},o.timeSinceDrag=function(){return E.isDragging?0:(xu()-D)/1e3},o.timeSinceClick=function(){return(xu()-q)/1e3},o.hitTest=function(Oe,le){return e.hitTest(E.target,Oe,le)},o.getDirection=function(Oe,le){var me=Oe==="velocity"&&Ha?Oe:I_(Oe)&&!r?"element":"start",he,Qe,Je,Xe,Ft,Wt;return me==="element"&&(Ft=dp(E.target),Wt=dp(Oe)),he=me==="start"?E.x-De:me==="velocity"?Ha.getVelocity(t,p):Ft.left+Ft.width/2-(Wt.left+Wt.width/2),r?he<0?"counter-clockwise":"clockwise":(le=le||2,Qe=me==="start"?E.y-Re:me==="velocity"?Ha.getVelocity(t,g):Ft.top+Ft.height/2-(Wt.top+Wt.height/2),Je=Math.abs(he/Qe),Xe=Je<1/le?"":he<0?"left":"right",Je<le&&(Xe!==""&&(Xe+="-"),Xe+=Qe<0?"up":"down"),Xe)},o.applyBounds=function(Oe,le){var me,he,Qe,Je,Xe,Ft;if(Oe&&i.bounds!==Oe)return i.bounds=Oe,E.update(!0,le);if(Pt(!0),ot(),ye&&!wt()){if(me=E.x,he=E.y,me>Tt?me=Tt:me<Fe&&(me=Fe),he>st?he=st:he<Et&&(he=Et),(E.x!==me||E.y!==he)&&(Qe=!0,E.x=E.endX=me,r?E.endRotation=me:E.y=E.endY=he,xt=!0,yt(!0),E.autoScroll&&!E.isDragging))for(FC(t.parentNode),Je=t,uc.scrollTop=Xn.pageYOffset!=null?Xn.pageYOffset:de.documentElement.scrollTop!=null?de.documentElement.scrollTop:de.body.scrollTop,uc.scrollLeft=Xn.pageXOffset!=null?Xn.pageXOffset:de.documentElement.scrollLeft!=null?de.documentElement.scrollLeft:de.body.scrollLeft;Je&&!Ft;)Ft=wA(Je.parentNode),Xe=Ft?uc:Je.parentNode,I&&Xe.scrollTop>Xe._gsMaxScrollY&&(Xe.scrollTop=Xe._gsMaxScrollY),v&&Xe.scrollLeft>Xe._gsMaxScrollX&&(Xe.scrollLeft=Xe._gsMaxScrollX),Je=Xe;E.isThrowing&&(Qe||E.endX>Tt||E.endX<Fe||E.endY>st||E.endY<Et)&&Xt(i.inertia||i.throwProps,Qe)}return E},o.update=function(Oe,le,me){if(le&&E.isPressed){var he=Id(t),Qe=ue.apply({x:E.x-De,y:E.y-Re}),Je=Id(t.parentNode,!0);Je.apply({x:he.e-Qe.x,y:he.f-Qe.y},Qe),E.x-=Qe.x-Je.e,E.y-=Qe.y-Je.f,yt(!0),si()}var Xe=E.x,Ft=E.y;return _i(!le),Oe?E.applyBounds():(xt&&me&&yt(!0),Pt(!0)),le&&(J(E.pointerX,E.pointerY),xt&&yt(!0)),E.isPressed&&!le&&(v&&Math.abs(Xe-E.x)>.01||I&&Math.abs(Ft-E.y)>.01&&!r)&&si(),E.autoScroll&&(FC(t.parentNode,E.isDragging),P=E.isDragging,yt(!0),XT(t,Ae),JT(t,Ae)),E},o.enable=function(Oe){var le={lazy:!0},me,he,Qe;if(i.cursor!==!1&&(le.cursor=i.cursor||e_),En.utils.checkPrefix("touchCallout")&&(le.touchCallout="none"),Oe!=="soft"){for(YT(Q,v===I?"none":i.allowNativeTouchScrolling&&t.scrollHeight===t.clientHeight==(t.scrollWidth===t.clientHeight)||i.allowEventDefault?"manipulation":v?"pan-y":"pan-x"),he=Q.length;--he>-1;)Qe=Q[he],ix||Jr(Qe,"mousedown",yi),Jr(Qe,"touchstart",yi),Jr(Qe,"click",Ce,!0),En.set(Qe,le),Qe.getBBox&&Qe.ownerSVGElement&&v!==I&&En.set(Qe.ownerSVGElement,{touchAction:i.allowNativeTouchScrolling||i.allowEventDefault?"manipulation":v?"pan-y":"pan-x"}),i.allowContextMenu||Jr(Qe,"contextmenu",St);$y(Q,!1)}return JT(t,Ae),te=!0,Ha&&Oe!=="soft"&&Ha.track(ce||t,h?"x,y":r?"rotation":"top,left"),t._gsDragID=me="d"+f8++,tA[me]=E,ce&&(ce.enable(),ce.element._gsDragID=me),(i.bounds||r)&&si(),i.bounds&&E.applyBounds(),E},o.disable=function(Oe){for(var le=E.isDragging,me=Q.length,he;--me>-1;)NC(Q[me],"cursor",null);if(Oe!=="soft"){for(YT(Q,null),me=Q.length;--me>-1;)he=Q[me],NC(he,"touchCallout",null),Or(he,"mousedown",yi),Or(he,"touchstart",yi),Or(he,"click",Ce,!0),Or(he,"contextmenu",St);$y(Q,!0),Ze&&(Or(Ze,"touchcancel",Z),Or(Ze,"touchend",Z),Or(Ze,"touchmove",ee)),Or(de,"mouseup",Z),Or(de,"mousemove",ee)}return XT(t,Ae),te=!1,Ha&&Oe!=="soft"&&Ha.untrack(ce||t,h?"x,y":r?"rotation":"top,left"),ce&&ce.disable(),qT(yt),E.isDragging=E.isPressed=_e=!1,le&&Tr(E,"dragend","onDragEnd"),E},o.enabled=function(Oe,le){return arguments.length?Oe?E.enable(le):E.disable(le):te},o.kill=o.revert=function(){return E.isThrowing=!1,E.tween&&E.tween.kill(),E.disable(),En.set(Q,{clearProps:"userSelect"}),delete tA[t._gsDragID],E},~u.indexOf("scroll")&&(ce=o.scrollProxy=new C8(t,A8({onKill:function(){E.isPressed&&Z(null)}},i)),t.style.overflowY=I&&!bw?"auto":"hidden",t.style.overflowX=v&&!bw?"auto":"hidden",t=ce.content),r?M.rotation=1:(v&&(M[p]=1),I&&(M[g]=1)),H.force3D="force3D"in i?i.force3D:!0,xP(HT(o)),o.enable(),o}return e.register=function(i){En=i,UC()},e.create=function(i,o){return ww||UC(!0),Hu(i).map(function(u){return new e(u,o)})},e.get=function(i){return tA[(Hu(i)[0]||{})._gsDragID]},e.timeSinceDrag=function(){return(xu()-WT)/1e3},e.hitTest=function(i,o,u){if(i===o)return!1;var h=dp(i),r=dp(o),p=h.top,g=h.left,v=h.right,I=h.bottom,C=h.width,E=h.height,Q=r.left>v||r.right<g||r.top>I||r.bottom<p,M,D,P;return Q||!u?!Q:(P=(u+"").indexOf("%")!==-1,u=parseFloat(u)||0,M={left:Math.max(g,r.left),top:Math.max(p,r.top)},M.width=Math.min(v,r.right)-M.left,M.height=Math.min(I,r.bottom)-M.top,M.width<0||M.height<0?!1:P?(u*=.01,D=M.width*M.height,D>=C*E*u||D>=r.width*r.height*u):M.width>u&&M.height>u)},e}(E8);m8(bA.prototype,{pointerX:0,pointerY:0,startX:0,startY:0,deltaX:0,deltaY:0,isDragging:!1,isPressed:!1});bA.zIndex=1e3;bA.version="3.11.4";CP()&&En.registerPlugin(bA);function BP(n){return xb()?(sR(n),!0):!1}function BA(n){return typeof n=="function"?n():Bi(n)}const A1=typeof window<"u"&&typeof document<"u",w8=Object.prototype.toString,b8=n=>w8.call(n)==="[object Object]",uB=()=>{};function B8(n,e){function t(...i){return new Promise((o,u)=>{Promise.resolve(n(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})).then(o).catch(u)})}return t}const SP=n=>n();function S8(n=SP){const e=Gt(!0);function t(){e.value=!1}function i(){e.value=!0}const o=(...u)=>{e.value&&n(...u)};return{isActive:Zx(e),pause:t,resume:i,eventFilter:o}}function M8(...n){if(n.length!==1)return Db(...n);const e=n[0];return typeof e=="function"?Zx(iz(()=>({get:e,set:uB}))):Gt(e)}function T8(n,e,t={}){const{eventFilter:i=SP,...o}=t;return qi(n,B8(i,e),o)}function D8(n,e,t={}){const{eventFilter:i,...o}=t,{eventFilter:u,pause:h,resume:r,isActive:p}=S8(i);return{stop:T8(n,e,{...o,eventFilter:u}),pause:h,resume:r,isActive:p}}function Q8(n,e=!0){hh()?Br(n):e?n():Gr(n)}function MP(n){var e;const t=BA(n);return(e=t==null?void 0:t.$el)!=null?e:t}const SA=A1?window:void 0;A1&&window.document;const R8=A1?window.navigator:void 0;A1&&window.location;function bd(...n){let e,t,i,o;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,o]=n,e=SA):[e,t,i,o]=n,!e)return uB;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const u=[],h=()=>{u.forEach(v=>v()),u.length=0},r=(v,I,C,E)=>(v.addEventListener(I,C,E),()=>v.removeEventListener(I,C,E)),p=qi(()=>[MP(e),BA(o)],([v,I])=>{if(h(),!v)return;const C=b8(I)?{...I}:I;u.push(...t.flatMap(E=>i.map(Q=>r(v,E,Q,C))))},{immediate:!0,flush:"post"}),g=()=>{p(),h()};return BP(g),g}function L8(){const n=Gt(!1);return hh()&&Br(()=>{n.value=!0}),n}function TP(n){const e=L8();return cn(()=>(e.value,Boolean(n())))}function P8({navigator:n=R8}={}){const e=["chargingchange","chargingtimechange","dischargingtimechange","levelchange"],t=TP(()=>n&&"getBattery"in n),i=Gt(!1),o=Gt(0),u=Gt(0),h=Gt(1);let r;function p(){i.value=this.charging,o.value=this.chargingTime||0,u.value=this.dischargingTime||0,h.value=this.level}return t.value&&n.getBattery().then(g=>{r=g,p.call(r),bd(r,e,p,{passive:!0})}),{isSupported:t,charging:i,chargingTime:o,dischargingTime:u,level:h}}function k8(n,e={}){const{window:t=SA}=e,i=TP(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let o;const u=Gt(!1),h=g=>{u.value=g.matches},r=()=>{o&&("removeEventListener"in o?o.removeEventListener("change",h):o.removeListener(h))},p=Lb(()=>{i.value&&(r(),o=t.matchMedia(BA(n)),"addEventListener"in o?o.addEventListener("change",h):o.addListener(h),u.value=o.matches)});return BP(()=>{p(),r(),o=void 0}),u}const ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tv="__vueuse_ssr_handlers__",F8=N8();function N8(){return tv in ev||(ev[tv]=ev[tv]||{}),ev[tv]}function DP(n,e){return F8[n]||e}function z8(n){return n==null?"any":n instanceof Set?"set":n instanceof Map?"map":n instanceof Date?"date":typeof n=="boolean"?"boolean":typeof n=="string"?"string":typeof n=="object"?"object":Number.isNaN(n)?"any":"number"}const U8={boolean:{read:n=>n==="true",write:n=>String(n)},object:{read:n=>JSON.parse(n),write:n=>JSON.stringify(n)},number:{read:n=>Number.parseFloat(n),write:n=>String(n)},any:{read:n=>n,write:n=>String(n)},string:{read:n=>n,write:n=>String(n)},map:{read:n=>new Map(JSON.parse(n)),write:n=>JSON.stringify(Array.from(n.entries()))},set:{read:n=>new Set(JSON.parse(n)),write:n=>JSON.stringify(Array.from(n))},date:{read:n=>new Date(n),write:n=>n.toISOString()}},eD="vueuse-storage";function g1(n,e,t,i={}){var o;const{flush:u="pre",deep:h=!0,listenToStorageChanges:r=!0,writeDefaults:p=!0,mergeDefaults:g=!1,shallow:v,window:I=SA,eventFilter:C,onError:E=H=>{console.error(H)}}=i,Q=(v?mR:Gt)(e);if(!t)try{t=DP("getDefaultStorage",()=>{var H;return(H=SA)==null?void 0:H.localStorage})()}catch(H){E(H)}if(!t)return Q;const M=BA(e),D=z8(M),P=(o=i.serializer)!=null?o:U8[D],{pause:O,resume:F}=D8(Q,()=>N(Q.value),{flush:u,deep:h,eventFilter:C});return I&&r&&(bd(I,"storage",q),bd(I,eD,X)),q(),Q;function N(H){try{if(H==null)t.removeItem(n);else{const W=P.write(H),se=t.getItem(n);se!==W&&(t.setItem(n,W),I&&I.dispatchEvent(new CustomEvent(eD,{detail:{key:n,oldValue:se,newValue:W,storageArea:t}})))}}catch(W){E(W)}}function z(H){const W=H?H.newValue:t.getItem(n);if(W==null)return p&&M!==null&&t.setItem(n,P.write(M)),M;if(!H&&g){const se=P.read(W);return typeof g=="function"?g(se,M):D==="object"&&!Array.isArray(se)?{...M,...se}:se}else return typeof W!="string"?W:P.read(W)}function X(H){q(H.detail)}function q(H){if(!(H&&H.storageArea!==t)){if(H&&H.key==null){Q.value=M;return}if(!(H&&H.key!==n)){O();try{(H==null?void 0:H.newValue)!==P.write(Q.value)&&(Q.value=z(H))}catch(W){E(W)}finally{H?Gr(F):F()}}}}}function O8(n){return k8("(prefers-color-scheme: dark)",n)}function G8(n={}){const{selector:e="html",attribute:t="class",initialValue:i="auto",window:o=SA,storage:u,storageKey:h="vueuse-color-scheme",listenToStorageChanges:r=!0,storageRef:p,emitAuto:g,disableTransition:v=!0}=n,I={auto:"",light:"light",dark:"dark",...n.modes||{}},C=O8({window:o}),E=cn(()=>C.value?"dark":"light"),Q=p||(h==null?M8(i):g1(h,i,u,{window:o,listenToStorageChanges:r})),M=cn(()=>Q.value==="auto"?E.value:Q.value),D=DP("updateHTMLAttrs",(N,z,X)=>{const q=typeof N=="string"?o==null?void 0:o.document.querySelector(N):MP(N);if(!q)return;let H;if(v){H=o.document.createElement("style");const W="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";H.appendChild(document.createTextNode(W)),o.document.head.appendChild(H)}if(z==="class"){const W=X.split(/\s/g);Object.values(I).flatMap(se=>(se||"").split(/\s/g)).filter(Boolean).forEach(se=>{W.includes(se)?q.classList.add(se):q.classList.remove(se)})}else q.setAttribute(z,X);v&&(o.getComputedStyle(H).opacity,document.head.removeChild(H))});function P(N){var z;D(e,t,(z=I[N])!=null?z:N)}function O(N){n.onChanged?n.onChanged(N,P):P(N)}qi(M,O,{flush:"post",immediate:!0}),Q8(()=>O(M.value));const F=cn({get(){return g?Q.value:M.value},set(N){Q.value=N}});try{return Object.assign(F,{store:Q,system:E,state:M})}catch{return F}}const H8={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function QP(n={}){const{reactive:e=!1,target:t=SA,aliasMap:i=H8,passive:o=!0,onEventFired:u=uB}=n,h=Ql(new Set),r={toJSON(){return{}},current:h},p=e?Ql(r):r,g=new Set,v=new Set;function I(M,D){M in p&&(e?p[M]=D:p[M].value=D)}function C(){h.clear();for(const M of v)I(M,!1)}function E(M,D){var P,O;const F=(P=M.key)==null?void 0:P.toLowerCase(),z=[(O=M.code)==null?void 0:O.toLowerCase(),F].filter(Boolean);F&&(D?h.add(F):h.delete(F));for(const X of z)v.add(X),I(X,D);F==="meta"&&!D?(g.forEach(X=>{h.delete(X),I(X,!1)}),g.clear()):typeof M.getModifierState=="function"&&M.getModifierState("Meta")&&D&&[...h,...z].forEach(X=>g.add(X))}bd(t,"keydown",M=>(E(M,!0),u(M)),{passive:o}),bd(t,"keyup",M=>(E(M,!1),u(M)),{passive:o}),bd("blur",C,{passive:!0}),bd("focus",C,{passive:!0});const Q=new Proxy(p,{get(M,D,P){if(typeof D!="string")return Reflect.get(M,D,P);if(D=D.toLowerCase(),D in i&&(D=i[D]),!(D in p))if(/[+_-]/.test(D)){const F=D.split(/[+_-]/g).map(N=>N.trim());p[D]=cn(()=>F.every(N=>BA(Q[N])))}else p[D]=Gt(!1);const O=Reflect.get(M,D,P);return e?BA(O):O}});return Q}const hB=Gb("orientation",{state:()=>({orientation:{a:null,b:null,g:null}}),actions:{setOrientation(n,e,t){this.orientation.a=n,this.orientation.b=e,this.orientation.g=t}}}),Fc=Gb("device",{state:()=>({bottomNav:!1,currentColor:"",isMobile:typeof window.orientation<"u"||navigator.userAgent.indexOf("IEMobile")!==-1,isSafari:navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1,isMobileDevice:()=>{let n=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor),n}}),getters:{isBottomNav:n=>n.bottomNav,getCurrentColor:n=>n.currentColor},actions:{toggleBottomNav(){this.bottomNav=!this.bottomNav},setCurrentColor(n){this.currentColor=n}},persist:!0}),RP=Gb("layout",{state:()=>({layoutBounds:void 0}),getters:{getContentBounds:n=>n.layoutBounds},actions:{setContentBounds(n){this.layoutBounds=n}},persist:!0});const ns=(n,e)=>{const t=n.__vccOpts||n;for(const[i,o]of e)t[i]=o;return t};function tD(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function V8(n,e,t){return e&&tD(n.prototype,e),t&&tD(n,t),n}/*!
 * Observer 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Is,Mw,Po,Vu,Wu,rA,LP,Ad,E_,PP,Cc,Va,kP,FP=function(){return Is||typeof window<"u"&&(Is=window.gsap)&&Is.registerPlugin&&Is},NP=1,Hp=[],An=[],Tl=[],w_=Date.now,Tw=function(e,t){return t},W8=function(){var e=E_.core,t=e.bridge||{},i=e._scrollers,o=e._proxies;i.push.apply(i,An),o.push.apply(o,Tl),An=i,Tl=o,Tw=function(h,r){return t[h](r)}},Zu=function(e,t){return~Tl.indexOf(e)&&Tl[Tl.indexOf(e)+1][t]},b_=function(e){return!!~PP.indexOf(e)},lo=function(e,t,i,o,u){return e.addEventListener(t,i,{passive:!o,capture:!!u})},Hs=function(e,t,i,o){return e.removeEventListener(t,i,!!o)},iv="scrollLeft",nv="scrollTop",Dw=function(){return Cc&&Cc.isPressed||An.cache++},Px=function(e,t){var i=function o(u){if(u||u===0){NP&&(Po.history.scrollRestoration="manual");var h=Cc&&Cc.isPressed;u=o.v=Math.round(u)||(Cc&&Cc.iOS?1:0),e(u),o.cacheID=An.cache,h&&Tw("ss",u)}else(t||An.cache!==o.cacheID||Tw("ref"))&&(o.cacheID=An.cache,o.v=e());return o.v+o.offset};return i.offset=0,e&&i},Js={s:iv,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:Px(function(n){return arguments.length?Po.scrollTo(n,Zr.sc()):Po.pageXOffset||Vu[iv]||Wu[iv]||rA[iv]||0})},Zr={s:nv,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Js,sc:Px(function(n){return arguments.length?Po.scrollTo(Js.sc(),n):Po.pageYOffset||Vu[nv]||Wu[nv]||rA[nv]||0})},uo=function(e){return Is.utils.toArray(e)[0]||(typeof e=="string"&&Is.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},ah=function(e,t){var i=t.s,o=t.sc;b_(e)&&(e=Vu.scrollingElement||Wu);var u=An.indexOf(e),h=o===Zr.sc?1:2;!~u&&(u=An.push(e)-1),An[u+h]||e.addEventListener("scroll",Dw);var r=An[u+h],p=r||(An[u+h]=Px(Zu(e,i),!0)||(b_(e)?o:Px(function(g){return arguments.length?e[i]=g:e[i]})));return p.target=e,r||(p.smooth=Is.getProperty(e,"scrollBehavior")==="smooth"),p},Qw=function(e,t,i){var o=e,u=e,h=w_(),r=h,p=t||50,g=Math.max(500,p*3),v=function(Q,M){var D=w_();M||D-h>p?(u=o,o=Q,r=h,h=D):i?o+=Q:o=u+(Q-u)/(D-r)*(h-r)},I=function(){u=o=i?0:o,r=h=0},C=function(Q){var M=r,D=u,P=w_();return(Q||Q===0)&&Q!==o&&v(Q),h===r||P-r>g?0:(o+(i?D:-D))/((i?P:h)-M)*1e3};return{update:v,reset:I,getVelocity:C}},Bm=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},iD=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},zP=function(){E_=Is.core.globals().ScrollTrigger,E_&&E_.core&&W8()},UP=function(e){return Is=e||FP(),Is&&typeof document<"u"&&document.body&&(Po=window,Vu=document,Wu=Vu.documentElement,rA=Vu.body,PP=[Po,Vu,Wu,rA],Is.utils.clamp,kP=Is.core.context||function(){},Ad="onpointerenter"in rA?"pointer":"mouse",LP=Vr.isTouch=Po.matchMedia&&Po.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Po||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Va=Vr.eventTypes=("ontouchstart"in Wu?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Wu?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return NP=0},500),zP(),Mw=1),Mw};Js.op=Zr;An.cache=0;var Vr=function(){function n(t){this.init(t)}var e=n.prototype;return e.init=function(i){Mw||UP(Is)||console.warn("Please gsap.registerPlugin(Observer)"),E_||zP();var o=i.tolerance,u=i.dragMinimum,h=i.type,r=i.target,p=i.lineHeight,g=i.debounce,v=i.preventDefault,I=i.onStop,C=i.onStopDelay,E=i.ignore,Q=i.wheelSpeed,M=i.event,D=i.onDragStart,P=i.onDragEnd,O=i.onDrag,F=i.onPress,N=i.onRelease,z=i.onRight,X=i.onLeft,q=i.onUp,H=i.onDown,W=i.onChangeX,se=i.onChangeY,de=i.onChange,te=i.onToggleX,ce=i.onToggleY,Ee=i.onHover,Be=i.onHoverEnd,De=i.onMove,Re=i.ignoreCheck,ye=i.isNormalizer,ht=i.onGestureStart,oe=i.onGestureEnd,Tt=i.onWheel,Fe=i.onEnable,st=i.onDisable,Et=i.onClick,Ke=i.scrollSpeed,Ne=i.capture,dt=i.allowClicks,xt=i.lockAxis,ft=i.onLockAxis;this.target=r=uo(r)||Wu,this.vars=i,E&&(E=Is.utils.toArray(E)),o=o||1e-9,u=u||0,Q=Q||1,Ke=Ke||1,h=h||"wheel,touch,pointer",g=g!==!1,p||(p=parseFloat(Po.getComputedStyle(rA).lineHeight)||22);var Ve,Ye,ae,_e,Ze,nt,ut,ze=this,Qt=0,mt=0,Ut=ah(r,Js),Dt=ah(r,Zr),Ie=Ut(),ue=Dt(),at=~h.indexOf("touch")&&!~h.indexOf("pointer")&&Va[0]==="pointerdown",St=b_(r),yt=r.ownerDocument||Vu,Pt=[0,0,0],Ot=[0,0,0],Ue=0,ot=function(){return Ue=w_()},ni=function(he,Qe){return(ze.event=he)&&E&&~E.indexOf(he.target)||Qe&&at&&he.pointerType!=="touch"||Re&&Re(he,Qe)},fi=function(){ze._vx.reset(),ze._vy.reset(),Ye.pause(),I&&I(ze)},Xt=function(){var he=ze.deltaX=iD(Pt),Qe=ze.deltaY=iD(Ot),Je=Math.abs(he)>=o,Xe=Math.abs(Qe)>=o;de&&(Je||Xe)&&de(ze,he,Qe,Pt,Ot),Je&&(z&&ze.deltaX>0&&z(ze),X&&ze.deltaX<0&&X(ze),W&&W(ze),te&&ze.deltaX<0!=Qt<0&&te(ze),Qt=ze.deltaX,Pt[0]=Pt[1]=Pt[2]=0),Xe&&(H&&ze.deltaY>0&&H(ze),q&&ze.deltaY<0&&q(ze),se&&se(ze),ce&&ze.deltaY<0!=mt<0&&ce(ze),mt=ze.deltaY,Ot[0]=Ot[1]=Ot[2]=0),(_e||ae)&&(De&&De(ze),ae&&(O(ze),ae=!1),_e=!1),nt&&!(nt=!1)&&ft&&ft(ze),Ze&&(Tt(ze),Ze=!1),Ve=0},_i=function(he,Qe,Je){Pt[Je]+=he,Ot[Je]+=Qe,ze._vx.update(he),ze._vy.update(Qe),g?Ve||(Ve=requestAnimationFrame(Xt)):Xt()},si=function(he,Qe){xt&&!ut&&(ze.axis=ut=Math.abs(he)>Math.abs(Qe)?"x":"y",nt=!0),ut!=="y"&&(Pt[2]+=he,ze._vx.update(he,!0)),ut!=="x"&&(Ot[2]+=Qe,ze._vy.update(Qe,!0)),g?Ve||(Ve=requestAnimationFrame(Xt)):Xt()},wt=function(he){if(!ni(he,1)){he=Bm(he,v);var Qe=he.clientX,Je=he.clientY,Xe=Qe-ze.x,Ft=Je-ze.y,Wt=ze.isDragging;ze.x=Qe,ze.y=Je,(Wt||Math.abs(ze.startX-Qe)>=u||Math.abs(ze.startY-Je)>=u)&&(O&&(ae=!0),Wt||(ze.isDragging=!0),si(Xe,Ft),Wt||D&&D(ze))}},kt=ze.onPress=function(me){ni(me,1)||(ze.axis=ut=null,Ye.pause(),ze.isPressed=!0,me=Bm(me),Qt=mt=0,ze.startX=ze.x=me.clientX,ze.startY=ze.y=me.clientY,ze._vx.reset(),ze._vy.reset(),lo(ye?r:yt,Va[1],wt,v,!0),ze.deltaX=ze.deltaY=0,F&&F(ze))},yi=function(he){if(!ni(he,1)){Hs(ye?r:yt,Va[1],wt,!0);var Qe=!isNaN(ze.y-ze.startY),Je=ze.isDragging&&(Math.abs(ze.x-ze.startX)>3||Math.abs(ze.y-ze.startY)>3),Xe=Bm(he);!Je&&Qe&&(ze._vx.reset(),ze._vy.reset(),v&&dt&&Is.delayedCall(.08,function(){if(w_()-Ue>300&&!he.defaultPrevented){if(he.target.click)he.target.click();else if(yt.createEvent){var Ft=yt.createEvent("MouseEvents");Ft.initMouseEvent("click",!0,!0,Po,1,Xe.screenX,Xe.screenY,Xe.clientX,Xe.clientY,!1,!1,!1,!1,0,null),he.target.dispatchEvent(Ft)}}})),ze.isDragging=ze.isGesturing=ze.isPressed=!1,I&&!ye&&Ye.restart(!0),P&&Je&&P(ze),N&&N(ze,Je)}},ee=function(he){return he.touches&&he.touches.length>1&&(ze.isGesturing=!0)&&ht(he,ze.isDragging)},J=function(){return(ze.isGesturing=!1)||oe(ze)},Z=function(he){if(!ni(he)){var Qe=Ut(),Je=Dt();_i((Qe-Ie)*Ke,(Je-ue)*Ke,1),Ie=Qe,ue=Je,I&&Ye.restart(!0)}},Ae=function(he){if(!ni(he)){he=Bm(he,v),Tt&&(Ze=!0);var Qe=(he.deltaMode===1?p:he.deltaMode===2?Po.innerHeight:1)*Q;_i(he.deltaX*Qe,he.deltaY*Qe,0),I&&!ye&&Ye.restart(!0)}},Ce=function(he){if(!ni(he)){var Qe=he.clientX,Je=he.clientY,Xe=Qe-ze.x,Ft=Je-ze.y;ze.x=Qe,ze.y=Je,_e=!0,(Xe||Ft)&&si(Xe,Ft)}},Le=function(he){ze.event=he,Ee(ze)},Oe=function(he){ze.event=he,Be(ze)},le=function(he){return ni(he)||Bm(he,v)&&Et(ze)};Ye=ze._dc=Is.delayedCall(C||.25,fi).pause(),ze.deltaX=ze.deltaY=0,ze._vx=Qw(0,50,!0),ze._vy=Qw(0,50,!0),ze.scrollX=Ut,ze.scrollY=Dt,ze.isDragging=ze.isGesturing=ze.isPressed=!1,kP(this),ze.enable=function(me){return ze.isEnabled||(lo(St?yt:r,"scroll",Dw),h.indexOf("scroll")>=0&&lo(St?yt:r,"scroll",Z,v,Ne),h.indexOf("wheel")>=0&&lo(r,"wheel",Ae,v,Ne),(h.indexOf("touch")>=0&&LP||h.indexOf("pointer")>=0)&&(lo(r,Va[0],kt,v,Ne),lo(yt,Va[2],yi),lo(yt,Va[3],yi),dt&&lo(r,"click",ot,!1,!0),Et&&lo(r,"click",le),ht&&lo(yt,"gesturestart",ee),oe&&lo(yt,"gestureend",J),Ee&&lo(r,Ad+"enter",Le),Be&&lo(r,Ad+"leave",Oe),De&&lo(r,Ad+"move",Ce)),ze.isEnabled=!0,me&&me.type&&kt(me),Fe&&Fe(ze)),ze},ze.disable=function(){ze.isEnabled&&(Hp.filter(function(me){return me!==ze&&b_(me.target)}).length||Hs(St?yt:r,"scroll",Dw),ze.isPressed&&(ze._vx.reset(),ze._vy.reset(),Hs(ye?r:yt,Va[1],wt,!0)),Hs(St?yt:r,"scroll",Z,Ne),Hs(r,"wheel",Ae,Ne),Hs(r,Va[0],kt,Ne),Hs(yt,Va[2],yi),Hs(yt,Va[3],yi),Hs(r,"click",ot,!0),Hs(r,"click",le),Hs(yt,"gesturestart",ee),Hs(yt,"gestureend",J),Hs(r,Ad+"enter",Le),Hs(r,Ad+"leave",Oe),Hs(r,Ad+"move",Ce),ze.isEnabled=ze.isPressed=ze.isDragging=!1,st&&st(ze))},ze.kill=ze.revert=function(){ze.disable();var me=Hp.indexOf(ze);me>=0&&Hp.splice(me,1),Cc===ze&&(Cc=0)},Hp.push(ze),ye&&b_(r)&&(Cc=ze),ze.enable(M)},V8(n,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),n}();Vr.version="3.11.4";Vr.create=function(n){return new Vr(n)};Vr.register=UP;Vr.getAll=function(){return Hp.slice()};Vr.getById=function(n){return Hp.filter(function(e){return e.vars.id===n})[0]};FP()&&Is.registerPlugin(Vr);/*!
 * ScrollTrigger 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Fi,kp,vn,fr,qa,wr,OP,kx,Fx,Vp,rx,rv,Ls,m1,Rw,qs,nD,rD,Fp,GP,OC,HP,To,VP,WP,YP,Qu,Lw,dB,GC,sv=1,Ks=Date.now,HC=Ks(),ma=0,ov=0,sD=function(){return m1=1},oD=function(){return m1=0},yl=function(e){return e},t_=function(e){return Math.round(e*1e5)/1e5||0},jP=function(){return typeof window<"u"},qP=function(){return Fi||jP()&&(Fi=window.gsap)&&Fi.registerPlugin&&Fi},jd=function(e){return!!~OP.indexOf(e)},KP=function(e){return Zu(e,"getBoundingClientRect")||(jd(e)?function(){return ux.width=vn.innerWidth,ux.height=vn.innerHeight,ux}:function(){return _c(e)})},Y8=function(e,t,i){var o=i.d,u=i.d2,h=i.a;return(h=Zu(e,"getBoundingClientRect"))?function(){return h()[o]}:function(){return(t?vn["inner"+u]:e["client"+u])||0}},j8=function(e,t){return!t||~Tl.indexOf(e)?KP(e):function(){return ux}},Yu=function(e,t){var i=t.s,o=t.d2,u=t.d,h=t.a;return(i="scroll"+o)&&(h=Zu(e,i))?h()-KP(e)()[u]:jd(e)?(qa[i]||wr[i])-(vn["inner"+o]||qa["client"+o]||wr["client"+o]):e[i]-e["offset"+o]},av=function(e,t){for(var i=0;i<Fp.length;i+=3)(!t||~t.indexOf(Fp[i+1]))&&e(Fp[i],Fp[i+1],Fp[i+2])},Wa=function(e){return typeof e=="string"},Xs=function(e){return typeof e=="function"},i_=function(e){return typeof e=="number"},sx=function(e){return typeof e=="object"},Sm=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},VC=function(e,t){if(e.enabled){var i=t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},fp=Math.abs,JP="left",XP="top",fB="right",pB="bottom",Nd="width",zd="height",B_="Right",S_="Left",M_="Top",T_="Bottom",Dr="padding",oa="margin",MA="Width",AB="Height",ms="px",Ja=function(e){return vn.getComputedStyle(e)},q8=function(e){var t=Ja(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},aD=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},_c=function(e,t){var i=t&&Ja(e)[Rw]!=="matrix(1, 0, 0, 1, 0, 0)"&&Fi.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),o=e.getBoundingClientRect();return i&&i.progress(0).kill(),o},Pw=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},ZP=function(e){var t=[],i=e.labels,o=e.duration(),u;for(u in i)t.push(i[u]/o);return t},K8=function(e){return function(t){return Fi.utils.snap(ZP(e),t)}},gB=function(e){var t=Fi.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort(function(o,u){return o-u});return i?function(o,u,h){h===void 0&&(h=.001);var r;if(!u)return t(o);if(u>0){for(o-=h,r=0;r<i.length;r++)if(i[r]>=o)return i[r];return i[r-1]}else for(r=i.length,o+=h;r--;)if(i[r]<=o)return i[r];return i[0]}:function(o,u,h){h===void 0&&(h=.001);var r=t(o);return!u||Math.abs(r-o)<h||r-o<0==u<0?r:t(u<0?o-e:o+e)}},J8=function(e){return function(t,i){return gB(ZP(e))(t,i.direction)}},lv=function(e,t,i,o){return i.split(",").forEach(function(u){return e(t,u,o)})},_s=function(e,t,i,o,u){return e.addEventListener(t,i,{passive:!o,capture:!!u})},cs=function(e,t,i,o){return e.removeEventListener(t,i,!!o)},cv=function(e,t,i){return i&&i.wheelHandler&&e(t,"wheel",i)},lD={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},uv={toggleActions:"play",anticipatePin:0},Nx={top:0,left:0,center:.5,bottom:1,right:1},ox=function(e,t){if(Wa(e)){var i=e.indexOf("="),o=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(o*=t/100),e=e.substr(0,i-1)),e=o+(e in Nx?Nx[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},hv=function(e,t,i,o,u,h,r,p){var g=u.startColor,v=u.endColor,I=u.fontSize,C=u.indent,E=u.fontWeight,Q=fr.createElement("div"),M=jd(i)||Zu(i,"pinType")==="fixed",D=e.indexOf("scroller")!==-1,P=M?wr:i,O=e.indexOf("start")!==-1,F=O?g:v,N="border-color:"+F+";font-size:"+I+";color:"+F+";font-weight:"+E+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return N+="position:"+((D||p)&&M?"fixed;":"absolute;"),(D||p||!M)&&(N+=(o===Zr?fB:pB)+":"+(h+parseFloat(C))+"px;"),r&&(N+="box-sizing:border-box;text-align:left;width:"+r.offsetWidth+"px;"),Q._isStart=O,Q.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),Q.style.cssText=N,Q.innerText=t||t===0?e+"-"+t:e,P.children[0]?P.insertBefore(Q,P.children[0]):P.appendChild(Q),Q._offset=Q["offset"+o.op.d2],ax(Q,0,o,O),Q},ax=function(e,t,i,o){var u={display:"block"},h=i[o?"os2":"p2"],r=i[o?"p2":"os2"];e._isFlipped=o,u[i.a+"Percent"]=o?-100:0,u[i.a]=o?"1px":0,u["border"+h+MA]=1,u["border"+r+MA]=0,u[i.p]=t+"px",Fi.set(e,u)},dn=[],kw={},t0,cD=function(){return Ks()-ma>34&&(t0||(t0=requestAnimationFrame(lh)))},pp=function(){(!To||!To.isPressed||To.startX>wr.clientWidth)&&(An.cache++,To?t0||(t0=requestAnimationFrame(lh)):lh(),ma||Kd("scrollStart"),ma=Ks())},WC=function(){YP=vn.innerWidth,WP=vn.innerHeight},n_=function(){An.cache++,!Ls&&!HP&&!fr.fullscreenElement&&!fr.webkitFullscreenElement&&(!VP||YP!==vn.innerWidth||Math.abs(vn.innerHeight-WP)>vn.innerHeight*.25)&&kx.restart(!0)},qd={},X8=[],$P=function n(){return cs(_n,"scrollEnd",n)||Bd(!0)},Kd=function(e){return qd[e]&&qd[e].map(function(t){return t()})||X8},Do=[],ek=function(e){for(var t=0;t<Do.length;t+=5)(!e||Do[t+4]&&Do[t+4].query===e)&&(Do[t].style.cssText=Do[t+1],Do[t].getBBox&&Do[t].setAttribute("transform",Do[t+2]||""),Do[t+3].uncache=1)},mB=function(e,t){var i;for(qs=0;qs<dn.length;qs++)i=dn[qs],i&&(!t||i._ctx===t)&&(e?i.kill(1):i.revert(!0,!0));t&&ek(t),t||Kd("revert")},tk=function(e,t){An.cache++,(t||!Ya)&&An.forEach(function(i){return Xs(i)&&i.cacheID++&&(i.rec=0)}),Wa(e)&&(vn.history.scrollRestoration=dB=e)},Ya,Ud=0,uD,Z8=function(){if(uD!==Ud){var e=uD=Ud;requestAnimationFrame(function(){return e===Ud&&Bd(!0)})}},Bd=function(e,t){if(ma&&!e){_s(_n,"scrollEnd",$P);return}Ya=_n.isRefreshing=!0,An.forEach(function(o){return Xs(o)&&o.cacheID++&&(o.rec=o())});var i=Kd("refreshInit");GP&&_n.sort(),t||mB(),An.forEach(function(o){Xs(o)&&(o.smooth&&(o.target.style.scrollBehavior="auto"),o(0))}),dn.slice(0).forEach(function(o){return o.refresh()}),dn.forEach(function(o,u){if(o._subPinOffset&&o.pin){var h=o.vars.horizontal?"offsetWidth":"offsetHeight",r=o.pin[h];o.revert(!0,1),o.adjustPinSpacing(o.pin[h]-r),o.revert(!1,1)}}),dn.forEach(function(o){return o.vars.end==="max"&&o.setPositions(o.start,Math.max(o.start+1,Yu(o.scroller,o._dir)))}),i.forEach(function(o){return o&&o.render&&o.render(-1)}),An.forEach(function(o){Xs(o)&&(o.smooth&&requestAnimationFrame(function(){return o.target.style.scrollBehavior="smooth"}),o.rec&&o(o.rec))}),tk(dB,1),kx.pause(),Ud++,lh(2),dn.forEach(function(o){return Xs(o.vars.onRefresh)&&o.vars.onRefresh(o)}),Ya=_n.isRefreshing=!1,Kd("refresh")},hD=0,lx=1,D_,lh=function(e){if(!Ya||e===2){_n.isUpdating=!0,D_&&D_.update(0);var t=dn.length,i=Ks(),o=i-HC>=50,u=t&&dn[0].scroll();if(lx=hD>u?-1:1,hD=u,o&&(ma&&!m1&&i-ma>200&&(ma=0,Kd("scrollEnd")),rx=HC,HC=i),lx<0){for(qs=t;qs-- >0;)dn[qs]&&dn[qs].update(0,o);lx=1}else for(qs=0;qs<t;qs++)dn[qs]&&dn[qs].update(0,o);_n.isUpdating=!1}t0=0},Fw=[JP,XP,pB,fB,oa+T_,oa+B_,oa+M_,oa+S_,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],cx=Fw.concat([Nd,zd,"boxSizing","max"+MA,"max"+AB,"position",oa,Dr,Dr+M_,Dr+B_,Dr+T_,Dr+S_]),$8=function(e,t,i){sA(i);var o=e._gsap;if(o.spacerIsNative)sA(o.spacerState);else if(e._gsap.swappedIn){var u=t.parentNode;u&&(u.insertBefore(e,t),u.removeChild(t))}e._gsap.swappedIn=!1},YC=function(e,t,i,o){if(!e._gsap.swappedIn){for(var u=Fw.length,h=t.style,r=e.style,p;u--;)p=Fw[u],h[p]=i[p];h.position=i.position==="absolute"?"absolute":"relative",i.display==="inline"&&(h.display="inline-block"),r[pB]=r[fB]="auto",h.flexBasis=i.flexBasis||"auto",h.overflow="visible",h.boxSizing="border-box",h[Nd]=Pw(e,Js)+ms,h[zd]=Pw(e,Zr)+ms,h[Dr]=r[oa]=r[XP]=r[JP]="0",sA(o),r[Nd]=r["max"+MA]=i[Nd],r[zd]=r["max"+AB]=i[zd],r[Dr]=i[Dr],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},eH=/([A-Z])/g,sA=function(e){if(e){var t=e.t.style,i=e.length,o=0,u,h;for((e.t._gsap||Fi.core.getCache(e.t)).uncache=1;o<i;o+=2)h=e[o+1],u=e[o],h?t[u]=h:t[u]&&t.removeProperty(u.replace(eH,"-$1").toLowerCase())}},dv=function(e){for(var t=cx.length,i=e.style,o=[],u=0;u<t;u++)o.push(cx[u],i[cx[u]]);return o.t=e,o},tH=function(e,t,i){for(var o=[],u=e.length,h=i?8:0,r;h<u;h+=2)r=e[h],o.push(r,r in t?t[r]:e[h+1]);return o.t=e.t,o},ux={left:0,top:0},dD=function(e,t,i,o,u,h,r,p,g,v,I,C,E){Xs(e)&&(e=e(p)),Wa(e)&&e.substr(0,3)==="max"&&(e=C+(e.charAt(4)==="="?ox("0"+e.substr(3),i):0));var Q=E?E.time():0,M,D,P;if(E&&E.seek(0),i_(e))r&&ax(r,i,o,!0);else{Xs(t)&&(t=t(p));var O=(e||"0").split(" "),F,N,z,X;P=uo(t)||wr,F=_c(P)||{},(!F||!F.left&&!F.top)&&Ja(P).display==="none"&&(X=P.style.display,P.style.display="block",F=_c(P),X?P.style.display=X:P.style.removeProperty("display")),N=ox(O[0],F[o.d]),z=ox(O[1]||"0",i),e=F[o.p]-g[o.p]-v+N+u-z,r&&ax(r,z,o,i-z<20||r._isStart&&z>20),i-=i-z}if(h){var q=e+i,H=h._isStart;M="scroll"+o.d2,ax(h,q,o,H&&q>20||!H&&(I?Math.max(wr[M],qa[M]):h.parentNode[M])<=q+1),I&&(g=_c(r),I&&(h.style[o.op.p]=g[o.op.p]-o.op.m-h._offset+ms))}return E&&P&&(M=_c(P),E.seek(C),D=_c(P),E._caScrollDist=M[o.p]-D[o.p],e=e/E._caScrollDist*C),E&&E.seek(Q),E?e:Math.round(e)},iH=/(webkit|moz|length|cssText|inset)/i,fD=function(e,t,i,o){if(e.parentNode!==t){var u=e.style,h,r;if(t===wr){e._stOrig=u.cssText,r=Ja(e);for(h in r)!+h&&!iH.test(h)&&r[h]&&typeof u[h]=="string"&&h!=="0"&&(u[h]=r[h]);u.top=i,u.left=o}else u.cssText=e._stOrig;Fi.core.getCache(e).uncache=1,t.appendChild(e)}},pD=function(e,t){var i=ah(e,t),o="_scroll"+t.p2,u,h,r=function p(g,v,I,C,E){var Q=p.tween,M=v.onComplete,D={};return I=I||i(),E=C&&E||0,C=C||g-I,Q&&Q.kill(),u=Math.round(I),v[o]=g,v.modifiers=D,D[o]=function(P){return P=Math.round(i()),P!==u&&P!==h&&Math.abs(P-u)>3&&Math.abs(P-h)>3?(Q.kill(),p.tween=0):P=I+C*Q.ratio+E*Q.ratio*Q.ratio,h=u,u=Math.round(P)},v.onUpdate=function(){An.cache++,lh()},v.onComplete=function(){p.tween=0,M&&M.call(Q)},Q=p.tween=Fi.to(e,v),Q};return e[o]=i,i.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},_s(e,"wheel",i.wheelHandler),r},_n=function(){function n(t,i){kp||n.register(Fi)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(t,i)}var e=n.prototype;return e.init=function(i,o){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!ov){this.update=this.refresh=this.kill=yl;return}i=aD(Wa(i)||i_(i)||i.nodeType?{trigger:i}:i,uv);var u=i,h=u.onUpdate,r=u.toggleClass,p=u.id,g=u.onToggle,v=u.onRefresh,I=u.scrub,C=u.trigger,E=u.pin,Q=u.pinSpacing,M=u.invalidateOnRefresh,D=u.anticipatePin,P=u.onScrubComplete,O=u.onSnapComplete,F=u.once,N=u.snap,z=u.pinReparent,X=u.pinSpacer,q=u.containerAnimation,H=u.fastScrollEnd,W=u.preventOverlaps,se=i.horizontal||i.containerAnimation&&i.horizontal!==!1?Js:Zr,de=!I&&I!==0,te=uo(i.scroller||vn),ce=Fi.core.getCache(te),Ee=jd(te),Be=("pinType"in i?i.pinType:Zu(te,"pinType")||Ee&&"fixed")==="fixed",De=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],Re=de&&i.toggleActions.split(" "),ye="markers"in i?i.markers:uv.markers,ht=Ee?0:parseFloat(Ja(te)["border"+se.p2+MA])||0,oe=this,Tt=i.onRefreshInit&&function(){return i.onRefreshInit(oe)},Fe=Y8(te,Ee,se),st=j8(te,Ee),Et=0,Ke=0,Ne=ah(te,se),dt,xt,ft,Ve,Ye,ae,_e,Ze,nt,ut,ze,Qt,mt,Ut,Dt,Ie,ue,at,St,yt,Pt,Ot,Ue,ot,ni,fi,Xt,_i,si,wt,kt,yi,ee,J,Z,Ae,Ce,Le,Oe;if(Lw(oe),oe._dir=se,D*=45,oe.scroller=te,oe.scroll=q?q.time.bind(q):Ne,Ve=Ne(),oe.vars=i,o=o||i.animation,"refreshPriority"in i&&(GP=1,i.refreshPriority===-9999&&(D_=oe)),ce.tweenScroll=ce.tweenScroll||{top:pD(te,Zr),left:pD(te,Js)},oe.tweenTo=dt=ce.tweenScroll[se.p],oe.scrubDuration=function(Qe){yi=i_(Qe)&&Qe,yi?kt?kt.duration(Qe):kt=Fi.to(o,{ease:"expo",totalProgress:"+=0.001",duration:yi,paused:!0,onComplete:function(){return P&&P(oe)}}):(kt&&kt.progress(1).kill(),kt=0)},o&&(o.vars.lazy=!1,o._initted||o.vars.immediateRender!==!1&&i.immediateRender!==!1&&o.duration()&&o.render(0,!0,!0),oe.animation=o.pause(),o.scrollTrigger=oe,oe.scrubDuration(I),si=0,p||(p=o.vars.id)),dn.push(oe),N&&((!sx(N)||N.push)&&(N={snapTo:N}),"scrollBehavior"in wr.style&&Fi.set(Ee?[wr,qa]:te,{scrollBehavior:"auto"}),An.forEach(function(Qe){return Xs(Qe)&&Qe.target===(Ee?fr.scrollingElement||qa:te)&&(Qe.smooth=!1)}),ft=Xs(N.snapTo)?N.snapTo:N.snapTo==="labels"?K8(o):N.snapTo==="labelsDirectional"?J8(o):N.directional!==!1?function(Qe,Je){return gB(N.snapTo)(Qe,Ks()-Ke<500?0:Je.direction)}:Fi.utils.snap(N.snapTo),ee=N.duration||{min:.1,max:2},ee=sx(ee)?Vp(ee.min,ee.max):Vp(ee,ee),J=Fi.delayedCall(N.delay||yi/2||.1,function(){var Qe=Ne(),Je=Ks()-Ke<500,Xe=dt.tween;if((Je||Math.abs(oe.getVelocity())<10)&&!Xe&&!m1&&Et!==Qe){var Ft=(Qe-ae)/mt,Wt=o&&!de?o.totalProgress():Ft,qt=Je?0:(Wt-wt)/(Ks()-rx)*1e3||0,pe=Fi.utils.clamp(-Ft,1-Ft,fp(qt/2)*qt/.185),je=Ft+(N.inertia===!1?0:pe),pt=Vp(0,1,ft(je,oe)),it=Math.round(ae+pt*mt),Ct=N,li=Ct.onStart,Ai=Ct.onInterrupt,oi=Ct.onComplete;if(Qe<=_e&&Qe>=ae&&it!==Qe){if(Xe&&!Xe._initted&&Xe.data<=fp(it-Qe))return;N.inertia===!1&&(pe=pt-Ft),dt(it,{duration:ee(fp(Math.max(fp(je-Wt),fp(pt-Wt))*.185/qt/.05||0)),ease:N.ease||"power3",data:fp(it-Qe),onInterrupt:function(){return J.restart(!0)&&Ai&&Ai(oe)},onComplete:function(){oe.update(),Et=Ne(),si=wt=o&&!de?o.totalProgress():oe.progress,O&&O(oe),oi&&oi(oe)}},Qe,pe*mt,it-Qe-pe*mt),li&&li(oe,dt.tween)}}else oe.isActive&&Et!==Qe&&J.restart(!0)}).pause()),p&&(kw[p]=oe),C=oe.trigger=uo(C||E),Oe=C&&C._gsap&&C._gsap.stRevert,Oe&&(Oe=Oe(oe)),E=E===!0?C:uo(E),Wa(r)&&(r={targets:C,className:r}),E&&(Q===!1||Q===oa||(Q=!Q&&E.parentNode&&E.parentNode.style&&Ja(E.parentNode).display==="flex"?!1:Dr),oe.pin=E,xt=Fi.core.getCache(E),xt.spacer?Ut=xt.pinState:(X&&(X=uo(X),X&&!X.nodeType&&(X=X.current||X.nativeElement),xt.spacerIsNative=!!X,X&&(xt.spacerState=dv(X))),xt.spacer=ue=X||fr.createElement("div"),ue.classList.add("pin-spacer"),p&&ue.classList.add("pin-spacer-"+p),xt.pinState=Ut=dv(E)),i.force3D!==!1&&Fi.set(E,{force3D:!0}),oe.spacer=ue=xt.spacer,_i=Ja(E),Ue=_i[Q+se.os2],St=Fi.getProperty(E),yt=Fi.quickSetter(E,se.a,ms),YC(E,ue,_i),Ie=dv(E)),ye){Qt=sx(ye)?aD(ye,lD):lD,ut=hv("scroller-start",p,te,se,Qt,0),ze=hv("scroller-end",p,te,se,Qt,0,ut),at=ut["offset"+se.op.d2];var le=uo(Zu(te,"content")||te);Ze=this.markerStart=hv("start",p,le,se,Qt,at,0,q),nt=this.markerEnd=hv("end",p,le,se,Qt,at,0,q),q&&(Le=Fi.quickSetter([Ze,nt],se.a,ms)),!Be&&!(Tl.length&&Zu(te,"fixedMarkers")===!0)&&(q8(Ee?wr:te),Fi.set([ut,ze],{force3D:!0}),ni=Fi.quickSetter(ut,se.a,ms),Xt=Fi.quickSetter(ze,se.a,ms))}if(q){var me=q.vars.onUpdate,he=q.vars.onUpdateParams;q.eventCallback("onUpdate",function(){oe.update(0,0,1),me&&me.apply(he||[])})}oe.previous=function(){return dn[dn.indexOf(oe)-1]},oe.next=function(){return dn[dn.indexOf(oe)+1]},oe.revert=function(Qe,Je){if(!Je)return oe.kill(!0);var Xe=Qe!==!1||!oe.enabled,Ft=Ls;Xe!==oe.isReverted&&(Xe&&(Ae=Math.max(Ne(),oe.scroll.rec||0),Z=oe.progress,Ce=o&&o.progress()),Ze&&[Ze,nt,ut,ze].forEach(function(Wt){return Wt.style.display=Xe?"none":"block"}),Xe&&(Ls=1,oe.update(Xe)),E&&(!z||!oe.isActive)&&(Xe?$8(E,ue,Ut):YC(E,ue,Ja(E),ot)),Xe||oe.update(Xe),Ls=Ft,oe.isReverted=Xe)},oe.refresh=function(Qe,Je){if(!((Ls||!oe.enabled)&&!Je)){if(E&&Qe&&ma){_s(n,"scrollEnd",$P);return}!Ya&&Tt&&Tt(oe),Ls=1,Ke=Ks(),dt.tween&&(dt.tween.kill(),dt.tween=0),kt&&kt.pause(),M&&o&&o.revert({kill:!1}).invalidate(),oe.isReverted||oe.revert(!0,!0),oe._subPinOffset=!1;for(var Xe=Fe(),Ft=st(),Wt=q?q.duration():Yu(te,se),qt=0,pe=0,je=i.end,pt=i.endTrigger||C,it=i.start||(i.start===0||!C?0:E?"0 0":"0 100%"),Ct=oe.pinnedContainer=i.pinnedContainer&&uo(i.pinnedContainer),li=C&&Math.max(0,dn.indexOf(oe))||0,Ai=li,oi,ci,zi,Pi,Li,xi,Gn,Sr,Es,wn,ki;Ai--;)xi=dn[Ai],xi.end||xi.refresh(0,1)||(Ls=1),Gn=xi.pin,Gn&&(Gn===C||Gn===E)&&!xi.isReverted&&(wn||(wn=[]),wn.unshift(xi),xi.revert(!0,!0)),xi!==dn[Ai]&&(li--,Ai--);for(Xs(it)&&(it=it(oe)),ae=dD(it,C,Xe,se,Ne(),Ze,ut,oe,Ft,ht,Be,Wt,q)||(E?-.001:0),Xs(je)&&(je=je(oe)),Wa(je)&&!je.indexOf("+=")&&(~je.indexOf(" ")?je=(Wa(it)?it.split(" ")[0]:"")+je:(qt=ox(je.substr(2),Xe),je=Wa(it)?it:ae+qt,pt=C)),_e=Math.max(ae,dD(je||(pt?"100% 0":Wt),pt,Xe,se,Ne()+qt,nt,ze,oe,Ft,ht,Be,Wt,q))||-.001,mt=_e-ae||(ae-=.01)&&.001,qt=0,Ai=li;Ai--;)xi=dn[Ai],Gn=xi.pin,Gn&&xi.start-xi._pinPush<=ae&&!q&&xi.end>0&&(oi=xi.end-xi.start,(Gn===C&&xi.start-xi._pinPush<ae||Gn===Ct)&&!i_(it)&&(qt+=oi*(1-xi.progress)),Gn===E&&(pe+=oi));if(ae+=qt,_e+=qt,oe._pinPush=pe,Ze&&qt&&(oi={},oi[se.a]="+="+qt,Ct&&(oi[se.p]="-="+Ne()),Fi.set([Ze,nt],oi)),E)oi=Ja(E),Pi=se===Zr,zi=Ne(),Pt=parseFloat(St(se.a))+pe,!Wt&&_e>1&&(ki=(Ee?fr.scrollingElement||qa:te).style,ki={style:ki,value:ki["overflow"+se.a.toUpperCase()]},ki["overflow"+se.a.toUpperCase()]="scroll"),YC(E,ue,oi),Ie=dv(E),ci=_c(E,!0),Sr=Be&&ah(te,Pi?Js:Zr)(),Q&&(ot=[Q+se.os2,mt+pe+ms],ot.t=ue,Ai=Q===Dr?Pw(E,se)+mt+pe:0,Ai&&ot.push(se.d,Ai+ms),sA(ot),Ct&&dn.forEach(function(Mr){Mr.pin===Ct&&Mr.vars.pinSpacing!==!1&&(Mr._subPinOffset=!0)}),Be&&Ne(Ae)),Be&&(Li={top:ci.top+(Pi?zi-ae:Sr)+ms,left:ci.left+(Pi?Sr:zi-ae)+ms,boxSizing:"border-box",position:"fixed"},Li[Nd]=Li["max"+MA]=Math.ceil(ci.width)+ms,Li[zd]=Li["max"+AB]=Math.ceil(ci.height)+ms,Li[oa]=Li[oa+M_]=Li[oa+B_]=Li[oa+T_]=Li[oa+S_]="0",Li[Dr]=oi[Dr],Li[Dr+M_]=oi[Dr+M_],Li[Dr+B_]=oi[Dr+B_],Li[Dr+T_]=oi[Dr+T_],Li[Dr+S_]=oi[Dr+S_],Dt=tH(Ut,Li,z),Ya&&Ne(0)),o?(Es=o._initted,OC(1),o.render(o.duration(),!0,!0),Ot=St(se.a)-Pt+mt+pe,fi=Math.abs(mt-Ot)>1,Be&&fi&&Dt.splice(Dt.length-2,2),o.render(0,!0,!0),Es||o.invalidate(!0),o.parent||o.totalTime(o.totalTime()),OC(0)):Ot=mt,ki&&(ki.value?ki.style["overflow"+se.a.toUpperCase()]=ki.value:ki.style.removeProperty("overflow-"+se.a));else if(C&&Ne()&&!q)for(ci=C.parentNode;ci&&ci!==wr;)ci._pinOffset&&(ae-=ci._pinOffset,_e-=ci._pinOffset),ci=ci.parentNode;wn&&wn.forEach(function(Mr){return Mr.revert(!1,!0)}),oe.start=ae,oe.end=_e,Ve=Ye=Ya?Ae:Ne(),!q&&!Ya&&(Ve<Ae&&Ne(Ae),oe.scroll.rec=0),oe.revert(!1,!0),J&&(Et=-1,oe.isActive&&Ne(ae+mt*Z),J.restart(!0)),Ls=0,o&&de&&(o._initted||Ce)&&o.progress()!==Ce&&o.progress(Ce,!0).render(o.time(),!0,!0),(Z!==oe.progress||q)&&(o&&!de&&o.totalProgress(Z,!0),oe.progress=(Ve-ae)/mt===Z?0:Z),E&&Q&&(ue._pinOffset=Math.round(oe.progress*Ot)),v&&!Ya&&v(oe)}},oe.getVelocity=function(){return(Ne()-Ye)/(Ks()-rx)*1e3||0},oe.endAnimation=function(){Sm(oe.callbackAnimation),o&&(kt?kt.progress(1):o.paused()?de||Sm(o,oe.direction<0,1):Sm(o,o.reversed()))},oe.labelToScroll=function(Qe){return o&&o.labels&&(ae||oe.refresh()||ae)+o.labels[Qe]/o.duration()*mt||0},oe.getTrailing=function(Qe){var Je=dn.indexOf(oe),Xe=oe.direction>0?dn.slice(0,Je).reverse():dn.slice(Je+1);return(Wa(Qe)?Xe.filter(function(Ft){return Ft.vars.preventOverlaps===Qe}):Xe).filter(function(Ft){return oe.direction>0?Ft.end<=ae:Ft.start>=_e})},oe.update=function(Qe,Je,Xe){if(!(q&&!Xe&&!Qe)){var Ft=Ya?Ae:oe.scroll(),Wt=Qe?0:(Ft-ae)/mt,qt=Wt<0?0:Wt>1?1:Wt||0,pe=oe.progress,je,pt,it,Ct,li,Ai,oi,ci;if(Je&&(Ye=Ve,Ve=q?Ne():Ft,N&&(wt=si,si=o&&!de?o.totalProgress():qt)),D&&!qt&&E&&!Ls&&!sv&&ma&&ae<Ft+(Ft-Ye)/(Ks()-rx)*D&&(qt=1e-4),qt!==pe&&oe.enabled){if(je=oe.isActive=!!qt&&qt<1,pt=!!pe&&pe<1,Ai=je!==pt,li=Ai||!!qt!=!!pe,oe.direction=qt>pe?1:-1,oe.progress=qt,li&&!Ls&&(it=qt&&!pe?0:qt===1?1:pe===1?2:3,de&&(Ct=!Ai&&Re[it+1]!=="none"&&Re[it+1]||Re[it],ci=o&&(Ct==="complete"||Ct==="reset"||Ct in o))),W&&(Ai||ci)&&(ci||I||!o)&&(Xs(W)?W(oe):oe.getTrailing(W).forEach(function(xi){return xi.endAnimation()})),de||(kt&&!Ls&&!sv?(kt._dp._time-kt._start!==kt._time&&kt.render(kt._dp._time-kt._start),kt.resetTo?kt.resetTo("totalProgress",qt,o._tTime/o._tDur):(kt.vars.totalProgress=qt,kt.invalidate().restart())):o&&o.totalProgress(qt,!!Ls)),E){if(Qe&&Q&&(ue.style[Q+se.os2]=Ue),!Be)yt(t_(Pt+Ot*qt));else if(li){if(oi=!Qe&&qt>pe&&_e+1>Ft&&Ft+1>=Yu(te,se),z)if(!Qe&&(je||oi)){var zi=_c(E,!0),Pi=Ft-ae;fD(E,wr,zi.top+(se===Zr?Pi:0)+ms,zi.left+(se===Zr?0:Pi)+ms)}else fD(E,ue);sA(je||oi?Dt:Ie),fi&&qt<1&&je||yt(Pt+(qt===1&&!oi?Ot:0))}}N&&!dt.tween&&!Ls&&!sv&&J.restart(!0),r&&(Ai||F&&qt&&(qt<1||!GC))&&Fx(r.targets).forEach(function(xi){return xi.classList[je||F?"add":"remove"](r.className)}),h&&!de&&!Qe&&h(oe),li&&!Ls?(de&&(ci&&(Ct==="complete"?o.pause().totalProgress(1):Ct==="reset"?o.restart(!0).pause():Ct==="restart"?o.restart(!0):o[Ct]()),h&&h(oe)),(Ai||!GC)&&(g&&Ai&&VC(oe,g),De[it]&&VC(oe,De[it]),F&&(qt===1?oe.kill(!1,1):De[it]=0),Ai||(it=qt===1?1:3,De[it]&&VC(oe,De[it]))),H&&!je&&Math.abs(oe.getVelocity())>(i_(H)?H:2500)&&(Sm(oe.callbackAnimation),kt?kt.progress(1):Sm(o,Ct==="reverse"?1:!qt,1))):de&&h&&!Ls&&h(oe)}if(Xt){var Li=q?Ft/q.duration()*(q._caScrollDist||0):Ft;ni(Li+(ut._isFlipped?1:0)),Xt(Li)}Le&&Le(-Ft/q.duration()*(q._caScrollDist||0))}},oe.enable=function(Qe,Je){oe.enabled||(oe.enabled=!0,_s(te,"resize",n_),_s(Ee?fr:te,"scroll",pp),Tt&&_s(n,"refreshInit",Tt),Qe!==!1&&(oe.progress=Z=0,Ve=Ye=Et=Ne()),Je!==!1&&oe.refresh())},oe.getTween=function(Qe){return Qe&&dt?dt.tween:kt},oe.setPositions=function(Qe,Je){E&&(Pt+=Qe-ae,Ot+=Je-Qe-mt,Q===Dr&&oe.adjustPinSpacing(Je-Qe-mt)),oe.start=ae=Qe,oe.end=_e=Je,mt=Je-Qe,oe.update()},oe.adjustPinSpacing=function(Qe){if(ot){var Je=ot.indexOf(se.d)+1;ot[Je]=parseFloat(ot[Je])+Qe+ms,ot[1]=parseFloat(ot[1])+Qe+ms,sA(ot)}},oe.disable=function(Qe,Je){if(oe.enabled&&(Qe!==!1&&oe.revert(!0,!0),oe.enabled=oe.isActive=!1,Je||kt&&kt.pause(),Ae=0,xt&&(xt.uncache=1),Tt&&cs(n,"refreshInit",Tt),J&&(J.pause(),dt.tween&&dt.tween.kill()&&(dt.tween=0)),!Ee)){for(var Xe=dn.length;Xe--;)if(dn[Xe].scroller===te&&dn[Xe]!==oe)return;cs(te,"resize",n_),cs(te,"scroll",pp)}},oe.kill=function(Qe,Je){oe.disable(Qe,Je),kt&&!Je&&kt.kill(),p&&delete kw[p];var Xe=dn.indexOf(oe);Xe>=0&&dn.splice(Xe,1),Xe===qs&&lx>0&&qs--,Xe=0,dn.forEach(function(Ft){return Ft.scroller===oe.scroller&&(Xe=1)}),Xe||Ya||(oe.scroll.rec=0),o&&(o.scrollTrigger=null,Qe&&o.revert({kill:!1}),Je||o.kill()),Ze&&[Ze,nt,ut,ze].forEach(function(Ft){return Ft.parentNode&&Ft.parentNode.removeChild(Ft)}),D_===oe&&(D_=0),E&&(xt&&(xt.uncache=1),Xe=0,dn.forEach(function(Ft){return Ft.pin===E&&Xe++}),Xe||(xt.spacer=0)),i.onKill&&i.onKill(oe)},oe.enable(!1,!1),Oe&&Oe(oe),!o||!o.add||mt?oe.refresh():Fi.delayedCall(.01,function(){return ae||_e||oe.refresh()})&&(mt=.01)&&(ae=_e=0),E&&Z8()},n.register=function(i){return kp||(Fi=i||qP(),jP()&&window.document&&n.enable(),kp=ov),kp},n.defaults=function(i){if(i)for(var o in i)uv[o]=i[o];return uv},n.disable=function(i,o){ov=0,dn.forEach(function(h){return h[o?"kill":"disable"](i)}),cs(vn,"wheel",pp),cs(fr,"scroll",pp),clearInterval(rv),cs(fr,"touchcancel",yl),cs(wr,"touchstart",yl),lv(cs,fr,"pointerdown,touchstart,mousedown",sD),lv(cs,fr,"pointerup,touchend,mouseup",oD),kx.kill(),av(cs);for(var u=0;u<An.length;u+=3)cv(cs,An[u],An[u+1]),cv(cs,An[u],An[u+2])},n.enable=function(){if(vn=window,fr=document,qa=fr.documentElement,wr=fr.body,Fi&&(Fx=Fi.utils.toArray,Vp=Fi.utils.clamp,Lw=Fi.core.context||yl,OC=Fi.core.suppressOverwrites||yl,dB=vn.history.scrollRestoration||"auto",Fi.core.globals("ScrollTrigger",n),wr)){ov=1,Vr.register(Fi),n.isTouch=Vr.isTouch,Qu=Vr.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),_s(vn,"wheel",pp),OP=[vn,fr,qa,wr],Fi.matchMedia?(n.matchMedia=function(p){var g=Fi.matchMedia(),v;for(v in p)g.add(v,p[v]);return g},Fi.addEventListener("matchMediaInit",function(){return mB()}),Fi.addEventListener("matchMediaRevert",function(){return ek()}),Fi.addEventListener("matchMedia",function(){Bd(0,1),Kd("matchMedia")}),Fi.matchMedia("(orientation: portrait)",function(){return WC(),WC})):console.warn("Requires GSAP 3.11.0 or later"),WC(),_s(fr,"scroll",pp);var i=wr.style,o=i.borderTopStyle,u=Fi.core.Animation.prototype,h,r;for(u.revert||Object.defineProperty(u,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",h=_c(wr),Zr.m=Math.round(h.top+Zr.sc())||0,Js.m=Math.round(h.left+Js.sc())||0,o?i.borderTopStyle=o:i.removeProperty("border-top-style"),rv=setInterval(cD,250),Fi.delayedCall(.5,function(){return sv=0}),_s(fr,"touchcancel",yl),_s(wr,"touchstart",yl),lv(_s,fr,"pointerdown,touchstart,mousedown",sD),lv(_s,fr,"pointerup,touchend,mouseup",oD),Rw=Fi.utils.checkPrefix("transform"),cx.push(Rw),kp=Ks(),kx=Fi.delayedCall(.2,Bd).pause(),Fp=[fr,"visibilitychange",function(){var p=vn.innerWidth,g=vn.innerHeight;fr.hidden?(nD=p,rD=g):(nD!==p||rD!==g)&&n_()},fr,"DOMContentLoaded",Bd,vn,"load",Bd,vn,"resize",n_],av(_s),dn.forEach(function(p){return p.enable(0,1)}),r=0;r<An.length;r+=3)cv(cs,An[r],An[r+1]),cv(cs,An[r],An[r+2])}},n.config=function(i){"limitCallbacks"in i&&(GC=!!i.limitCallbacks);var o=i.syncInterval;o&&clearInterval(rv)||(rv=o)&&setInterval(cD,o),"ignoreMobileResize"in i&&(VP=n.isTouch===1&&i.ignoreMobileResize),"autoRefreshEvents"in i&&(av(cs)||av(_s,i.autoRefreshEvents||"none"),HP=(i.autoRefreshEvents+"").indexOf("resize")===-1)},n.scrollerProxy=function(i,o){var u=uo(i),h=An.indexOf(u),r=jd(u);~h&&An.splice(h,r?6:2),o&&(r?Tl.unshift(vn,o,wr,o,qa,o):Tl.unshift(u,o))},n.clearMatchMedia=function(i){dn.forEach(function(o){return o._ctx&&o._ctx.query===i&&o._ctx.kill(!0,!0)})},n.isInViewport=function(i,o,u){var h=(Wa(i)?uo(i):i).getBoundingClientRect(),r=h[u?Nd:zd]*o||0;return u?h.right-r>0&&h.left+r<vn.innerWidth:h.bottom-r>0&&h.top+r<vn.innerHeight},n.positionInViewport=function(i,o,u){Wa(i)&&(i=uo(i));var h=i.getBoundingClientRect(),r=h[u?Nd:zd],p=o==null?r/2:o in Nx?Nx[o]*r:~o.indexOf("%")?parseFloat(o)*r/100:parseFloat(o)||0;return u?(h.left+p)/vn.innerWidth:(h.top+p)/vn.innerHeight},n.killAll=function(i){if(dn.slice(0).forEach(function(u){return u.vars.id!=="ScrollSmoother"&&u.kill()}),i!==!0){var o=qd.killAll||[];qd={},o.forEach(function(u){return u()})}},n}();_n.version="3.11.4";_n.saveStyles=function(n){return n?Fx(n).forEach(function(e){if(e&&e.style){var t=Do.indexOf(e);t>=0&&Do.splice(t,5),Do.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),Fi.core.getCache(e),Lw())}}):Do};_n.revert=function(n,e){return mB(!n,e)};_n.create=function(n,e){return new _n(n,e)};_n.refresh=function(n){return n?n_():(kp||_n.register())&&Bd(!0)};_n.update=function(n){return++An.cache&&lh(n===!0?2:0)};_n.clearScrollMemory=tk;_n.maxScroll=function(n,e){return Yu(n,e?Js:Zr)};_n.getScrollFunc=function(n,e){return ah(uo(n),e?Js:Zr)};_n.getById=function(n){return kw[n]};_n.getAll=function(){return dn.filter(function(n){return n.vars.id!=="ScrollSmoother"})};_n.isScrolling=function(){return!!ma};_n.snapDirectional=gB;_n.addEventListener=function(n,e){var t=qd[n]||(qd[n]=[]);~t.indexOf(e)||t.push(e)};_n.removeEventListener=function(n,e){var t=qd[n],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};_n.batch=function(n,e){var t=[],i={},o=e.interval||.016,u=e.batchMax||1e9,h=function(g,v){var I=[],C=[],E=Fi.delayedCall(o,function(){v(I,C),I=[],C=[]}).pause();return function(Q){I.length||E.restart(!0),I.push(Q.trigger),C.push(Q),u<=I.length&&E.progress(1)}},r;for(r in e)i[r]=r.substr(0,2)==="on"&&Xs(e[r])&&r!=="onRefreshInit"?h(r,e[r]):e[r];return Xs(u)&&(u=u(),_s(_n,"refresh",function(){return u=e.batchMax()})),Fx(n).forEach(function(p){var g={};for(r in i)g[r]=i[r];g.trigger=p,t.push(_n.create(g))}),t};var AD=function(e,t,i,o){return t>o?e(o):t<0&&e(0),i>o?(o-t)/(i-t):i<0?t/(t-i):1},jC=function n(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Vr.isTouch?" pinch-zoom":""):"none",e===qa&&n(wr,t)},fv={auto:1,scroll:1},nH=function(e){var t=e.event,i=e.target,o=e.axis,u=(t.changedTouches?t.changedTouches[0]:t).target,h=u._gsap||Fi.core.getCache(u),r=Ks(),p;if(!h._isScrollT||r-h._isScrollT>2e3){for(;u&&u!==wr&&(u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth||!(fv[(p=Ja(u)).overflowY]||fv[p.overflowX]));)u=u.parentNode;h._isScroll=u&&u!==i&&!jd(u)&&(fv[(p=Ja(u)).overflowY]||fv[p.overflowX]),h._isScrollT=r}(h._isScroll||o==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},ik=function(e,t,i,o){return Vr.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:o=o&&nH,onPress:o,onDrag:o,onScroll:o,onEnable:function(){return i&&_s(fr,Vr.eventTypes[0],mD,!1,!0)},onDisable:function(){return cs(fr,Vr.eventTypes[0],mD,!0)}})},rH=/(input|label|select|textarea)/i,gD,mD=function(e){var t=rH.test(e.target.tagName);(t||gD)&&(e._gsapAllow=!0,gD=t)},sH=function(e){sx(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,i=t.normalizeScrollX,o=t.momentum,u=t.allowNestedScroll,h,r,p=uo(e.target)||qa,g=Fi.core.globals().ScrollSmoother,v=g&&g.get(),I=Qu&&(e.content&&uo(e.content)||v&&e.content!==!1&&!v.smooth()&&v.content()),C=ah(p,Zr),E=ah(p,Js),Q=1,M=(Vr.isTouch&&vn.visualViewport?vn.visualViewport.scale*vn.visualViewport.width:vn.outerWidth)/vn.innerWidth,D=0,P=Xs(o)?function(){return o(h)}:function(){return o||2.8},O,F,N=ik(p,e.type,!0,u),z=function(){return F=!1},X=yl,q=yl,H=function(){r=Yu(p,Zr),q=Vp(Qu?1:0,r),i&&(X=Vp(0,Yu(p,Js))),O=Ud},W=function(){I._gsap.y=t_(parseFloat(I._gsap.y)+C.offset)+"px",I.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(I._gsap.y)+", 0, 1)",C.offset=C.cacheID=0},se=function(){if(F){requestAnimationFrame(z);var Re=t_(h.deltaY/2),ye=q(C.v-Re);if(I&&ye!==C.v+C.offset){C.offset=ye-C.v;var ht=t_((parseFloat(I&&I._gsap.y)||0)-C.offset);I.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+ht+", 0, 1)",I._gsap.y=ht+"px",C.cacheID=An.cache,lh()}return!0}C.offset&&W(),F=!0},de,te,ce,Ee,Be=function(){H(),de.isActive()&&de.vars.scrollY>r&&(C()>r?de.progress(1)&&C(r):de.resetTo("scrollY",r))};return I&&Fi.set(I,{y:"+=0"}),e.ignoreCheck=function(De){return Qu&&De.type==="touchmove"&&se()||Q>1.05&&De.type!=="touchstart"||h.isGesturing||De.touches&&De.touches.length>1},e.onPress=function(){var De=Q;Q=t_((vn.visualViewport&&vn.visualViewport.scale||1)/M),de.pause(),De!==Q&&jC(p,Q>1.01?!0:i?!1:"x"),te=E(),ce=C(),H(),O=Ud},e.onRelease=e.onGestureStart=function(De,Re){if(C.offset&&W(),!Re)Ee.restart(!0);else{An.cache++;var ye=P(),ht,oe;i&&(ht=E(),oe=ht+ye*.05*-De.velocityX/.227,ye*=AD(E,ht,oe,Yu(p,Js)),de.vars.scrollX=X(oe)),ht=C(),oe=ht+ye*.05*-De.velocityY/.227,ye*=AD(C,ht,oe,Yu(p,Zr)),de.vars.scrollY=q(oe),de.invalidate().duration(ye).play(.01),(Qu&&de.vars.scrollY>=r||ht>=r-1)&&Fi.to({},{onUpdate:Be,duration:ye})}},e.onWheel=function(){de._ts&&de.pause(),Ks()-D>1e3&&(O=0,D=Ks())},e.onChange=function(De,Re,ye,ht,oe){if(Ud!==O&&H(),Re&&i&&E(X(ht[2]===Re?te+(De.startX-De.x):E()+Re-ht[1])),ye){C.offset&&W();var Tt=oe[2]===ye,Fe=Tt?ce+De.startY-De.y:C()+ye-oe[1],st=q(Fe);Tt&&Fe!==st&&(ce+=st-Fe),C(st)}(ye||Re)&&lh()},e.onEnable=function(){jC(p,i?!1:"x"),_n.addEventListener("refresh",Be),_s(vn,"resize",Be),C.smooth&&(C.target.style.scrollBehavior="auto",C.smooth=E.smooth=!1),N.enable()},e.onDisable=function(){jC(p,!0),cs(vn,"resize",Be),_n.removeEventListener("refresh",Be),N.kill()},e.lockAxis=e.lockAxis!==!1,h=new Vr(e),h.iOS=Qu,Qu&&!C()&&C(1),Qu&&Fi.ticker.add(yl),Ee=h._dc,de=Fi.to(h,{ease:"power4",paused:!0,scrollX:i?"+=0.1":"+=0",scrollY:"+=0.1",onComplete:Ee.vars.onComplete}),h};_n.sort=function(n){return dn.sort(n||function(e,t){return(e.vars.refreshPriority||0)*-1e6+e.start-(t.start+(t.vars.refreshPriority||0)*-1e6)})};_n.observe=function(n){return new Vr(n)};_n.normalizeScroll=function(n){if(typeof n>"u")return To;if(n===!0&&To)return To.enable();if(n===!1)return To&&To.kill();var e=n instanceof Vr?n:sH(n);return To&&To.target===e.target&&To.kill(),jd(e.target)&&(To=e),e};_n.core={_getVelocityProp:Qw,_inputObserver:ik,_scrollers:An,_proxies:Tl,bridge:{ss:function(){ma||Kd("scrollStart"),ma=Ks()},ref:function(){return Ls}}};qP()&&Fi.registerPlugin(_n);const fh=n=>(OA("data-v-70441074"),n=n(),GA(),n),oH={id:"info",class:"info"},aH={class:"section__body-wrapper"},lH={class:"section__body"},cH=fh(()=>Yt("div",{class:"line"},[Yt("h3",null,"my name is")],-1)),uH=fh(()=>Yt("div",{style:{"view-transition-name":"head-title"},class:"line"},[Yt("h1",null,"jordan andrzejczak")],-1)),hH={class:"info__body"},dH=fh(()=>Yt("div",{class:"line"},[Yt("h4",null,"I'm a")],-1)),fH={class:"info__card-wrapper"},pH=fh(()=>Yt("div",{class:"info__card-text"},"Web developer",-1)),AH=[pH],gH=fh(()=>Yt("div",{class:"info__card-text"},"Graphic designer",-1)),mH=[gH],_H=fh(()=>Yt("div",{class:"info__card-text"},"Animation enthusiast",-1)),yH=[_H],vH=fh(()=>Yt("div",{class:"info__card-text"},"Student",-1)),xH=[vH],IH=fh(()=>Yt("div",{class:"info__card-text"},"Explorer",-1)),CH=[IH],EH=kn({__name:"InfoComponent",setup(n){const e=Fc(),{isMobile:t}=No(e);return Br(()=>{pr.from("#info .line>h3",{scrollTrigger:"#info",duration:1,y:"150%",autoAlpha:0,delay:.25,ease:"power3.out"}),pr.from("#info .line>h4",{scrollTrigger:"#info",duration:1,y:"150%",autoAlpha:0,delay:.75,ease:"power3.out"}),pr.from("#info .info__card-wrapper>.info__card",{scrollTrigger:"#info",duration:1,y:"150%",autoAlpha:0,delay:1,ease:"power3.out",stagger:{each:.75,amount:.5}})}),(i,o)=>(Qi(),tn("section",oH,[Yt("div",aH,[Yt("div",lH,[cH,uH,Yt("div",hH,[dH,Yt("div",fH,[Yt("div",{class:mn(["info__card","hoverable",{"mobile-card":Bi(t)}])},AH,2),Yt("div",{class:mn(["info__card","hoverable",{"mobile-card":Bi(t)}])},mH,2),Yt("div",{class:mn(["info__card","hoverable",{"mobile-card":Bi(t)}])},yH,2),Yt("div",{class:mn(["info__card","hoverable",{"mobile-card":Bi(t)}])},xH,2),Yt("div",{class:mn(["info__card","hoverable",{"mobile-card":Bi(t)}])},CH,2)])])])])]))}});const wH=ns(EH,[["__scopeId","data-v-70441074"]]),bH={id:"timeline",class:"timeline"},BH=WR('<div class="section__body-wrapper"><div class="section__body"><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3>Medior Vue.js Developer</h3></div><div class="line"><h4>AFS Group Netherlands</h4></div><div class="line"><h5>September 2022 – Present</h5></div></div><ul class="expandable"><li> Worked on an internal software system for energy market brokers and redesigned the entirety of the system, </li><li> Developed new ideas and novel aproaches for upcoming consulting web application using Vue 3, Pinia and GraphQL, </li><li> Used software development methodologies like Agile and Waterfall to plan and execute the development process. </li></ul></div></div><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3>Web Developer</h3></div><div class="line"><h4>Custommerce sp. z o. o.</h4></div><div class="line"><h5>October 2021 – September 2022</h5></div></div><ul class="expandable"><li> Created rich content cards for well‑known brands like Nivea, iRobot, Remington or Legrand and implemented them in numerous e‑commerce shops in Poland, </li><li> Developed unique system for optimizing HTML and CSS in Node.js </li></ul></div></div><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3>Front-end Web Developer</h3></div><div class="line"><h4>Infocentrum sp. z o. o.</h4></div><div class="line"><h5>August 2020 – January 2022</h5></div></div><ul class="expandable"><li> Software for production efficiency and countering the spread of COVID-19 for one of the largest companies in Poland H. CEGIELSKI-POZNAŃ S. A. </li><li>Websites and e-commerce shops for individual clients</li></ul></div></div><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3>Web Developer</h3></div><div class="line"><h4>ITM-Software sp. z o. o.</h4></div><div class="line"><h5>June 2019 – July 2020</h5></div></div><ul class="expandable"><li> Promo materials for company, new website, dedicated UI designs for upcoming software. </li></ul></div></div></div></div>',1),SH=[BH],MH=kn({__name:"TimelineComponent",setup(n){const e=Fc(),{isMobileDevice:t}=No(e);function i(){var o=document.querySelectorAll(".timeline__element");o.forEach(u=>{t.value()?u.addEventListener("click",h=>{h.preventDefault();var r=u.querySelector(".expandable");if(r.classList.contains("expanded"))r.style.height="0px",r.addEventListener("transitionend",()=>{r.classList.remove("expanded")},{once:!0});else{document.querySelectorAll(".expanded").forEach(v=>{v.style.height="0px",v.addEventListener("transitionend",()=>{v.classList.remove("expanded")},{once:!0})}),r.classList.add("expanded"),r.style.height="auto";var p=r.clientHeight+"px";r.style.height="0px",setTimeout(()=>{r.style.height=p},0)}}):(u.addEventListener("mouseenter",h=>{var r=u.querySelector(".expandable");r.classList.add("expanded"),r.style.height="auto";var p=r.clientHeight+"px";r.style.height="0px",setTimeout(()=>{r.style.height=p},0)}),u.addEventListener("mouseleave",h=>{var r=u.querySelector(".expandable");r.style.height="0px",r.addEventListener("transitionend",()=>{r.classList.remove("expanded")},{once:!0})}))})}return Br(()=>{i()}),(o,u)=>(Qi(),tn("section",bH,SH))}}),TH={},DH={id:"education",class:"education"},QH=WR('<div class="section__body-wrapper"><div class="section__body"><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3>Uniwerystet im. Adama Mickiewicza</h3></div><div class="line"><h4>Software Engineer</h4></div><div class="line"><h5>October 2021 – Present</h5></div></div></div></div><div class="timeline__wrapper"><div class="timeline__line"><div class="timeline__line-dot"></div></div><div class="timeline__element"><div class="timeline__header"><div class="line"><h3> Zespół Szkół Komunikacji im. Hipolita Cegielskiego </h3></div><div class="line"><h4>IT Technician</h4></div><div class="line"><h5>September 2018 – May 2021</h5></div></div></div></div></div></div>',1),RH=[QH];function LH(n,e){return Qi(),tn("section",DH,RH)}const PH=ns(TH,[["render",LH]]),Nc=n=>(OA("data-v-91aa939d"),n=n(),GA(),n),kH={id:"skills",class:"skills"},FH={class:"section__body-wrapper"},NH={class:"section__body"},zH={class:"skills__body"},UH={class:"skills__card-wrapper"},OH=Nc(()=>Yt("div",{class:"skills__card-text"},"English",-1)),GH=Nc(()=>Yt("div",{class:"skills__card-text"},"Polish",-1)),HH=Nc(()=>Yt("div",{class:"skills__card-text"},"TypeScript",-1)),VH=Nc(()=>Yt("div",{class:"skills__card-text"},"CSS Preprocessors",-1)),WH=Nc(()=>Yt("div",{class:"skills__card-text"},"Vue.js",-1)),YH=Nc(()=>Yt("div",{class:"skills__card-text"},"HTML5",-1)),jH=Nc(()=>Yt("div",{class:"skills__card-text"},"Jest",-1)),qH=Nc(()=>Yt("div",{class:"skills__card-text"},"GraphQL",-1)),KH=Nc(()=>Yt("div",{class:"skills__card-text"},"Docker",-1)),JH=kn({__name:"SkillsComponent",setup(n){const e=Fc(),{isMobile:t}=No(e);return(i,o)=>{const u=HA("v-icon");return Qi(),tn("section",kH,[Yt("div",FH,[Yt("div",NH,[Yt("div",zH,[Yt("div",UH,[Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"io-language",scale:"2"}),OH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"io-language",scale:"2"}),GH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-typescript",scale:"2"}),HH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-sass-alt",scale:"2"}),VH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"la-node",scale:"2"})],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"io-logo-vue",scale:"2"}),WH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"si-html5",scale:"2"}),YH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"si-git",scale:"2"})],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-jest",scale:"2"}),jH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-graphql",scale:"2"}),qH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-mysql",scale:"2"})],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"co-docker",scale:"2"}),KH],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"si-adobephotoshop",scale:"2"})],2),Yt("div",{class:mn(["skills__card","hoverable",{"mobile-card":Bi(t)}])},[Di(u,{class:"skills__card-icon",name:"si-adobeaftereffects",scale:"2"})],2)])])])])])}}});const XH=ns(JH,[["__scopeId","data-v-91aa939d"]]),_1=n=>(OA("data-v-5a85171f"),n=n(),GA(),n),ZH={id:"contact",class:"contact"},$H={class:"section__body-wrapper"},eV={class:"section__body"},tV={class:"contact__card-wrapper"},iV=_1(()=>Yt("div",{class:"contact__card-input"},[Yt("div",null,"To:"),Yt("input",{value:"jordan.andrzejczak@outlook.com",disabled:"",type:"text"})],-1)),nV={class:"contact__card-input"},rV=_1(()=>Yt("div",null,"Subject:",-1)),sV={class:"contact__card-input__body"},oV=_1(()=>Yt("div",null,"Body:",-1)),aV={class:"contact__card-actions"},lV=["href"],cV=_1(()=>Yt("div",null,"send email",-1)),uV=[cV],hV={class:"contact__tiles"},dV=kn({__name:"ContactComponent",setup(n){const e=Fc(),{isMobile:t}=No(e),i=Gt({subject:"",body:""}),o=cn(()=>`mailto:jordan.andrzejczak@outlook.com?subject=${i.value.subject}&body=${i.value.body}`);return Br(()=>{}),(u,h)=>{const r=HA("v-icon");return Qi(),tn("section",ZH,[Yt("div",$H,[Yt("div",eV,[Yt("div",tV,[Yt("div",{class:mn(["contact__card",{"mobile-card":Bi(t)}])},[iV,Yt("div",nV,[rV,H_(Yt("input",{"onUpdate:modelValue":h[0]||(h[0]=p=>i.value.subject=p),type:"text",maxlength:"40"},null,512),[[sT,i.value.subject]])]),Yt("div",sV,[oV,H_(Yt("textarea",{"onUpdate:modelValue":h[1]||(h[1]=p=>i.value.body=p),name:"",id:"",cols:"30",rows:"10"},null,512),[[sT,i.value.body]])]),Yt("div",aV,[Yt("a",{class:mn(["cta__button","hoverable",{disabled:!i.value.subject||!i.value.body}]),href:Bi(o)},uV,10,lV)])],2)]),Yt("div",hV,[Yt("a",{href:"https://www.behance.net/andrzejczak",target:"_blank",class:mn(["contact__tiles__card","hoverable",{"mobile-card":Bi(t)}])},[Di(r,{class:"contact__tiles__card-icon",name:"bi-behance",scale:"2"})],2),Yt("a",{href:"https://github.com/jandrzejczak",target:"_blank",class:mn(["contact__tiles__card","hoverable",{"mobile-card":Bi(t)}])},[Di(r,{class:"contact__tiles__card-icon",name:"bi-github",scale:"2"})],2),Yt("a",{href:"https://www.linkedin.com/in/andrzejczak/",target:"_blank",class:mn(["contact__tiles__card","hoverable",{"mobile-card":Bi(t)}])},[Di(r,{class:"contact__tiles__card-icon",name:"bi-linkedin",scale:"2"})],2),Yt("a",{href:"https://www.instagram.com/andrzejczakjordan/",target:"_blank",class:mn(["contact__tiles__card","hoverable",{"mobile-card":Bi(t)}])},[Di(r,{class:"contact__tiles__card-icon",name:"bi-instagram",scale:"2"})],2)])])])])}}});const fV=ns(dV,[["__scopeId","data-v-5a85171f"]]),pV={class:"container"},AV=kn({__name:"ScrollSection",setup(n){function e(){var u;const i=document.querySelectorAll("section"),o=document.querySelectorAll(".nav__item");(u=document.querySelector(".container"))==null||u.addEventListener("scroll",()=>{i.forEach(h=>{let r=h.getBoundingClientRect();r.top>=0&&r.left>=0&&r.bottom<=window.innerHeight&&r.right<=window.innerWidth&&o.forEach(p=>{var g;(g=p.getAttribute("href"))!=null&&g.includes(h.getAttribute("id")??"")?p.classList.add("active"):p.classList.remove("active")})})})}function t(){pr.registerPlugin(_n),_n.defaults({toggleActions:"play pause resume pause",scroller:".container"}),pr.from("#timeline .timeline__wrapper>.timeline__line",{scrollTrigger:"#timeline",duration:1,y:"-101%",autoAlpha:1,delay:.25,ease:"power3.inOut",stagger:{each:1,amount:2.5}}),pr.from("#timeline .timeline__line>.timeline__line-dot",{scrollTrigger:"#timeline",duration:1,scale:0,autoAlpha:0,delay:.75,ease:"power3.inOut",stagger:{each:.5,amount:2.5}}),pr.from("#timeline .line>h3",{scrollTrigger:"#timeline",duration:1,y:"150%",autoAlpha:0,delay:.75,ease:"power3.inOut",stagger:{each:.5,amount:2.5}}),pr.from("#timeline .line>h4",{scrollTrigger:"#timeline",duration:1,y:"150%",autoAlpha:0,delay:1,ease:"power3.inOut",stagger:{each:.5,amount:2.5}}),pr.from("#timeline .line>h5",{scrollTrigger:"#timeline",duration:1,y:"150%",autoAlpha:0,delay:1.25,ease:"power3.inOut",stagger:{each:.5,amount:2.5}}),pr.from("#timeline .timeline__element li",{scrollTrigger:"#timeline",duration:1,y:"100%",autoAlpha:0,delay:1.5,ease:"power3.inOut",stagger:{each:.5,amount:2.5}}),pr.from("#education .timeline__wrapper>.timeline__line",{scrollTrigger:"#education",duration:1,y:"-101%",autoAlpha:1,delay:.25,ease:"power3.inOut",stagger:{each:1,amount:2}}),pr.from("#education .timeline__line>.timeline__line-dot",{scrollTrigger:"#education",duration:1,scale:0,autoAlpha:0,delay:.75,ease:"power3.inOut",stagger:{each:.5,amount:2}}),pr.from("#education .line>h3",{scrollTrigger:"#education",duration:1,y:"150%",autoAlpha:0,delay:.75,ease:"power3.inOut",stagger:{each:.5,amount:2}}),pr.from("#education .line>h4",{scrollTrigger:"#education",duration:1,y:"150%",autoAlpha:0,delay:1,ease:"power3.inOut",stagger:{each:.5,amount:2}}),pr.from("#education .line>h5",{scrollTrigger:"#education",duration:1,y:"150%",autoAlpha:0,delay:1.25,ease:"power3.inOut",stagger:{each:.5,amount:2}}),pr.from("#skills .skills__card-wrapper>.skills__card",{scrollTrigger:"#skills",duration:1,y:"150%",autoAlpha:0,delay:1,ease:"power3.out",stagger:{each:.75,amount:.5}})}return Br(()=>{t(),e()}),(i,o)=>(Qi(),tn("div",pV,[Di(wH),Di(MH),Di(PH),Di(XH),Di(fV)]))}});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const _B="149",Ap={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},gp={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},gV=0,_D=1,mV=2,nk=1,yB=2,r_=3,rl=0,_o=1,fa=2,$u=0,oA=1,yD=2,vD=3,xD=4,_V=5,Np=100,yV=101,vV=102,ID=103,CD=104,xV=200,IV=201,CV=202,EV=203,rk=204,sk=205,wV=206,bV=207,BV=208,SV=209,MV=210,TV=0,DV=1,QV=2,Nw=3,RV=4,LV=5,PV=6,kV=7,vB=0,FV=1,NV=2,Sc=0,zV=1,UV=2,OV=3,GV=4,HV=5,ok=300,TA=301,DA=302,Jd=303,zw=304,y1=306,QA=1e3,po=1001,zx=1002,us=1003,Uw=1004,hx=1005,$r=1006,ak=1007,ch=1008,Xd=1009,VV=1010,WV=1011,lk=1012,YV=1013,Sd=1014,Za=1015,Ec=1016,jV=1017,qV=1018,aA=1020,KV=1021,aa=1023,JV=1024,XV=1025,Od=1026,RA=1027,ZV=1028,$V=1029,e9=1030,t9=1031,i9=1033,qC=33776,KC=33777,JC=33778,XC=33779,ED=35840,wD=35841,bD=35842,BD=35843,n9=36196,SD=37492,MD=37496,TD=37808,DD=37809,QD=37810,RD=37811,LD=37812,PD=37813,kD=37814,FD=37815,ND=37816,zD=37817,UD=37818,OD=37819,GD=37820,HD=37821,ZC=36492,r9=36283,VD=36284,WD=36285,YD=36286,i0=2300,LA=2301,$C=2302,jD=2400,qD=2401,KD=2402,s9=2500,o9=0,ck=1,Ow=2,uh=3e3,Cn=3001,a9=3200,l9=3201,xB=0,c9=1,vl="srgb",n0="srgb-linear",eE=7680,u9=519,Gw=35044,JD="300 es",Hw=1035;class lf{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const o=this._listeners[e];if(o!==void 0){const u=o.indexOf(t);u!==-1&&o.splice(u,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const o=i.slice(0);for(let u=0,h=o.length;u<h;u++)o[u].call(this,e);e.target=null}}}const Rs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let XD=1234567;const Q_=Math.PI/180,r0=180/Math.PI;function il(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Rs[n&255]+Rs[n>>8&255]+Rs[n>>16&255]+Rs[n>>24&255]+"-"+Rs[e&255]+Rs[e>>8&255]+"-"+Rs[e>>16&15|64]+Rs[e>>24&255]+"-"+Rs[t&63|128]+Rs[t>>8&255]+"-"+Rs[t>>16&255]+Rs[t>>24&255]+Rs[i&255]+Rs[i>>8&255]+Rs[i>>16&255]+Rs[i>>24&255]).toLowerCase()}function hs(n,e,t){return Math.max(e,Math.min(t,n))}function IB(n,e){return(n%e+e)%e}function h9(n,e,t,i,o){return i+(n-e)*(o-i)/(t-e)}function d9(n,e,t){return n!==e?(t-n)/(e-n):0}function R_(n,e,t){return(1-t)*n+t*e}function f9(n,e,t,i){return R_(n,e,1-Math.exp(-t*i))}function p9(n,e=1){return e-Math.abs(IB(n,e*2)-e)}function A9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function g9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function m9(n,e){return n+Math.floor(Math.random()*(e-n+1))}function _9(n,e){return n+Math.random()*(e-n)}function y9(n){return n*(.5-Math.random())}function v9(n){n!==void 0&&(XD=n);let e=XD+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function x9(n){return n*Q_}function I9(n){return n*r0}function Vw(n){return(n&n-1)===0&&n!==0}function uk(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Ux(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function C9(n,e,t,i,o){const u=Math.cos,h=Math.sin,r=u(t/2),p=h(t/2),g=u((e+i)/2),v=h((e+i)/2),I=u((e-i)/2),C=h((e-i)/2),E=u((i-e)/2),Q=h((i-e)/2);switch(o){case"XYX":n.set(r*v,p*I,p*C,r*g);break;case"YZY":n.set(p*C,r*v,p*I,r*g);break;case"ZXZ":n.set(p*I,p*C,r*v,r*g);break;case"XZX":n.set(r*v,p*Q,p*E,r*g);break;case"YXY":n.set(p*E,r*v,p*Q,r*g);break;case"ZYZ":n.set(p*Q,p*E,r*v,r*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}function wc(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Zn(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var E9=Object.freeze({__proto__:null,DEG2RAD:Q_,RAD2DEG:r0,ceilPowerOfTwo:uk,clamp:hs,damp:f9,degToRad:x9,denormalize:wc,euclideanModulo:IB,floorPowerOfTwo:Ux,generateUUID:il,inverseLerp:d9,isPowerOfTwo:Vw,lerp:R_,mapLinear:h9,normalize:Zn,pingpong:p9,radToDeg:I9,randFloat:_9,randFloatSpread:y9,randInt:m9,seededRandom:v9,setQuaternionFromProperEuler:C9,smootherstep:g9,smoothstep:A9});class Yi{constructor(e=0,t=0){Yi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6],this.y=o[1]*t+o[4]*i+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),o=Math.sin(t),u=this.x-e.x,h=this.y-e.y;return this.x=u*i-h*o+e.x,this.y=u*o+h*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ko{constructor(){ko.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,o,u,h,r,p,g){const v=this.elements;return v[0]=e,v[1]=o,v[2]=r,v[3]=t,v[4]=u,v[5]=p,v[6]=i,v[7]=h,v[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,o=t.elements,u=this.elements,h=i[0],r=i[3],p=i[6],g=i[1],v=i[4],I=i[7],C=i[2],E=i[5],Q=i[8],M=o[0],D=o[3],P=o[6],O=o[1],F=o[4],N=o[7],z=o[2],X=o[5],q=o[8];return u[0]=h*M+r*O+p*z,u[3]=h*D+r*F+p*X,u[6]=h*P+r*N+p*q,u[1]=g*M+v*O+I*z,u[4]=g*D+v*F+I*X,u[7]=g*P+v*N+I*q,u[2]=C*M+E*O+Q*z,u[5]=C*D+E*F+Q*X,u[8]=C*P+E*N+Q*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],o=e[2],u=e[3],h=e[4],r=e[5],p=e[6],g=e[7],v=e[8];return t*h*v-t*r*g-i*u*v+i*r*p+o*u*g-o*h*p}invert(){const e=this.elements,t=e[0],i=e[1],o=e[2],u=e[3],h=e[4],r=e[5],p=e[6],g=e[7],v=e[8],I=v*h-r*g,C=r*p-v*u,E=g*u-h*p,Q=t*I+i*C+o*E;if(Q===0)return this.set(0,0,0,0,0,0,0,0,0);const M=1/Q;return e[0]=I*M,e[1]=(o*g-v*i)*M,e[2]=(r*i-o*h)*M,e[3]=C*M,e[4]=(v*t-o*p)*M,e[5]=(o*u-r*t)*M,e[6]=E*M,e[7]=(i*p-g*t)*M,e[8]=(h*t-i*u)*M,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,o,u,h,r){const p=Math.cos(u),g=Math.sin(u);return this.set(i*p,i*g,-i*(p*h+g*r)+h+e,-o*g,o*p,-o*(-g*h+p*r)+r+t,0,0,1),this}scale(e,t){return this.premultiply(tE.makeScale(e,t)),this}rotate(e){return this.premultiply(tE.makeRotation(-e)),this}translate(e,t){return this.premultiply(tE.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let o=0;o<9;o++)if(t[o]!==i[o])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const tE=new ko;function hk(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function s0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Gd(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function dx(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const iE={[vl]:{[n0]:Gd},[n0]:{[vl]:dx}},Vs={legacyMode:!0,get workingColorSpace(){return n0},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(iE[e]&&iE[e][t]!==void 0){const i=iE[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},dk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Kr={r:0,g:0,b:0},Ua={h:0,s:0,l:0},pv={h:0,s:0,l:0};function nE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function Av(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}class Xi{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Vs.toWorkingColorSpace(this,t),this}setRGB(e,t,i,o=Vs.workingColorSpace){return this.r=e,this.g=t,this.b=i,Vs.toWorkingColorSpace(this,o),this}setHSL(e,t,i,o=Vs.workingColorSpace){if(e=IB(e,1),t=hs(t,0,1),i=hs(i,0,1),t===0)this.r=this.g=this.b=i;else{const u=i<=.5?i*(1+t):i+t-i*t,h=2*i-u;this.r=nE(h,u,e+1/3),this.g=nE(h,u,e),this.b=nE(h,u,e-1/3)}return Vs.toWorkingColorSpace(this,o),this}setStyle(e,t=vl){function i(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let u;const h=o[1],r=o[2];switch(h){case"rgb":case"rgba":if(u=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,Vs.toWorkingColorSpace(this,t),i(u[4]),this;if(u=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,Vs.toWorkingColorSpace(this,t),i(u[4]),this;break;case"hsl":case"hsla":if(u=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const p=parseFloat(u[1])/360,g=parseFloat(u[2])/100,v=parseFloat(u[3])/100;return i(u[4]),this.setHSL(p,g,v,t)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const u=o[1],h=u.length;if(h===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,Vs.toWorkingColorSpace(this,t),this;if(h===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,Vs.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=vl){const i=dk[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Gd(e.r),this.g=Gd(e.g),this.b=Gd(e.b),this}copyLinearToSRGB(e){return this.r=dx(e.r),this.g=dx(e.g),this.b=dx(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vl){return Vs.fromWorkingColorSpace(Av(this,Kr),e),hs(Kr.r*255,0,255)<<16^hs(Kr.g*255,0,255)<<8^hs(Kr.b*255,0,255)<<0}getHexString(e=vl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Vs.workingColorSpace){Vs.fromWorkingColorSpace(Av(this,Kr),t);const i=Kr.r,o=Kr.g,u=Kr.b,h=Math.max(i,o,u),r=Math.min(i,o,u);let p,g;const v=(r+h)/2;if(r===h)p=0,g=0;else{const I=h-r;switch(g=v<=.5?I/(h+r):I/(2-h-r),h){case i:p=(o-u)/I+(o<u?6:0);break;case o:p=(u-i)/I+2;break;case u:p=(i-o)/I+4;break}p/=6}return e.h=p,e.s=g,e.l=v,e}getRGB(e,t=Vs.workingColorSpace){return Vs.fromWorkingColorSpace(Av(this,Kr),t),e.r=Kr.r,e.g=Kr.g,e.b=Kr.b,e}getStyle(e=vl){return Vs.fromWorkingColorSpace(Av(this,Kr),e),e!==vl?`color(${e} ${Kr.r} ${Kr.g} ${Kr.b})`:`rgb(${Kr.r*255|0},${Kr.g*255|0},${Kr.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(Ua),Ua.h+=e,Ua.s+=t,Ua.l+=i,this.setHSL(Ua.h,Ua.s,Ua.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ua),e.getHSL(pv);const i=R_(Ua.h,pv.h,t),o=R_(Ua.s,pv.s,t),u=R_(Ua.l,pv.l,t);return this.setHSL(i,o,u),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Xi.NAMES=dk;let mp;class fk{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{mp===void 0&&(mp=s0("canvas")),mp.width=e.width,mp.height=e.height;const i=mp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=mp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=s0("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const o=i.getImageData(0,0,e.width,e.height),u=o.data;for(let h=0;h<u.length;h++)u[h]=Gd(u[h]/255)*255;return i.putImageData(o,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Gd(t[i]/255)*255):t[i]=Gd(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class pk{constructor(e=null){this.isSource=!0,this.uuid=il(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},o=this.data;if(o!==null){let u;if(Array.isArray(o)){u=[];for(let h=0,r=o.length;h<r;h++)o[h].isDataTexture?u.push(rE(o[h].image)):u.push(rE(o[h]))}else u=rE(o);i.url=u}return t||(e.images[this.uuid]=i),i}}function rE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?fk.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let w9=0;class Cs extends lf{constructor(e=Cs.DEFAULT_IMAGE,t=Cs.DEFAULT_MAPPING,i=po,o=po,u=$r,h=ch,r=aa,p=Xd,g=Cs.DEFAULT_ANISOTROPY,v=uh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:w9++}),this.uuid=il(),this.name="",this.source=new pk(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=o,this.magFilter=u,this.minFilter=h,this.anisotropy=g,this.format=r,this.internalFormat=null,this.type=p,this.offset=new Yi(0,0),this.repeat=new Yi(1,1),this.center=new Yi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ko,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=v,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ok)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case QA:e.x=e.x-Math.floor(e.x);break;case po:e.x=e.x<0?0:1;break;case zx:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case QA:e.y=e.y-Math.floor(e.y);break;case po:e.y=e.y<0?0:1;break;case zx:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Cs.DEFAULT_IMAGE=null;Cs.DEFAULT_MAPPING=ok;Cs.DEFAULT_ANISOTROPY=1;class er{constructor(e=0,t=0,i=0,o=1){er.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,o){return this.x=e,this.y=t,this.z=i,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,o=this.z,u=this.w,h=e.elements;return this.x=h[0]*t+h[4]*i+h[8]*o+h[12]*u,this.y=h[1]*t+h[5]*i+h[9]*o+h[13]*u,this.z=h[2]*t+h[6]*i+h[10]*o+h[14]*u,this.w=h[3]*t+h[7]*i+h[11]*o+h[15]*u,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,o,u;const p=e.elements,g=p[0],v=p[4],I=p[8],C=p[1],E=p[5],Q=p[9],M=p[2],D=p[6],P=p[10];if(Math.abs(v-C)<.01&&Math.abs(I-M)<.01&&Math.abs(Q-D)<.01){if(Math.abs(v+C)<.1&&Math.abs(I+M)<.1&&Math.abs(Q+D)<.1&&Math.abs(g+E+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const F=(g+1)/2,N=(E+1)/2,z=(P+1)/2,X=(v+C)/4,q=(I+M)/4,H=(Q+D)/4;return F>N&&F>z?F<.01?(i=0,o=.707106781,u=.707106781):(i=Math.sqrt(F),o=X/i,u=q/i):N>z?N<.01?(i=.707106781,o=0,u=.707106781):(o=Math.sqrt(N),i=X/o,u=H/o):z<.01?(i=.707106781,o=.707106781,u=0):(u=Math.sqrt(z),i=q/u,o=H/u),this.set(i,o,u,t),this}let O=Math.sqrt((D-Q)*(D-Q)+(I-M)*(I-M)+(C-v)*(C-v));return Math.abs(O)<.001&&(O=1),this.x=(D-Q)/O,this.y=(I-M)/O,this.z=(C-v)/O,this.w=Math.acos((g+E+P-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Zd extends lf{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new er(0,0,e,t),this.scissorTest=!1,this.viewport=new er(0,0,e,t);const o={width:e,height:t,depth:1};this.texture=new Cs(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:$r,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new pk(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ak extends Cs{constructor(e=null,t=1,i=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:o},this.magFilter=us,this.minFilter=us,this.wrapR=po,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class b9 extends Cs{constructor(e=null,t=1,i=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:o},this.magFilter=us,this.minFilter=us,this.wrapR=po,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ll{constructor(e=0,t=0,i=0,o=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=o}static slerpFlat(e,t,i,o,u,h,r){let p=i[o+0],g=i[o+1],v=i[o+2],I=i[o+3];const C=u[h+0],E=u[h+1],Q=u[h+2],M=u[h+3];if(r===0){e[t+0]=p,e[t+1]=g,e[t+2]=v,e[t+3]=I;return}if(r===1){e[t+0]=C,e[t+1]=E,e[t+2]=Q,e[t+3]=M;return}if(I!==M||p!==C||g!==E||v!==Q){let D=1-r;const P=p*C+g*E+v*Q+I*M,O=P>=0?1:-1,F=1-P*P;if(F>Number.EPSILON){const z=Math.sqrt(F),X=Math.atan2(z,P*O);D=Math.sin(D*X)/z,r=Math.sin(r*X)/z}const N=r*O;if(p=p*D+C*N,g=g*D+E*N,v=v*D+Q*N,I=I*D+M*N,D===1-r){const z=1/Math.sqrt(p*p+g*g+v*v+I*I);p*=z,g*=z,v*=z,I*=z}}e[t]=p,e[t+1]=g,e[t+2]=v,e[t+3]=I}static multiplyQuaternionsFlat(e,t,i,o,u,h){const r=i[o],p=i[o+1],g=i[o+2],v=i[o+3],I=u[h],C=u[h+1],E=u[h+2],Q=u[h+3];return e[t]=r*Q+v*I+p*E-g*C,e[t+1]=p*Q+v*C+g*I-r*E,e[t+2]=g*Q+v*E+r*C-p*I,e[t+3]=v*Q-r*I-p*C-g*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,o){return this._x=e,this._y=t,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,o=e._y,u=e._z,h=e._order,r=Math.cos,p=Math.sin,g=r(i/2),v=r(o/2),I=r(u/2),C=p(i/2),E=p(o/2),Q=p(u/2);switch(h){case"XYZ":this._x=C*v*I+g*E*Q,this._y=g*E*I-C*v*Q,this._z=g*v*Q+C*E*I,this._w=g*v*I-C*E*Q;break;case"YXZ":this._x=C*v*I+g*E*Q,this._y=g*E*I-C*v*Q,this._z=g*v*Q-C*E*I,this._w=g*v*I+C*E*Q;break;case"ZXY":this._x=C*v*I-g*E*Q,this._y=g*E*I+C*v*Q,this._z=g*v*Q+C*E*I,this._w=g*v*I-C*E*Q;break;case"ZYX":this._x=C*v*I-g*E*Q,this._y=g*E*I+C*v*Q,this._z=g*v*Q-C*E*I,this._w=g*v*I+C*E*Q;break;case"YZX":this._x=C*v*I+g*E*Q,this._y=g*E*I+C*v*Q,this._z=g*v*Q-C*E*I,this._w=g*v*I-C*E*Q;break;case"XZY":this._x=C*v*I-g*E*Q,this._y=g*E*I-C*v*Q,this._z=g*v*Q+C*E*I,this._w=g*v*I+C*E*Q;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+h)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,o=Math.sin(i);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],o=t[4],u=t[8],h=t[1],r=t[5],p=t[9],g=t[2],v=t[6],I=t[10],C=i+r+I;if(C>0){const E=.5/Math.sqrt(C+1);this._w=.25/E,this._x=(v-p)*E,this._y=(u-g)*E,this._z=(h-o)*E}else if(i>r&&i>I){const E=2*Math.sqrt(1+i-r-I);this._w=(v-p)/E,this._x=.25*E,this._y=(o+h)/E,this._z=(u+g)/E}else if(r>I){const E=2*Math.sqrt(1+r-i-I);this._w=(u-g)/E,this._x=(o+h)/E,this._y=.25*E,this._z=(p+v)/E}else{const E=2*Math.sqrt(1+I-i-r);this._w=(h-o)/E,this._x=(u+g)/E,this._y=(p+v)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(hs(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const o=Math.min(1,t/i);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,o=e._y,u=e._z,h=e._w,r=t._x,p=t._y,g=t._z,v=t._w;return this._x=i*v+h*r+o*g-u*p,this._y=o*v+h*p+u*r-i*g,this._z=u*v+h*g+i*p-o*r,this._w=h*v-i*r-o*p-u*g,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,o=this._y,u=this._z,h=this._w;let r=h*e._w+i*e._x+o*e._y+u*e._z;if(r<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,r=-r):this.copy(e),r>=1)return this._w=h,this._x=i,this._y=o,this._z=u,this;const p=1-r*r;if(p<=Number.EPSILON){const E=1-t;return this._w=E*h+t*this._w,this._x=E*i+t*this._x,this._y=E*o+t*this._y,this._z=E*u+t*this._z,this.normalize(),this._onChangeCallback(),this}const g=Math.sqrt(p),v=Math.atan2(g,r),I=Math.sin((1-t)*v)/g,C=Math.sin(t*v)/g;return this._w=h*I+this._w*C,this._x=i*I+this._x*C,this._y=o*I+this._y*C,this._z=u*I+this._z*C,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),o=2*Math.PI*Math.random(),u=2*Math.PI*Math.random();return this.set(t*Math.cos(o),i*Math.sin(u),i*Math.cos(u),t*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class rt{constructor(e=0,t=0,i=0){rt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ZD.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ZD.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,o=this.z,u=e.elements;return this.x=u[0]*t+u[3]*i+u[6]*o,this.y=u[1]*t+u[4]*i+u[7]*o,this.z=u[2]*t+u[5]*i+u[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,o=this.z,u=e.elements,h=1/(u[3]*t+u[7]*i+u[11]*o+u[15]);return this.x=(u[0]*t+u[4]*i+u[8]*o+u[12])*h,this.y=(u[1]*t+u[5]*i+u[9]*o+u[13])*h,this.z=(u[2]*t+u[6]*i+u[10]*o+u[14])*h,this}applyQuaternion(e){const t=this.x,i=this.y,o=this.z,u=e.x,h=e.y,r=e.z,p=e.w,g=p*t+h*o-r*i,v=p*i+r*t-u*o,I=p*o+u*i-h*t,C=-u*t-h*i-r*o;return this.x=g*p+C*-u+v*-r-I*-h,this.y=v*p+C*-h+I*-u-g*-r,this.z=I*p+C*-r+g*-h-v*-u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,o=this.z,u=e.elements;return this.x=u[0]*t+u[4]*i+u[8]*o,this.y=u[1]*t+u[5]*i+u[9]*o,this.z=u[2]*t+u[6]*i+u[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,o=e.y,u=e.z,h=t.x,r=t.y,p=t.z;return this.x=o*p-u*r,this.y=u*h-i*p,this.z=i*r-o*h,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return sE.copy(this).projectOnVector(e),this.sub(sE)}reflect(e){return this.sub(sE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(hs(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,o=this.z-e.z;return t*t+i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const o=Math.sin(t)*e;return this.x=o*Math.sin(i),this.y=Math.cos(t)*e,this.z=o*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const sE=new rt,ZD=new Ll;class xa{constructor(e=new rt(1/0,1/0,1/0),t=new rt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,o=1/0,u=-1/0,h=-1/0,r=-1/0;for(let p=0,g=e.length;p<g;p+=3){const v=e[p],I=e[p+1],C=e[p+2];v<t&&(t=v),I<i&&(i=I),C<o&&(o=C),v>u&&(u=v),I>h&&(h=I),C>r&&(r=C)}return this.min.set(t,i,o),this.max.set(u,h,r),this}setFromBufferAttribute(e){let t=1/0,i=1/0,o=1/0,u=-1/0,h=-1/0,r=-1/0;for(let p=0,g=e.count;p<g;p++){const v=e.getX(p),I=e.getY(p),C=e.getZ(p);v<t&&(t=v),I<i&&(i=I),C<o&&(o=C),v>u&&(u=v),I>h&&(h=I),C>r&&(r=C)}return this.min.set(t,i,o),this.max.set(u,h,r),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=cd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const u=i.attributes.position;for(let h=0,r=u.count;h<r;h++)cd.fromBufferAttribute(u,h).applyMatrix4(e.matrixWorld),this.expandByPoint(cd)}else i.boundingBox===null&&i.computeBoundingBox(),oE.copy(i.boundingBox),oE.applyMatrix4(e.matrixWorld),this.union(oE);const o=e.children;for(let u=0,h=o.length;u<h;u++)this.expandByObject(o[u],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,cd),cd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Mm),gv.subVectors(this.max,Mm),_p.subVectors(e.a,Mm),yp.subVectors(e.b,Mm),vp.subVectors(e.c,Mm),Iu.subVectors(yp,_p),Cu.subVectors(vp,yp),ud.subVectors(_p,vp);let t=[0,-Iu.z,Iu.y,0,-Cu.z,Cu.y,0,-ud.z,ud.y,Iu.z,0,-Iu.x,Cu.z,0,-Cu.x,ud.z,0,-ud.x,-Iu.y,Iu.x,0,-Cu.y,Cu.x,0,-ud.y,ud.x,0];return!aE(t,_p,yp,vp,gv)||(t=[1,0,0,0,1,0,0,0,1],!aE(t,_p,yp,vp,gv))?!1:(mv.crossVectors(Iu,Cu),t=[mv.x,mv.y,mv.z],aE(t,_p,yp,vp,gv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return cd.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(cd).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(nc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),nc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),nc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),nc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),nc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),nc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),nc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),nc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(nc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const nc=[new rt,new rt,new rt,new rt,new rt,new rt,new rt,new rt],cd=new rt,oE=new xa,_p=new rt,yp=new rt,vp=new rt,Iu=new rt,Cu=new rt,ud=new rt,Mm=new rt,gv=new rt,mv=new rt,hd=new rt;function aE(n,e,t,i,o){for(let u=0,h=n.length-3;u<=h;u+=3){hd.fromArray(n,u);const r=o.x*Math.abs(hd.x)+o.y*Math.abs(hd.y)+o.z*Math.abs(hd.z),p=e.dot(hd),g=t.dot(hd),v=i.dot(hd);if(Math.max(-Math.max(p,g,v),Math.min(p,g,v))>r)return!1}return!0}const B9=new xa,Tm=new rt,lE=new rt;class cf{constructor(e=new rt,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):B9.setFromPoints(e).getCenter(i);let o=0;for(let u=0,h=e.length;u<h;u++)o=Math.max(o,i.distanceToSquared(e[u]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Tm.subVectors(e,this.center);const t=Tm.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),o=(i-this.radius)*.5;this.center.addScaledVector(Tm,o/i),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(lE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Tm.copy(e.center).add(lE)),this.expandByPoint(Tm.copy(e.center).sub(lE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const rc=new rt,cE=new rt,_v=new rt,Eu=new rt,uE=new rt,yv=new rt,hE=new rt;class m0{constructor(e=new rt,t=new rt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=rc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(rc.copy(this.direction).multiplyScalar(t).add(this.origin),rc.distanceToSquared(e))}distanceSqToSegment(e,t,i,o){cE.copy(e).add(t).multiplyScalar(.5),_v.copy(t).sub(e).normalize(),Eu.copy(this.origin).sub(cE);const u=e.distanceTo(t)*.5,h=-this.direction.dot(_v),r=Eu.dot(this.direction),p=-Eu.dot(_v),g=Eu.lengthSq(),v=Math.abs(1-h*h);let I,C,E,Q;if(v>0)if(I=h*p-r,C=h*r-p,Q=u*v,I>=0)if(C>=-Q)if(C<=Q){const M=1/v;I*=M,C*=M,E=I*(I+h*C+2*r)+C*(h*I+C+2*p)+g}else C=u,I=Math.max(0,-(h*C+r)),E=-I*I+C*(C+2*p)+g;else C=-u,I=Math.max(0,-(h*C+r)),E=-I*I+C*(C+2*p)+g;else C<=-Q?(I=Math.max(0,-(-h*u+r)),C=I>0?-u:Math.min(Math.max(-u,-p),u),E=-I*I+C*(C+2*p)+g):C<=Q?(I=0,C=Math.min(Math.max(-u,-p),u),E=C*(C+2*p)+g):(I=Math.max(0,-(h*u+r)),C=I>0?u:Math.min(Math.max(-u,-p),u),E=-I*I+C*(C+2*p)+g);else C=h>0?-u:u,I=Math.max(0,-(h*C+r)),E=-I*I+C*(C+2*p)+g;return i&&i.copy(this.direction).multiplyScalar(I).add(this.origin),o&&o.copy(_v).multiplyScalar(C).add(cE),E}intersectSphere(e,t){rc.subVectors(e.center,this.origin);const i=rc.dot(this.direction),o=rc.dot(rc)-i*i,u=e.radius*e.radius;if(o>u)return null;const h=Math.sqrt(u-o),r=i-h,p=i+h;return r<0&&p<0?null:r<0?this.at(p,t):this.at(r,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,o,u,h,r,p;const g=1/this.direction.x,v=1/this.direction.y,I=1/this.direction.z,C=this.origin;return g>=0?(i=(e.min.x-C.x)*g,o=(e.max.x-C.x)*g):(i=(e.max.x-C.x)*g,o=(e.min.x-C.x)*g),v>=0?(u=(e.min.y-C.y)*v,h=(e.max.y-C.y)*v):(u=(e.max.y-C.y)*v,h=(e.min.y-C.y)*v),i>h||u>o||((u>i||isNaN(i))&&(i=u),(h<o||isNaN(o))&&(o=h),I>=0?(r=(e.min.z-C.z)*I,p=(e.max.z-C.z)*I):(r=(e.max.z-C.z)*I,p=(e.min.z-C.z)*I),i>p||r>o)||((r>i||i!==i)&&(i=r),(p<o||o!==o)&&(o=p),o<0)?null:this.at(i>=0?i:o,t)}intersectsBox(e){return this.intersectBox(e,rc)!==null}intersectTriangle(e,t,i,o,u){uE.subVectors(t,e),yv.subVectors(i,e),hE.crossVectors(uE,yv);let h=this.direction.dot(hE),r;if(h>0){if(o)return null;r=1}else if(h<0)r=-1,h=-h;else return null;Eu.subVectors(this.origin,e);const p=r*this.direction.dot(yv.crossVectors(Eu,yv));if(p<0)return null;const g=r*this.direction.dot(uE.cross(Eu));if(g<0||p+g>h)return null;const v=-r*Eu.dot(hE);return v<0?null:this.at(v/h,u)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class sn{constructor(){sn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,o,u,h,r,p,g,v,I,C,E,Q,M,D){const P=this.elements;return P[0]=e,P[4]=t,P[8]=i,P[12]=o,P[1]=u,P[5]=h,P[9]=r,P[13]=p,P[2]=g,P[6]=v,P[10]=I,P[14]=C,P[3]=E,P[7]=Q,P[11]=M,P[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new sn().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,o=1/xp.setFromMatrixColumn(e,0).length(),u=1/xp.setFromMatrixColumn(e,1).length(),h=1/xp.setFromMatrixColumn(e,2).length();return t[0]=i[0]*o,t[1]=i[1]*o,t[2]=i[2]*o,t[3]=0,t[4]=i[4]*u,t[5]=i[5]*u,t[6]=i[6]*u,t[7]=0,t[8]=i[8]*h,t[9]=i[9]*h,t[10]=i[10]*h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,o=e.y,u=e.z,h=Math.cos(i),r=Math.sin(i),p=Math.cos(o),g=Math.sin(o),v=Math.cos(u),I=Math.sin(u);if(e.order==="XYZ"){const C=h*v,E=h*I,Q=r*v,M=r*I;t[0]=p*v,t[4]=-p*I,t[8]=g,t[1]=E+Q*g,t[5]=C-M*g,t[9]=-r*p,t[2]=M-C*g,t[6]=Q+E*g,t[10]=h*p}else if(e.order==="YXZ"){const C=p*v,E=p*I,Q=g*v,M=g*I;t[0]=C+M*r,t[4]=Q*r-E,t[8]=h*g,t[1]=h*I,t[5]=h*v,t[9]=-r,t[2]=E*r-Q,t[6]=M+C*r,t[10]=h*p}else if(e.order==="ZXY"){const C=p*v,E=p*I,Q=g*v,M=g*I;t[0]=C-M*r,t[4]=-h*I,t[8]=Q+E*r,t[1]=E+Q*r,t[5]=h*v,t[9]=M-C*r,t[2]=-h*g,t[6]=r,t[10]=h*p}else if(e.order==="ZYX"){const C=h*v,E=h*I,Q=r*v,M=r*I;t[0]=p*v,t[4]=Q*g-E,t[8]=C*g+M,t[1]=p*I,t[5]=M*g+C,t[9]=E*g-Q,t[2]=-g,t[6]=r*p,t[10]=h*p}else if(e.order==="YZX"){const C=h*p,E=h*g,Q=r*p,M=r*g;t[0]=p*v,t[4]=M-C*I,t[8]=Q*I+E,t[1]=I,t[5]=h*v,t[9]=-r*v,t[2]=-g*v,t[6]=E*I+Q,t[10]=C-M*I}else if(e.order==="XZY"){const C=h*p,E=h*g,Q=r*p,M=r*g;t[0]=p*v,t[4]=-I,t[8]=g*v,t[1]=C*I+M,t[5]=h*v,t[9]=E*I-Q,t[2]=Q*I-E,t[6]=r*v,t[10]=M*I+C}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(S9,e,M9)}lookAt(e,t,i){const o=this.elements;return Bo.subVectors(e,t),Bo.lengthSq()===0&&(Bo.z=1),Bo.normalize(),wu.crossVectors(i,Bo),wu.lengthSq()===0&&(Math.abs(i.z)===1?Bo.x+=1e-4:Bo.z+=1e-4,Bo.normalize(),wu.crossVectors(i,Bo)),wu.normalize(),vv.crossVectors(Bo,wu),o[0]=wu.x,o[4]=vv.x,o[8]=Bo.x,o[1]=wu.y,o[5]=vv.y,o[9]=Bo.y,o[2]=wu.z,o[6]=vv.z,o[10]=Bo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,o=t.elements,u=this.elements,h=i[0],r=i[4],p=i[8],g=i[12],v=i[1],I=i[5],C=i[9],E=i[13],Q=i[2],M=i[6],D=i[10],P=i[14],O=i[3],F=i[7],N=i[11],z=i[15],X=o[0],q=o[4],H=o[8],W=o[12],se=o[1],de=o[5],te=o[9],ce=o[13],Ee=o[2],Be=o[6],De=o[10],Re=o[14],ye=o[3],ht=o[7],oe=o[11],Tt=o[15];return u[0]=h*X+r*se+p*Ee+g*ye,u[4]=h*q+r*de+p*Be+g*ht,u[8]=h*H+r*te+p*De+g*oe,u[12]=h*W+r*ce+p*Re+g*Tt,u[1]=v*X+I*se+C*Ee+E*ye,u[5]=v*q+I*de+C*Be+E*ht,u[9]=v*H+I*te+C*De+E*oe,u[13]=v*W+I*ce+C*Re+E*Tt,u[2]=Q*X+M*se+D*Ee+P*ye,u[6]=Q*q+M*de+D*Be+P*ht,u[10]=Q*H+M*te+D*De+P*oe,u[14]=Q*W+M*ce+D*Re+P*Tt,u[3]=O*X+F*se+N*Ee+z*ye,u[7]=O*q+F*de+N*Be+z*ht,u[11]=O*H+F*te+N*De+z*oe,u[15]=O*W+F*ce+N*Re+z*Tt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],o=e[8],u=e[12],h=e[1],r=e[5],p=e[9],g=e[13],v=e[2],I=e[6],C=e[10],E=e[14],Q=e[3],M=e[7],D=e[11],P=e[15];return Q*(+u*p*I-o*g*I-u*r*C+i*g*C+o*r*E-i*p*E)+M*(+t*p*E-t*g*C+u*h*C-o*h*E+o*g*v-u*p*v)+D*(+t*g*I-t*r*E-u*h*I+i*h*E+u*r*v-i*g*v)+P*(-o*r*v-t*p*I+t*r*C+o*h*I-i*h*C+i*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],o=e[2],u=e[3],h=e[4],r=e[5],p=e[6],g=e[7],v=e[8],I=e[9],C=e[10],E=e[11],Q=e[12],M=e[13],D=e[14],P=e[15],O=I*D*g-M*C*g+M*p*E-r*D*E-I*p*P+r*C*P,F=Q*C*g-v*D*g-Q*p*E+h*D*E+v*p*P-h*C*P,N=v*M*g-Q*I*g+Q*r*E-h*M*E-v*r*P+h*I*P,z=Q*I*p-v*M*p-Q*r*C+h*M*C+v*r*D-h*I*D,X=t*O+i*F+o*N+u*z;if(X===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/X;return e[0]=O*q,e[1]=(M*C*u-I*D*u-M*o*E+i*D*E+I*o*P-i*C*P)*q,e[2]=(r*D*u-M*p*u+M*o*g-i*D*g-r*o*P+i*p*P)*q,e[3]=(I*p*u-r*C*u-I*o*g+i*C*g+r*o*E-i*p*E)*q,e[4]=F*q,e[5]=(v*D*u-Q*C*u+Q*o*E-t*D*E-v*o*P+t*C*P)*q,e[6]=(Q*p*u-h*D*u-Q*o*g+t*D*g+h*o*P-t*p*P)*q,e[7]=(h*C*u-v*p*u+v*o*g-t*C*g-h*o*E+t*p*E)*q,e[8]=N*q,e[9]=(Q*I*u-v*M*u-Q*i*E+t*M*E+v*i*P-t*I*P)*q,e[10]=(h*M*u-Q*r*u+Q*i*g-t*M*g-h*i*P+t*r*P)*q,e[11]=(v*r*u-h*I*u-v*i*g+t*I*g+h*i*E-t*r*E)*q,e[12]=z*q,e[13]=(v*M*o-Q*I*o+Q*i*C-t*M*C-v*i*D+t*I*D)*q,e[14]=(Q*r*o-h*M*o-Q*i*p+t*M*p+h*i*D-t*r*D)*q,e[15]=(h*I*o-v*r*o+v*i*p-t*I*p-h*i*C+t*r*C)*q,this}scale(e){const t=this.elements,i=e.x,o=e.y,u=e.z;return t[0]*=i,t[4]*=o,t[8]*=u,t[1]*=i,t[5]*=o,t[9]*=u,t[2]*=i,t[6]*=o,t[10]*=u,t[3]*=i,t[7]*=o,t[11]*=u,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,o))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),o=Math.sin(t),u=1-i,h=e.x,r=e.y,p=e.z,g=u*h,v=u*r;return this.set(g*h+i,g*r-o*p,g*p+o*r,0,g*r+o*p,v*r+i,v*p-o*h,0,g*p-o*r,v*p+o*h,u*p*p+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,o,u,h){return this.set(1,i,u,0,e,1,h,0,t,o,1,0,0,0,0,1),this}compose(e,t,i){const o=this.elements,u=t._x,h=t._y,r=t._z,p=t._w,g=u+u,v=h+h,I=r+r,C=u*g,E=u*v,Q=u*I,M=h*v,D=h*I,P=r*I,O=p*g,F=p*v,N=p*I,z=i.x,X=i.y,q=i.z;return o[0]=(1-(M+P))*z,o[1]=(E+N)*z,o[2]=(Q-F)*z,o[3]=0,o[4]=(E-N)*X,o[5]=(1-(C+P))*X,o[6]=(D+O)*X,o[7]=0,o[8]=(Q+F)*q,o[9]=(D-O)*q,o[10]=(1-(C+M))*q,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,i){const o=this.elements;let u=xp.set(o[0],o[1],o[2]).length();const h=xp.set(o[4],o[5],o[6]).length(),r=xp.set(o[8],o[9],o[10]).length();this.determinant()<0&&(u=-u),e.x=o[12],e.y=o[13],e.z=o[14],Oa.copy(this);const g=1/u,v=1/h,I=1/r;return Oa.elements[0]*=g,Oa.elements[1]*=g,Oa.elements[2]*=g,Oa.elements[4]*=v,Oa.elements[5]*=v,Oa.elements[6]*=v,Oa.elements[8]*=I,Oa.elements[9]*=I,Oa.elements[10]*=I,t.setFromRotationMatrix(Oa),i.x=u,i.y=h,i.z=r,this}makePerspective(e,t,i,o,u,h){const r=this.elements,p=2*u/(t-e),g=2*u/(i-o),v=(t+e)/(t-e),I=(i+o)/(i-o),C=-(h+u)/(h-u),E=-2*h*u/(h-u);return r[0]=p,r[4]=0,r[8]=v,r[12]=0,r[1]=0,r[5]=g,r[9]=I,r[13]=0,r[2]=0,r[6]=0,r[10]=C,r[14]=E,r[3]=0,r[7]=0,r[11]=-1,r[15]=0,this}makeOrthographic(e,t,i,o,u,h){const r=this.elements,p=1/(t-e),g=1/(i-o),v=1/(h-u),I=(t+e)*p,C=(i+o)*g,E=(h+u)*v;return r[0]=2*p,r[4]=0,r[8]=0,r[12]=-I,r[1]=0,r[5]=2*g,r[9]=0,r[13]=-C,r[2]=0,r[6]=0,r[10]=-2*v,r[14]=-E,r[3]=0,r[7]=0,r[11]=0,r[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let o=0;o<16;o++)if(t[o]!==i[o])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const xp=new rt,Oa=new sn,S9=new rt(0,0,0),M9=new rt(1,1,1),wu=new rt,vv=new rt,Bo=new rt,$D=new sn,eQ=new Ll;class v1{constructor(e=0,t=0,i=0,o=v1.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,o=this._order){return this._x=e,this._y=t,this._z=i,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const o=e.elements,u=o[0],h=o[4],r=o[8],p=o[1],g=o[5],v=o[9],I=o[2],C=o[6],E=o[10];switch(t){case"XYZ":this._y=Math.asin(hs(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(-v,E),this._z=Math.atan2(-h,u)):(this._x=Math.atan2(C,g),this._z=0);break;case"YXZ":this._x=Math.asin(-hs(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(r,E),this._z=Math.atan2(p,g)):(this._y=Math.atan2(-I,u),this._z=0);break;case"ZXY":this._x=Math.asin(hs(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-I,E),this._z=Math.atan2(-h,g)):(this._y=0,this._z=Math.atan2(p,u));break;case"ZYX":this._y=Math.asin(-hs(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(C,E),this._z=Math.atan2(p,u)):(this._x=0,this._z=Math.atan2(-h,g));break;case"YZX":this._z=Math.asin(hs(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-v,g),this._y=Math.atan2(-I,u)):(this._x=0,this._y=Math.atan2(r,E));break;case"XZY":this._z=Math.asin(-hs(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(C,g),this._y=Math.atan2(r,u)):(this._x=Math.atan2(-v,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return $D.makeRotationFromQuaternion(e),this.setFromRotationMatrix($D,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return eQ.setFromEuler(this),this.setFromQuaternion(eQ,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}v1.DEFAULT_ORDER="XYZ";class CB{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let T9=0;const tQ=new rt,Ip=new Ll,sc=new sn,xv=new rt,Dm=new rt,D9=new rt,Q9=new Ll,iQ=new rt(1,0,0),nQ=new rt(0,1,0),rQ=new rt(0,0,1),R9={type:"added"},sQ={type:"removed"};class rr extends lf{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:T9++}),this.uuid=il(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=rr.DEFAULT_UP.clone();const e=new rt,t=new v1,i=new Ll,o=new rt(1,1,1);function u(){i.setFromEuler(t,!1)}function h(){t.setFromQuaternion(i,void 0,!1)}t._onChange(u),i._onChange(h),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new sn},normalMatrix:{value:new ko}}),this.matrix=new sn,this.matrixWorld=new sn,this.matrixAutoUpdate=rr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=rr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new CB,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ip.setFromAxisAngle(e,t),this.quaternion.multiply(Ip),this}rotateOnWorldAxis(e,t){return Ip.setFromAxisAngle(e,t),this.quaternion.premultiply(Ip),this}rotateX(e){return this.rotateOnAxis(iQ,e)}rotateY(e){return this.rotateOnAxis(nQ,e)}rotateZ(e){return this.rotateOnAxis(rQ,e)}translateOnAxis(e,t){return tQ.copy(e).applyQuaternion(this.quaternion),this.position.add(tQ.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(iQ,e)}translateY(e){return this.translateOnAxis(nQ,e)}translateZ(e){return this.translateOnAxis(rQ,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(sc.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?xv.copy(e):xv.set(e,t,i);const o=this.parent;this.updateWorldMatrix(!0,!1),Dm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?sc.lookAt(Dm,xv,this.up):sc.lookAt(xv,Dm,this.up),this.quaternion.setFromRotationMatrix(sc),o&&(sc.extractRotation(o.matrixWorld),Ip.setFromRotationMatrix(sc),this.quaternion.premultiply(Ip.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(R9)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(sQ)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(sQ)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),sc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),sc.multiply(e.parent.matrixWorld)),e.applyMatrix4(sc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,o=this.children.length;i<o;i++){const h=this.children[i].getObjectByProperty(e,t);if(h!==void 0)return h}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let o=0,u=this.children.length;o<u;o++){const h=this.children[o].getObjectsByProperty(e,t);h.length>0&&(i=i.concat(h))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dm,e,D9),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Dm,Q9,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,o=t.length;i<o;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,o=t.length;i<o;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,o=t.length;i<o;i++){const u=t[i];(u.matrixWorldAutoUpdate===!0||e===!0)&&u.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const o=this.children;for(let u=0,h=o.length;u<h;u++){const r=o[u];r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON()));function u(r,p){return r[p.uuid]===void 0&&(r[p.uuid]=p.toJSON(e)),p.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=u(e.geometries,this.geometry);const r=this.geometry.parameters;if(r!==void 0&&r.shapes!==void 0){const p=r.shapes;if(Array.isArray(p))for(let g=0,v=p.length;g<v;g++){const I=p[g];u(e.shapes,I)}else u(e.shapes,p)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(u(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const r=[];for(let p=0,g=this.material.length;p<g;p++)r.push(u(e.materials,this.material[p]));o.material=r}else o.material=u(e.materials,this.material);if(this.children.length>0){o.children=[];for(let r=0;r<this.children.length;r++)o.children.push(this.children[r].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let r=0;r<this.animations.length;r++){const p=this.animations[r];o.animations.push(u(e.animations,p))}}if(t){const r=h(e.geometries),p=h(e.materials),g=h(e.textures),v=h(e.images),I=h(e.shapes),C=h(e.skeletons),E=h(e.animations),Q=h(e.nodes);r.length>0&&(i.geometries=r),p.length>0&&(i.materials=p),g.length>0&&(i.textures=g),v.length>0&&(i.images=v),I.length>0&&(i.shapes=I),C.length>0&&(i.skeletons=C),E.length>0&&(i.animations=E),Q.length>0&&(i.nodes=Q)}return i.object=o,i;function h(r){const p=[];for(const g in r){const v=r[g];delete v.metadata,p.push(v)}return p}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const o=e.children[i];this.add(o.clone())}return this}}rr.DEFAULT_UP=new rt(0,1,0);rr.DEFAULT_MATRIX_AUTO_UPDATE=!0;rr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ga=new rt,oc=new rt,dE=new rt,ac=new rt,Cp=new rt,Ep=new rt,oQ=new rt,fE=new rt,pE=new rt,AE=new rt;class la{constructor(e=new rt,t=new rt,i=new rt){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,o){o.subVectors(i,t),Ga.subVectors(e,t),o.cross(Ga);const u=o.lengthSq();return u>0?o.multiplyScalar(1/Math.sqrt(u)):o.set(0,0,0)}static getBarycoord(e,t,i,o,u){Ga.subVectors(o,t),oc.subVectors(i,t),dE.subVectors(e,t);const h=Ga.dot(Ga),r=Ga.dot(oc),p=Ga.dot(dE),g=oc.dot(oc),v=oc.dot(dE),I=h*g-r*r;if(I===0)return u.set(-2,-1,-1);const C=1/I,E=(g*p-r*v)*C,Q=(h*v-r*p)*C;return u.set(1-E-Q,Q,E)}static containsPoint(e,t,i,o){return this.getBarycoord(e,t,i,o,ac),ac.x>=0&&ac.y>=0&&ac.x+ac.y<=1}static getUV(e,t,i,o,u,h,r,p){return this.getBarycoord(e,t,i,o,ac),p.set(0,0),p.addScaledVector(u,ac.x),p.addScaledVector(h,ac.y),p.addScaledVector(r,ac.z),p}static isFrontFacing(e,t,i,o){return Ga.subVectors(i,t),oc.subVectors(e,t),Ga.cross(oc).dot(o)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,o){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,i,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ga.subVectors(this.c,this.b),oc.subVectors(this.a,this.b),Ga.cross(oc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return la.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return la.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,o,u){return la.getUV(e,this.a,this.b,this.c,t,i,o,u)}containsPoint(e){return la.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return la.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,o=this.b,u=this.c;let h,r;Cp.subVectors(o,i),Ep.subVectors(u,i),fE.subVectors(e,i);const p=Cp.dot(fE),g=Ep.dot(fE);if(p<=0&&g<=0)return t.copy(i);pE.subVectors(e,o);const v=Cp.dot(pE),I=Ep.dot(pE);if(v>=0&&I<=v)return t.copy(o);const C=p*I-v*g;if(C<=0&&p>=0&&v<=0)return h=p/(p-v),t.copy(i).addScaledVector(Cp,h);AE.subVectors(e,u);const E=Cp.dot(AE),Q=Ep.dot(AE);if(Q>=0&&E<=Q)return t.copy(u);const M=E*g-p*Q;if(M<=0&&g>=0&&Q<=0)return r=g/(g-Q),t.copy(i).addScaledVector(Ep,r);const D=v*Q-E*I;if(D<=0&&I-v>=0&&E-Q>=0)return oQ.subVectors(u,o),r=(I-v)/(I-v+(E-Q)),t.copy(o).addScaledVector(oQ,r);const P=1/(D+M+C);return h=M*P,r=C*P,t.copy(i).addScaledVector(Cp,h).addScaledVector(Ep,r)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let L9=0;class _a extends lf{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:L9++}),this.uuid=il(),this.name="",this.type="Material",this.blending=oA,this.side=rl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=rk,this.blendDst=sk,this.blendEquation=Np,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Nw,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=u9,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=eE,this.stencilZFail=eE,this.stencilZPass=eE,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const o=this[t];if(o===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}o&&o.isColor?o.set(i):o&&o.isVector3&&i&&i.isVector3?o.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==oA&&(i.blending=this.blending),this.side!==rl&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function o(u){const h=[];for(const r in u){const p=u[r];delete p.metadata,h.push(p)}return h}if(t){const u=o(e.textures),h=o(e.images);u.length>0&&(i.textures=u),h.length>0&&(i.images=h)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const o=t.length;i=new Array(o);for(let u=0;u!==o;++u)i[u]=t[u].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ju extends _a{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Xi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ur=new rt,Iv=new Yi;class es{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Gw,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let o=0,u=this.itemSize;o<u;o++)this.array[e+o]=t.array[i+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Iv.fromBufferAttribute(this,t),Iv.applyMatrix3(e),this.setXY(t,Iv.x,Iv.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ur.fromBufferAttribute(this,t),Ur.applyMatrix3(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ur.fromBufferAttribute(this,t),Ur.applyMatrix4(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ur.fromBufferAttribute(this,t),Ur.applyNormalMatrix(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ur.fromBufferAttribute(this,t),Ur.transformDirection(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=wc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Zn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=wc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Zn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=wc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Zn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=wc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Zn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,o){return e*=this.itemSize,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array),o=Zn(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=o,this}setXYZW(e,t,i,o,u){return e*=this.itemSize,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array),o=Zn(o,this.array),u=Zn(u,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=o,this.array[e+3]=u,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Gw&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class gk extends es{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class mk extends es{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Mc extends es{constructor(e,t,i){super(new Float32Array(e),t,i)}}let P9=0;const ea=new sn,gE=new rr,wp=new rt,So=new xa,Qm=new xa,ls=new rt;class Oo extends lf{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:P9++}),this.uuid=il(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hk(e)?mk:gk)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const u=new ko().getNormalMatrix(e);i.applyNormalMatrix(u),i.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ea.makeRotationFromQuaternion(e),this.applyMatrix4(ea),this}rotateX(e){return ea.makeRotationX(e),this.applyMatrix4(ea),this}rotateY(e){return ea.makeRotationY(e),this.applyMatrix4(ea),this}rotateZ(e){return ea.makeRotationZ(e),this.applyMatrix4(ea),this}translate(e,t,i){return ea.makeTranslation(e,t,i),this.applyMatrix4(ea),this}scale(e,t,i){return ea.makeScale(e,t,i),this.applyMatrix4(ea),this}lookAt(e){return gE.lookAt(e),gE.updateMatrix(),this.applyMatrix4(gE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(wp).negate(),this.translate(wp.x,wp.y,wp.z),this}setFromPoints(e){const t=[];for(let i=0,o=e.length;i<o;i++){const u=e[i];t.push(u.x,u.y,u.z||0)}return this.setAttribute("position",new Mc(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new rt(-1/0,-1/0,-1/0),new rt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,o=t.length;i<o;i++){const u=t[i];So.setFromBufferAttribute(u),this.morphTargetsRelative?(ls.addVectors(this.boundingBox.min,So.min),this.boundingBox.expandByPoint(ls),ls.addVectors(this.boundingBox.max,So.max),this.boundingBox.expandByPoint(ls)):(this.boundingBox.expandByPoint(So.min),this.boundingBox.expandByPoint(So.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new cf);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new rt,1/0);return}if(e){const i=this.boundingSphere.center;if(So.setFromBufferAttribute(e),t)for(let u=0,h=t.length;u<h;u++){const r=t[u];Qm.setFromBufferAttribute(r),this.morphTargetsRelative?(ls.addVectors(So.min,Qm.min),So.expandByPoint(ls),ls.addVectors(So.max,Qm.max),So.expandByPoint(ls)):(So.expandByPoint(Qm.min),So.expandByPoint(Qm.max))}So.getCenter(i);let o=0;for(let u=0,h=e.count;u<h;u++)ls.fromBufferAttribute(e,u),o=Math.max(o,i.distanceToSquared(ls));if(t)for(let u=0,h=t.length;u<h;u++){const r=t[u],p=this.morphTargetsRelative;for(let g=0,v=r.count;g<v;g++)ls.fromBufferAttribute(r,g),p&&(wp.fromBufferAttribute(e,g),ls.add(wp)),o=Math.max(o,i.distanceToSquared(ls))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,o=t.position.array,u=t.normal.array,h=t.uv.array,r=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new es(new Float32Array(4*r),4));const p=this.getAttribute("tangent").array,g=[],v=[];for(let se=0;se<r;se++)g[se]=new rt,v[se]=new rt;const I=new rt,C=new rt,E=new rt,Q=new Yi,M=new Yi,D=new Yi,P=new rt,O=new rt;function F(se,de,te){I.fromArray(o,se*3),C.fromArray(o,de*3),E.fromArray(o,te*3),Q.fromArray(h,se*2),M.fromArray(h,de*2),D.fromArray(h,te*2),C.sub(I),E.sub(I),M.sub(Q),D.sub(Q);const ce=1/(M.x*D.y-D.x*M.y);isFinite(ce)&&(P.copy(C).multiplyScalar(D.y).addScaledVector(E,-M.y).multiplyScalar(ce),O.copy(E).multiplyScalar(M.x).addScaledVector(C,-D.x).multiplyScalar(ce),g[se].add(P),g[de].add(P),g[te].add(P),v[se].add(O),v[de].add(O),v[te].add(O))}let N=this.groups;N.length===0&&(N=[{start:0,count:i.length}]);for(let se=0,de=N.length;se<de;++se){const te=N[se],ce=te.start,Ee=te.count;for(let Be=ce,De=ce+Ee;Be<De;Be+=3)F(i[Be+0],i[Be+1],i[Be+2])}const z=new rt,X=new rt,q=new rt,H=new rt;function W(se){q.fromArray(u,se*3),H.copy(q);const de=g[se];z.copy(de),z.sub(q.multiplyScalar(q.dot(de))).normalize(),X.crossVectors(H,de);const ce=X.dot(v[se])<0?-1:1;p[se*4]=z.x,p[se*4+1]=z.y,p[se*4+2]=z.z,p[se*4+3]=ce}for(let se=0,de=N.length;se<de;++se){const te=N[se],ce=te.start,Ee=te.count;for(let Be=ce,De=ce+Ee;Be<De;Be+=3)W(i[Be+0]),W(i[Be+1]),W(i[Be+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new es(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let C=0,E=i.count;C<E;C++)i.setXYZ(C,0,0,0);const o=new rt,u=new rt,h=new rt,r=new rt,p=new rt,g=new rt,v=new rt,I=new rt;if(e)for(let C=0,E=e.count;C<E;C+=3){const Q=e.getX(C+0),M=e.getX(C+1),D=e.getX(C+2);o.fromBufferAttribute(t,Q),u.fromBufferAttribute(t,M),h.fromBufferAttribute(t,D),v.subVectors(h,u),I.subVectors(o,u),v.cross(I),r.fromBufferAttribute(i,Q),p.fromBufferAttribute(i,M),g.fromBufferAttribute(i,D),r.add(v),p.add(v),g.add(v),i.setXYZ(Q,r.x,r.y,r.z),i.setXYZ(M,p.x,p.y,p.z),i.setXYZ(D,g.x,g.y,g.z)}else for(let C=0,E=t.count;C<E;C+=3)o.fromBufferAttribute(t,C+0),u.fromBufferAttribute(t,C+1),h.fromBufferAttribute(t,C+2),v.subVectors(h,u),I.subVectors(o,u),v.cross(I),i.setXYZ(C+0,v.x,v.y,v.z),i.setXYZ(C+1,v.x,v.y,v.z),i.setXYZ(C+2,v.x,v.y,v.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ls.fromBufferAttribute(e,t),ls.normalize(),e.setXYZ(t,ls.x,ls.y,ls.z)}toNonIndexed(){function e(r,p){const g=r.array,v=r.itemSize,I=r.normalized,C=new g.constructor(p.length*v);let E=0,Q=0;for(let M=0,D=p.length;M<D;M++){r.isInterleavedBufferAttribute?E=p[M]*r.data.stride+r.offset:E=p[M]*v;for(let P=0;P<v;P++)C[Q++]=g[E++]}return new es(C,v,I)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Oo,i=this.index.array,o=this.attributes;for(const r in o){const p=o[r],g=e(p,i);t.setAttribute(r,g)}const u=this.morphAttributes;for(const r in u){const p=[],g=u[r];for(let v=0,I=g.length;v<I;v++){const C=g[v],E=e(C,i);p.push(E)}t.morphAttributes[r]=p}t.morphTargetsRelative=this.morphTargetsRelative;const h=this.groups;for(let r=0,p=h.length;r<p;r++){const g=h[r];t.addGroup(g.start,g.count,g.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const p=this.parameters;for(const g in p)p[g]!==void 0&&(e[g]=p[g]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const p in i){const g=i[p];e.data.attributes[p]=g.toJSON(e.data)}const o={};let u=!1;for(const p in this.morphAttributes){const g=this.morphAttributes[p],v=[];for(let I=0,C=g.length;I<C;I++){const E=g[I];v.push(E.toJSON(e.data))}v.length>0&&(o[p]=v,u=!0)}u&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const h=this.groups;h.length>0&&(e.data.groups=JSON.parse(JSON.stringify(h)));const r=this.boundingSphere;return r!==null&&(e.data.boundingSphere={center:r.center.toArray(),radius:r.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const o=e.attributes;for(const g in o){const v=o[g];this.setAttribute(g,v.clone(t))}const u=e.morphAttributes;for(const g in u){const v=[],I=u[g];for(let C=0,E=I.length;C<E;C++)v.push(I[C].clone(t));this.morphAttributes[g]=v}this.morphTargetsRelative=e.morphTargetsRelative;const h=e.groups;for(let g=0,v=h.length;g<v;g++){const I=h[g];this.addGroup(I.start,I.count,I.materialIndex)}const r=e.boundingBox;r!==null&&(this.boundingBox=r.clone());const p=e.boundingSphere;return p!==null&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const aQ=new sn,bp=new m0,mE=new cf,Rm=new rt,Lm=new rt,Pm=new rt,_E=new rt,Cv=new rt,Ev=new Yi,wv=new Yi,bv=new Yi,yE=new rt,Bv=new rt;class nr extends rr{constructor(e=new Oo,t=new ju){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const o=t[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=o.length;u<h;u++){const r=o[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=u}}}}getVertexPosition(e,t){const i=this.geometry,o=i.attributes.position,u=i.morphAttributes.position,h=i.morphTargetsRelative;t.fromBufferAttribute(o,e);const r=this.morphTargetInfluences;if(u&&r){Cv.set(0,0,0);for(let p=0,g=u.length;p<g;p++){const v=r[p],I=u[p];v!==0&&(_E.fromBufferAttribute(I,e),h?Cv.addScaledVector(_E,v):Cv.addScaledVector(_E.sub(t),v))}t.add(Cv)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,o=this.material,u=this.matrixWorld;if(o===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),mE.copy(i.boundingSphere),mE.applyMatrix4(u),e.ray.intersectsSphere(mE)===!1)||(aQ.copy(u).invert(),bp.copy(e.ray).applyMatrix4(aQ),i.boundingBox!==null&&bp.intersectsBox(i.boundingBox)===!1))return;let h;const r=i.index,p=i.attributes.position,g=i.attributes.uv,v=i.attributes.uv2,I=i.groups,C=i.drawRange;if(r!==null)if(Array.isArray(o))for(let E=0,Q=I.length;E<Q;E++){const M=I[E],D=o[M.materialIndex],P=Math.max(M.start,C.start),O=Math.min(r.count,Math.min(M.start+M.count,C.start+C.count));for(let F=P,N=O;F<N;F+=3){const z=r.getX(F),X=r.getX(F+1),q=r.getX(F+2);h=Sv(this,D,e,bp,g,v,z,X,q),h&&(h.faceIndex=Math.floor(F/3),h.face.materialIndex=M.materialIndex,t.push(h))}}else{const E=Math.max(0,C.start),Q=Math.min(r.count,C.start+C.count);for(let M=E,D=Q;M<D;M+=3){const P=r.getX(M),O=r.getX(M+1),F=r.getX(M+2);h=Sv(this,o,e,bp,g,v,P,O,F),h&&(h.faceIndex=Math.floor(M/3),t.push(h))}}else if(p!==void 0)if(Array.isArray(o))for(let E=0,Q=I.length;E<Q;E++){const M=I[E],D=o[M.materialIndex],P=Math.max(M.start,C.start),O=Math.min(p.count,Math.min(M.start+M.count,C.start+C.count));for(let F=P,N=O;F<N;F+=3){const z=F,X=F+1,q=F+2;h=Sv(this,D,e,bp,g,v,z,X,q),h&&(h.faceIndex=Math.floor(F/3),h.face.materialIndex=M.materialIndex,t.push(h))}}else{const E=Math.max(0,C.start),Q=Math.min(p.count,C.start+C.count);for(let M=E,D=Q;M<D;M+=3){const P=M,O=M+1,F=M+2;h=Sv(this,o,e,bp,g,v,P,O,F),h&&(h.faceIndex=Math.floor(M/3),t.push(h))}}}}function k9(n,e,t,i,o,u,h,r){let p;if(e.side===_o?p=i.intersectTriangle(h,u,o,!0,r):p=i.intersectTriangle(o,u,h,e.side===rl,r),p===null)return null;Bv.copy(r),Bv.applyMatrix4(n.matrixWorld);const g=t.ray.origin.distanceTo(Bv);return g<t.near||g>t.far?null:{distance:g,point:Bv.clone(),object:n}}function Sv(n,e,t,i,o,u,h,r,p){n.getVertexPosition(h,Rm),n.getVertexPosition(r,Lm),n.getVertexPosition(p,Pm);const g=k9(n,e,t,i,Rm,Lm,Pm,yE);if(g){o&&(Ev.fromBufferAttribute(o,h),wv.fromBufferAttribute(o,r),bv.fromBufferAttribute(o,p),g.uv=la.getUV(yE,Rm,Lm,Pm,Ev,wv,bv,new Yi)),u&&(Ev.fromBufferAttribute(u,h),wv.fromBufferAttribute(u,r),bv.fromBufferAttribute(u,p),g.uv2=la.getUV(yE,Rm,Lm,Pm,Ev,wv,bv,new Yi));const v={a:h,b:r,c:p,normal:new rt,materialIndex:0};la.getNormal(Rm,Lm,Pm,v.normal),g.face=v}return g}class _0 extends Oo{constructor(e=1,t=1,i=1,o=1,u=1,h=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:o,heightSegments:u,depthSegments:h};const r=this;o=Math.floor(o),u=Math.floor(u),h=Math.floor(h);const p=[],g=[],v=[],I=[];let C=0,E=0;Q("z","y","x",-1,-1,i,t,e,h,u,0),Q("z","y","x",1,-1,i,t,-e,h,u,1),Q("x","z","y",1,1,e,i,t,o,h,2),Q("x","z","y",1,-1,e,i,-t,o,h,3),Q("x","y","z",1,-1,e,t,i,o,u,4),Q("x","y","z",-1,-1,e,t,-i,o,u,5),this.setIndex(p),this.setAttribute("position",new Mc(g,3)),this.setAttribute("normal",new Mc(v,3)),this.setAttribute("uv",new Mc(I,2));function Q(M,D,P,O,F,N,z,X,q,H,W){const se=N/q,de=z/H,te=N/2,ce=z/2,Ee=X/2,Be=q+1,De=H+1;let Re=0,ye=0;const ht=new rt;for(let oe=0;oe<De;oe++){const Tt=oe*de-ce;for(let Fe=0;Fe<Be;Fe++){const st=Fe*se-te;ht[M]=st*O,ht[D]=Tt*F,ht[P]=Ee,g.push(ht.x,ht.y,ht.z),ht[M]=0,ht[D]=0,ht[P]=X>0?1:-1,v.push(ht.x,ht.y,ht.z),I.push(Fe/q),I.push(1-oe/H),Re+=1}}for(let oe=0;oe<H;oe++)for(let Tt=0;Tt<q;Tt++){const Fe=C+Tt+Be*oe,st=C+Tt+Be*(oe+1),Et=C+(Tt+1)+Be*(oe+1),Ke=C+(Tt+1)+Be*oe;p.push(Fe,st,Ke),p.push(st,Et,Ke),ye+=6}r.addGroup(E,ye,W),E+=ye,C+=Re}}static fromJSON(e){return new _0(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function PA(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const o=n[t][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?e[t][i]=o.clone():Array.isArray(o)?e[t][i]=o.slice():e[t][i]=o}}return e}function js(n){const e={};for(let t=0;t<n.length;t++){const i=PA(n[t]);for(const o in i)e[o]=i[o]}return e}function F9(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function _k(n){return n.getRenderTarget()===null&&n.outputEncoding===Cn?vl:n0}const N9={clone:PA,merge:js};var z9=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,U9=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class $d extends _a{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=z9,this.fragmentShader=U9,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=PA(e.uniforms),this.uniformsGroups=F9(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const h=this.uniforms[o].value;h&&h.isTexture?t.uniforms[o]={type:"t",value:h.toJSON(e).uuid}:h&&h.isColor?t.uniforms[o]={type:"c",value:h.getHex()}:h&&h.isVector2?t.uniforms[o]={type:"v2",value:h.toArray()}:h&&h.isVector3?t.uniforms[o]={type:"v3",value:h.toArray()}:h&&h.isVector4?t.uniforms[o]={type:"v4",value:h.toArray()}:h&&h.isMatrix3?t.uniforms[o]={type:"m3",value:h.toArray()}:h&&h.isMatrix4?t.uniforms[o]={type:"m4",value:h.toArray()}:t.uniforms[o]={value:h}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const o in this.extensions)this.extensions[o]===!0&&(i[o]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class yk extends rr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new sn,this.projectionMatrix=new sn,this.projectionMatrixInverse=new sn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class ds extends yk{constructor(e=50,t=1,i=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=r0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Q_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return r0*2*Math.atan(Math.tan(Q_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,o,u,h){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=o,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Q_*.5*this.fov)/this.zoom,i=2*t,o=this.aspect*i,u=-.5*o;const h=this.view;if(this.view!==null&&this.view.enabled){const p=h.fullWidth,g=h.fullHeight;u+=h.offsetX*o/p,t-=h.offsetY*i/g,o*=h.width/p,i*=h.height/g}const r=this.filmOffset;r!==0&&(u+=e*r/this.getFilmWidth()),this.projectionMatrix.makePerspective(u,u+o,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Bp=-90,Sp=1;class O9 extends rr{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const o=new ds(Bp,Sp,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(1,0,0),this.add(o);const u=new ds(Bp,Sp,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(-1,0,0),this.add(u);const h=new ds(Bp,Sp,e,t);h.layers=this.layers,h.up.set(0,0,-1),h.lookAt(0,1,0),this.add(h);const r=new ds(Bp,Sp,e,t);r.layers=this.layers,r.up.set(0,0,1),r.lookAt(0,-1,0),this.add(r);const p=new ds(Bp,Sp,e,t);p.layers=this.layers,p.up.set(0,1,0),p.lookAt(0,0,1),this.add(p);const g=new ds(Bp,Sp,e,t);g.layers=this.layers,g.up.set(0,1,0),g.lookAt(0,0,-1),this.add(g)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[o,u,h,r,p,g]=this.children,v=e.getRenderTarget(),I=e.toneMapping,C=e.xr.enabled;e.toneMapping=Sc,e.xr.enabled=!1;const E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,o),e.setRenderTarget(i,1),e.render(t,u),e.setRenderTarget(i,2),e.render(t,h),e.setRenderTarget(i,3),e.render(t,r),e.setRenderTarget(i,4),e.render(t,p),i.texture.generateMipmaps=E,e.setRenderTarget(i,5),e.render(t,g),e.setRenderTarget(v),e.toneMapping=I,e.xr.enabled=C,i.texture.needsPMREMUpdate=!0}}class vk extends Cs{constructor(e,t,i,o,u,h,r,p,g,v){e=e!==void 0?e:[],t=t!==void 0?t:TA,super(e,t,i,o,u,h,r,p,g,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class G9 extends Zd{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},o=[i,i,i,i,i,i];this.texture=new vk(o,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:$r}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new _0(5,5,5),u=new $d({name:"CubemapFromEquirect",uniforms:PA(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:_o,blending:$u});u.uniforms.tEquirect.value=t;const h=new nr(o,u),r=t.minFilter;return t.minFilter===ch&&(t.minFilter=$r),new O9(1,10,this).update(e,h),t.minFilter=r,h.geometry.dispose(),h.material.dispose(),this}clear(e,t,i,o){const u=e.getRenderTarget();for(let h=0;h<6;h++)e.setRenderTarget(this,h),e.clear(t,i,o);e.setRenderTarget(u)}}const vE=new rt,H9=new rt,V9=new ko;class mc{constructor(e=new rt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,o){return this.normal.set(e,t,i),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const o=vE.subVectors(i,t).cross(H9.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(vE),o=this.normal.dot(i);if(o===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const u=-(e.start.dot(this.normal)+this.constant)/o;return u<0||u>1?null:t.copy(i).multiplyScalar(u).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||V9.getNormalMatrix(e),o=this.coplanarPoint(vE).applyMatrix4(e),u=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(u),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Mp=new cf,Mv=new rt;class EB{constructor(e=new mc,t=new mc,i=new mc,o=new mc,u=new mc,h=new mc){this.planes=[e,t,i,o,u,h]}set(e,t,i,o,u,h){const r=this.planes;return r[0].copy(e),r[1].copy(t),r[2].copy(i),r[3].copy(o),r[4].copy(u),r[5].copy(h),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,o=i[0],u=i[1],h=i[2],r=i[3],p=i[4],g=i[5],v=i[6],I=i[7],C=i[8],E=i[9],Q=i[10],M=i[11],D=i[12],P=i[13],O=i[14],F=i[15];return t[0].setComponents(r-o,I-p,M-C,F-D).normalize(),t[1].setComponents(r+o,I+p,M+C,F+D).normalize(),t[2].setComponents(r+u,I+g,M+E,F+P).normalize(),t[3].setComponents(r-u,I-g,M-E,F-P).normalize(),t[4].setComponents(r-h,I-v,M-Q,F-O).normalize(),t[5].setComponents(r+h,I+v,M+Q,F+O).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Mp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mp)}intersectsSprite(e){return Mp.center.set(0,0,0),Mp.radius=.7071067811865476,Mp.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mp)}intersectsSphere(e){const t=this.planes,i=e.center,o=-e.radius;for(let u=0;u<6;u++)if(t[u].distanceToPoint(i)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const o=t[i];if(Mv.x=o.normal.x>0?e.max.x:e.min.x,Mv.y=o.normal.y>0?e.max.y:e.min.y,Mv.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Mv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function xk(){let n=null,e=!1,t=null,i=null;function o(u,h){t(u,h),i=n.requestAnimationFrame(o)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(o),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(u){t=u},setContext:function(u){n=u}}}function W9(n,e){const t=e.isWebGL2,i=new WeakMap;function o(g,v){const I=g.array,C=g.usage,E=n.createBuffer();n.bindBuffer(v,E),n.bufferData(v,I,C),g.onUploadCallback();let Q;if(I instanceof Float32Array)Q=5126;else if(I instanceof Uint16Array)if(g.isFloat16BufferAttribute)if(t)Q=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else Q=5123;else if(I instanceof Int16Array)Q=5122;else if(I instanceof Uint32Array)Q=5125;else if(I instanceof Int32Array)Q=5124;else if(I instanceof Int8Array)Q=5120;else if(I instanceof Uint8Array)Q=5121;else if(I instanceof Uint8ClampedArray)Q=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+I);return{buffer:E,type:Q,bytesPerElement:I.BYTES_PER_ELEMENT,version:g.version}}function u(g,v,I){const C=v.array,E=v.updateRange;n.bindBuffer(I,g),E.count===-1?n.bufferSubData(I,0,C):(t?n.bufferSubData(I,E.offset*C.BYTES_PER_ELEMENT,C,E.offset,E.count):n.bufferSubData(I,E.offset*C.BYTES_PER_ELEMENT,C.subarray(E.offset,E.offset+E.count)),E.count=-1),v.onUploadCallback()}function h(g){return g.isInterleavedBufferAttribute&&(g=g.data),i.get(g)}function r(g){g.isInterleavedBufferAttribute&&(g=g.data);const v=i.get(g);v&&(n.deleteBuffer(v.buffer),i.delete(g))}function p(g,v){if(g.isGLBufferAttribute){const C=i.get(g);(!C||C.version<g.version)&&i.set(g,{buffer:g.buffer,type:g.type,bytesPerElement:g.elementSize,version:g.version});return}g.isInterleavedBufferAttribute&&(g=g.data);const I=i.get(g);I===void 0?i.set(g,o(g,v)):I.version<g.version&&(u(I.buffer,g,v),I.version=g.version)}return{get:h,remove:r,update:p}}class WA extends Oo{constructor(e=1,t=1,i=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:o};const u=e/2,h=t/2,r=Math.floor(i),p=Math.floor(o),g=r+1,v=p+1,I=e/r,C=t/p,E=[],Q=[],M=[],D=[];for(let P=0;P<v;P++){const O=P*C-h;for(let F=0;F<g;F++){const N=F*I-u;Q.push(N,-O,0),M.push(0,0,1),D.push(F/r),D.push(1-P/p)}}for(let P=0;P<p;P++)for(let O=0;O<r;O++){const F=O+g*P,N=O+g*(P+1),z=O+1+g*(P+1),X=O+1+g*P;E.push(F,N,X),E.push(N,z,X)}this.setIndex(E),this.setAttribute("position",new Mc(Q,3)),this.setAttribute("normal",new Mc(M,3)),this.setAttribute("uv",new Mc(D,2))}static fromJSON(e){return new WA(e.width,e.height,e.widthSegments,e.heightSegments)}}var Y9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,j9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,q9=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,K9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,J9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,X9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Z9="vec3 transformed = vec3( position );",$9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,e7=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,t7=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,i7=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,n7=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,r7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,s7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,o7=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,a7=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,l7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,c7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,u7=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,h7=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,d7=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,f7=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,p7=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,A7=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,g7=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,m7=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,_7="gl_FragColor = linearToOutputTexel( gl_FragColor );",y7=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,v7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,x7=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,I7=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,C7=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,E7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,w7=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,b7=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,B7=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,S7=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,M7=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,T7=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,D7=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Q7=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,R7=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,L7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,P7=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,k7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,F7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,N7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,z7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,U7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,O7=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,G7=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,H7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,V7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,W7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Y7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,j7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,q7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,K7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,J7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,X7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Z7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,eW=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,tW=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,iW=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,nW=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,rW=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,sW=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,oW=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,aW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,lW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,cW=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,uW=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,hW=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,dW=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,fW=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,pW=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,AW=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,gW=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,mW=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,_W=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,yW=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,vW=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,xW=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,IW=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,CW=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,EW=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wW=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,bW=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,BW=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,SW=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,MW=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,TW=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,DW=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,QW=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,RW=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,LW=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,PW=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,kW=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,FW=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,NW=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,zW=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,UW=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,OW=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,GW=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,HW=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const VW=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,WW=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,YW=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,jW=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,qW=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KW=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JW=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,XW=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,ZW=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,$W=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,eY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,tY=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,iY=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,nY=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,rY=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,sY=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oY=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,aY=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lY=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,cY=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uY=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,hY=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,dY=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fY=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pY=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,AY=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gY=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mY=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_Y=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,yY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vY=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xY=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,IY=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,CY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ln={alphamap_fragment:Y9,alphamap_pars_fragment:j9,alphatest_fragment:q9,alphatest_pars_fragment:K9,aomap_fragment:J9,aomap_pars_fragment:X9,begin_vertex:Z9,beginnormal_vertex:$9,bsdfs:e7,iridescence_fragment:t7,bumpmap_pars_fragment:i7,clipping_planes_fragment:n7,clipping_planes_pars_fragment:r7,clipping_planes_pars_vertex:s7,clipping_planes_vertex:o7,color_fragment:a7,color_pars_fragment:l7,color_pars_vertex:c7,color_vertex:u7,common:h7,cube_uv_reflection_fragment:d7,defaultnormal_vertex:f7,displacementmap_pars_vertex:p7,displacementmap_vertex:A7,emissivemap_fragment:g7,emissivemap_pars_fragment:m7,encodings_fragment:_7,encodings_pars_fragment:y7,envmap_fragment:v7,envmap_common_pars_fragment:x7,envmap_pars_fragment:I7,envmap_pars_vertex:C7,envmap_physical_pars_fragment:P7,envmap_vertex:E7,fog_vertex:w7,fog_pars_vertex:b7,fog_fragment:B7,fog_pars_fragment:S7,gradientmap_pars_fragment:M7,lightmap_fragment:T7,lightmap_pars_fragment:D7,lights_lambert_fragment:Q7,lights_lambert_pars_fragment:R7,lights_pars_begin:L7,lights_toon_fragment:k7,lights_toon_pars_fragment:F7,lights_phong_fragment:N7,lights_phong_pars_fragment:z7,lights_physical_fragment:U7,lights_physical_pars_fragment:O7,lights_fragment_begin:G7,lights_fragment_maps:H7,lights_fragment_end:V7,logdepthbuf_fragment:W7,logdepthbuf_pars_fragment:Y7,logdepthbuf_pars_vertex:j7,logdepthbuf_vertex:q7,map_fragment:K7,map_pars_fragment:J7,map_particle_fragment:X7,map_particle_pars_fragment:Z7,metalnessmap_fragment:$7,metalnessmap_pars_fragment:eW,morphcolor_vertex:tW,morphnormal_vertex:iW,morphtarget_pars_vertex:nW,morphtarget_vertex:rW,normal_fragment_begin:sW,normal_fragment_maps:oW,normal_pars_fragment:aW,normal_pars_vertex:lW,normal_vertex:cW,normalmap_pars_fragment:uW,clearcoat_normal_fragment_begin:hW,clearcoat_normal_fragment_maps:dW,clearcoat_pars_fragment:fW,iridescence_pars_fragment:pW,output_fragment:AW,packing:gW,premultiplied_alpha_fragment:mW,project_vertex:_W,dithering_fragment:yW,dithering_pars_fragment:vW,roughnessmap_fragment:xW,roughnessmap_pars_fragment:IW,shadowmap_pars_fragment:CW,shadowmap_pars_vertex:EW,shadowmap_vertex:wW,shadowmask_pars_fragment:bW,skinbase_vertex:BW,skinning_pars_vertex:SW,skinning_vertex:MW,skinnormal_vertex:TW,specularmap_fragment:DW,specularmap_pars_fragment:QW,tonemapping_fragment:RW,tonemapping_pars_fragment:LW,transmission_fragment:PW,transmission_pars_fragment:kW,uv_pars_fragment:FW,uv_pars_vertex:NW,uv_vertex:zW,uv2_pars_fragment:UW,uv2_pars_vertex:OW,uv2_vertex:GW,worldpos_vertex:HW,background_vert:VW,background_frag:WW,backgroundCube_vert:YW,backgroundCube_frag:jW,cube_vert:qW,cube_frag:KW,depth_vert:JW,depth_frag:XW,distanceRGBA_vert:ZW,distanceRGBA_frag:$W,equirect_vert:eY,equirect_frag:tY,linedashed_vert:iY,linedashed_frag:nY,meshbasic_vert:rY,meshbasic_frag:sY,meshlambert_vert:oY,meshlambert_frag:aY,meshmatcap_vert:lY,meshmatcap_frag:cY,meshnormal_vert:uY,meshnormal_frag:hY,meshphong_vert:dY,meshphong_frag:fY,meshphysical_vert:pY,meshphysical_frag:AY,meshtoon_vert:gY,meshtoon_frag:mY,points_vert:_Y,points_frag:yY,shadow_vert:vY,shadow_frag:xY,sprite_vert:IY,sprite_frag:CY},Ei={common:{diffuse:{value:new Xi(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ko},uv2Transform:{value:new ko},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Yi(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Xi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ko}},sprite:{diffuse:{value:new Xi(16777215)},opacity:{value:1},center:{value:new Yi(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ko}}},Il={basic:{uniforms:js([Ei.common,Ei.specularmap,Ei.envmap,Ei.aomap,Ei.lightmap,Ei.fog]),vertexShader:ln.meshbasic_vert,fragmentShader:ln.meshbasic_frag},lambert:{uniforms:js([Ei.common,Ei.specularmap,Ei.envmap,Ei.aomap,Ei.lightmap,Ei.emissivemap,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,Ei.fog,Ei.lights,{emissive:{value:new Xi(0)}}]),vertexShader:ln.meshlambert_vert,fragmentShader:ln.meshlambert_frag},phong:{uniforms:js([Ei.common,Ei.specularmap,Ei.envmap,Ei.aomap,Ei.lightmap,Ei.emissivemap,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,Ei.fog,Ei.lights,{emissive:{value:new Xi(0)},specular:{value:new Xi(1118481)},shininess:{value:30}}]),vertexShader:ln.meshphong_vert,fragmentShader:ln.meshphong_frag},standard:{uniforms:js([Ei.common,Ei.envmap,Ei.aomap,Ei.lightmap,Ei.emissivemap,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,Ei.roughnessmap,Ei.metalnessmap,Ei.fog,Ei.lights,{emissive:{value:new Xi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ln.meshphysical_vert,fragmentShader:ln.meshphysical_frag},toon:{uniforms:js([Ei.common,Ei.aomap,Ei.lightmap,Ei.emissivemap,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,Ei.gradientmap,Ei.fog,Ei.lights,{emissive:{value:new Xi(0)}}]),vertexShader:ln.meshtoon_vert,fragmentShader:ln.meshtoon_frag},matcap:{uniforms:js([Ei.common,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,Ei.fog,{matcap:{value:null}}]),vertexShader:ln.meshmatcap_vert,fragmentShader:ln.meshmatcap_frag},points:{uniforms:js([Ei.points,Ei.fog]),vertexShader:ln.points_vert,fragmentShader:ln.points_frag},dashed:{uniforms:js([Ei.common,Ei.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ln.linedashed_vert,fragmentShader:ln.linedashed_frag},depth:{uniforms:js([Ei.common,Ei.displacementmap]),vertexShader:ln.depth_vert,fragmentShader:ln.depth_frag},normal:{uniforms:js([Ei.common,Ei.bumpmap,Ei.normalmap,Ei.displacementmap,{opacity:{value:1}}]),vertexShader:ln.meshnormal_vert,fragmentShader:ln.meshnormal_frag},sprite:{uniforms:js([Ei.sprite,Ei.fog]),vertexShader:ln.sprite_vert,fragmentShader:ln.sprite_frag},background:{uniforms:{uvTransform:{value:new ko},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ln.background_vert,fragmentShader:ln.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ln.backgroundCube_vert,fragmentShader:ln.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ln.cube_vert,fragmentShader:ln.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ln.equirect_vert,fragmentShader:ln.equirect_frag},distanceRGBA:{uniforms:js([Ei.common,Ei.displacementmap,{referencePosition:{value:new rt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ln.distanceRGBA_vert,fragmentShader:ln.distanceRGBA_frag},shadow:{uniforms:js([Ei.lights,Ei.fog,{color:{value:new Xi(0)},opacity:{value:1}}]),vertexShader:ln.shadow_vert,fragmentShader:ln.shadow_frag}};Il.physical={uniforms:js([Il.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Yi(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Xi(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Yi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Xi(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Xi(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ln.meshphysical_vert,fragmentShader:ln.meshphysical_frag};const Tv={r:0,b:0,g:0};function EY(n,e,t,i,o,u,h){const r=new Xi(0);let p=u===!0?0:1,g,v,I=null,C=0,E=null;function Q(D,P){let O=!1,F=P.isScene===!0?P.background:null;F&&F.isTexture&&(F=(P.backgroundBlurriness>0?t:e).get(F));const N=n.xr,z=N.getSession&&N.getSession();z&&z.environmentBlendMode==="additive"&&(F=null),F===null?M(r,p):F&&F.isColor&&(M(F,1),O=!0),(n.autoClear||O)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),F&&(F.isCubeTexture||F.mapping===y1)?(v===void 0&&(v=new nr(new _0(1,1,1),new $d({name:"BackgroundCubeMaterial",uniforms:PA(Il.backgroundCube.uniforms),vertexShader:Il.backgroundCube.vertexShader,fragmentShader:Il.backgroundCube.fragmentShader,side:_o,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(X,q,H){this.matrixWorld.copyPosition(H.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(v)),v.material.uniforms.envMap.value=F,v.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,v.material.uniforms.backgroundBlurriness.value=P.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,v.material.toneMapped=F.encoding!==Cn,(I!==F||C!==F.version||E!==n.toneMapping)&&(v.material.needsUpdate=!0,I=F,C=F.version,E=n.toneMapping),v.layers.enableAll(),D.unshift(v,v.geometry,v.material,0,0,null)):F&&F.isTexture&&(g===void 0&&(g=new nr(new WA(2,2),new $d({name:"BackgroundMaterial",uniforms:PA(Il.background.uniforms),vertexShader:Il.background.vertexShader,fragmentShader:Il.background.fragmentShader,side:rl,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(g)),g.material.uniforms.t2D.value=F,g.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,g.material.toneMapped=F.encoding!==Cn,F.matrixAutoUpdate===!0&&F.updateMatrix(),g.material.uniforms.uvTransform.value.copy(F.matrix),(I!==F||C!==F.version||E!==n.toneMapping)&&(g.material.needsUpdate=!0,I=F,C=F.version,E=n.toneMapping),g.layers.enableAll(),D.unshift(g,g.geometry,g.material,0,0,null))}function M(D,P){D.getRGB(Tv,_k(n)),i.buffers.color.setClear(Tv.r,Tv.g,Tv.b,P,h)}return{getClearColor:function(){return r},setClearColor:function(D,P=1){r.set(D),p=P,M(r,p)},getClearAlpha:function(){return p},setClearAlpha:function(D){p=D,M(r,p)},render:Q}}function wY(n,e,t,i){const o=n.getParameter(34921),u=i.isWebGL2?null:e.get("OES_vertex_array_object"),h=i.isWebGL2||u!==null,r={},p=D(null);let g=p,v=!1;function I(Ee,Be,De,Re,ye){let ht=!1;if(h){const oe=M(Re,De,Be);g!==oe&&(g=oe,E(g.object)),ht=P(Ee,Re,De,ye),ht&&O(Ee,Re,De,ye)}else{const oe=Be.wireframe===!0;(g.geometry!==Re.id||g.program!==De.id||g.wireframe!==oe)&&(g.geometry=Re.id,g.program=De.id,g.wireframe=oe,ht=!0)}ye!==null&&t.update(ye,34963),(ht||v)&&(v=!1,H(Ee,Be,De,Re),ye!==null&&n.bindBuffer(34963,t.get(ye).buffer))}function C(){return i.isWebGL2?n.createVertexArray():u.createVertexArrayOES()}function E(Ee){return i.isWebGL2?n.bindVertexArray(Ee):u.bindVertexArrayOES(Ee)}function Q(Ee){return i.isWebGL2?n.deleteVertexArray(Ee):u.deleteVertexArrayOES(Ee)}function M(Ee,Be,De){const Re=De.wireframe===!0;let ye=r[Ee.id];ye===void 0&&(ye={},r[Ee.id]=ye);let ht=ye[Be.id];ht===void 0&&(ht={},ye[Be.id]=ht);let oe=ht[Re];return oe===void 0&&(oe=D(C()),ht[Re]=oe),oe}function D(Ee){const Be=[],De=[],Re=[];for(let ye=0;ye<o;ye++)Be[ye]=0,De[ye]=0,Re[ye]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Be,enabledAttributes:De,attributeDivisors:Re,object:Ee,attributes:{},index:null}}function P(Ee,Be,De,Re){const ye=g.attributes,ht=Be.attributes;let oe=0;const Tt=De.getAttributes();for(const Fe in Tt)if(Tt[Fe].location>=0){const Et=ye[Fe];let Ke=ht[Fe];if(Ke===void 0&&(Fe==="instanceMatrix"&&Ee.instanceMatrix&&(Ke=Ee.instanceMatrix),Fe==="instanceColor"&&Ee.instanceColor&&(Ke=Ee.instanceColor)),Et===void 0||Et.attribute!==Ke||Ke&&Et.data!==Ke.data)return!0;oe++}return g.attributesNum!==oe||g.index!==Re}function O(Ee,Be,De,Re){const ye={},ht=Be.attributes;let oe=0;const Tt=De.getAttributes();for(const Fe in Tt)if(Tt[Fe].location>=0){let Et=ht[Fe];Et===void 0&&(Fe==="instanceMatrix"&&Ee.instanceMatrix&&(Et=Ee.instanceMatrix),Fe==="instanceColor"&&Ee.instanceColor&&(Et=Ee.instanceColor));const Ke={};Ke.attribute=Et,Et&&Et.data&&(Ke.data=Et.data),ye[Fe]=Ke,oe++}g.attributes=ye,g.attributesNum=oe,g.index=Re}function F(){const Ee=g.newAttributes;for(let Be=0,De=Ee.length;Be<De;Be++)Ee[Be]=0}function N(Ee){z(Ee,0)}function z(Ee,Be){const De=g.newAttributes,Re=g.enabledAttributes,ye=g.attributeDivisors;De[Ee]=1,Re[Ee]===0&&(n.enableVertexAttribArray(Ee),Re[Ee]=1),ye[Ee]!==Be&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ee,Be),ye[Ee]=Be)}function X(){const Ee=g.newAttributes,Be=g.enabledAttributes;for(let De=0,Re=Be.length;De<Re;De++)Be[De]!==Ee[De]&&(n.disableVertexAttribArray(De),Be[De]=0)}function q(Ee,Be,De,Re,ye,ht){i.isWebGL2===!0&&(De===5124||De===5125)?n.vertexAttribIPointer(Ee,Be,De,ye,ht):n.vertexAttribPointer(Ee,Be,De,Re,ye,ht)}function H(Ee,Be,De,Re){if(i.isWebGL2===!1&&(Ee.isInstancedMesh||Re.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;F();const ye=Re.attributes,ht=De.getAttributes(),oe=Be.defaultAttributeValues;for(const Tt in ht){const Fe=ht[Tt];if(Fe.location>=0){let st=ye[Tt];if(st===void 0&&(Tt==="instanceMatrix"&&Ee.instanceMatrix&&(st=Ee.instanceMatrix),Tt==="instanceColor"&&Ee.instanceColor&&(st=Ee.instanceColor)),st!==void 0){const Et=st.normalized,Ke=st.itemSize,Ne=t.get(st);if(Ne===void 0)continue;const dt=Ne.buffer,xt=Ne.type,ft=Ne.bytesPerElement;if(st.isInterleavedBufferAttribute){const Ve=st.data,Ye=Ve.stride,ae=st.offset;if(Ve.isInstancedInterleavedBuffer){for(let _e=0;_e<Fe.locationSize;_e++)z(Fe.location+_e,Ve.meshPerAttribute);Ee.isInstancedMesh!==!0&&Re._maxInstanceCount===void 0&&(Re._maxInstanceCount=Ve.meshPerAttribute*Ve.count)}else for(let _e=0;_e<Fe.locationSize;_e++)N(Fe.location+_e);n.bindBuffer(34962,dt);for(let _e=0;_e<Fe.locationSize;_e++)q(Fe.location+_e,Ke/Fe.locationSize,xt,Et,Ye*ft,(ae+Ke/Fe.locationSize*_e)*ft)}else{if(st.isInstancedBufferAttribute){for(let Ve=0;Ve<Fe.locationSize;Ve++)z(Fe.location+Ve,st.meshPerAttribute);Ee.isInstancedMesh!==!0&&Re._maxInstanceCount===void 0&&(Re._maxInstanceCount=st.meshPerAttribute*st.count)}else for(let Ve=0;Ve<Fe.locationSize;Ve++)N(Fe.location+Ve);n.bindBuffer(34962,dt);for(let Ve=0;Ve<Fe.locationSize;Ve++)q(Fe.location+Ve,Ke/Fe.locationSize,xt,Et,Ke*ft,Ke/Fe.locationSize*Ve*ft)}}else if(oe!==void 0){const Et=oe[Tt];if(Et!==void 0)switch(Et.length){case 2:n.vertexAttrib2fv(Fe.location,Et);break;case 3:n.vertexAttrib3fv(Fe.location,Et);break;case 4:n.vertexAttrib4fv(Fe.location,Et);break;default:n.vertexAttrib1fv(Fe.location,Et)}}}}X()}function W(){te();for(const Ee in r){const Be=r[Ee];for(const De in Be){const Re=Be[De];for(const ye in Re)Q(Re[ye].object),delete Re[ye];delete Be[De]}delete r[Ee]}}function se(Ee){if(r[Ee.id]===void 0)return;const Be=r[Ee.id];for(const De in Be){const Re=Be[De];for(const ye in Re)Q(Re[ye].object),delete Re[ye];delete Be[De]}delete r[Ee.id]}function de(Ee){for(const Be in r){const De=r[Be];if(De[Ee.id]===void 0)continue;const Re=De[Ee.id];for(const ye in Re)Q(Re[ye].object),delete Re[ye];delete De[Ee.id]}}function te(){ce(),v=!0,g!==p&&(g=p,E(g.object))}function ce(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:I,reset:te,resetDefaultState:ce,dispose:W,releaseStatesOfGeometry:se,releaseStatesOfProgram:de,initAttributes:F,enableAttribute:N,disableUnusedAttributes:X}}function bY(n,e,t,i){const o=i.isWebGL2;let u;function h(g){u=g}function r(g,v){n.drawArrays(u,g,v),t.update(v,u,1)}function p(g,v,I){if(I===0)return;let C,E;if(o)C=n,E="drawArraysInstanced";else if(C=e.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",C===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}C[E](u,g,v,I),t.update(v,u,I)}this.setMode=h,this.render=r,this.renderInstances=p}function BY(n,e,t){let i;function o(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const q=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function u(q){if(q==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";q="mediump"}return q==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const h=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let r=t.precision!==void 0?t.precision:"highp";const p=u(r);p!==r&&(console.warn("THREE.WebGLRenderer:",r,"not supported, using",p,"instead."),r=p);const g=h||e.has("WEBGL_draw_buffers"),v=t.logarithmicDepthBuffer===!0,I=n.getParameter(34930),C=n.getParameter(35660),E=n.getParameter(3379),Q=n.getParameter(34076),M=n.getParameter(34921),D=n.getParameter(36347),P=n.getParameter(36348),O=n.getParameter(36349),F=C>0,N=h||e.has("OES_texture_float"),z=F&&N,X=h?n.getParameter(36183):0;return{isWebGL2:h,drawBuffers:g,getMaxAnisotropy:o,getMaxPrecision:u,precision:r,logarithmicDepthBuffer:v,maxTextures:I,maxVertexTextures:C,maxTextureSize:E,maxCubemapSize:Q,maxAttributes:M,maxVertexUniforms:D,maxVaryings:P,maxFragmentUniforms:O,vertexTextures:F,floatFragmentTextures:N,floatVertexTextures:z,maxSamples:X}}function SY(n){const e=this;let t=null,i=0,o=!1,u=!1;const h=new mc,r=new ko,p={value:null,needsUpdate:!1};this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(I,C){const E=I.length!==0||C||i!==0||o;return o=C,i=I.length,E},this.beginShadows=function(){u=!0,v(null)},this.endShadows=function(){u=!1},this.setGlobalState=function(I,C){t=v(I,C,0)},this.setState=function(I,C,E){const Q=I.clippingPlanes,M=I.clipIntersection,D=I.clipShadows,P=n.get(I);if(!o||Q===null||Q.length===0||u&&!D)u?v(null):g();else{const O=u?0:i,F=O*4;let N=P.clippingState||null;p.value=N,N=v(Q,C,F,E);for(let z=0;z!==F;++z)N[z]=t[z];P.clippingState=N,this.numIntersection=M?this.numPlanes:0,this.numPlanes+=O}};function g(){p.value!==t&&(p.value=t,p.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function v(I,C,E,Q){const M=I!==null?I.length:0;let D=null;if(M!==0){if(D=p.value,Q!==!0||D===null){const P=E+M*4,O=C.matrixWorldInverse;r.getNormalMatrix(O),(D===null||D.length<P)&&(D=new Float32Array(P));for(let F=0,N=E;F!==M;++F,N+=4)h.copy(I[F]).applyMatrix4(O,r),h.normal.toArray(D,N),D[N+3]=h.constant}p.value=D,p.needsUpdate=!0}return e.numPlanes=M,e.numIntersection=0,D}}function MY(n){let e=new WeakMap;function t(h,r){return r===Jd?h.mapping=TA:r===zw&&(h.mapping=DA),h}function i(h){if(h&&h.isTexture&&h.isRenderTargetTexture===!1){const r=h.mapping;if(r===Jd||r===zw)if(e.has(h)){const p=e.get(h).texture;return t(p,h.mapping)}else{const p=h.image;if(p&&p.height>0){const g=new G9(p.height/2);return g.fromEquirectangularTexture(n,h),e.set(h,g),h.addEventListener("dispose",o),t(g.texture,h.mapping)}else return null}}return h}function o(h){const r=h.target;r.removeEventListener("dispose",o);const p=e.get(r);p!==void 0&&(e.delete(r),p.dispose())}function u(){e=new WeakMap}return{get:i,dispose:u}}class wB extends yk{constructor(e=-1,t=1,i=1,o=-1,u=.1,h=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=o,this.near=u,this.far=h,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,o,u,h){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=o,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let u=i-e,h=i+e,r=o+t,p=o-t;if(this.view!==null&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u+=g*this.view.offsetX,h=u+g*this.view.width,r-=v*this.view.offsetY,p=r-v*this.view.height}this.projectionMatrix.makeOrthographic(u,h,r,p,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Wp=4,lQ=[.125,.215,.35,.446,.526,.582],Cd=20,xE=new wB,cQ=new Xi;let IE=null;const gd=(1+Math.sqrt(5))/2,Tp=1/gd,uQ=[new rt(1,1,1),new rt(-1,1,1),new rt(1,1,-1),new rt(-1,1,-1),new rt(0,gd,Tp),new rt(0,gd,-Tp),new rt(Tp,0,gd),new rt(-Tp,0,gd),new rt(gd,Tp,0),new rt(-gd,Tp,0)];class hQ{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,o=100){IE=this._renderer.getRenderTarget(),this._setSize(256);const u=this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,i,o,u),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=pQ(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=fQ(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(IE),e.scissorTest=!1,Dv(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===TA||e.mapping===DA?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),IE=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:$r,minFilter:$r,generateMipmaps:!1,type:Ec,format:aa,encoding:uh,depthBuffer:!1},o=dQ(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=dQ(e,t,i);const{_lodMax:u}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=TY(u)),this._blurMaterial=DY(u,e,t)}return o}_compileMaterial(e){const t=new nr(this._lodPlanes[0],e);this._renderer.compile(t,xE)}_sceneToCubeUV(e,t,i,o){const r=new ds(90,1,t,i),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,I=v.autoClear,C=v.toneMapping;v.getClearColor(cQ),v.toneMapping=Sc,v.autoClear=!1;const E=new ju({name:"PMREM.Background",side:_o,depthWrite:!1,depthTest:!1}),Q=new nr(new _0,E);let M=!1;const D=e.background;D?D.isColor&&(E.color.copy(D),e.background=null,M=!0):(E.color.copy(cQ),M=!0);for(let P=0;P<6;P++){const O=P%3;O===0?(r.up.set(0,p[P],0),r.lookAt(g[P],0,0)):O===1?(r.up.set(0,0,p[P]),r.lookAt(0,g[P],0)):(r.up.set(0,p[P],0),r.lookAt(0,0,g[P]));const F=this._cubeSize;Dv(o,O*F,P>2?F:0,F,F),v.setRenderTarget(o),M&&v.render(Q,r),v.render(e,r)}Q.geometry.dispose(),Q.material.dispose(),v.toneMapping=C,v.autoClear=I,e.background=D}_textureToCubeUV(e,t){const i=this._renderer,o=e.mapping===TA||e.mapping===DA;o?(this._cubemapMaterial===null&&(this._cubemapMaterial=pQ()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=fQ());const u=o?this._cubemapMaterial:this._equirectMaterial,h=new nr(this._lodPlanes[0],u),r=u.uniforms;r.envMap.value=e;const p=this._cubeSize;Dv(t,0,0,3*p,2*p),i.setRenderTarget(t),i.render(h,xE)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const u=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),h=uQ[(o-1)%uQ.length];this._blur(e,o-1,o,u,h)}t.autoClear=i}_blur(e,t,i,o,u){const h=this._pingPongRenderTarget;this._halfBlur(e,h,t,i,o,"latitudinal",u),this._halfBlur(h,e,i,i,o,"longitudinal",u)}_halfBlur(e,t,i,o,u,h,r){const p=this._renderer,g=this._blurMaterial;h!=="latitudinal"&&h!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const v=3,I=new nr(this._lodPlanes[o],g),C=g.uniforms,E=this._sizeLods[i]-1,Q=isFinite(u)?Math.PI/(2*E):2*Math.PI/(2*Cd-1),M=u/Q,D=isFinite(u)?1+Math.floor(v*M):Cd;D>Cd&&console.warn(`sigmaRadians, ${u}, is too large and will clip, as it requested ${D} samples when the maximum is set to ${Cd}`);const P=[];let O=0;for(let q=0;q<Cd;++q){const H=q/M,W=Math.exp(-H*H/2);P.push(W),q===0?O+=W:q<D&&(O+=2*W)}for(let q=0;q<P.length;q++)P[q]=P[q]/O;C.envMap.value=e.texture,C.samples.value=D,C.weights.value=P,C.latitudinal.value=h==="latitudinal",r&&(C.poleAxis.value=r);const{_lodMax:F}=this;C.dTheta.value=Q,C.mipInt.value=F-i;const N=this._sizeLods[o],z=3*N*(o>F-Wp?o-F+Wp:0),X=4*(this._cubeSize-N);Dv(t,z,X,3*N,2*N),p.setRenderTarget(t),p.render(I,xE)}}function TY(n){const e=[],t=[],i=[];let o=n;const u=n-Wp+1+lQ.length;for(let h=0;h<u;h++){const r=Math.pow(2,o);t.push(r);let p=1/r;h>n-Wp?p=lQ[h-n+Wp-1]:h===0&&(p=0),i.push(p);const g=1/(r-2),v=-g,I=1+g,C=[v,v,I,v,I,I,v,v,I,I,v,I],E=6,Q=6,M=3,D=2,P=1,O=new Float32Array(M*Q*E),F=new Float32Array(D*Q*E),N=new Float32Array(P*Q*E);for(let X=0;X<E;X++){const q=X%3*2/3-1,H=X>2?0:-1,W=[q,H,0,q+2/3,H,0,q+2/3,H+1,0,q,H,0,q+2/3,H+1,0,q,H+1,0];O.set(W,M*Q*X),F.set(C,D*Q*X);const se=[X,X,X,X,X,X];N.set(se,P*Q*X)}const z=new Oo;z.setAttribute("position",new es(O,M)),z.setAttribute("uv",new es(F,D)),z.setAttribute("faceIndex",new es(N,P)),e.push(z),o>Wp&&o--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function dQ(n,e,t){const i=new Zd(n,e,t);return i.texture.mapping=y1,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Dv(n,e,t,i,o){n.viewport.set(e,t,i,o),n.scissor.set(e,t,i,o)}function DY(n,e,t){const i=new Float32Array(Cd),o=new rt(0,1,0);return new $d({name:"SphericalGaussianBlur",defines:{n:Cd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:bB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function fQ(){return new $d({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:bB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function pQ(){return new $d({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:bB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$u,depthTest:!1,depthWrite:!1})}function bB(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function QY(n){let e=new WeakMap,t=null;function i(r){if(r&&r.isTexture){const p=r.mapping,g=p===Jd||p===zw,v=p===TA||p===DA;if(g||v)if(r.isRenderTargetTexture&&r.needsPMREMUpdate===!0){r.needsPMREMUpdate=!1;let I=e.get(r);return t===null&&(t=new hQ(n)),I=g?t.fromEquirectangular(r,I):t.fromCubemap(r,I),e.set(r,I),I.texture}else{if(e.has(r))return e.get(r).texture;{const I=r.image;if(g&&I&&I.height>0||v&&I&&o(I)){t===null&&(t=new hQ(n));const C=g?t.fromEquirectangular(r):t.fromCubemap(r);return e.set(r,C),r.addEventListener("dispose",u),C.texture}else return null}}}return r}function o(r){let p=0;const g=6;for(let v=0;v<g;v++)r[v]!==void 0&&p++;return p===g}function u(r){const p=r.target;p.removeEventListener("dispose",u);const g=e.get(p);g!==void 0&&(e.delete(p),g.dispose())}function h(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:h}}function RY(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let o;switch(i){case"WEBGL_depth_texture":o=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=n.getExtension(i)}return e[i]=o,o}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const o=t(i);return o===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),o}}}function LY(n,e,t,i){const o={},u=new WeakMap;function h(I){const C=I.target;C.index!==null&&e.remove(C.index);for(const Q in C.attributes)e.remove(C.attributes[Q]);C.removeEventListener("dispose",h),delete o[C.id];const E=u.get(C);E&&(e.remove(E),u.delete(C)),i.releaseStatesOfGeometry(C),C.isInstancedBufferGeometry===!0&&delete C._maxInstanceCount,t.memory.geometries--}function r(I,C){return o[C.id]===!0||(C.addEventListener("dispose",h),o[C.id]=!0,t.memory.geometries++),C}function p(I){const C=I.attributes;for(const Q in C)e.update(C[Q],34962);const E=I.morphAttributes;for(const Q in E){const M=E[Q];for(let D=0,P=M.length;D<P;D++)e.update(M[D],34962)}}function g(I){const C=[],E=I.index,Q=I.attributes.position;let M=0;if(E!==null){const O=E.array;M=E.version;for(let F=0,N=O.length;F<N;F+=3){const z=O[F+0],X=O[F+1],q=O[F+2];C.push(z,X,X,q,q,z)}}else{const O=Q.array;M=Q.version;for(let F=0,N=O.length/3-1;F<N;F+=3){const z=F+0,X=F+1,q=F+2;C.push(z,X,X,q,q,z)}}const D=new(hk(C)?mk:gk)(C,1);D.version=M;const P=u.get(I);P&&e.remove(P),u.set(I,D)}function v(I){const C=u.get(I);if(C){const E=I.index;E!==null&&C.version<E.version&&g(I)}else g(I);return u.get(I)}return{get:r,update:p,getWireframeAttribute:v}}function PY(n,e,t,i){const o=i.isWebGL2;let u;function h(C){u=C}let r,p;function g(C){r=C.type,p=C.bytesPerElement}function v(C,E){n.drawElements(u,E,r,C*p),t.update(E,u,1)}function I(C,E,Q){if(Q===0)return;let M,D;if(o)M=n,D="drawElementsInstanced";else if(M=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",M===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[D](u,E,r,C*p,Q),t.update(E,u,Q)}this.setMode=h,this.setIndex=g,this.render=v,this.renderInstances=I}function kY(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(u,h,r){switch(t.calls++,h){case 4:t.triangles+=r*(u/3);break;case 1:t.lines+=r*(u/2);break;case 3:t.lines+=r*(u-1);break;case 2:t.lines+=r*u;break;case 0:t.points+=r*u;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",h);break}}function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:o,update:i}}function FY(n,e){return n[0]-e[0]}function NY(n,e){return Math.abs(e[1])-Math.abs(n[1])}function zY(n,e,t){const i={},o=new Float32Array(8),u=new WeakMap,h=new er,r=[];for(let g=0;g<8;g++)r[g]=[g,0];function p(g,v,I,C){const E=g.morphTargetInfluences;if(e.isWebGL2===!0){const Q=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,M=Q!==void 0?Q.length:0;let D=u.get(v);if(D===void 0||D.count!==M){let Be=function(){ce.dispose(),u.delete(v),v.removeEventListener("dispose",Be)};D!==void 0&&D.texture.dispose();const F=v.morphAttributes.position!==void 0,N=v.morphAttributes.normal!==void 0,z=v.morphAttributes.color!==void 0,X=v.morphAttributes.position||[],q=v.morphAttributes.normal||[],H=v.morphAttributes.color||[];let W=0;F===!0&&(W=1),N===!0&&(W=2),z===!0&&(W=3);let se=v.attributes.position.count*W,de=1;se>e.maxTextureSize&&(de=Math.ceil(se/e.maxTextureSize),se=e.maxTextureSize);const te=new Float32Array(se*de*4*M),ce=new Ak(te,se,de,M);ce.type=Za,ce.needsUpdate=!0;const Ee=W*4;for(let De=0;De<M;De++){const Re=X[De],ye=q[De],ht=H[De],oe=se*de*4*De;for(let Tt=0;Tt<Re.count;Tt++){const Fe=Tt*Ee;F===!0&&(h.fromBufferAttribute(Re,Tt),te[oe+Fe+0]=h.x,te[oe+Fe+1]=h.y,te[oe+Fe+2]=h.z,te[oe+Fe+3]=0),N===!0&&(h.fromBufferAttribute(ye,Tt),te[oe+Fe+4]=h.x,te[oe+Fe+5]=h.y,te[oe+Fe+6]=h.z,te[oe+Fe+7]=0),z===!0&&(h.fromBufferAttribute(ht,Tt),te[oe+Fe+8]=h.x,te[oe+Fe+9]=h.y,te[oe+Fe+10]=h.z,te[oe+Fe+11]=ht.itemSize===4?h.w:1)}}D={count:M,texture:ce,size:new Yi(se,de)},u.set(v,D),v.addEventListener("dispose",Be)}let P=0;for(let F=0;F<E.length;F++)P+=E[F];const O=v.morphTargetsRelative?1:1-P;C.getUniforms().setValue(n,"morphTargetBaseInfluence",O),C.getUniforms().setValue(n,"morphTargetInfluences",E),C.getUniforms().setValue(n,"morphTargetsTexture",D.texture,t),C.getUniforms().setValue(n,"morphTargetsTextureSize",D.size)}else{const Q=E===void 0?0:E.length;let M=i[v.id];if(M===void 0||M.length!==Q){M=[];for(let N=0;N<Q;N++)M[N]=[N,0];i[v.id]=M}for(let N=0;N<Q;N++){const z=M[N];z[0]=N,z[1]=E[N]}M.sort(NY);for(let N=0;N<8;N++)N<Q&&M[N][1]?(r[N][0]=M[N][0],r[N][1]=M[N][1]):(r[N][0]=Number.MAX_SAFE_INTEGER,r[N][1]=0);r.sort(FY);const D=v.morphAttributes.position,P=v.morphAttributes.normal;let O=0;for(let N=0;N<8;N++){const z=r[N],X=z[0],q=z[1];X!==Number.MAX_SAFE_INTEGER&&q?(D&&v.getAttribute("morphTarget"+N)!==D[X]&&v.setAttribute("morphTarget"+N,D[X]),P&&v.getAttribute("morphNormal"+N)!==P[X]&&v.setAttribute("morphNormal"+N,P[X]),o[N]=q,O+=q):(D&&v.hasAttribute("morphTarget"+N)===!0&&v.deleteAttribute("morphTarget"+N),P&&v.hasAttribute("morphNormal"+N)===!0&&v.deleteAttribute("morphNormal"+N),o[N]=0)}const F=v.morphTargetsRelative?1:1-O;C.getUniforms().setValue(n,"morphTargetBaseInfluence",F),C.getUniforms().setValue(n,"morphTargetInfluences",o)}}return{update:p}}function UY(n,e,t,i){let o=new WeakMap;function u(p){const g=i.render.frame,v=p.geometry,I=e.get(p,v);return o.get(I)!==g&&(e.update(I),o.set(I,g)),p.isInstancedMesh&&(p.hasEventListener("dispose",r)===!1&&p.addEventListener("dispose",r),t.update(p.instanceMatrix,34962),p.instanceColor!==null&&t.update(p.instanceColor,34962)),I}function h(){o=new WeakMap}function r(p){const g=p.target;g.removeEventListener("dispose",r),t.remove(g.instanceMatrix),g.instanceColor!==null&&t.remove(g.instanceColor)}return{update:u,dispose:h}}const Ik=new Cs,Ck=new Ak,Ek=new b9,wk=new vk,AQ=[],gQ=[],mQ=new Float32Array(16),_Q=new Float32Array(9),yQ=new Float32Array(4);function YA(n,e,t){const i=n[0];if(i<=0||i>0)return n;const o=e*t;let u=AQ[o];if(u===void 0&&(u=new Float32Array(o),AQ[o]=u),e!==0){i.toArray(u,0);for(let h=1,r=0;h!==e;++h)r+=t,n[h].toArray(u,r)}return u}function ts(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function is(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function x1(n,e){let t=gQ[e];t===void 0&&(t=new Int32Array(e),gQ[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function OY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function GY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;n.uniform2fv(this.addr,e),is(t,e)}}function HY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ts(t,e))return;n.uniform3fv(this.addr,e),is(t,e)}}function VY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;n.uniform4fv(this.addr,e),is(t,e)}}function WY(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ts(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),is(t,e)}else{if(ts(t,i))return;yQ.set(i),n.uniformMatrix2fv(this.addr,!1,yQ),is(t,i)}}function YY(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ts(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),is(t,e)}else{if(ts(t,i))return;_Q.set(i),n.uniformMatrix3fv(this.addr,!1,_Q),is(t,i)}}function jY(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ts(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),is(t,e)}else{if(ts(t,i))return;mQ.set(i),n.uniformMatrix4fv(this.addr,!1,mQ),is(t,i)}}function qY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function KY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;n.uniform2iv(this.addr,e),is(t,e)}}function JY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;n.uniform3iv(this.addr,e),is(t,e)}}function XY(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;n.uniform4iv(this.addr,e),is(t,e)}}function ZY(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function $Y(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ts(t,e))return;n.uniform2uiv(this.addr,e),is(t,e)}}function ej(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ts(t,e))return;n.uniform3uiv(this.addr,e),is(t,e)}}function tj(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ts(t,e))return;n.uniform4uiv(this.addr,e),is(t,e)}}function ij(n,e,t){const i=this.cache,o=t.allocateTextureUnit();i[0]!==o&&(n.uniform1i(this.addr,o),i[0]=o),t.setTexture2D(e||Ik,o)}function nj(n,e,t){const i=this.cache,o=t.allocateTextureUnit();i[0]!==o&&(n.uniform1i(this.addr,o),i[0]=o),t.setTexture3D(e||Ek,o)}function rj(n,e,t){const i=this.cache,o=t.allocateTextureUnit();i[0]!==o&&(n.uniform1i(this.addr,o),i[0]=o),t.setTextureCube(e||wk,o)}function sj(n,e,t){const i=this.cache,o=t.allocateTextureUnit();i[0]!==o&&(n.uniform1i(this.addr,o),i[0]=o),t.setTexture2DArray(e||Ck,o)}function oj(n){switch(n){case 5126:return OY;case 35664:return GY;case 35665:return HY;case 35666:return VY;case 35674:return WY;case 35675:return YY;case 35676:return jY;case 5124:case 35670:return qY;case 35667:case 35671:return KY;case 35668:case 35672:return JY;case 35669:case 35673:return XY;case 5125:return ZY;case 36294:return $Y;case 36295:return ej;case 36296:return tj;case 35678:case 36198:case 36298:case 36306:case 35682:return ij;case 35679:case 36299:case 36307:return nj;case 35680:case 36300:case 36308:case 36293:return rj;case 36289:case 36303:case 36311:case 36292:return sj}}function aj(n,e){n.uniform1fv(this.addr,e)}function lj(n,e){const t=YA(e,this.size,2);n.uniform2fv(this.addr,t)}function cj(n,e){const t=YA(e,this.size,3);n.uniform3fv(this.addr,t)}function uj(n,e){const t=YA(e,this.size,4);n.uniform4fv(this.addr,t)}function hj(n,e){const t=YA(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function dj(n,e){const t=YA(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function fj(n,e){const t=YA(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function pj(n,e){n.uniform1iv(this.addr,e)}function Aj(n,e){n.uniform2iv(this.addr,e)}function gj(n,e){n.uniform3iv(this.addr,e)}function mj(n,e){n.uniform4iv(this.addr,e)}function _j(n,e){n.uniform1uiv(this.addr,e)}function yj(n,e){n.uniform2uiv(this.addr,e)}function vj(n,e){n.uniform3uiv(this.addr,e)}function xj(n,e){n.uniform4uiv(this.addr,e)}function Ij(n,e,t){const i=this.cache,o=e.length,u=x1(t,o);ts(i,u)||(n.uniform1iv(this.addr,u),is(i,u));for(let h=0;h!==o;++h)t.setTexture2D(e[h]||Ik,u[h])}function Cj(n,e,t){const i=this.cache,o=e.length,u=x1(t,o);ts(i,u)||(n.uniform1iv(this.addr,u),is(i,u));for(let h=0;h!==o;++h)t.setTexture3D(e[h]||Ek,u[h])}function Ej(n,e,t){const i=this.cache,o=e.length,u=x1(t,o);ts(i,u)||(n.uniform1iv(this.addr,u),is(i,u));for(let h=0;h!==o;++h)t.setTextureCube(e[h]||wk,u[h])}function wj(n,e,t){const i=this.cache,o=e.length,u=x1(t,o);ts(i,u)||(n.uniform1iv(this.addr,u),is(i,u));for(let h=0;h!==o;++h)t.setTexture2DArray(e[h]||Ck,u[h])}function bj(n){switch(n){case 5126:return aj;case 35664:return lj;case 35665:return cj;case 35666:return uj;case 35674:return hj;case 35675:return dj;case 35676:return fj;case 5124:case 35670:return pj;case 35667:case 35671:return Aj;case 35668:case 35672:return gj;case 35669:case 35673:return mj;case 5125:return _j;case 36294:return yj;case 36295:return vj;case 36296:return xj;case 35678:case 36198:case 36298:case 36306:case 35682:return Ij;case 35679:case 36299:case 36307:return Cj;case 35680:case 36300:case 36308:case 36293:return Ej;case 36289:case 36303:case 36311:case 36292:return wj}}class Bj{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=oj(t.type)}}class Sj{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=bj(t.type)}}class Mj{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const o=this.seq;for(let u=0,h=o.length;u!==h;++u){const r=o[u];r.setValue(e,t[r.id],i)}}}const CE=/(\w+)(\])?(\[|\.)?/g;function vQ(n,e){n.seq.push(e),n.map[e.id]=e}function Tj(n,e,t){const i=n.name,o=i.length;for(CE.lastIndex=0;;){const u=CE.exec(i),h=CE.lastIndex;let r=u[1];const p=u[2]==="]",g=u[3];if(p&&(r=r|0),g===void 0||g==="["&&h+2===o){vQ(t,g===void 0?new Bj(r,n,e):new Sj(r,n,e));break}else{let I=t.map[r];I===void 0&&(I=new Mj(r),vQ(t,I)),t=I}}}class fx{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let o=0;o<i;++o){const u=e.getActiveUniform(t,o),h=e.getUniformLocation(t,u.name);Tj(u,h,this)}}setValue(e,t,i,o){const u=this.map[t];u!==void 0&&u.setValue(e,i,o)}setOptional(e,t,i){const o=t[i];o!==void 0&&this.setValue(e,i,o)}static upload(e,t,i,o){for(let u=0,h=t.length;u!==h;++u){const r=t[u],p=i[r.id];p.needsUpdate!==!1&&r.setValue(e,p.value,o)}}static seqWithValue(e,t){const i=[];for(let o=0,u=e.length;o!==u;++o){const h=e[o];h.id in t&&i.push(h)}return i}}function xQ(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Dj=0;function Qj(n,e){const t=n.split(`
`),i=[],o=Math.max(e-6,0),u=Math.min(e+6,t.length);for(let h=o;h<u;h++){const r=h+1;i.push(`${r===e?">":" "} ${r}: ${t[h]}`)}return i.join(`
`)}function Rj(n){switch(n){case uh:return["Linear","( value )"];case Cn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function IQ(n,e,t){const i=n.getShaderParameter(e,35713),o=n.getShaderInfoLog(e).trim();if(i&&o==="")return"";const u=/ERROR: 0:(\d+)/.exec(o);if(u){const h=parseInt(u[1]);return t.toUpperCase()+`

`+o+`

`+Qj(n.getShaderSource(e),h)}else return o}function Lj(n,e){const t=Rj(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Pj(n,e){let t;switch(e){case zV:t="Linear";break;case UV:t="Reinhard";break;case OV:t="OptimizedCineon";break;case GV:t="ACESFilmic";break;case HV:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function kj(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(s_).join(`
`)}function Fj(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function Nj(n,e){const t={},i=n.getProgramParameter(e,35721);for(let o=0;o<i;o++){const u=n.getActiveAttrib(e,o),h=u.name;let r=1;u.type===35674&&(r=2),u.type===35675&&(r=3),u.type===35676&&(r=4),t[h]={type:u.type,location:n.getAttribLocation(e,h),locationSize:r}}return t}function s_(n){return n!==""}function CQ(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function EQ(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const zj=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ww(n){return n.replace(zj,Uj)}function Uj(n,e){const t=ln[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Ww(t)}const Oj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wQ(n){return n.replace(Oj,Gj)}function Gj(n,e,t,i){let o="";for(let u=parseInt(e);u<parseInt(t);u++)o+=i.replace(/\[\s*i\s*\]/g,"[ "+u+" ]").replace(/UNROLLED_LOOP_INDEX/g,u);return o}function bQ(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Hj(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===nk?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===yB?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===r_&&(e="SHADOWMAP_TYPE_VSM"),e}function Vj(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case TA:case DA:e="ENVMAP_TYPE_CUBE";break;case y1:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Wj(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case DA:e="ENVMAP_MODE_REFRACTION";break}return e}function Yj(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case vB:e="ENVMAP_BLENDING_MULTIPLY";break;case FV:e="ENVMAP_BLENDING_MIX";break;case NV:e="ENVMAP_BLENDING_ADD";break}return e}function jj(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function qj(n,e,t,i){const o=n.getContext(),u=t.defines;let h=t.vertexShader,r=t.fragmentShader;const p=Hj(t),g=Vj(t),v=Wj(t),I=Yj(t),C=jj(t),E=t.isWebGL2?"":kj(t),Q=Fj(u),M=o.createProgram();let D,P,O=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(D=[Q].filter(s_).join(`
`),D.length>0&&(D+=`
`),P=[E,Q].filter(s_).join(`
`),P.length>0&&(P+=`
`)):(D=[bQ(t),"#define SHADER_NAME "+t.shaderName,Q,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(s_).join(`
`),P=[E,bQ(t),"#define SHADER_NAME "+t.shaderName,Q,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",t.envMap?"#define "+I:"",C?"#define CUBEUV_TEXEL_WIDTH "+C.texelWidth:"",C?"#define CUBEUV_TEXEL_HEIGHT "+C.texelHeight:"",C?"#define CUBEUV_MAX_MIP "+C.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Sc?"#define TONE_MAPPING":"",t.toneMapping!==Sc?ln.tonemapping_pars_fragment:"",t.toneMapping!==Sc?Pj("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ln.encodings_pars_fragment,Lj("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(s_).join(`
`)),h=Ww(h),h=CQ(h,t),h=EQ(h,t),r=Ww(r),r=CQ(r,t),r=EQ(r,t),h=wQ(h),r=wQ(r),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,P=["#define varying in",t.glslVersion===JD?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===JD?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+P);const F=O+D+h,N=O+P+r,z=xQ(o,35633,F),X=xQ(o,35632,N);if(o.attachShader(M,z),o.attachShader(M,X),t.index0AttributeName!==void 0?o.bindAttribLocation(M,0,t.index0AttributeName):t.morphTargets===!0&&o.bindAttribLocation(M,0,"position"),o.linkProgram(M),n.debug.checkShaderErrors){const W=o.getProgramInfoLog(M).trim(),se=o.getShaderInfoLog(z).trim(),de=o.getShaderInfoLog(X).trim();let te=!0,ce=!0;if(o.getProgramParameter(M,35714)===!1){te=!1;const Ee=IQ(o,z,"vertex"),Be=IQ(o,X,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(M,35715)+`

Program Info Log: `+W+`
`+Ee+`
`+Be)}else W!==""?console.warn("THREE.WebGLProgram: Program Info Log:",W):(se===""||de==="")&&(ce=!1);ce&&(this.diagnostics={runnable:te,programLog:W,vertexShader:{log:se,prefix:D},fragmentShader:{log:de,prefix:P}})}o.deleteShader(z),o.deleteShader(X);let q;this.getUniforms=function(){return q===void 0&&(q=new fx(o,M)),q};let H;return this.getAttributes=function(){return H===void 0&&(H=Nj(o,M)),H},this.destroy=function(){i.releaseStatesOfProgram(this),o.deleteProgram(M),this.program=void 0},this.name=t.shaderName,this.id=Dj++,this.cacheKey=e,this.usedTimes=1,this.program=M,this.vertexShader=z,this.fragmentShader=X,this}let Kj=0;class Jj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,o=this._getShaderStage(t),u=this._getShaderStage(i),h=this._getShaderCacheForMaterial(e);return h.has(o)===!1&&(h.add(o),o.usedTimes++),h.has(u)===!1&&(h.add(u),u.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new Xj(e),t.set(e,i)),i}}class Xj{constructor(e){this.id=Kj++,this.code=e,this.usedTimes=0}}function Zj(n,e,t,i,o,u,h){const r=new CB,p=new Jj,g=[],v=o.isWebGL2,I=o.logarithmicDepthBuffer,C=o.vertexTextures;let E=o.precision;const Q={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function M(H,W,se,de,te){const ce=de.fog,Ee=te.geometry,Be=H.isMeshStandardMaterial?de.environment:null,De=(H.isMeshStandardMaterial?t:e).get(H.envMap||Be),Re=De&&De.mapping===y1?De.image.height:null,ye=Q[H.type];H.precision!==null&&(E=o.getMaxPrecision(H.precision),E!==H.precision&&console.warn("THREE.WebGLProgram.getParameters:",H.precision,"not supported, using",E,"instead."));const ht=Ee.morphAttributes.position||Ee.morphAttributes.normal||Ee.morphAttributes.color,oe=ht!==void 0?ht.length:0;let Tt=0;Ee.morphAttributes.position!==void 0&&(Tt=1),Ee.morphAttributes.normal!==void 0&&(Tt=2),Ee.morphAttributes.color!==void 0&&(Tt=3);let Fe,st,Et,Ke;if(ye){const Ye=Il[ye];Fe=Ye.vertexShader,st=Ye.fragmentShader}else Fe=H.vertexShader,st=H.fragmentShader,p.update(H),Et=p.getVertexShaderID(H),Ke=p.getFragmentShaderID(H);const Ne=n.getRenderTarget(),dt=H.alphaTest>0,xt=H.clearcoat>0,ft=H.iridescence>0;return{isWebGL2:v,shaderID:ye,shaderName:H.type,vertexShader:Fe,fragmentShader:st,defines:H.defines,customVertexShaderID:Et,customFragmentShaderID:Ke,isRawShaderMaterial:H.isRawShaderMaterial===!0,glslVersion:H.glslVersion,precision:E,instancing:te.isInstancedMesh===!0,instancingColor:te.isInstancedMesh===!0&&te.instanceColor!==null,supportsVertexTextures:C,outputEncoding:Ne===null?n.outputEncoding:Ne.isXRRenderTarget===!0?Ne.texture.encoding:uh,map:!!H.map,matcap:!!H.matcap,envMap:!!De,envMapMode:De&&De.mapping,envMapCubeUVHeight:Re,lightMap:!!H.lightMap,aoMap:!!H.aoMap,emissiveMap:!!H.emissiveMap,bumpMap:!!H.bumpMap,normalMap:!!H.normalMap,objectSpaceNormalMap:H.normalMapType===c9,tangentSpaceNormalMap:H.normalMapType===xB,decodeVideoTexture:!!H.map&&H.map.isVideoTexture===!0&&H.map.encoding===Cn,clearcoat:xt,clearcoatMap:xt&&!!H.clearcoatMap,clearcoatRoughnessMap:xt&&!!H.clearcoatRoughnessMap,clearcoatNormalMap:xt&&!!H.clearcoatNormalMap,iridescence:ft,iridescenceMap:ft&&!!H.iridescenceMap,iridescenceThicknessMap:ft&&!!H.iridescenceThicknessMap,displacementMap:!!H.displacementMap,roughnessMap:!!H.roughnessMap,metalnessMap:!!H.metalnessMap,specularMap:!!H.specularMap,specularIntensityMap:!!H.specularIntensityMap,specularColorMap:!!H.specularColorMap,opaque:H.transparent===!1&&H.blending===oA,alphaMap:!!H.alphaMap,alphaTest:dt,gradientMap:!!H.gradientMap,sheen:H.sheen>0,sheenColorMap:!!H.sheenColorMap,sheenRoughnessMap:!!H.sheenRoughnessMap,transmission:H.transmission>0,transmissionMap:!!H.transmissionMap,thicknessMap:!!H.thicknessMap,combine:H.combine,vertexTangents:!!H.normalMap&&!!Ee.attributes.tangent,vertexColors:H.vertexColors,vertexAlphas:H.vertexColors===!0&&!!Ee.attributes.color&&Ee.attributes.color.itemSize===4,vertexUvs:!!H.map||!!H.bumpMap||!!H.normalMap||!!H.specularMap||!!H.alphaMap||!!H.emissiveMap||!!H.roughnessMap||!!H.metalnessMap||!!H.clearcoatMap||!!H.clearcoatRoughnessMap||!!H.clearcoatNormalMap||!!H.iridescenceMap||!!H.iridescenceThicknessMap||!!H.displacementMap||!!H.transmissionMap||!!H.thicknessMap||!!H.specularIntensityMap||!!H.specularColorMap||!!H.sheenColorMap||!!H.sheenRoughnessMap,uvsVertexOnly:!(H.map||H.bumpMap||H.normalMap||H.specularMap||H.alphaMap||H.emissiveMap||H.roughnessMap||H.metalnessMap||H.clearcoatNormalMap||H.iridescenceMap||H.iridescenceThicknessMap||H.transmission>0||H.transmissionMap||H.thicknessMap||H.specularIntensityMap||H.specularColorMap||H.sheen>0||H.sheenColorMap||H.sheenRoughnessMap)&&!!H.displacementMap,fog:!!ce,useFog:H.fog===!0,fogExp2:ce&&ce.isFogExp2,flatShading:!!H.flatShading,sizeAttenuation:H.sizeAttenuation,logarithmicDepthBuffer:I,skinning:te.isSkinnedMesh===!0,morphTargets:Ee.morphAttributes.position!==void 0,morphNormals:Ee.morphAttributes.normal!==void 0,morphColors:Ee.morphAttributes.color!==void 0,morphTargetsCount:oe,morphTextureStride:Tt,numDirLights:W.directional.length,numPointLights:W.point.length,numSpotLights:W.spot.length,numSpotLightMaps:W.spotLightMap.length,numRectAreaLights:W.rectArea.length,numHemiLights:W.hemi.length,numDirLightShadows:W.directionalShadowMap.length,numPointLightShadows:W.pointShadowMap.length,numSpotLightShadows:W.spotShadowMap.length,numSpotLightShadowsWithMaps:W.numSpotLightShadowsWithMaps,numClippingPlanes:h.numPlanes,numClipIntersection:h.numIntersection,dithering:H.dithering,shadowMapEnabled:n.shadowMap.enabled&&se.length>0,shadowMapType:n.shadowMap.type,toneMapping:H.toneMapped?n.toneMapping:Sc,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:H.premultipliedAlpha,doubleSided:H.side===fa,flipSided:H.side===_o,useDepthPacking:!!H.depthPacking,depthPacking:H.depthPacking||0,index0AttributeName:H.index0AttributeName,extensionDerivatives:H.extensions&&H.extensions.derivatives,extensionFragDepth:H.extensions&&H.extensions.fragDepth,extensionDrawBuffers:H.extensions&&H.extensions.drawBuffers,extensionShaderTextureLOD:H.extensions&&H.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||i.has("EXT_shader_texture_lod"),customProgramCacheKey:H.customProgramCacheKey()}}function D(H){const W=[];if(H.shaderID?W.push(H.shaderID):(W.push(H.customVertexShaderID),W.push(H.customFragmentShaderID)),H.defines!==void 0)for(const se in H.defines)W.push(se),W.push(H.defines[se]);return H.isRawShaderMaterial===!1&&(P(W,H),O(W,H),W.push(n.outputEncoding)),W.push(H.customProgramCacheKey),W.join()}function P(H,W){H.push(W.precision),H.push(W.outputEncoding),H.push(W.envMapMode),H.push(W.envMapCubeUVHeight),H.push(W.combine),H.push(W.vertexUvs),H.push(W.fogExp2),H.push(W.sizeAttenuation),H.push(W.morphTargetsCount),H.push(W.morphAttributeCount),H.push(W.numDirLights),H.push(W.numPointLights),H.push(W.numSpotLights),H.push(W.numSpotLightMaps),H.push(W.numHemiLights),H.push(W.numRectAreaLights),H.push(W.numDirLightShadows),H.push(W.numPointLightShadows),H.push(W.numSpotLightShadows),H.push(W.numSpotLightShadowsWithMaps),H.push(W.shadowMapType),H.push(W.toneMapping),H.push(W.numClippingPlanes),H.push(W.numClipIntersection),H.push(W.depthPacking)}function O(H,W){r.disableAll(),W.isWebGL2&&r.enable(0),W.supportsVertexTextures&&r.enable(1),W.instancing&&r.enable(2),W.instancingColor&&r.enable(3),W.map&&r.enable(4),W.matcap&&r.enable(5),W.envMap&&r.enable(6),W.lightMap&&r.enable(7),W.aoMap&&r.enable(8),W.emissiveMap&&r.enable(9),W.bumpMap&&r.enable(10),W.normalMap&&r.enable(11),W.objectSpaceNormalMap&&r.enable(12),W.tangentSpaceNormalMap&&r.enable(13),W.clearcoat&&r.enable(14),W.clearcoatMap&&r.enable(15),W.clearcoatRoughnessMap&&r.enable(16),W.clearcoatNormalMap&&r.enable(17),W.iridescence&&r.enable(18),W.iridescenceMap&&r.enable(19),W.iridescenceThicknessMap&&r.enable(20),W.displacementMap&&r.enable(21),W.specularMap&&r.enable(22),W.roughnessMap&&r.enable(23),W.metalnessMap&&r.enable(24),W.gradientMap&&r.enable(25),W.alphaMap&&r.enable(26),W.alphaTest&&r.enable(27),W.vertexColors&&r.enable(28),W.vertexAlphas&&r.enable(29),W.vertexUvs&&r.enable(30),W.vertexTangents&&r.enable(31),W.uvsVertexOnly&&r.enable(32),H.push(r.mask),r.disableAll(),W.fog&&r.enable(0),W.useFog&&r.enable(1),W.flatShading&&r.enable(2),W.logarithmicDepthBuffer&&r.enable(3),W.skinning&&r.enable(4),W.morphTargets&&r.enable(5),W.morphNormals&&r.enable(6),W.morphColors&&r.enable(7),W.premultipliedAlpha&&r.enable(8),W.shadowMapEnabled&&r.enable(9),W.physicallyCorrectLights&&r.enable(10),W.doubleSided&&r.enable(11),W.flipSided&&r.enable(12),W.useDepthPacking&&r.enable(13),W.dithering&&r.enable(14),W.specularIntensityMap&&r.enable(15),W.specularColorMap&&r.enable(16),W.transmission&&r.enable(17),W.transmissionMap&&r.enable(18),W.thicknessMap&&r.enable(19),W.sheen&&r.enable(20),W.sheenColorMap&&r.enable(21),W.sheenRoughnessMap&&r.enable(22),W.decodeVideoTexture&&r.enable(23),W.opaque&&r.enable(24),H.push(r.mask)}function F(H){const W=Q[H.type];let se;if(W){const de=Il[W];se=N9.clone(de.uniforms)}else se=H.uniforms;return se}function N(H,W){let se;for(let de=0,te=g.length;de<te;de++){const ce=g[de];if(ce.cacheKey===W){se=ce,++se.usedTimes;break}}return se===void 0&&(se=new qj(n,W,H,u),g.push(se)),se}function z(H){if(--H.usedTimes===0){const W=g.indexOf(H);g[W]=g[g.length-1],g.pop(),H.destroy()}}function X(H){p.remove(H)}function q(){p.dispose()}return{getParameters:M,getProgramCacheKey:D,getUniforms:F,acquireProgram:N,releaseProgram:z,releaseShaderCache:X,programs:g,dispose:q}}function $j(){let n=new WeakMap;function e(u){let h=n.get(u);return h===void 0&&(h={},n.set(u,h)),h}function t(u){n.delete(u)}function i(u,h,r){n.get(u)[h]=r}function o(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:o}}function eq(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function BQ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function SQ(){const n=[];let e=0;const t=[],i=[],o=[];function u(){e=0,t.length=0,i.length=0,o.length=0}function h(I,C,E,Q,M,D){let P=n[e];return P===void 0?(P={id:I.id,object:I,geometry:C,material:E,groupOrder:Q,renderOrder:I.renderOrder,z:M,group:D},n[e]=P):(P.id=I.id,P.object=I,P.geometry=C,P.material=E,P.groupOrder=Q,P.renderOrder=I.renderOrder,P.z=M,P.group=D),e++,P}function r(I,C,E,Q,M,D){const P=h(I,C,E,Q,M,D);E.transmission>0?i.push(P):E.transparent===!0?o.push(P):t.push(P)}function p(I,C,E,Q,M,D){const P=h(I,C,E,Q,M,D);E.transmission>0?i.unshift(P):E.transparent===!0?o.unshift(P):t.unshift(P)}function g(I,C){t.length>1&&t.sort(I||eq),i.length>1&&i.sort(C||BQ),o.length>1&&o.sort(C||BQ)}function v(){for(let I=e,C=n.length;I<C;I++){const E=n[I];if(E.id===null)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}}return{opaque:t,transmissive:i,transparent:o,init:u,push:r,unshift:p,finish:v,sort:g}}function tq(){let n=new WeakMap;function e(i,o){const u=n.get(i);let h;return u===void 0?(h=new SQ,n.set(i,[h])):o>=u.length?(h=new SQ,u.push(h)):h=u[o],h}function t(){n=new WeakMap}return{get:e,dispose:t}}function iq(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new rt,color:new Xi};break;case"SpotLight":t={position:new rt,direction:new rt,color:new Xi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new rt,color:new Xi,distance:0,decay:0};break;case"HemisphereLight":t={direction:new rt,skyColor:new Xi,groundColor:new Xi};break;case"RectAreaLight":t={color:new Xi,position:new rt,halfWidth:new rt,halfHeight:new rt};break}return n[e.id]=t,t}}}function nq(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Yi};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Yi};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Yi,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let rq=0;function sq(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function oq(n,e){const t=new iq,i=nq(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)o.probe.push(new rt);const u=new rt,h=new sn,r=new sn;function p(v,I){let C=0,E=0,Q=0;for(let de=0;de<9;de++)o.probe[de].set(0,0,0);let M=0,D=0,P=0,O=0,F=0,N=0,z=0,X=0,q=0,H=0;v.sort(sq);const W=I!==!0?Math.PI:1;for(let de=0,te=v.length;de<te;de++){const ce=v[de],Ee=ce.color,Be=ce.intensity,De=ce.distance,Re=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)C+=Ee.r*Be*W,E+=Ee.g*Be*W,Q+=Ee.b*Be*W;else if(ce.isLightProbe)for(let ye=0;ye<9;ye++)o.probe[ye].addScaledVector(ce.sh.coefficients[ye],Be);else if(ce.isDirectionalLight){const ye=t.get(ce);if(ye.color.copy(ce.color).multiplyScalar(ce.intensity*W),ce.castShadow){const ht=ce.shadow,oe=i.get(ce);oe.shadowBias=ht.bias,oe.shadowNormalBias=ht.normalBias,oe.shadowRadius=ht.radius,oe.shadowMapSize=ht.mapSize,o.directionalShadow[M]=oe,o.directionalShadowMap[M]=Re,o.directionalShadowMatrix[M]=ce.shadow.matrix,N++}o.directional[M]=ye,M++}else if(ce.isSpotLight){const ye=t.get(ce);ye.position.setFromMatrixPosition(ce.matrixWorld),ye.color.copy(Ee).multiplyScalar(Be*W),ye.distance=De,ye.coneCos=Math.cos(ce.angle),ye.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),ye.decay=ce.decay,o.spot[P]=ye;const ht=ce.shadow;if(ce.map&&(o.spotLightMap[q]=ce.map,q++,ht.updateMatrices(ce),ce.castShadow&&H++),o.spotLightMatrix[P]=ht.matrix,ce.castShadow){const oe=i.get(ce);oe.shadowBias=ht.bias,oe.shadowNormalBias=ht.normalBias,oe.shadowRadius=ht.radius,oe.shadowMapSize=ht.mapSize,o.spotShadow[P]=oe,o.spotShadowMap[P]=Re,X++}P++}else if(ce.isRectAreaLight){const ye=t.get(ce);ye.color.copy(Ee).multiplyScalar(Be),ye.halfWidth.set(ce.width*.5,0,0),ye.halfHeight.set(0,ce.height*.5,0),o.rectArea[O]=ye,O++}else if(ce.isPointLight){const ye=t.get(ce);if(ye.color.copy(ce.color).multiplyScalar(ce.intensity*W),ye.distance=ce.distance,ye.decay=ce.decay,ce.castShadow){const ht=ce.shadow,oe=i.get(ce);oe.shadowBias=ht.bias,oe.shadowNormalBias=ht.normalBias,oe.shadowRadius=ht.radius,oe.shadowMapSize=ht.mapSize,oe.shadowCameraNear=ht.camera.near,oe.shadowCameraFar=ht.camera.far,o.pointShadow[D]=oe,o.pointShadowMap[D]=Re,o.pointShadowMatrix[D]=ce.shadow.matrix,z++}o.point[D]=ye,D++}else if(ce.isHemisphereLight){const ye=t.get(ce);ye.skyColor.copy(ce.color).multiplyScalar(Be*W),ye.groundColor.copy(ce.groundColor).multiplyScalar(Be*W),o.hemi[F]=ye,F++}}O>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=Ei.LTC_FLOAT_1,o.rectAreaLTC2=Ei.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(o.rectAreaLTC1=Ei.LTC_HALF_1,o.rectAreaLTC2=Ei.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=C,o.ambient[1]=E,o.ambient[2]=Q;const se=o.hash;(se.directionalLength!==M||se.pointLength!==D||se.spotLength!==P||se.rectAreaLength!==O||se.hemiLength!==F||se.numDirectionalShadows!==N||se.numPointShadows!==z||se.numSpotShadows!==X||se.numSpotMaps!==q)&&(o.directional.length=M,o.spot.length=P,o.rectArea.length=O,o.point.length=D,o.hemi.length=F,o.directionalShadow.length=N,o.directionalShadowMap.length=N,o.pointShadow.length=z,o.pointShadowMap.length=z,o.spotShadow.length=X,o.spotShadowMap.length=X,o.directionalShadowMatrix.length=N,o.pointShadowMatrix.length=z,o.spotLightMatrix.length=X+q-H,o.spotLightMap.length=q,o.numSpotLightShadowsWithMaps=H,se.directionalLength=M,se.pointLength=D,se.spotLength=P,se.rectAreaLength=O,se.hemiLength=F,se.numDirectionalShadows=N,se.numPointShadows=z,se.numSpotShadows=X,se.numSpotMaps=q,o.version=rq++)}function g(v,I){let C=0,E=0,Q=0,M=0,D=0;const P=I.matrixWorldInverse;for(let O=0,F=v.length;O<F;O++){const N=v[O];if(N.isDirectionalLight){const z=o.directional[C];z.direction.setFromMatrixPosition(N.matrixWorld),u.setFromMatrixPosition(N.target.matrixWorld),z.direction.sub(u),z.direction.transformDirection(P),C++}else if(N.isSpotLight){const z=o.spot[Q];z.position.setFromMatrixPosition(N.matrixWorld),z.position.applyMatrix4(P),z.direction.setFromMatrixPosition(N.matrixWorld),u.setFromMatrixPosition(N.target.matrixWorld),z.direction.sub(u),z.direction.transformDirection(P),Q++}else if(N.isRectAreaLight){const z=o.rectArea[M];z.position.setFromMatrixPosition(N.matrixWorld),z.position.applyMatrix4(P),r.identity(),h.copy(N.matrixWorld),h.premultiply(P),r.extractRotation(h),z.halfWidth.set(N.width*.5,0,0),z.halfHeight.set(0,N.height*.5,0),z.halfWidth.applyMatrix4(r),z.halfHeight.applyMatrix4(r),M++}else if(N.isPointLight){const z=o.point[E];z.position.setFromMatrixPosition(N.matrixWorld),z.position.applyMatrix4(P),E++}else if(N.isHemisphereLight){const z=o.hemi[D];z.direction.setFromMatrixPosition(N.matrixWorld),z.direction.transformDirection(P),D++}}}return{setup:p,setupView:g,state:o}}function MQ(n,e){const t=new oq(n,e),i=[],o=[];function u(){i.length=0,o.length=0}function h(I){i.push(I)}function r(I){o.push(I)}function p(I){t.setup(i,I)}function g(I){t.setupView(i,I)}return{init:u,state:{lightsArray:i,shadowsArray:o,lights:t},setupLights:p,setupLightsView:g,pushLight:h,pushShadow:r}}function aq(n,e){let t=new WeakMap;function i(u,h=0){const r=t.get(u);let p;return r===void 0?(p=new MQ(n,e),t.set(u,[p])):h>=r.length?(p=new MQ(n,e),r.push(p)):p=r[h],p}function o(){t=new WeakMap}return{get:i,dispose:o}}class lq extends _a{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=a9,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cq extends _a{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new rt,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const uq=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,hq=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function dq(n,e,t){let i=new EB;const o=new Yi,u=new Yi,h=new er,r=new lq({depthPacking:l9}),p=new cq,g={},v=t.maxTextureSize,I={[rl]:_o,[_o]:rl,[fa]:fa},C=new $d({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Yi},radius:{value:4}},vertexShader:uq,fragmentShader:hq}),E=C.clone();E.defines.HORIZONTAL_PASS=1;const Q=new Oo;Q.setAttribute("position",new es(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const M=new nr(Q,C),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=nk,this.render=function(N,z,X){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||N.length===0)return;const q=n.getRenderTarget(),H=n.getActiveCubeFace(),W=n.getActiveMipmapLevel(),se=n.state;se.setBlending($u),se.buffers.color.setClear(1,1,1,1),se.buffers.depth.setTest(!0),se.setScissorTest(!1);for(let de=0,te=N.length;de<te;de++){const ce=N[de],Ee=ce.shadow;if(Ee===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(Ee.autoUpdate===!1&&Ee.needsUpdate===!1)continue;o.copy(Ee.mapSize);const Be=Ee.getFrameExtents();if(o.multiply(Be),u.copy(Ee.mapSize),(o.x>v||o.y>v)&&(o.x>v&&(u.x=Math.floor(v/Be.x),o.x=u.x*Be.x,Ee.mapSize.x=u.x),o.y>v&&(u.y=Math.floor(v/Be.y),o.y=u.y*Be.y,Ee.mapSize.y=u.y)),Ee.map===null){const Re=this.type!==r_?{minFilter:us,magFilter:us}:{};Ee.map=new Zd(o.x,o.y,Re),Ee.map.texture.name=ce.name+".shadowMap",Ee.camera.updateProjectionMatrix()}n.setRenderTarget(Ee.map),n.clear();const De=Ee.getViewportCount();for(let Re=0;Re<De;Re++){const ye=Ee.getViewport(Re);h.set(u.x*ye.x,u.y*ye.y,u.x*ye.z,u.y*ye.w),se.viewport(h),Ee.updateMatrices(ce,Re),i=Ee.getFrustum(),F(z,X,Ee.camera,ce,this.type)}Ee.isPointLightShadow!==!0&&this.type===r_&&P(Ee,X),Ee.needsUpdate=!1}D.needsUpdate=!1,n.setRenderTarget(q,H,W)};function P(N,z){const X=e.update(M);C.defines.VSM_SAMPLES!==N.blurSamples&&(C.defines.VSM_SAMPLES=N.blurSamples,E.defines.VSM_SAMPLES=N.blurSamples,C.needsUpdate=!0,E.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new Zd(o.x,o.y)),C.uniforms.shadow_pass.value=N.map.texture,C.uniforms.resolution.value=N.mapSize,C.uniforms.radius.value=N.radius,n.setRenderTarget(N.mapPass),n.clear(),n.renderBufferDirect(z,null,X,C,M,null),E.uniforms.shadow_pass.value=N.mapPass.texture,E.uniforms.resolution.value=N.mapSize,E.uniforms.radius.value=N.radius,n.setRenderTarget(N.map),n.clear(),n.renderBufferDirect(z,null,X,E,M,null)}function O(N,z,X,q,H,W){let se=null;const de=X.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(de!==void 0)se=de;else if(se=X.isPointLight===!0?p:r,n.localClippingEnabled&&z.clipShadows===!0&&Array.isArray(z.clippingPlanes)&&z.clippingPlanes.length!==0||z.displacementMap&&z.displacementScale!==0||z.alphaMap&&z.alphaTest>0||z.map&&z.alphaTest>0){const te=se.uuid,ce=z.uuid;let Ee=g[te];Ee===void 0&&(Ee={},g[te]=Ee);let Be=Ee[ce];Be===void 0&&(Be=se.clone(),Ee[ce]=Be),se=Be}return se.visible=z.visible,se.wireframe=z.wireframe,W===r_?se.side=z.shadowSide!==null?z.shadowSide:z.side:se.side=z.shadowSide!==null?z.shadowSide:I[z.side],se.alphaMap=z.alphaMap,se.alphaTest=z.alphaTest,se.map=z.map,se.clipShadows=z.clipShadows,se.clippingPlanes=z.clippingPlanes,se.clipIntersection=z.clipIntersection,se.displacementMap=z.displacementMap,se.displacementScale=z.displacementScale,se.displacementBias=z.displacementBias,se.wireframeLinewidth=z.wireframeLinewidth,se.linewidth=z.linewidth,X.isPointLight===!0&&se.isMeshDistanceMaterial===!0&&(se.referencePosition.setFromMatrixPosition(X.matrixWorld),se.nearDistance=q,se.farDistance=H),se}function F(N,z,X,q,H){if(N.visible===!1)return;if(N.layers.test(z.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&H===r_)&&(!N.frustumCulled||i.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(X.matrixWorldInverse,N.matrixWorld);const de=e.update(N),te=N.material;if(Array.isArray(te)){const ce=de.groups;for(let Ee=0,Be=ce.length;Ee<Be;Ee++){const De=ce[Ee],Re=te[De.materialIndex];if(Re&&Re.visible){const ye=O(N,Re,q,X.near,X.far,H);n.renderBufferDirect(X,null,de,ye,N,De)}}}else if(te.visible){const ce=O(N,te,q,X.near,X.far,H);n.renderBufferDirect(X,null,de,ce,N,null)}}const se=N.children;for(let de=0,te=se.length;de<te;de++)F(se[de],z,X,q,H)}}function fq(n,e,t){const i=t.isWebGL2;function o(){let ee=!1;const J=new er;let Z=null;const Ae=new er(0,0,0,0);return{setMask:function(Ce){Z!==Ce&&!ee&&(n.colorMask(Ce,Ce,Ce,Ce),Z=Ce)},setLocked:function(Ce){ee=Ce},setClear:function(Ce,Le,Oe,le,me){me===!0&&(Ce*=le,Le*=le,Oe*=le),J.set(Ce,Le,Oe,le),Ae.equals(J)===!1&&(n.clearColor(Ce,Le,Oe,le),Ae.copy(J))},reset:function(){ee=!1,Z=null,Ae.set(-1,0,0,0)}}}function u(){let ee=!1,J=null,Z=null,Ae=null;return{setTest:function(Ce){Ce?dt(2929):xt(2929)},setMask:function(Ce){J!==Ce&&!ee&&(n.depthMask(Ce),J=Ce)},setFunc:function(Ce){if(Z!==Ce){switch(Ce){case TV:n.depthFunc(512);break;case DV:n.depthFunc(519);break;case QV:n.depthFunc(513);break;case Nw:n.depthFunc(515);break;case RV:n.depthFunc(514);break;case LV:n.depthFunc(518);break;case PV:n.depthFunc(516);break;case kV:n.depthFunc(517);break;default:n.depthFunc(515)}Z=Ce}},setLocked:function(Ce){ee=Ce},setClear:function(Ce){Ae!==Ce&&(n.clearDepth(Ce),Ae=Ce)},reset:function(){ee=!1,J=null,Z=null,Ae=null}}}function h(){let ee=!1,J=null,Z=null,Ae=null,Ce=null,Le=null,Oe=null,le=null,me=null;return{setTest:function(he){ee||(he?dt(2960):xt(2960))},setMask:function(he){J!==he&&!ee&&(n.stencilMask(he),J=he)},setFunc:function(he,Qe,Je){(Z!==he||Ae!==Qe||Ce!==Je)&&(n.stencilFunc(he,Qe,Je),Z=he,Ae=Qe,Ce=Je)},setOp:function(he,Qe,Je){(Le!==he||Oe!==Qe||le!==Je)&&(n.stencilOp(he,Qe,Je),Le=he,Oe=Qe,le=Je)},setLocked:function(he){ee=he},setClear:function(he){me!==he&&(n.clearStencil(he),me=he)},reset:function(){ee=!1,J=null,Z=null,Ae=null,Ce=null,Le=null,Oe=null,le=null,me=null}}}const r=new o,p=new u,g=new h,v=new WeakMap,I=new WeakMap;let C={},E={},Q=new WeakMap,M=[],D=null,P=!1,O=null,F=null,N=null,z=null,X=null,q=null,H=null,W=!1,se=null,de=null,te=null,ce=null,Ee=null;const Be=n.getParameter(35661);let De=!1,Re=0;const ye=n.getParameter(7938);ye.indexOf("WebGL")!==-1?(Re=parseFloat(/^WebGL (\d)/.exec(ye)[1]),De=Re>=1):ye.indexOf("OpenGL ES")!==-1&&(Re=parseFloat(/^OpenGL ES (\d)/.exec(ye)[1]),De=Re>=2);let ht=null,oe={};const Tt=n.getParameter(3088),Fe=n.getParameter(2978),st=new er().fromArray(Tt),Et=new er().fromArray(Fe);function Ke(ee,J,Z){const Ae=new Uint8Array(4),Ce=n.createTexture();n.bindTexture(ee,Ce),n.texParameteri(ee,10241,9728),n.texParameteri(ee,10240,9728);for(let Le=0;Le<Z;Le++)n.texImage2D(J+Le,0,6408,1,1,0,6408,5121,Ae);return Ce}const Ne={};Ne[3553]=Ke(3553,3553,1),Ne[34067]=Ke(34067,34069,6),r.setClear(0,0,0,1),p.setClear(1),g.setClear(0),dt(2929),p.setFunc(Nw),ut(!1),ze(_D),dt(2884),Ze($u);function dt(ee){C[ee]!==!0&&(n.enable(ee),C[ee]=!0)}function xt(ee){C[ee]!==!1&&(n.disable(ee),C[ee]=!1)}function ft(ee,J){return E[ee]!==J?(n.bindFramebuffer(ee,J),E[ee]=J,i&&(ee===36009&&(E[36160]=J),ee===36160&&(E[36009]=J)),!0):!1}function Ve(ee,J){let Z=M,Ae=!1;if(ee)if(Z=Q.get(J),Z===void 0&&(Z=[],Q.set(J,Z)),ee.isWebGLMultipleRenderTargets){const Ce=ee.texture;if(Z.length!==Ce.length||Z[0]!==36064){for(let Le=0,Oe=Ce.length;Le<Oe;Le++)Z[Le]=36064+Le;Z.length=Ce.length,Ae=!0}}else Z[0]!==36064&&(Z[0]=36064,Ae=!0);else Z[0]!==1029&&(Z[0]=1029,Ae=!0);Ae&&(t.isWebGL2?n.drawBuffers(Z):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Z))}function Ye(ee){return D!==ee?(n.useProgram(ee),D=ee,!0):!1}const ae={[Np]:32774,[yV]:32778,[vV]:32779};if(i)ae[ID]=32775,ae[CD]=32776;else{const ee=e.get("EXT_blend_minmax");ee!==null&&(ae[ID]=ee.MIN_EXT,ae[CD]=ee.MAX_EXT)}const _e={[xV]:0,[IV]:1,[CV]:768,[rk]:770,[MV]:776,[BV]:774,[wV]:772,[EV]:769,[sk]:771,[SV]:775,[bV]:773};function Ze(ee,J,Z,Ae,Ce,Le,Oe,le){if(ee===$u){P===!0&&(xt(3042),P=!1);return}if(P===!1&&(dt(3042),P=!0),ee!==_V){if(ee!==O||le!==W){if((F!==Np||X!==Np)&&(n.blendEquation(32774),F=Np,X=Np),le)switch(ee){case oA:n.blendFuncSeparate(1,771,1,771);break;case yD:n.blendFunc(1,1);break;case vD:n.blendFuncSeparate(0,769,0,1);break;case xD:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ee);break}else switch(ee){case oA:n.blendFuncSeparate(770,771,1,771);break;case yD:n.blendFunc(770,1);break;case vD:n.blendFuncSeparate(0,769,0,1);break;case xD:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ee);break}N=null,z=null,q=null,H=null,O=ee,W=le}return}Ce=Ce||J,Le=Le||Z,Oe=Oe||Ae,(J!==F||Ce!==X)&&(n.blendEquationSeparate(ae[J],ae[Ce]),F=J,X=Ce),(Z!==N||Ae!==z||Le!==q||Oe!==H)&&(n.blendFuncSeparate(_e[Z],_e[Ae],_e[Le],_e[Oe]),N=Z,z=Ae,q=Le,H=Oe),O=ee,W=!1}function nt(ee,J){ee.side===fa?xt(2884):dt(2884);let Z=ee.side===_o;J&&(Z=!Z),ut(Z),ee.blending===oA&&ee.transparent===!1?Ze($u):Ze(ee.blending,ee.blendEquation,ee.blendSrc,ee.blendDst,ee.blendEquationAlpha,ee.blendSrcAlpha,ee.blendDstAlpha,ee.premultipliedAlpha),p.setFunc(ee.depthFunc),p.setTest(ee.depthTest),p.setMask(ee.depthWrite),r.setMask(ee.colorWrite);const Ae=ee.stencilWrite;g.setTest(Ae),Ae&&(g.setMask(ee.stencilWriteMask),g.setFunc(ee.stencilFunc,ee.stencilRef,ee.stencilFuncMask),g.setOp(ee.stencilFail,ee.stencilZFail,ee.stencilZPass)),mt(ee.polygonOffset,ee.polygonOffsetFactor,ee.polygonOffsetUnits),ee.alphaToCoverage===!0?dt(32926):xt(32926)}function ut(ee){se!==ee&&(ee?n.frontFace(2304):n.frontFace(2305),se=ee)}function ze(ee){ee!==gV?(dt(2884),ee!==de&&(ee===_D?n.cullFace(1029):ee===mV?n.cullFace(1028):n.cullFace(1032))):xt(2884),de=ee}function Qt(ee){ee!==te&&(De&&n.lineWidth(ee),te=ee)}function mt(ee,J,Z){ee?(dt(32823),(ce!==J||Ee!==Z)&&(n.polygonOffset(J,Z),ce=J,Ee=Z)):xt(32823)}function Ut(ee){ee?dt(3089):xt(3089)}function Dt(ee){ee===void 0&&(ee=33984+Be-1),ht!==ee&&(n.activeTexture(ee),ht=ee)}function Ie(ee,J,Z){Z===void 0&&(ht===null?Z=33984+Be-1:Z=ht);let Ae=oe[Z];Ae===void 0&&(Ae={type:void 0,texture:void 0},oe[Z]=Ae),(Ae.type!==ee||Ae.texture!==J)&&(ht!==Z&&(n.activeTexture(Z),ht=Z),n.bindTexture(ee,J||Ne[ee]),Ae.type=ee,Ae.texture=J)}function ue(){const ee=oe[ht];ee!==void 0&&ee.type!==void 0&&(n.bindTexture(ee.type,null),ee.type=void 0,ee.texture=void 0)}function at(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function St(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function yt(){try{n.texSubImage2D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function Pt(){try{n.texSubImage3D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function Ot(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function Ue(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function ot(){try{n.texStorage2D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function ni(){try{n.texStorage3D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function fi(){try{n.texImage2D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function Xt(){try{n.texImage3D.apply(n,arguments)}catch(ee){console.error("THREE.WebGLState:",ee)}}function _i(ee){st.equals(ee)===!1&&(n.scissor(ee.x,ee.y,ee.z,ee.w),st.copy(ee))}function si(ee){Et.equals(ee)===!1&&(n.viewport(ee.x,ee.y,ee.z,ee.w),Et.copy(ee))}function wt(ee,J){let Z=I.get(J);Z===void 0&&(Z=new WeakMap,I.set(J,Z));let Ae=Z.get(ee);Ae===void 0&&(Ae=n.getUniformBlockIndex(J,ee.name),Z.set(ee,Ae))}function kt(ee,J){const Ae=I.get(J).get(ee);v.get(J)!==Ae&&(n.uniformBlockBinding(J,Ae,ee.__bindingPointIndex),v.set(J,Ae))}function yi(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),C={},ht=null,oe={},E={},Q=new WeakMap,M=[],D=null,P=!1,O=null,F=null,N=null,z=null,X=null,q=null,H=null,W=!1,se=null,de=null,te=null,ce=null,Ee=null,st.set(0,0,n.canvas.width,n.canvas.height),Et.set(0,0,n.canvas.width,n.canvas.height),r.reset(),p.reset(),g.reset()}return{buffers:{color:r,depth:p,stencil:g},enable:dt,disable:xt,bindFramebuffer:ft,drawBuffers:Ve,useProgram:Ye,setBlending:Ze,setMaterial:nt,setFlipSided:ut,setCullFace:ze,setLineWidth:Qt,setPolygonOffset:mt,setScissorTest:Ut,activeTexture:Dt,bindTexture:Ie,unbindTexture:ue,compressedTexImage2D:at,compressedTexImage3D:St,texImage2D:fi,texImage3D:Xt,updateUBOMapping:wt,uniformBlockBinding:kt,texStorage2D:ot,texStorage3D:ni,texSubImage2D:yt,texSubImage3D:Pt,compressedTexSubImage2D:Ot,compressedTexSubImage3D:Ue,scissor:_i,viewport:si,reset:yi}}function pq(n,e,t,i,o,u,h){const r=o.isWebGL2,p=o.maxTextures,g=o.maxCubemapSize,v=o.maxTextureSize,I=o.maxSamples,C=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,E=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),Q=new WeakMap;let M;const D=new WeakMap;let P=!1;try{P=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function O(Ie,ue){return P?new OffscreenCanvas(Ie,ue):s0("canvas")}function F(Ie,ue,at,St){let yt=1;if((Ie.width>St||Ie.height>St)&&(yt=St/Math.max(Ie.width,Ie.height)),yt<1||ue===!0)if(typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ie instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ie instanceof ImageBitmap){const Pt=ue?Ux:Math.floor,Ot=Pt(yt*Ie.width),Ue=Pt(yt*Ie.height);M===void 0&&(M=O(Ot,Ue));const ot=at?O(Ot,Ue):M;return ot.width=Ot,ot.height=Ue,ot.getContext("2d").drawImage(Ie,0,0,Ot,Ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ie.width+"x"+Ie.height+") to ("+Ot+"x"+Ue+")."),ot}else return"data"in Ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ie.width+"x"+Ie.height+")."),Ie;return Ie}function N(Ie){return Vw(Ie.width)&&Vw(Ie.height)}function z(Ie){return r?!1:Ie.wrapS!==po||Ie.wrapT!==po||Ie.minFilter!==us&&Ie.minFilter!==$r}function X(Ie,ue){return Ie.generateMipmaps&&ue&&Ie.minFilter!==us&&Ie.minFilter!==$r}function q(Ie){n.generateMipmap(Ie)}function H(Ie,ue,at,St,yt=!1){if(r===!1)return ue;if(Ie!==null){if(n[Ie]!==void 0)return n[Ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ie+"'")}let Pt=ue;return ue===6403&&(at===5126&&(Pt=33326),at===5131&&(Pt=33325),at===5121&&(Pt=33321)),ue===33319&&(at===5126&&(Pt=33328),at===5131&&(Pt=33327),at===5121&&(Pt=33323)),ue===6408&&(at===5126&&(Pt=34836),at===5131&&(Pt=34842),at===5121&&(Pt=St===Cn&&yt===!1?35907:32856),at===32819&&(Pt=32854),at===32820&&(Pt=32855)),(Pt===33325||Pt===33326||Pt===33327||Pt===33328||Pt===34842||Pt===34836)&&e.get("EXT_color_buffer_float"),Pt}function W(Ie,ue,at){return X(Ie,at)===!0||Ie.isFramebufferTexture&&Ie.minFilter!==us&&Ie.minFilter!==$r?Math.log2(Math.max(ue.width,ue.height))+1:Ie.mipmaps!==void 0&&Ie.mipmaps.length>0?Ie.mipmaps.length:Ie.isCompressedTexture&&Array.isArray(Ie.image)?ue.mipmaps.length:1}function se(Ie){return Ie===us||Ie===Uw||Ie===hx?9728:9729}function de(Ie){const ue=Ie.target;ue.removeEventListener("dispose",de),ce(ue),ue.isVideoTexture&&Q.delete(ue)}function te(Ie){const ue=Ie.target;ue.removeEventListener("dispose",te),Be(ue)}function ce(Ie){const ue=i.get(Ie);if(ue.__webglInit===void 0)return;const at=Ie.source,St=D.get(at);if(St){const yt=St[ue.__cacheKey];yt.usedTimes--,yt.usedTimes===0&&Ee(Ie),Object.keys(St).length===0&&D.delete(at)}i.remove(Ie)}function Ee(Ie){const ue=i.get(Ie);n.deleteTexture(ue.__webglTexture);const at=Ie.source,St=D.get(at);delete St[ue.__cacheKey],h.memory.textures--}function Be(Ie){const ue=Ie.texture,at=i.get(Ie),St=i.get(ue);if(St.__webglTexture!==void 0&&(n.deleteTexture(St.__webglTexture),h.memory.textures--),Ie.depthTexture&&Ie.depthTexture.dispose(),Ie.isWebGLCubeRenderTarget)for(let yt=0;yt<6;yt++)n.deleteFramebuffer(at.__webglFramebuffer[yt]),at.__webglDepthbuffer&&n.deleteRenderbuffer(at.__webglDepthbuffer[yt]);else{if(n.deleteFramebuffer(at.__webglFramebuffer),at.__webglDepthbuffer&&n.deleteRenderbuffer(at.__webglDepthbuffer),at.__webglMultisampledFramebuffer&&n.deleteFramebuffer(at.__webglMultisampledFramebuffer),at.__webglColorRenderbuffer)for(let yt=0;yt<at.__webglColorRenderbuffer.length;yt++)at.__webglColorRenderbuffer[yt]&&n.deleteRenderbuffer(at.__webglColorRenderbuffer[yt]);at.__webglDepthRenderbuffer&&n.deleteRenderbuffer(at.__webglDepthRenderbuffer)}if(Ie.isWebGLMultipleRenderTargets)for(let yt=0,Pt=ue.length;yt<Pt;yt++){const Ot=i.get(ue[yt]);Ot.__webglTexture&&(n.deleteTexture(Ot.__webglTexture),h.memory.textures--),i.remove(ue[yt])}i.remove(ue),i.remove(Ie)}let De=0;function Re(){De=0}function ye(){const Ie=De;return Ie>=p&&console.warn("THREE.WebGLTextures: Trying to use "+Ie+" texture units while this GPU supports only "+p),De+=1,Ie}function ht(Ie){const ue=[];return ue.push(Ie.wrapS),ue.push(Ie.wrapT),ue.push(Ie.wrapR||0),ue.push(Ie.magFilter),ue.push(Ie.minFilter),ue.push(Ie.anisotropy),ue.push(Ie.internalFormat),ue.push(Ie.format),ue.push(Ie.type),ue.push(Ie.generateMipmaps),ue.push(Ie.premultiplyAlpha),ue.push(Ie.flipY),ue.push(Ie.unpackAlignment),ue.push(Ie.encoding),ue.join()}function oe(Ie,ue){const at=i.get(Ie);if(Ie.isVideoTexture&&Ut(Ie),Ie.isRenderTargetTexture===!1&&Ie.version>0&&at.__version!==Ie.version){const St=Ie.image;if(St===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(St.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{xt(at,Ie,ue);return}}t.bindTexture(3553,at.__webglTexture,33984+ue)}function Tt(Ie,ue){const at=i.get(Ie);if(Ie.version>0&&at.__version!==Ie.version){xt(at,Ie,ue);return}t.bindTexture(35866,at.__webglTexture,33984+ue)}function Fe(Ie,ue){const at=i.get(Ie);if(Ie.version>0&&at.__version!==Ie.version){xt(at,Ie,ue);return}t.bindTexture(32879,at.__webglTexture,33984+ue)}function st(Ie,ue){const at=i.get(Ie);if(Ie.version>0&&at.__version!==Ie.version){ft(at,Ie,ue);return}t.bindTexture(34067,at.__webglTexture,33984+ue)}const Et={[QA]:10497,[po]:33071,[zx]:33648},Ke={[us]:9728,[Uw]:9984,[hx]:9986,[$r]:9729,[ak]:9985,[ch]:9987};function Ne(Ie,ue,at){if(at?(n.texParameteri(Ie,10242,Et[ue.wrapS]),n.texParameteri(Ie,10243,Et[ue.wrapT]),(Ie===32879||Ie===35866)&&n.texParameteri(Ie,32882,Et[ue.wrapR]),n.texParameteri(Ie,10240,Ke[ue.magFilter]),n.texParameteri(Ie,10241,Ke[ue.minFilter])):(n.texParameteri(Ie,10242,33071),n.texParameteri(Ie,10243,33071),(Ie===32879||Ie===35866)&&n.texParameteri(Ie,32882,33071),(ue.wrapS!==po||ue.wrapT!==po)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Ie,10240,se(ue.magFilter)),n.texParameteri(Ie,10241,se(ue.minFilter)),ue.minFilter!==us&&ue.minFilter!==$r&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const St=e.get("EXT_texture_filter_anisotropic");if(ue.magFilter===us||ue.minFilter!==hx&&ue.minFilter!==ch||ue.type===Za&&e.has("OES_texture_float_linear")===!1||r===!1&&ue.type===Ec&&e.has("OES_texture_half_float_linear")===!1)return;(ue.anisotropy>1||i.get(ue).__currentAnisotropy)&&(n.texParameterf(Ie,St.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ue.anisotropy,o.getMaxAnisotropy())),i.get(ue).__currentAnisotropy=ue.anisotropy)}}function dt(Ie,ue){let at=!1;Ie.__webglInit===void 0&&(Ie.__webglInit=!0,ue.addEventListener("dispose",de));const St=ue.source;let yt=D.get(St);yt===void 0&&(yt={},D.set(St,yt));const Pt=ht(ue);if(Pt!==Ie.__cacheKey){yt[Pt]===void 0&&(yt[Pt]={texture:n.createTexture(),usedTimes:0},h.memory.textures++,at=!0),yt[Pt].usedTimes++;const Ot=yt[Ie.__cacheKey];Ot!==void 0&&(yt[Ie.__cacheKey].usedTimes--,Ot.usedTimes===0&&Ee(ue)),Ie.__cacheKey=Pt,Ie.__webglTexture=yt[Pt].texture}return at}function xt(Ie,ue,at){let St=3553;(ue.isDataArrayTexture||ue.isCompressedArrayTexture)&&(St=35866),ue.isData3DTexture&&(St=32879);const yt=dt(Ie,ue),Pt=ue.source;t.bindTexture(St,Ie.__webglTexture,33984+at);const Ot=i.get(Pt);if(Pt.version!==Ot.__version||yt===!0){t.activeTexture(33984+at),n.pixelStorei(37440,ue.flipY),n.pixelStorei(37441,ue.premultiplyAlpha),n.pixelStorei(3317,ue.unpackAlignment),n.pixelStorei(37443,0);const Ue=z(ue)&&N(ue.image)===!1;let ot=F(ue.image,Ue,!1,v);ot=Dt(ue,ot);const ni=N(ot)||r,fi=u.convert(ue.format,ue.encoding);let Xt=u.convert(ue.type),_i=H(ue.internalFormat,fi,Xt,ue.encoding,ue.isVideoTexture);Ne(St,ue,ni);let si;const wt=ue.mipmaps,kt=r&&ue.isVideoTexture!==!0,yi=Ot.__version===void 0||yt===!0,ee=W(ue,ot,ni);if(ue.isDepthTexture)_i=6402,r?ue.type===Za?_i=36012:ue.type===Sd?_i=33190:ue.type===aA?_i=35056:_i=33189:ue.type===Za&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ue.format===Od&&_i===6402&&ue.type!==lk&&ue.type!==Sd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ue.type=Sd,Xt=u.convert(ue.type)),ue.format===RA&&_i===6402&&(_i=34041,ue.type!==aA&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ue.type=aA,Xt=u.convert(ue.type))),yi&&(kt?t.texStorage2D(3553,1,_i,ot.width,ot.height):t.texImage2D(3553,0,_i,ot.width,ot.height,0,fi,Xt,null));else if(ue.isDataTexture)if(wt.length>0&&ni){kt&&yi&&t.texStorage2D(3553,ee,_i,wt[0].width,wt[0].height);for(let J=0,Z=wt.length;J<Z;J++)si=wt[J],kt?t.texSubImage2D(3553,J,0,0,si.width,si.height,fi,Xt,si.data):t.texImage2D(3553,J,_i,si.width,si.height,0,fi,Xt,si.data);ue.generateMipmaps=!1}else kt?(yi&&t.texStorage2D(3553,ee,_i,ot.width,ot.height),t.texSubImage2D(3553,0,0,0,ot.width,ot.height,fi,Xt,ot.data)):t.texImage2D(3553,0,_i,ot.width,ot.height,0,fi,Xt,ot.data);else if(ue.isCompressedTexture)if(ue.isCompressedArrayTexture){kt&&yi&&t.texStorage3D(35866,ee,_i,wt[0].width,wt[0].height,ot.depth);for(let J=0,Z=wt.length;J<Z;J++)si=wt[J],ue.format!==aa?fi!==null?kt?t.compressedTexSubImage3D(35866,J,0,0,0,si.width,si.height,ot.depth,fi,si.data,0,0):t.compressedTexImage3D(35866,J,_i,si.width,si.height,ot.depth,0,si.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage3D(35866,J,0,0,0,si.width,si.height,ot.depth,fi,Xt,si.data):t.texImage3D(35866,J,_i,si.width,si.height,ot.depth,0,fi,Xt,si.data)}else{kt&&yi&&t.texStorage2D(3553,ee,_i,wt[0].width,wt[0].height);for(let J=0,Z=wt.length;J<Z;J++)si=wt[J],ue.format!==aa?fi!==null?kt?t.compressedTexSubImage2D(3553,J,0,0,si.width,si.height,fi,si.data):t.compressedTexImage2D(3553,J,_i,si.width,si.height,0,si.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage2D(3553,J,0,0,si.width,si.height,fi,Xt,si.data):t.texImage2D(3553,J,_i,si.width,si.height,0,fi,Xt,si.data)}else if(ue.isDataArrayTexture)kt?(yi&&t.texStorage3D(35866,ee,_i,ot.width,ot.height,ot.depth),t.texSubImage3D(35866,0,0,0,0,ot.width,ot.height,ot.depth,fi,Xt,ot.data)):t.texImage3D(35866,0,_i,ot.width,ot.height,ot.depth,0,fi,Xt,ot.data);else if(ue.isData3DTexture)kt?(yi&&t.texStorage3D(32879,ee,_i,ot.width,ot.height,ot.depth),t.texSubImage3D(32879,0,0,0,0,ot.width,ot.height,ot.depth,fi,Xt,ot.data)):t.texImage3D(32879,0,_i,ot.width,ot.height,ot.depth,0,fi,Xt,ot.data);else if(ue.isFramebufferTexture){if(yi)if(kt)t.texStorage2D(3553,ee,_i,ot.width,ot.height);else{let J=ot.width,Z=ot.height;for(let Ae=0;Ae<ee;Ae++)t.texImage2D(3553,Ae,_i,J,Z,0,fi,Xt,null),J>>=1,Z>>=1}}else if(wt.length>0&&ni){kt&&yi&&t.texStorage2D(3553,ee,_i,wt[0].width,wt[0].height);for(let J=0,Z=wt.length;J<Z;J++)si=wt[J],kt?t.texSubImage2D(3553,J,0,0,fi,Xt,si):t.texImage2D(3553,J,_i,fi,Xt,si);ue.generateMipmaps=!1}else kt?(yi&&t.texStorage2D(3553,ee,_i,ot.width,ot.height),t.texSubImage2D(3553,0,0,0,fi,Xt,ot)):t.texImage2D(3553,0,_i,fi,Xt,ot);X(ue,ni)&&q(St),Ot.__version=Pt.version,ue.onUpdate&&ue.onUpdate(ue)}Ie.__version=ue.version}function ft(Ie,ue,at){if(ue.image.length!==6)return;const St=dt(Ie,ue),yt=ue.source;t.bindTexture(34067,Ie.__webglTexture,33984+at);const Pt=i.get(yt);if(yt.version!==Pt.__version||St===!0){t.activeTexture(33984+at),n.pixelStorei(37440,ue.flipY),n.pixelStorei(37441,ue.premultiplyAlpha),n.pixelStorei(3317,ue.unpackAlignment),n.pixelStorei(37443,0);const Ot=ue.isCompressedTexture||ue.image[0].isCompressedTexture,Ue=ue.image[0]&&ue.image[0].isDataTexture,ot=[];for(let J=0;J<6;J++)!Ot&&!Ue?ot[J]=F(ue.image[J],!1,!0,g):ot[J]=Ue?ue.image[J].image:ue.image[J],ot[J]=Dt(ue,ot[J]);const ni=ot[0],fi=N(ni)||r,Xt=u.convert(ue.format,ue.encoding),_i=u.convert(ue.type),si=H(ue.internalFormat,Xt,_i,ue.encoding),wt=r&&ue.isVideoTexture!==!0,kt=Pt.__version===void 0||St===!0;let yi=W(ue,ni,fi);Ne(34067,ue,fi);let ee;if(Ot){wt&&kt&&t.texStorage2D(34067,yi,si,ni.width,ni.height);for(let J=0;J<6;J++){ee=ot[J].mipmaps;for(let Z=0;Z<ee.length;Z++){const Ae=ee[Z];ue.format!==aa?Xt!==null?wt?t.compressedTexSubImage2D(34069+J,Z,0,0,Ae.width,Ae.height,Xt,Ae.data):t.compressedTexImage2D(34069+J,Z,si,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wt?t.texSubImage2D(34069+J,Z,0,0,Ae.width,Ae.height,Xt,_i,Ae.data):t.texImage2D(34069+J,Z,si,Ae.width,Ae.height,0,Xt,_i,Ae.data)}}}else{ee=ue.mipmaps,wt&&kt&&(ee.length>0&&yi++,t.texStorage2D(34067,yi,si,ot[0].width,ot[0].height));for(let J=0;J<6;J++)if(Ue){wt?t.texSubImage2D(34069+J,0,0,0,ot[J].width,ot[J].height,Xt,_i,ot[J].data):t.texImage2D(34069+J,0,si,ot[J].width,ot[J].height,0,Xt,_i,ot[J].data);for(let Z=0;Z<ee.length;Z++){const Ce=ee[Z].image[J].image;wt?t.texSubImage2D(34069+J,Z+1,0,0,Ce.width,Ce.height,Xt,_i,Ce.data):t.texImage2D(34069+J,Z+1,si,Ce.width,Ce.height,0,Xt,_i,Ce.data)}}else{wt?t.texSubImage2D(34069+J,0,0,0,Xt,_i,ot[J]):t.texImage2D(34069+J,0,si,Xt,_i,ot[J]);for(let Z=0;Z<ee.length;Z++){const Ae=ee[Z];wt?t.texSubImage2D(34069+J,Z+1,0,0,Xt,_i,Ae.image[J]):t.texImage2D(34069+J,Z+1,si,Xt,_i,Ae.image[J])}}}X(ue,fi)&&q(34067),Pt.__version=yt.version,ue.onUpdate&&ue.onUpdate(ue)}Ie.__version=ue.version}function Ve(Ie,ue,at,St,yt){const Pt=u.convert(at.format,at.encoding),Ot=u.convert(at.type),Ue=H(at.internalFormat,Pt,Ot,at.encoding);i.get(ue).__hasExternalTextures||(yt===32879||yt===35866?t.texImage3D(yt,0,Ue,ue.width,ue.height,ue.depth,0,Pt,Ot,null):t.texImage2D(yt,0,Ue,ue.width,ue.height,0,Pt,Ot,null)),t.bindFramebuffer(36160,Ie),mt(ue)?C.framebufferTexture2DMultisampleEXT(36160,St,yt,i.get(at).__webglTexture,0,Qt(ue)):(yt===3553||yt>=34069&&yt<=34074)&&n.framebufferTexture2D(36160,St,yt,i.get(at).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ye(Ie,ue,at){if(n.bindRenderbuffer(36161,Ie),ue.depthBuffer&&!ue.stencilBuffer){let St=33189;if(at||mt(ue)){const yt=ue.depthTexture;yt&&yt.isDepthTexture&&(yt.type===Za?St=36012:yt.type===Sd&&(St=33190));const Pt=Qt(ue);mt(ue)?C.renderbufferStorageMultisampleEXT(36161,Pt,St,ue.width,ue.height):n.renderbufferStorageMultisample(36161,Pt,St,ue.width,ue.height)}else n.renderbufferStorage(36161,St,ue.width,ue.height);n.framebufferRenderbuffer(36160,36096,36161,Ie)}else if(ue.depthBuffer&&ue.stencilBuffer){const St=Qt(ue);at&&mt(ue)===!1?n.renderbufferStorageMultisample(36161,St,35056,ue.width,ue.height):mt(ue)?C.renderbufferStorageMultisampleEXT(36161,St,35056,ue.width,ue.height):n.renderbufferStorage(36161,34041,ue.width,ue.height),n.framebufferRenderbuffer(36160,33306,36161,Ie)}else{const St=ue.isWebGLMultipleRenderTargets===!0?ue.texture:[ue.texture];for(let yt=0;yt<St.length;yt++){const Pt=St[yt],Ot=u.convert(Pt.format,Pt.encoding),Ue=u.convert(Pt.type),ot=H(Pt.internalFormat,Ot,Ue,Pt.encoding),ni=Qt(ue);at&&mt(ue)===!1?n.renderbufferStorageMultisample(36161,ni,ot,ue.width,ue.height):mt(ue)?C.renderbufferStorageMultisampleEXT(36161,ni,ot,ue.width,ue.height):n.renderbufferStorage(36161,ot,ue.width,ue.height)}}n.bindRenderbuffer(36161,null)}function ae(Ie,ue){if(ue&&ue.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,Ie),!(ue.depthTexture&&ue.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(ue.depthTexture).__webglTexture||ue.depthTexture.image.width!==ue.width||ue.depthTexture.image.height!==ue.height)&&(ue.depthTexture.image.width=ue.width,ue.depthTexture.image.height=ue.height,ue.depthTexture.needsUpdate=!0),oe(ue.depthTexture,0);const St=i.get(ue.depthTexture).__webglTexture,yt=Qt(ue);if(ue.depthTexture.format===Od)mt(ue)?C.framebufferTexture2DMultisampleEXT(36160,36096,3553,St,0,yt):n.framebufferTexture2D(36160,36096,3553,St,0);else if(ue.depthTexture.format===RA)mt(ue)?C.framebufferTexture2DMultisampleEXT(36160,33306,3553,St,0,yt):n.framebufferTexture2D(36160,33306,3553,St,0);else throw new Error("Unknown depthTexture format")}function _e(Ie){const ue=i.get(Ie),at=Ie.isWebGLCubeRenderTarget===!0;if(Ie.depthTexture&&!ue.__autoAllocateDepthBuffer){if(at)throw new Error("target.depthTexture not supported in Cube render targets");ae(ue.__webglFramebuffer,Ie)}else if(at){ue.__webglDepthbuffer=[];for(let St=0;St<6;St++)t.bindFramebuffer(36160,ue.__webglFramebuffer[St]),ue.__webglDepthbuffer[St]=n.createRenderbuffer(),Ye(ue.__webglDepthbuffer[St],Ie,!1)}else t.bindFramebuffer(36160,ue.__webglFramebuffer),ue.__webglDepthbuffer=n.createRenderbuffer(),Ye(ue.__webglDepthbuffer,Ie,!1);t.bindFramebuffer(36160,null)}function Ze(Ie,ue,at){const St=i.get(Ie);ue!==void 0&&Ve(St.__webglFramebuffer,Ie,Ie.texture,36064,3553),at!==void 0&&_e(Ie)}function nt(Ie){const ue=Ie.texture,at=i.get(Ie),St=i.get(ue);Ie.addEventListener("dispose",te),Ie.isWebGLMultipleRenderTargets!==!0&&(St.__webglTexture===void 0&&(St.__webglTexture=n.createTexture()),St.__version=ue.version,h.memory.textures++);const yt=Ie.isWebGLCubeRenderTarget===!0,Pt=Ie.isWebGLMultipleRenderTargets===!0,Ot=N(Ie)||r;if(yt){at.__webglFramebuffer=[];for(let Ue=0;Ue<6;Ue++)at.__webglFramebuffer[Ue]=n.createFramebuffer()}else{if(at.__webglFramebuffer=n.createFramebuffer(),Pt)if(o.drawBuffers){const Ue=Ie.texture;for(let ot=0,ni=Ue.length;ot<ni;ot++){const fi=i.get(Ue[ot]);fi.__webglTexture===void 0&&(fi.__webglTexture=n.createTexture(),h.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(r&&Ie.samples>0&&mt(Ie)===!1){const Ue=Pt?ue:[ue];at.__webglMultisampledFramebuffer=n.createFramebuffer(),at.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,at.__webglMultisampledFramebuffer);for(let ot=0;ot<Ue.length;ot++){const ni=Ue[ot];at.__webglColorRenderbuffer[ot]=n.createRenderbuffer(),n.bindRenderbuffer(36161,at.__webglColorRenderbuffer[ot]);const fi=u.convert(ni.format,ni.encoding),Xt=u.convert(ni.type),_i=H(ni.internalFormat,fi,Xt,ni.encoding,Ie.isXRRenderTarget===!0),si=Qt(Ie);n.renderbufferStorageMultisample(36161,si,_i,Ie.width,Ie.height),n.framebufferRenderbuffer(36160,36064+ot,36161,at.__webglColorRenderbuffer[ot])}n.bindRenderbuffer(36161,null),Ie.depthBuffer&&(at.__webglDepthRenderbuffer=n.createRenderbuffer(),Ye(at.__webglDepthRenderbuffer,Ie,!0)),t.bindFramebuffer(36160,null)}}if(yt){t.bindTexture(34067,St.__webglTexture),Ne(34067,ue,Ot);for(let Ue=0;Ue<6;Ue++)Ve(at.__webglFramebuffer[Ue],Ie,ue,36064,34069+Ue);X(ue,Ot)&&q(34067),t.unbindTexture()}else if(Pt){const Ue=Ie.texture;for(let ot=0,ni=Ue.length;ot<ni;ot++){const fi=Ue[ot],Xt=i.get(fi);t.bindTexture(3553,Xt.__webglTexture),Ne(3553,fi,Ot),Ve(at.__webglFramebuffer,Ie,fi,36064+ot,3553),X(fi,Ot)&&q(3553)}t.unbindTexture()}else{let Ue=3553;(Ie.isWebGL3DRenderTarget||Ie.isWebGLArrayRenderTarget)&&(r?Ue=Ie.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ue,St.__webglTexture),Ne(Ue,ue,Ot),Ve(at.__webglFramebuffer,Ie,ue,36064,Ue),X(ue,Ot)&&q(Ue),t.unbindTexture()}Ie.depthBuffer&&_e(Ie)}function ut(Ie){const ue=N(Ie)||r,at=Ie.isWebGLMultipleRenderTargets===!0?Ie.texture:[Ie.texture];for(let St=0,yt=at.length;St<yt;St++){const Pt=at[St];if(X(Pt,ue)){const Ot=Ie.isWebGLCubeRenderTarget?34067:3553,Ue=i.get(Pt).__webglTexture;t.bindTexture(Ot,Ue),q(Ot),t.unbindTexture()}}}function ze(Ie){if(r&&Ie.samples>0&&mt(Ie)===!1){const ue=Ie.isWebGLMultipleRenderTargets?Ie.texture:[Ie.texture],at=Ie.width,St=Ie.height;let yt=16384;const Pt=[],Ot=Ie.stencilBuffer?33306:36096,Ue=i.get(Ie),ot=Ie.isWebGLMultipleRenderTargets===!0;if(ot)for(let ni=0;ni<ue.length;ni++)t.bindFramebuffer(36160,Ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ni,36161,null),t.bindFramebuffer(36160,Ue.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ni,3553,null,0);t.bindFramebuffer(36008,Ue.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Ue.__webglFramebuffer);for(let ni=0;ni<ue.length;ni++){Pt.push(36064+ni),Ie.depthBuffer&&Pt.push(Ot);const fi=Ue.__ignoreDepthValues!==void 0?Ue.__ignoreDepthValues:!1;if(fi===!1&&(Ie.depthBuffer&&(yt|=256),Ie.stencilBuffer&&(yt|=1024)),ot&&n.framebufferRenderbuffer(36008,36064,36161,Ue.__webglColorRenderbuffer[ni]),fi===!0&&(n.invalidateFramebuffer(36008,[Ot]),n.invalidateFramebuffer(36009,[Ot])),ot){const Xt=i.get(ue[ni]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Xt,0)}n.blitFramebuffer(0,0,at,St,0,0,at,St,yt,9728),E&&n.invalidateFramebuffer(36008,Pt)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ot)for(let ni=0;ni<ue.length;ni++){t.bindFramebuffer(36160,Ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+ni,36161,Ue.__webglColorRenderbuffer[ni]);const fi=i.get(ue[ni]).__webglTexture;t.bindFramebuffer(36160,Ue.__webglFramebuffer),n.framebufferTexture2D(36009,36064+ni,3553,fi,0)}t.bindFramebuffer(36009,Ue.__webglMultisampledFramebuffer)}}function Qt(Ie){return Math.min(I,Ie.samples)}function mt(Ie){const ue=i.get(Ie);return r&&Ie.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ue.__useRenderToTexture!==!1}function Ut(Ie){const ue=h.render.frame;Q.get(Ie)!==ue&&(Q.set(Ie,ue),Ie.update())}function Dt(Ie,ue){const at=Ie.encoding,St=Ie.format,yt=Ie.type;return Ie.isCompressedTexture===!0||Ie.isVideoTexture===!0||Ie.format===Hw||at!==uh&&(at===Cn?r===!1?e.has("EXT_sRGB")===!0&&St===aa?(Ie.format=Hw,Ie.minFilter=$r,Ie.generateMipmaps=!1):ue=fk.sRGBToLinear(ue):(St!==aa||yt!==Xd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",at)),ue}this.allocateTextureUnit=ye,this.resetTextureUnits=Re,this.setTexture2D=oe,this.setTexture2DArray=Tt,this.setTexture3D=Fe,this.setTextureCube=st,this.rebindTextures=Ze,this.setupRenderTarget=nt,this.updateRenderTargetMipmap=ut,this.updateMultisampleRenderTarget=ze,this.setupDepthRenderbuffer=_e,this.setupFrameBufferTexture=Ve,this.useMultisampledRTT=mt}function Aq(n,e,t){const i=t.isWebGL2;function o(u,h=null){let r;if(u===Xd)return 5121;if(u===jV)return 32819;if(u===qV)return 32820;if(u===VV)return 5120;if(u===WV)return 5122;if(u===lk)return 5123;if(u===YV)return 5124;if(u===Sd)return 5125;if(u===Za)return 5126;if(u===Ec)return i?5131:(r=e.get("OES_texture_half_float"),r!==null?r.HALF_FLOAT_OES:null);if(u===KV)return 6406;if(u===aa)return 6408;if(u===JV)return 6409;if(u===XV)return 6410;if(u===Od)return 6402;if(u===RA)return 34041;if(u===Hw)return r=e.get("EXT_sRGB"),r!==null?r.SRGB_ALPHA_EXT:null;if(u===ZV)return 6403;if(u===$V)return 36244;if(u===e9)return 33319;if(u===t9)return 33320;if(u===i9)return 36249;if(u===qC||u===KC||u===JC||u===XC)if(h===Cn)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(u===qC)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(u===KC)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(u===JC)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(u===XC)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(u===qC)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(u===KC)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(u===JC)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(u===XC)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(u===ED||u===wD||u===bD||u===BD)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(u===ED)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(u===wD)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(u===bD)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(u===BD)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(u===n9)return r=e.get("WEBGL_compressed_texture_etc1"),r!==null?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(u===SD||u===MD)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(u===SD)return h===Cn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(u===MD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(u===TD||u===DD||u===QD||u===RD||u===LD||u===PD||u===kD||u===FD||u===ND||u===zD||u===UD||u===OD||u===GD||u===HD)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(u===TD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(u===DD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(u===QD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(u===RD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(u===LD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(u===PD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(u===kD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(u===FD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(u===ND)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(u===zD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(u===UD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(u===OD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(u===GD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(u===HD)return h===Cn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(u===ZC)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(u===ZC)return h===Cn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(u===r9||u===VD||u===WD||u===YD)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(u===ZC)return r.COMPRESSED_RED_RGTC1_EXT;if(u===VD)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(u===WD)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(u===YD)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return u===aA?i?34042:(r=e.get("WEBGL_depth_texture"),r!==null?r.UNSIGNED_INT_24_8_WEBGL:null):n[u]!==void 0?n[u]:null}return{convert:o}}class gq extends ds{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Md=class extends rr{constructor(){super(),this.isGroup=!0,this.type="Group"}};const mq={type:"move"};class EE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Md,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Md,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new rt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new rt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Md,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new rt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new rt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let o=null,u=null,h=null;const r=this._targetRay,p=this._grip,g=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(g&&e.hand){h=!0;for(const M of e.hand.values()){const D=t.getJointPose(M,i),P=this._getHandJoint(g,M);D!==null&&(P.matrix.fromArray(D.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.jointRadius=D.radius),P.visible=D!==null}const v=g.joints["index-finger-tip"],I=g.joints["thumb-tip"],C=v.position.distanceTo(I.position),E=.02,Q=.005;g.inputState.pinching&&C>E+Q?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!g.inputState.pinching&&C<=E-Q&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else p!==null&&e.gripSpace&&(u=t.getPose(e.gripSpace,i),u!==null&&(p.matrix.fromArray(u.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),u.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(u.linearVelocity)):p.hasLinearVelocity=!1,u.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(u.angularVelocity)):p.hasAngularVelocity=!1));r!==null&&(o=t.getPose(e.targetRaySpace,i),o===null&&u!==null&&(o=u),o!==null&&(r.matrix.fromArray(o.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),o.linearVelocity?(r.hasLinearVelocity=!0,r.linearVelocity.copy(o.linearVelocity)):r.hasLinearVelocity=!1,o.angularVelocity?(r.hasAngularVelocity=!0,r.angularVelocity.copy(o.angularVelocity)):r.hasAngularVelocity=!1,this.dispatchEvent(mq)))}return r!==null&&(r.visible=o!==null),p!==null&&(p.visible=u!==null),g!==null&&(g.visible=h!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Md;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class _q extends Cs{constructor(e,t,i,o,u,h,r,p,g,v){if(v=v!==void 0?v:Od,v!==Od&&v!==RA)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&v===Od&&(i=Sd),i===void 0&&v===RA&&(i=aA),super(null,o,u,h,r,p,v,i,g),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=r!==void 0?r:us,this.minFilter=p!==void 0?p:us,this.flipY=!1,this.generateMipmaps=!1}}class yq extends lf{constructor(e,t){super();const i=this;let o=null,u=1,h=null,r="local-floor",p=1,g=null,v=null,I=null,C=null,E=null,Q=null;const M=t.getContextAttributes();let D=null,P=null;const O=[],F=[],N=new Set,z=new Map,X=new ds;X.layers.enable(1),X.viewport=new er;const q=new ds;q.layers.enable(2),q.viewport=new er;const H=[X,q],W=new gq;W.layers.enable(1),W.layers.enable(2);let se=null,de=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Fe){let st=O[Fe];return st===void 0&&(st=new EE,O[Fe]=st),st.getTargetRaySpace()},this.getControllerGrip=function(Fe){let st=O[Fe];return st===void 0&&(st=new EE,O[Fe]=st),st.getGripSpace()},this.getHand=function(Fe){let st=O[Fe];return st===void 0&&(st=new EE,O[Fe]=st),st.getHandSpace()};function te(Fe){const st=F.indexOf(Fe.inputSource);if(st===-1)return;const Et=O[st];Et!==void 0&&Et.dispatchEvent({type:Fe.type,data:Fe.inputSource})}function ce(){o.removeEventListener("select",te),o.removeEventListener("selectstart",te),o.removeEventListener("selectend",te),o.removeEventListener("squeeze",te),o.removeEventListener("squeezestart",te),o.removeEventListener("squeezeend",te),o.removeEventListener("end",ce),o.removeEventListener("inputsourceschange",Ee);for(let Fe=0;Fe<O.length;Fe++){const st=F[Fe];st!==null&&(F[Fe]=null,O[Fe].disconnect(st))}se=null,de=null,e.setRenderTarget(D),E=null,C=null,I=null,o=null,P=null,Tt.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Fe){u=Fe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Fe){r=Fe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||h},this.setReferenceSpace=function(Fe){g=Fe},this.getBaseLayer=function(){return C!==null?C:E},this.getBinding=function(){return I},this.getFrame=function(){return Q},this.getSession=function(){return o},this.setSession=async function(Fe){if(o=Fe,o!==null){if(D=e.getRenderTarget(),o.addEventListener("select",te),o.addEventListener("selectstart",te),o.addEventListener("selectend",te),o.addEventListener("squeeze",te),o.addEventListener("squeezestart",te),o.addEventListener("squeezeend",te),o.addEventListener("end",ce),o.addEventListener("inputsourceschange",Ee),M.xrCompatible!==!0&&await t.makeXRCompatible(),o.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const st={antialias:o.renderState.layers===void 0?M.antialias:!0,alpha:M.alpha,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:u};E=new XRWebGLLayer(o,t,st),o.updateRenderState({baseLayer:E}),P=new Zd(E.framebufferWidth,E.framebufferHeight,{format:aa,type:Xd,encoding:e.outputEncoding,stencilBuffer:M.stencil})}else{let st=null,Et=null,Ke=null;M.depth&&(Ke=M.stencil?35056:33190,st=M.stencil?RA:Od,Et=M.stencil?aA:Sd);const Ne={colorFormat:32856,depthFormat:Ke,scaleFactor:u};I=new XRWebGLBinding(o,t),C=I.createProjectionLayer(Ne),o.updateRenderState({layers:[C]}),P=new Zd(C.textureWidth,C.textureHeight,{format:aa,type:Xd,depthTexture:new _q(C.textureWidth,C.textureHeight,Et,void 0,void 0,void 0,void 0,void 0,void 0,st),stencilBuffer:M.stencil,encoding:e.outputEncoding,samples:M.antialias?4:0});const dt=e.properties.get(P);dt.__ignoreDepthValues=C.ignoreDepthValues}P.isXRRenderTarget=!0,this.setFoveation(p),g=null,h=await o.requestReferenceSpace(r),Tt.setContext(o),Tt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function Ee(Fe){for(let st=0;st<Fe.removed.length;st++){const Et=Fe.removed[st],Ke=F.indexOf(Et);Ke>=0&&(F[Ke]=null,O[Ke].disconnect(Et))}for(let st=0;st<Fe.added.length;st++){const Et=Fe.added[st];let Ke=F.indexOf(Et);if(Ke===-1){for(let dt=0;dt<O.length;dt++)if(dt>=F.length){F.push(Et),Ke=dt;break}else if(F[dt]===null){F[dt]=Et,Ke=dt;break}if(Ke===-1)break}const Ne=O[Ke];Ne&&Ne.connect(Et)}}const Be=new rt,De=new rt;function Re(Fe,st,Et){Be.setFromMatrixPosition(st.matrixWorld),De.setFromMatrixPosition(Et.matrixWorld);const Ke=Be.distanceTo(De),Ne=st.projectionMatrix.elements,dt=Et.projectionMatrix.elements,xt=Ne[14]/(Ne[10]-1),ft=Ne[14]/(Ne[10]+1),Ve=(Ne[9]+1)/Ne[5],Ye=(Ne[9]-1)/Ne[5],ae=(Ne[8]-1)/Ne[0],_e=(dt[8]+1)/dt[0],Ze=xt*ae,nt=xt*_e,ut=Ke/(-ae+_e),ze=ut*-ae;st.matrixWorld.decompose(Fe.position,Fe.quaternion,Fe.scale),Fe.translateX(ze),Fe.translateZ(ut),Fe.matrixWorld.compose(Fe.position,Fe.quaternion,Fe.scale),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert();const Qt=xt+ut,mt=ft+ut,Ut=Ze-ze,Dt=nt+(Ke-ze),Ie=Ve*ft/mt*Qt,ue=Ye*ft/mt*Qt;Fe.projectionMatrix.makePerspective(Ut,Dt,Ie,ue,Qt,mt)}function ye(Fe,st){st===null?Fe.matrixWorld.copy(Fe.matrix):Fe.matrixWorld.multiplyMatrices(st.matrixWorld,Fe.matrix),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert()}this.updateCamera=function(Fe){if(o===null)return;W.near=q.near=X.near=Fe.near,W.far=q.far=X.far=Fe.far,(se!==W.near||de!==W.far)&&(o.updateRenderState({depthNear:W.near,depthFar:W.far}),se=W.near,de=W.far);const st=Fe.parent,Et=W.cameras;ye(W,st);for(let Ne=0;Ne<Et.length;Ne++)ye(Et[Ne],st);W.matrixWorld.decompose(W.position,W.quaternion,W.scale),Fe.matrix.copy(W.matrix),Fe.matrix.decompose(Fe.position,Fe.quaternion,Fe.scale);const Ke=Fe.children;for(let Ne=0,dt=Ke.length;Ne<dt;Ne++)Ke[Ne].updateMatrixWorld(!0);Et.length===2?Re(W,X,q):W.projectionMatrix.copy(X.projectionMatrix)},this.getCamera=function(){return W},this.getFoveation=function(){if(!(C===null&&E===null))return p},this.setFoveation=function(Fe){p=Fe,C!==null&&(C.fixedFoveation=Fe),E!==null&&E.fixedFoveation!==void 0&&(E.fixedFoveation=Fe)},this.getPlanes=function(){return N};let ht=null;function oe(Fe,st){if(v=st.getViewerPose(g||h),Q=st,v!==null){const Et=v.views;E!==null&&(e.setRenderTargetFramebuffer(P,E.framebuffer),e.setRenderTarget(P));let Ke=!1;Et.length!==W.cameras.length&&(W.cameras.length=0,Ke=!0);for(let Ne=0;Ne<Et.length;Ne++){const dt=Et[Ne];let xt=null;if(E!==null)xt=E.getViewport(dt);else{const Ve=I.getViewSubImage(C,dt);xt=Ve.viewport,Ne===0&&(e.setRenderTargetTextures(P,Ve.colorTexture,C.ignoreDepthValues?void 0:Ve.depthStencilTexture),e.setRenderTarget(P))}let ft=H[Ne];ft===void 0&&(ft=new ds,ft.layers.enable(Ne),ft.viewport=new er,H[Ne]=ft),ft.matrix.fromArray(dt.transform.matrix),ft.projectionMatrix.fromArray(dt.projectionMatrix),ft.viewport.set(xt.x,xt.y,xt.width,xt.height),Ne===0&&W.matrix.copy(ft.matrix),Ke===!0&&W.cameras.push(ft)}}for(let Et=0;Et<O.length;Et++){const Ke=F[Et],Ne=O[Et];Ke!==null&&Ne!==void 0&&Ne.update(Ke,st,g||h)}if(ht&&ht(Fe,st),st.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:st.detectedPlanes});let Et=null;for(const Ke of N)st.detectedPlanes.has(Ke)||(Et===null&&(Et=[]),Et.push(Ke));if(Et!==null)for(const Ke of Et)N.delete(Ke),z.delete(Ke),i.dispatchEvent({type:"planeremoved",data:Ke});for(const Ke of st.detectedPlanes)if(!N.has(Ke))N.add(Ke),z.set(Ke,st.lastChangedTime),i.dispatchEvent({type:"planeadded",data:Ke});else{const Ne=z.get(Ke);Ke.lastChangedTime>Ne&&(z.set(Ke,Ke.lastChangedTime),i.dispatchEvent({type:"planechanged",data:Ke}))}}Q=null}const Tt=new xk;Tt.setAnimationLoop(oe),this.setAnimationLoop=function(Fe){ht=Fe},this.dispose=function(){}}}function vq(n,e){function t(M,D){D.color.getRGB(M.fogColor.value,_k(n)),D.isFog?(M.fogNear.value=D.near,M.fogFar.value=D.far):D.isFogExp2&&(M.fogDensity.value=D.density)}function i(M,D,P,O,F){D.isMeshBasicMaterial||D.isMeshLambertMaterial?o(M,D):D.isMeshToonMaterial?(o(M,D),v(M,D)):D.isMeshPhongMaterial?(o(M,D),g(M,D)):D.isMeshStandardMaterial?(o(M,D),I(M,D),D.isMeshPhysicalMaterial&&C(M,D,F)):D.isMeshMatcapMaterial?(o(M,D),E(M,D)):D.isMeshDepthMaterial?o(M,D):D.isMeshDistanceMaterial?(o(M,D),Q(M,D)):D.isMeshNormalMaterial?o(M,D):D.isLineBasicMaterial?(u(M,D),D.isLineDashedMaterial&&h(M,D)):D.isPointsMaterial?r(M,D,P,O):D.isSpriteMaterial?p(M,D):D.isShadowMaterial?(M.color.value.copy(D.color),M.opacity.value=D.opacity):D.isShaderMaterial&&(D.uniformsNeedUpdate=!1)}function o(M,D){M.opacity.value=D.opacity,D.color&&M.diffuse.value.copy(D.color),D.emissive&&M.emissive.value.copy(D.emissive).multiplyScalar(D.emissiveIntensity),D.map&&(M.map.value=D.map),D.alphaMap&&(M.alphaMap.value=D.alphaMap),D.bumpMap&&(M.bumpMap.value=D.bumpMap,M.bumpScale.value=D.bumpScale,D.side===_o&&(M.bumpScale.value*=-1)),D.displacementMap&&(M.displacementMap.value=D.displacementMap,M.displacementScale.value=D.displacementScale,M.displacementBias.value=D.displacementBias),D.emissiveMap&&(M.emissiveMap.value=D.emissiveMap),D.normalMap&&(M.normalMap.value=D.normalMap,M.normalScale.value.copy(D.normalScale),D.side===_o&&M.normalScale.value.negate()),D.specularMap&&(M.specularMap.value=D.specularMap),D.alphaTest>0&&(M.alphaTest.value=D.alphaTest);const P=e.get(D).envMap;if(P&&(M.envMap.value=P,M.flipEnvMap.value=P.isCubeTexture&&P.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=D.reflectivity,M.ior.value=D.ior,M.refractionRatio.value=D.refractionRatio),D.lightMap){M.lightMap.value=D.lightMap;const N=n.physicallyCorrectLights!==!0?Math.PI:1;M.lightMapIntensity.value=D.lightMapIntensity*N}D.aoMap&&(M.aoMap.value=D.aoMap,M.aoMapIntensity.value=D.aoMapIntensity);let O;D.map?O=D.map:D.specularMap?O=D.specularMap:D.displacementMap?O=D.displacementMap:D.normalMap?O=D.normalMap:D.bumpMap?O=D.bumpMap:D.roughnessMap?O=D.roughnessMap:D.metalnessMap?O=D.metalnessMap:D.alphaMap?O=D.alphaMap:D.emissiveMap?O=D.emissiveMap:D.clearcoatMap?O=D.clearcoatMap:D.clearcoatNormalMap?O=D.clearcoatNormalMap:D.clearcoatRoughnessMap?O=D.clearcoatRoughnessMap:D.iridescenceMap?O=D.iridescenceMap:D.iridescenceThicknessMap?O=D.iridescenceThicknessMap:D.specularIntensityMap?O=D.specularIntensityMap:D.specularColorMap?O=D.specularColorMap:D.transmissionMap?O=D.transmissionMap:D.thicknessMap?O=D.thicknessMap:D.sheenColorMap?O=D.sheenColorMap:D.sheenRoughnessMap&&(O=D.sheenRoughnessMap),O!==void 0&&(O.isWebGLRenderTarget&&(O=O.texture),O.matrixAutoUpdate===!0&&O.updateMatrix(),M.uvTransform.value.copy(O.matrix));let F;D.aoMap?F=D.aoMap:D.lightMap&&(F=D.lightMap),F!==void 0&&(F.isWebGLRenderTarget&&(F=F.texture),F.matrixAutoUpdate===!0&&F.updateMatrix(),M.uv2Transform.value.copy(F.matrix))}function u(M,D){M.diffuse.value.copy(D.color),M.opacity.value=D.opacity}function h(M,D){M.dashSize.value=D.dashSize,M.totalSize.value=D.dashSize+D.gapSize,M.scale.value=D.scale}function r(M,D,P,O){M.diffuse.value.copy(D.color),M.opacity.value=D.opacity,M.size.value=D.size*P,M.scale.value=O*.5,D.map&&(M.map.value=D.map),D.alphaMap&&(M.alphaMap.value=D.alphaMap),D.alphaTest>0&&(M.alphaTest.value=D.alphaTest);let F;D.map?F=D.map:D.alphaMap&&(F=D.alphaMap),F!==void 0&&(F.matrixAutoUpdate===!0&&F.updateMatrix(),M.uvTransform.value.copy(F.matrix))}function p(M,D){M.diffuse.value.copy(D.color),M.opacity.value=D.opacity,M.rotation.value=D.rotation,D.map&&(M.map.value=D.map),D.alphaMap&&(M.alphaMap.value=D.alphaMap),D.alphaTest>0&&(M.alphaTest.value=D.alphaTest);let P;D.map?P=D.map:D.alphaMap&&(P=D.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),M.uvTransform.value.copy(P.matrix))}function g(M,D){M.specular.value.copy(D.specular),M.shininess.value=Math.max(D.shininess,1e-4)}function v(M,D){D.gradientMap&&(M.gradientMap.value=D.gradientMap)}function I(M,D){M.roughness.value=D.roughness,M.metalness.value=D.metalness,D.roughnessMap&&(M.roughnessMap.value=D.roughnessMap),D.metalnessMap&&(M.metalnessMap.value=D.metalnessMap),e.get(D).envMap&&(M.envMapIntensity.value=D.envMapIntensity)}function C(M,D,P){M.ior.value=D.ior,D.sheen>0&&(M.sheenColor.value.copy(D.sheenColor).multiplyScalar(D.sheen),M.sheenRoughness.value=D.sheenRoughness,D.sheenColorMap&&(M.sheenColorMap.value=D.sheenColorMap),D.sheenRoughnessMap&&(M.sheenRoughnessMap.value=D.sheenRoughnessMap)),D.clearcoat>0&&(M.clearcoat.value=D.clearcoat,M.clearcoatRoughness.value=D.clearcoatRoughness,D.clearcoatMap&&(M.clearcoatMap.value=D.clearcoatMap),D.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=D.clearcoatRoughnessMap),D.clearcoatNormalMap&&(M.clearcoatNormalScale.value.copy(D.clearcoatNormalScale),M.clearcoatNormalMap.value=D.clearcoatNormalMap,D.side===_o&&M.clearcoatNormalScale.value.negate())),D.iridescence>0&&(M.iridescence.value=D.iridescence,M.iridescenceIOR.value=D.iridescenceIOR,M.iridescenceThicknessMinimum.value=D.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=D.iridescenceThicknessRange[1],D.iridescenceMap&&(M.iridescenceMap.value=D.iridescenceMap),D.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=D.iridescenceThicknessMap)),D.transmission>0&&(M.transmission.value=D.transmission,M.transmissionSamplerMap.value=P.texture,M.transmissionSamplerSize.value.set(P.width,P.height),D.transmissionMap&&(M.transmissionMap.value=D.transmissionMap),M.thickness.value=D.thickness,D.thicknessMap&&(M.thicknessMap.value=D.thicknessMap),M.attenuationDistance.value=D.attenuationDistance,M.attenuationColor.value.copy(D.attenuationColor)),M.specularIntensity.value=D.specularIntensity,M.specularColor.value.copy(D.specularColor),D.specularIntensityMap&&(M.specularIntensityMap.value=D.specularIntensityMap),D.specularColorMap&&(M.specularColorMap.value=D.specularColorMap)}function E(M,D){D.matcap&&(M.matcap.value=D.matcap)}function Q(M,D){M.referencePosition.value.copy(D.referencePosition),M.nearDistance.value=D.nearDistance,M.farDistance.value=D.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function xq(n,e,t,i){let o={},u={},h=[];const r=t.isWebGL2?n.getParameter(35375):0;function p(O,F){const N=F.program;i.uniformBlockBinding(O,N)}function g(O,F){let N=o[O.id];N===void 0&&(Q(O),N=v(O),o[O.id]=N,O.addEventListener("dispose",D));const z=F.program;i.updateUBOMapping(O,z);const X=e.render.frame;u[O.id]!==X&&(C(O),u[O.id]=X)}function v(O){const F=I();O.__bindingPointIndex=F;const N=n.createBuffer(),z=O.__size,X=O.usage;return n.bindBuffer(35345,N),n.bufferData(35345,z,X),n.bindBuffer(35345,null),n.bindBufferBase(35345,F,N),N}function I(){for(let O=0;O<r;O++)if(h.indexOf(O)===-1)return h.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function C(O){const F=o[O.id],N=O.uniforms,z=O.__cache;n.bindBuffer(35345,F);for(let X=0,q=N.length;X<q;X++){const H=N[X];if(E(H,X,z)===!0){const W=H.__offset,se=Array.isArray(H.value)?H.value:[H.value];let de=0;for(let te=0;te<se.length;te++){const ce=se[te],Ee=M(ce);typeof ce=="number"?(H.__data[0]=ce,n.bufferSubData(35345,W+de,H.__data)):ce.isMatrix3?(H.__data[0]=ce.elements[0],H.__data[1]=ce.elements[1],H.__data[2]=ce.elements[2],H.__data[3]=ce.elements[0],H.__data[4]=ce.elements[3],H.__data[5]=ce.elements[4],H.__data[6]=ce.elements[5],H.__data[7]=ce.elements[0],H.__data[8]=ce.elements[6],H.__data[9]=ce.elements[7],H.__data[10]=ce.elements[8],H.__data[11]=ce.elements[0]):(ce.toArray(H.__data,de),de+=Ee.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,W,H.__data)}}n.bindBuffer(35345,null)}function E(O,F,N){const z=O.value;if(N[F]===void 0){if(typeof z=="number")N[F]=z;else{const X=Array.isArray(z)?z:[z],q=[];for(let H=0;H<X.length;H++)q.push(X[H].clone());N[F]=q}return!0}else if(typeof z=="number"){if(N[F]!==z)return N[F]=z,!0}else{const X=Array.isArray(N[F])?N[F]:[N[F]],q=Array.isArray(z)?z:[z];for(let H=0;H<X.length;H++){const W=X[H];if(W.equals(q[H])===!1)return W.copy(q[H]),!0}}return!1}function Q(O){const F=O.uniforms;let N=0;const z=16;let X=0;for(let q=0,H=F.length;q<H;q++){const W=F[q],se={boundary:0,storage:0},de=Array.isArray(W.value)?W.value:[W.value];for(let te=0,ce=de.length;te<ce;te++){const Ee=de[te],Be=M(Ee);se.boundary+=Be.boundary,se.storage+=Be.storage}if(W.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=N,q>0){X=N%z;const te=z-X;X!==0&&te-se.boundary<0&&(N+=z-X,W.__offset=N)}N+=se.storage}return X=N%z,X>0&&(N+=z-X),O.__size=N,O.__cache={},this}function M(O){const F={boundary:0,storage:0};return typeof O=="number"?(F.boundary=4,F.storage=4):O.isVector2?(F.boundary=8,F.storage=8):O.isVector3||O.isColor?(F.boundary=16,F.storage=12):O.isVector4?(F.boundary=16,F.storage=16):O.isMatrix3?(F.boundary=48,F.storage=48):O.isMatrix4?(F.boundary=64,F.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),F}function D(O){const F=O.target;F.removeEventListener("dispose",D);const N=h.indexOf(F.__bindingPointIndex);h.splice(N,1),n.deleteBuffer(o[F.id]),delete o[F.id],delete u[F.id]}function P(){for(const O in o)n.deleteBuffer(o[O]);h=[],o={},u={}}return{bind:p,update:g,dispose:P}}function Iq(){const n=s0("canvas");return n.style.display="block",n}function y0(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:Iq(),t=n.context!==void 0?n.context:null,i=n.depth!==void 0?n.depth:!0,o=n.stencil!==void 0?n.stencil:!0,u=n.antialias!==void 0?n.antialias:!1,h=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,r=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,p=n.powerPreference!==void 0?n.powerPreference:"default",g=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let v;t!==null?v=t.getContextAttributes().alpha:v=n.alpha!==void 0?n.alpha:!1;let I=null,C=null;const E=[],Q=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=uh,this.physicallyCorrectLights=!1,this.toneMapping=Sc,this.toneMappingExposure=1;const M=this;let D=!1,P=0,O=0,F=null,N=-1,z=null;const X=new er,q=new er;let H=null,W=e.width,se=e.height,de=1,te=null,ce=null;const Ee=new er(0,0,W,se),Be=new er(0,0,W,se);let De=!1;const Re=new EB;let ye=!1,ht=!1,oe=null;const Tt=new sn,Fe=new Yi,st=new rt,Et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ke(){return F===null?de:1}let Ne=t;function dt(pe,je){for(let pt=0;pt<pe.length;pt++){const it=pe[pt],Ct=e.getContext(it,je);if(Ct!==null)return Ct}return null}try{const pe={alpha:!0,depth:i,stencil:o,antialias:u,premultipliedAlpha:h,preserveDrawingBuffer:r,powerPreference:p,failIfMajorPerformanceCaveat:g};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${_B}`),e.addEventListener("webglcontextlost",_i,!1),e.addEventListener("webglcontextrestored",si,!1),e.addEventListener("webglcontextcreationerror",wt,!1),Ne===null){const je=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&je.shift(),Ne=dt(je,pe),Ne===null)throw dt(je)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ne.getShaderPrecisionFormat===void 0&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}let xt,ft,Ve,Ye,ae,_e,Ze,nt,ut,ze,Qt,mt,Ut,Dt,Ie,ue,at,St,yt,Pt,Ot,Ue,ot,ni;function fi(){xt=new RY(Ne),ft=new BY(Ne,xt,n),xt.init(ft),Ue=new Aq(Ne,xt,ft),Ve=new fq(Ne,xt,ft),Ye=new kY,ae=new $j,_e=new pq(Ne,xt,Ve,ae,ft,Ue,Ye),Ze=new MY(M),nt=new QY(M),ut=new W9(Ne,ft),ot=new wY(Ne,xt,ut,ft),ze=new LY(Ne,ut,Ye,ot),Qt=new UY(Ne,ze,ut,Ye),yt=new zY(Ne,ft,_e),ue=new SY(ae),mt=new Zj(M,Ze,nt,xt,ft,ot,ue),Ut=new vq(M,ae),Dt=new tq,Ie=new aq(xt,ft),St=new EY(M,Ze,nt,Ve,Qt,v,h),at=new dq(M,Qt,ft),ni=new xq(Ne,Ye,ft,Ve),Pt=new bY(Ne,xt,Ye,ft),Ot=new PY(Ne,xt,Ye,ft),Ye.programs=mt.programs,M.capabilities=ft,M.extensions=xt,M.properties=ae,M.renderLists=Dt,M.shadowMap=at,M.state=Ve,M.info=Ye}fi();const Xt=new yq(M,Ne);this.xr=Xt,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){const pe=xt.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){const pe=xt.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return de},this.setPixelRatio=function(pe){pe!==void 0&&(de=pe,this.setSize(W,se,!1))},this.getSize=function(pe){return pe.set(W,se)},this.setSize=function(pe,je,pt){if(Xt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=pe,se=je,e.width=Math.floor(pe*de),e.height=Math.floor(je*de),pt!==!1&&(e.style.width=pe+"px",e.style.height=je+"px"),this.setViewport(0,0,pe,je)},this.getDrawingBufferSize=function(pe){return pe.set(W*de,se*de).floor()},this.setDrawingBufferSize=function(pe,je,pt){W=pe,se=je,de=pt,e.width=Math.floor(pe*pt),e.height=Math.floor(je*pt),this.setViewport(0,0,pe,je)},this.getCurrentViewport=function(pe){return pe.copy(X)},this.getViewport=function(pe){return pe.copy(Ee)},this.setViewport=function(pe,je,pt,it){pe.isVector4?Ee.set(pe.x,pe.y,pe.z,pe.w):Ee.set(pe,je,pt,it),Ve.viewport(X.copy(Ee).multiplyScalar(de).floor())},this.getScissor=function(pe){return pe.copy(Be)},this.setScissor=function(pe,je,pt,it){pe.isVector4?Be.set(pe.x,pe.y,pe.z,pe.w):Be.set(pe,je,pt,it),Ve.scissor(q.copy(Be).multiplyScalar(de).floor())},this.getScissorTest=function(){return De},this.setScissorTest=function(pe){Ve.setScissorTest(De=pe)},this.setOpaqueSort=function(pe){te=pe},this.setTransparentSort=function(pe){ce=pe},this.getClearColor=function(pe){return pe.copy(St.getClearColor())},this.setClearColor=function(){St.setClearColor.apply(St,arguments)},this.getClearAlpha=function(){return St.getClearAlpha()},this.setClearAlpha=function(){St.setClearAlpha.apply(St,arguments)},this.clear=function(pe=!0,je=!0,pt=!0){let it=0;pe&&(it|=16384),je&&(it|=256),pt&&(it|=1024),Ne.clear(it)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",_i,!1),e.removeEventListener("webglcontextrestored",si,!1),e.removeEventListener("webglcontextcreationerror",wt,!1),Dt.dispose(),Ie.dispose(),ae.dispose(),Ze.dispose(),nt.dispose(),Qt.dispose(),ot.dispose(),ni.dispose(),mt.dispose(),Xt.dispose(),Xt.removeEventListener("sessionstart",Ae),Xt.removeEventListener("sessionend",Ce),oe&&(oe.dispose(),oe=null),Le.stop()};function _i(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function si(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const pe=Ye.autoReset,je=at.enabled,pt=at.autoUpdate,it=at.needsUpdate,Ct=at.type;fi(),Ye.autoReset=pe,at.enabled=je,at.autoUpdate=pt,at.needsUpdate=it,at.type=Ct}function wt(pe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",pe.statusMessage)}function kt(pe){const je=pe.target;je.removeEventListener("dispose",kt),yi(je)}function yi(pe){ee(pe),ae.remove(pe)}function ee(pe){const je=ae.get(pe).programs;je!==void 0&&(je.forEach(function(pt){mt.releaseProgram(pt)}),pe.isShaderMaterial&&mt.releaseShaderCache(pe))}this.renderBufferDirect=function(pe,je,pt,it,Ct,li){je===null&&(je=Et);const Ai=Ct.isMesh&&Ct.matrixWorld.determinant()<0,oi=Ft(pe,je,pt,it,Ct);Ve.setMaterial(it,Ai);let ci=pt.index,zi=1;it.wireframe===!0&&(ci=ze.getWireframeAttribute(pt),zi=2);const Pi=pt.drawRange,Li=pt.attributes.position;let xi=Pi.start*zi,Gn=(Pi.start+Pi.count)*zi;li!==null&&(xi=Math.max(xi,li.start*zi),Gn=Math.min(Gn,(li.start+li.count)*zi)),ci!==null?(xi=Math.max(xi,0),Gn=Math.min(Gn,ci.count)):Li!=null&&(xi=Math.max(xi,0),Gn=Math.min(Gn,Li.count));const Sr=Gn-xi;if(Sr<0||Sr===1/0)return;ot.setup(Ct,it,oi,pt,ci);let Es,wn=Pt;if(ci!==null&&(Es=ut.get(ci),wn=Ot,wn.setIndex(Es)),Ct.isMesh)it.wireframe===!0?(Ve.setLineWidth(it.wireframeLinewidth*Ke()),wn.setMode(1)):wn.setMode(4);else if(Ct.isLine){let ki=it.linewidth;ki===void 0&&(ki=1),Ve.setLineWidth(ki*Ke()),Ct.isLineSegments?wn.setMode(1):Ct.isLineLoop?wn.setMode(2):wn.setMode(3)}else Ct.isPoints?wn.setMode(0):Ct.isSprite&&wn.setMode(4);if(Ct.isInstancedMesh)wn.renderInstances(xi,Sr,Ct.count);else if(pt.isInstancedBufferGeometry){const ki=pt._maxInstanceCount!==void 0?pt._maxInstanceCount:1/0,Mr=Math.min(pt.instanceCount,ki);wn.renderInstances(xi,Sr,Mr)}else wn.render(xi,Sr)},this.compile=function(pe,je){function pt(it,Ct,li){it.transparent===!0&&it.side===fa&&it.forceSinglePass===!1?(it.side=_o,it.needsUpdate=!0,Je(it,Ct,li),it.side=rl,it.needsUpdate=!0,Je(it,Ct,li),it.side=fa):Je(it,Ct,li)}C=Ie.get(pe),C.init(),Q.push(C),pe.traverseVisible(function(it){it.isLight&&it.layers.test(je.layers)&&(C.pushLight(it),it.castShadow&&C.pushShadow(it))}),C.setupLights(M.physicallyCorrectLights),pe.traverse(function(it){const Ct=it.material;if(Ct)if(Array.isArray(Ct))for(let li=0;li<Ct.length;li++){const Ai=Ct[li];pt(Ai,pe,it)}else pt(Ct,pe,it)}),Q.pop(),C=null};let J=null;function Z(pe){J&&J(pe)}function Ae(){Le.stop()}function Ce(){Le.start()}const Le=new xk;Le.setAnimationLoop(Z),typeof self<"u"&&Le.setContext(self),this.setAnimationLoop=function(pe){J=pe,Xt.setAnimationLoop(pe),pe===null?Le.stop():Le.start()},Xt.addEventListener("sessionstart",Ae),Xt.addEventListener("sessionend",Ce),this.render=function(pe,je){if(je!==void 0&&je.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),je.parent===null&&je.matrixWorldAutoUpdate===!0&&je.updateMatrixWorld(),Xt.enabled===!0&&Xt.isPresenting===!0&&(Xt.cameraAutoUpdate===!0&&Xt.updateCamera(je),je=Xt.getCamera()),pe.isScene===!0&&pe.onBeforeRender(M,pe,je,F),C=Ie.get(pe,Q.length),C.init(),Q.push(C),Tt.multiplyMatrices(je.projectionMatrix,je.matrixWorldInverse),Re.setFromProjectionMatrix(Tt),ht=this.localClippingEnabled,ye=ue.init(this.clippingPlanes,ht),I=Dt.get(pe,E.length),I.init(),E.push(I),Oe(pe,je,0,M.sortObjects),I.finish(),M.sortObjects===!0&&I.sort(te,ce),ye===!0&&ue.beginShadows();const pt=C.state.shadowsArray;if(at.render(pt,pe,je),ye===!0&&ue.endShadows(),this.info.autoReset===!0&&this.info.reset(),St.render(I,pe),C.setupLights(M.physicallyCorrectLights),je.isArrayCamera){const it=je.cameras;for(let Ct=0,li=it.length;Ct<li;Ct++){const Ai=it[Ct];le(I,pe,Ai,Ai.viewport)}}else le(I,pe,je);F!==null&&(_e.updateMultisampleRenderTarget(F),_e.updateRenderTargetMipmap(F)),pe.isScene===!0&&pe.onAfterRender(M,pe,je),ot.resetDefaultState(),N=-1,z=null,Q.pop(),Q.length>0?C=Q[Q.length-1]:C=null,E.pop(),E.length>0?I=E[E.length-1]:I=null};function Oe(pe,je,pt,it){if(pe.visible===!1)return;if(pe.layers.test(je.layers)){if(pe.isGroup)pt=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(je);else if(pe.isLight)C.pushLight(pe),pe.castShadow&&C.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||Re.intersectsSprite(pe)){it&&st.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(Tt);const Ai=Qt.update(pe),oi=pe.material;oi.visible&&I.push(pe,Ai,oi,pt,st.z,null)}}else if((pe.isMesh||pe.isLine||pe.isPoints)&&(pe.isSkinnedMesh&&pe.skeleton.frame!==Ye.render.frame&&(pe.skeleton.update(),pe.skeleton.frame=Ye.render.frame),!pe.frustumCulled||Re.intersectsObject(pe))){it&&st.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(Tt);const Ai=Qt.update(pe),oi=pe.material;if(Array.isArray(oi)){const ci=Ai.groups;for(let zi=0,Pi=ci.length;zi<Pi;zi++){const Li=ci[zi],xi=oi[Li.materialIndex];xi&&xi.visible&&I.push(pe,Ai,xi,pt,st.z,Li)}}else oi.visible&&I.push(pe,Ai,oi,pt,st.z,null)}}const li=pe.children;for(let Ai=0,oi=li.length;Ai<oi;Ai++)Oe(li[Ai],je,pt,it)}function le(pe,je,pt,it){const Ct=pe.opaque,li=pe.transmissive,Ai=pe.transparent;C.setupLightsView(pt),ye===!0&&ue.setGlobalState(M.clippingPlanes,pt),li.length>0&&me(Ct,je,pt),it&&Ve.viewport(X.copy(it)),Ct.length>0&&he(Ct,je,pt),li.length>0&&he(li,je,pt),Ai.length>0&&he(Ai,je,pt),Ve.buffers.depth.setTest(!0),Ve.buffers.depth.setMask(!0),Ve.buffers.color.setMask(!0),Ve.setPolygonOffset(!1)}function me(pe,je,pt){const it=ft.isWebGL2;oe===null&&(oe=new Zd(1,1,{generateMipmaps:!0,type:xt.has("EXT_color_buffer_half_float")?Ec:Xd,minFilter:ch,samples:it&&u===!0?4:0})),M.getDrawingBufferSize(Fe),it?oe.setSize(Fe.x,Fe.y):oe.setSize(Ux(Fe.x),Ux(Fe.y));const Ct=M.getRenderTarget();M.setRenderTarget(oe),M.clear();const li=M.toneMapping;M.toneMapping=Sc,he(pe,je,pt),M.toneMapping=li,_e.updateMultisampleRenderTarget(oe),_e.updateRenderTargetMipmap(oe),M.setRenderTarget(Ct)}function he(pe,je,pt){const it=je.isScene===!0?je.overrideMaterial:null;for(let Ct=0,li=pe.length;Ct<li;Ct++){const Ai=pe[Ct],oi=Ai.object,ci=Ai.geometry,zi=it===null?Ai.material:it,Pi=Ai.group;oi.layers.test(pt.layers)&&Qe(oi,je,pt,ci,zi,Pi)}}function Qe(pe,je,pt,it,Ct,li){pe.onBeforeRender(M,je,pt,it,Ct,li),pe.modelViewMatrix.multiplyMatrices(pt.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),Ct.onBeforeRender(M,je,pt,it,pe,li),Ct.transparent===!0&&Ct.side===fa&&Ct.forceSinglePass===!1?(Ct.side=_o,Ct.needsUpdate=!0,M.renderBufferDirect(pt,je,it,Ct,pe,li),Ct.side=rl,Ct.needsUpdate=!0,M.renderBufferDirect(pt,je,it,Ct,pe,li),Ct.side=fa):M.renderBufferDirect(pt,je,it,Ct,pe,li),pe.onAfterRender(M,je,pt,it,Ct,li)}function Je(pe,je,pt){je.isScene!==!0&&(je=Et);const it=ae.get(pe),Ct=C.state.lights,li=C.state.shadowsArray,Ai=Ct.state.version,oi=mt.getParameters(pe,Ct.state,li,je,pt),ci=mt.getProgramCacheKey(oi);let zi=it.programs;it.environment=pe.isMeshStandardMaterial?je.environment:null,it.fog=je.fog,it.envMap=(pe.isMeshStandardMaterial?nt:Ze).get(pe.envMap||it.environment),zi===void 0&&(pe.addEventListener("dispose",kt),zi=new Map,it.programs=zi);let Pi=zi.get(ci);if(Pi!==void 0){if(it.currentProgram===Pi&&it.lightsStateVersion===Ai)return Xe(pe,oi),Pi}else oi.uniforms=mt.getUniforms(pe),pe.onBuild(pt,oi,M),pe.onBeforeCompile(oi,M),Pi=mt.acquireProgram(oi,ci),zi.set(ci,Pi),it.uniforms=oi.uniforms;const Li=it.uniforms;(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(Li.clippingPlanes=ue.uniform),Xe(pe,oi),it.needsLights=qt(pe),it.lightsStateVersion=Ai,it.needsLights&&(Li.ambientLightColor.value=Ct.state.ambient,Li.lightProbe.value=Ct.state.probe,Li.directionalLights.value=Ct.state.directional,Li.directionalLightShadows.value=Ct.state.directionalShadow,Li.spotLights.value=Ct.state.spot,Li.spotLightShadows.value=Ct.state.spotShadow,Li.rectAreaLights.value=Ct.state.rectArea,Li.ltc_1.value=Ct.state.rectAreaLTC1,Li.ltc_2.value=Ct.state.rectAreaLTC2,Li.pointLights.value=Ct.state.point,Li.pointLightShadows.value=Ct.state.pointShadow,Li.hemisphereLights.value=Ct.state.hemi,Li.directionalShadowMap.value=Ct.state.directionalShadowMap,Li.directionalShadowMatrix.value=Ct.state.directionalShadowMatrix,Li.spotShadowMap.value=Ct.state.spotShadowMap,Li.spotLightMatrix.value=Ct.state.spotLightMatrix,Li.spotLightMap.value=Ct.state.spotLightMap,Li.pointShadowMap.value=Ct.state.pointShadowMap,Li.pointShadowMatrix.value=Ct.state.pointShadowMatrix);const xi=Pi.getUniforms(),Gn=fx.seqWithValue(xi.seq,Li);return it.currentProgram=Pi,it.uniformsList=Gn,Pi}function Xe(pe,je){const pt=ae.get(pe);pt.outputEncoding=je.outputEncoding,pt.instancing=je.instancing,pt.skinning=je.skinning,pt.morphTargets=je.morphTargets,pt.morphNormals=je.morphNormals,pt.morphColors=je.morphColors,pt.morphTargetsCount=je.morphTargetsCount,pt.numClippingPlanes=je.numClippingPlanes,pt.numIntersection=je.numClipIntersection,pt.vertexAlphas=je.vertexAlphas,pt.vertexTangents=je.vertexTangents,pt.toneMapping=je.toneMapping}function Ft(pe,je,pt,it,Ct){je.isScene!==!0&&(je=Et),_e.resetTextureUnits();const li=je.fog,Ai=it.isMeshStandardMaterial?je.environment:null,oi=F===null?M.outputEncoding:F.isXRRenderTarget===!0?F.texture.encoding:uh,ci=(it.isMeshStandardMaterial?nt:Ze).get(it.envMap||Ai),zi=it.vertexColors===!0&&!!pt.attributes.color&&pt.attributes.color.itemSize===4,Pi=!!it.normalMap&&!!pt.attributes.tangent,Li=!!pt.morphAttributes.position,xi=!!pt.morphAttributes.normal,Gn=!!pt.morphAttributes.color,Sr=it.toneMapped?M.toneMapping:Sc,Es=pt.morphAttributes.position||pt.morphAttributes.normal||pt.morphAttributes.color,wn=Es!==void 0?Es.length:0,ki=ae.get(it),Mr=C.state.lights;if(ye===!0&&(ht===!0||pe!==z)){const In=pe===z&&it.id===N;ue.setState(it,pe,In)}let ur=!1;it.version===ki.__version?(ki.needsLights&&ki.lightsStateVersion!==Mr.state.version||ki.outputEncoding!==oi||Ct.isInstancedMesh&&ki.instancing===!1||!Ct.isInstancedMesh&&ki.instancing===!0||Ct.isSkinnedMesh&&ki.skinning===!1||!Ct.isSkinnedMesh&&ki.skinning===!0||ki.envMap!==ci||it.fog===!0&&ki.fog!==li||ki.numClippingPlanes!==void 0&&(ki.numClippingPlanes!==ue.numPlanes||ki.numIntersection!==ue.numIntersection)||ki.vertexAlphas!==zi||ki.vertexTangents!==Pi||ki.morphTargets!==Li||ki.morphNormals!==xi||ki.morphColors!==Gn||ki.toneMapping!==Sr||ft.isWebGL2===!0&&ki.morphTargetsCount!==wn)&&(ur=!0):(ur=!0,ki.__version=it.version);let vo=ki.currentProgram;ur===!0&&(vo=Je(it,je,Ct));let Go=!1,As=!1,Ia=!1;const Mt=vo.getUniforms(),Wr=ki.uniforms;if(Ve.useProgram(vo.program)&&(Go=!0,As=!0,Ia=!0),it.id!==N&&(N=it.id,As=!0),Go||z!==pe){if(Mt.setValue(Ne,"projectionMatrix",pe.projectionMatrix),ft.logarithmicDepthBuffer&&Mt.setValue(Ne,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),z!==pe&&(z=pe,As=!0,Ia=!0),it.isShaderMaterial||it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshStandardMaterial||it.envMap){const In=Mt.map.cameraPosition;In!==void 0&&In.setValue(Ne,st.setFromMatrixPosition(pe.matrixWorld))}(it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshLambertMaterial||it.isMeshBasicMaterial||it.isMeshStandardMaterial||it.isShaderMaterial)&&Mt.setValue(Ne,"isOrthographic",pe.isOrthographicCamera===!0),(it.isMeshPhongMaterial||it.isMeshToonMaterial||it.isMeshLambertMaterial||it.isMeshBasicMaterial||it.isMeshStandardMaterial||it.isShaderMaterial||it.isShadowMaterial||Ct.isSkinnedMesh)&&Mt.setValue(Ne,"viewMatrix",pe.matrixWorldInverse)}if(Ct.isSkinnedMesh){Mt.setOptional(Ne,Ct,"bindMatrix"),Mt.setOptional(Ne,Ct,"bindMatrixInverse");const In=Ct.skeleton;In&&(ft.floatVertexTextures?(In.boneTexture===null&&In.computeBoneTexture(),Mt.setValue(Ne,"boneTexture",In.boneTexture,_e),Mt.setValue(Ne,"boneTextureSize",In.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const qn=pt.morphAttributes;if((qn.position!==void 0||qn.normal!==void 0||qn.color!==void 0&&ft.isWebGL2===!0)&&yt.update(Ct,pt,it,vo),(As||ki.receiveShadow!==Ct.receiveShadow)&&(ki.receiveShadow=Ct.receiveShadow,Mt.setValue(Ne,"receiveShadow",Ct.receiveShadow)),it.isMeshGouraudMaterial&&it.envMap!==null&&(Wr.envMap.value=ci,Wr.flipEnvMap.value=ci.isCubeTexture&&ci.isRenderTargetTexture===!1?-1:1),As&&(Mt.setValue(Ne,"toneMappingExposure",M.toneMappingExposure),ki.needsLights&&Wt(Wr,Ia),li&&it.fog===!0&&Ut.refreshFogUniforms(Wr,li),Ut.refreshMaterialUniforms(Wr,it,de,se,oe),fx.upload(Ne,ki.uniformsList,Wr,_e)),it.isShaderMaterial&&it.uniformsNeedUpdate===!0&&(fx.upload(Ne,ki.uniformsList,Wr,_e),it.uniformsNeedUpdate=!1),it.isSpriteMaterial&&Mt.setValue(Ne,"center",Ct.center),Mt.setValue(Ne,"modelViewMatrix",Ct.modelViewMatrix),Mt.setValue(Ne,"normalMatrix",Ct.normalMatrix),Mt.setValue(Ne,"modelMatrix",Ct.matrixWorld),it.isShaderMaterial||it.isRawShaderMaterial){const In=it.uniformsGroups;for(let Uc=0,Zs=In.length;Uc<Zs;Uc++)if(ft.isWebGL2){const Oc=In[Uc];ni.update(Oc,vo),ni.bind(Oc,vo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return vo}function Wt(pe,je){pe.ambientLightColor.needsUpdate=je,pe.lightProbe.needsUpdate=je,pe.directionalLights.needsUpdate=je,pe.directionalLightShadows.needsUpdate=je,pe.pointLights.needsUpdate=je,pe.pointLightShadows.needsUpdate=je,pe.spotLights.needsUpdate=je,pe.spotLightShadows.needsUpdate=je,pe.rectAreaLights.needsUpdate=je,pe.hemisphereLights.needsUpdate=je}function qt(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(pe,je,pt){ae.get(pe.texture).__webglTexture=je,ae.get(pe.depthTexture).__webglTexture=pt;const it=ae.get(pe);it.__hasExternalTextures=!0,it.__hasExternalTextures&&(it.__autoAllocateDepthBuffer=pt===void 0,it.__autoAllocateDepthBuffer||xt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),it.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(pe,je){const pt=ae.get(pe);pt.__webglFramebuffer=je,pt.__useDefaultFramebuffer=je===void 0},this.setRenderTarget=function(pe,je=0,pt=0){F=pe,P=je,O=pt;let it=!0,Ct=null,li=!1,Ai=!1;if(pe){const ci=ae.get(pe);ci.__useDefaultFramebuffer!==void 0?(Ve.bindFramebuffer(36160,null),it=!1):ci.__webglFramebuffer===void 0?_e.setupRenderTarget(pe):ci.__hasExternalTextures&&_e.rebindTextures(pe,ae.get(pe.texture).__webglTexture,ae.get(pe.depthTexture).__webglTexture);const zi=pe.texture;(zi.isData3DTexture||zi.isDataArrayTexture||zi.isCompressedArrayTexture)&&(Ai=!0);const Pi=ae.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(Ct=Pi[je],li=!0):ft.isWebGL2&&pe.samples>0&&_e.useMultisampledRTT(pe)===!1?Ct=ae.get(pe).__webglMultisampledFramebuffer:Ct=Pi,X.copy(pe.viewport),q.copy(pe.scissor),H=pe.scissorTest}else X.copy(Ee).multiplyScalar(de).floor(),q.copy(Be).multiplyScalar(de).floor(),H=De;if(Ve.bindFramebuffer(36160,Ct)&&ft.drawBuffers&&it&&Ve.drawBuffers(pe,Ct),Ve.viewport(X),Ve.scissor(q),Ve.setScissorTest(H),li){const ci=ae.get(pe.texture);Ne.framebufferTexture2D(36160,36064,34069+je,ci.__webglTexture,pt)}else if(Ai){const ci=ae.get(pe.texture),zi=je||0;Ne.framebufferTextureLayer(36160,36064,ci.__webglTexture,pt||0,zi)}N=-1},this.readRenderTargetPixels=function(pe,je,pt,it,Ct,li,Ai){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let oi=ae.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&Ai!==void 0&&(oi=oi[Ai]),oi){Ve.bindFramebuffer(36160,oi);try{const ci=pe.texture,zi=ci.format,Pi=ci.type;if(zi!==aa&&Ue.convert(zi)!==Ne.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Li=Pi===Ec&&(xt.has("EXT_color_buffer_half_float")||ft.isWebGL2&&xt.has("EXT_color_buffer_float"));if(Pi!==Xd&&Ue.convert(Pi)!==Ne.getParameter(35738)&&!(Pi===Za&&(ft.isWebGL2||xt.has("OES_texture_float")||xt.has("WEBGL_color_buffer_float")))&&!Li){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}je>=0&&je<=pe.width-it&&pt>=0&&pt<=pe.height-Ct&&Ne.readPixels(je,pt,it,Ct,Ue.convert(zi),Ue.convert(Pi),li)}finally{const ci=F!==null?ae.get(F).__webglFramebuffer:null;Ve.bindFramebuffer(36160,ci)}}},this.copyFramebufferToTexture=function(pe,je,pt=0){const it=Math.pow(2,-pt),Ct=Math.floor(je.image.width*it),li=Math.floor(je.image.height*it);_e.setTexture2D(je,0),Ne.copyTexSubImage2D(3553,pt,0,0,pe.x,pe.y,Ct,li),Ve.unbindTexture()},this.copyTextureToTexture=function(pe,je,pt,it=0){const Ct=je.image.width,li=je.image.height,Ai=Ue.convert(pt.format),oi=Ue.convert(pt.type);_e.setTexture2D(pt,0),Ne.pixelStorei(37440,pt.flipY),Ne.pixelStorei(37441,pt.premultiplyAlpha),Ne.pixelStorei(3317,pt.unpackAlignment),je.isDataTexture?Ne.texSubImage2D(3553,it,pe.x,pe.y,Ct,li,Ai,oi,je.image.data):je.isCompressedTexture?Ne.compressedTexSubImage2D(3553,it,pe.x,pe.y,je.mipmaps[0].width,je.mipmaps[0].height,Ai,je.mipmaps[0].data):Ne.texSubImage2D(3553,it,pe.x,pe.y,Ai,oi,je.image),it===0&&pt.generateMipmaps&&Ne.generateMipmap(3553),Ve.unbindTexture()},this.copyTextureToTexture3D=function(pe,je,pt,it,Ct=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const li=pe.max.x-pe.min.x+1,Ai=pe.max.y-pe.min.y+1,oi=pe.max.z-pe.min.z+1,ci=Ue.convert(it.format),zi=Ue.convert(it.type);let Pi;if(it.isData3DTexture)_e.setTexture3D(it,0),Pi=32879;else if(it.isDataArrayTexture)_e.setTexture2DArray(it,0),Pi=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ne.pixelStorei(37440,it.flipY),Ne.pixelStorei(37441,it.premultiplyAlpha),Ne.pixelStorei(3317,it.unpackAlignment);const Li=Ne.getParameter(3314),xi=Ne.getParameter(32878),Gn=Ne.getParameter(3316),Sr=Ne.getParameter(3315),Es=Ne.getParameter(32877),wn=pt.isCompressedTexture?pt.mipmaps[0]:pt.image;Ne.pixelStorei(3314,wn.width),Ne.pixelStorei(32878,wn.height),Ne.pixelStorei(3316,pe.min.x),Ne.pixelStorei(3315,pe.min.y),Ne.pixelStorei(32877,pe.min.z),pt.isDataTexture||pt.isData3DTexture?Ne.texSubImage3D(Pi,Ct,je.x,je.y,je.z,li,Ai,oi,ci,zi,wn.data):pt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ne.compressedTexSubImage3D(Pi,Ct,je.x,je.y,je.z,li,Ai,oi,ci,wn.data)):Ne.texSubImage3D(Pi,Ct,je.x,je.y,je.z,li,Ai,oi,ci,zi,wn),Ne.pixelStorei(3314,Li),Ne.pixelStorei(32878,xi),Ne.pixelStorei(3316,Gn),Ne.pixelStorei(3315,Sr),Ne.pixelStorei(32877,Es),Ct===0&&it.generateMipmaps&&Ne.generateMipmap(Pi),Ve.unbindTexture()},this.initTexture=function(pe){pe.isCubeTexture?_e.setTextureCube(pe,0):pe.isData3DTexture?_e.setTexture3D(pe,0):pe.isDataArrayTexture||pe.isCompressedArrayTexture?_e.setTexture2DArray(pe,0):_e.setTexture2D(pe,0),Ve.unbindTexture()},this.resetState=function(){P=0,O=0,F=null,Ve.reset(),ot.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class Cq extends y0{}Cq.prototype.isWebGL1Renderer=!0;class I1{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Xi(e),this.near=t,this.far=i}clone(){return new I1(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class C1 extends rr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class Eq{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Gw,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=il()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let o=0,u=this.stride;o<u;o++)this.array[e+o]=t.array[i+o];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=il()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=il()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ws=new rt;class BB{constructor(e,t,i,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.applyMatrix4(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.applyNormalMatrix(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.transformDirection(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}setX(e,t){return this.normalized&&(t=Zn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Zn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=wc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=wc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=wc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=wc(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array),o=Zn(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=o,this}setXYZW(e,t,i,o,u){return e=e*this.data.stride+this.offset,this.normalized&&(t=Zn(t,this.array),i=Zn(i,this.array),o=Zn(o,this.array),u=Zn(u,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=o,this.data.array[e+3]=u,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)t.push(this.data.array[o+u])}return new es(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new BB(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)t.push(this.data.array[o+u])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const TQ=new rt,DQ=new er,QQ=new er,wq=new rt,RQ=new sn;class bq extends nr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new sn,this.bindMatrixInverse=new sn}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new er,t=this.geometry.attributes.skinWeight;for(let i=0,o=t.count;i<o;i++){e.fromBufferAttribute(t,i);const u=1/e.manhattanLength();u!==1/0?e.multiplyScalar(u):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,o=this.geometry;DQ.fromBufferAttribute(o.attributes.skinIndex,e),QQ.fromBufferAttribute(o.attributes.skinWeight,e),TQ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let u=0;u<4;u++){const h=QQ.getComponent(u);if(h!==0){const r=DQ.getComponent(u);RQ.multiplyMatrices(i.bones[r].matrixWorld,i.boneInverses[r]),t.addScaledVector(wq.copy(TQ).applyMatrix4(RQ),h)}}return t.applyMatrix4(this.bindMatrixInverse)}}class bk extends rr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Bk extends Cs{constructor(e=null,t=1,i=1,o,u,h,r,p,g=us,v=us,I,C){super(null,h,r,p,g,v,o,u,I,C),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const LQ=new sn,Bq=new sn;class SB{constructor(e=[],t=[]){this.uuid=il(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,o=this.bones.length;i<o;i++)this.boneInverses.push(new sn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new sn;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,o=this.boneTexture;for(let u=0,h=e.length;u<h;u++){const r=e[u]?e[u].matrixWorld:Bq;LQ.multiplyMatrices(r,t[u]),LQ.toArray(i,u*16)}o!==null&&(o.needsUpdate=!0)}clone(){return new SB(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=uk(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Bk(t,e,e,aa,Za);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const o=this.bones[t];if(o.name===e)return o}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,o=e.bones.length;i<o;i++){const u=e.bones[i];let h=t[u];h===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",u),h=new bk),this.bones.push(h),this.boneInverses.push(new sn().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let o=0,u=t.length;o<u;o++){const h=t[o];e.bones.push(h.uuid);const r=i[o];e.boneInverses.push(r.toArray())}return e}}class PQ extends es{constructor(e,t,i,o=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kQ=new sn,FQ=new sn,Qv=[],Sq=new sn,km=new nr;class Mq extends nr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new PQ(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let o=0;o<i;o++)this.setMatrixAt(o,Sq)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,o=this.count;if(km.geometry=this.geometry,km.material=this.material,km.material!==void 0)for(let u=0;u<o;u++){this.getMatrixAt(u,kQ),FQ.multiplyMatrices(i,kQ),km.matrixWorld=FQ,km.raycast(e,Qv);for(let h=0,r=Qv.length;h<r;h++){const p=Qv[h];p.instanceId=u,p.object=this,t.push(p)}Qv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new PQ(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Sk extends _a{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Xi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const NQ=new rt,zQ=new rt,UQ=new sn,wE=new m0,Rv=new cf;class MB extends rr{constructor(e=new Oo,t=new Sk){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let o=1,u=t.count;o<u;o++)NQ.fromBufferAttribute(t,o-1),zQ.fromBufferAttribute(t,o),i[o]=i[o-1],i[o]+=NQ.distanceTo(zQ);e.setAttribute("lineDistance",new Mc(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,o=this.matrixWorld,u=e.params.Line.threshold,h=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Rv.copy(i.boundingSphere),Rv.applyMatrix4(o),Rv.radius+=u,e.ray.intersectsSphere(Rv)===!1)return;UQ.copy(o).invert(),wE.copy(e.ray).applyMatrix4(UQ);const r=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=r*r,g=new rt,v=new rt,I=new rt,C=new rt,E=this.isLineSegments?2:1,Q=i.index,D=i.attributes.position;if(Q!==null){const P=Math.max(0,h.start),O=Math.min(Q.count,h.start+h.count);for(let F=P,N=O-1;F<N;F+=E){const z=Q.getX(F),X=Q.getX(F+1);if(g.fromBufferAttribute(D,z),v.fromBufferAttribute(D,X),wE.distanceSqToSegment(g,v,C,I)>p)continue;C.applyMatrix4(this.matrixWorld);const H=e.ray.origin.distanceTo(C);H<e.near||H>e.far||t.push({distance:H,point:I.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}else{const P=Math.max(0,h.start),O=Math.min(D.count,h.start+h.count);for(let F=P,N=O-1;F<N;F+=E){if(g.fromBufferAttribute(D,F),v.fromBufferAttribute(D,F+1),wE.distanceSqToSegment(g,v,C,I)>p)continue;C.applyMatrix4(this.matrixWorld);const X=e.ray.origin.distanceTo(C);X<e.near||X>e.far||t.push({distance:X,point:I.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const o=t[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=o.length;u<h;u++){const r=o[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=u}}}}}const OQ=new rt,GQ=new rt;class Tq extends MB{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let o=0,u=t.count;o<u;o+=2)OQ.fromBufferAttribute(t,o),GQ.fromBufferAttribute(t,o+1),i[o]=o===0?0:i[o-1],i[o+1]=i[o]+OQ.distanceTo(GQ);e.setAttribute("lineDistance",new Mc(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Dq extends MB{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Mk extends _a{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Xi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const HQ=new sn,Yw=new m0,Lv=new cf,Pv=new rt;class Qq extends rr{constructor(e=new Oo,t=new Mk){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,o=this.matrixWorld,u=e.params.Points.threshold,h=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Lv.copy(i.boundingSphere),Lv.applyMatrix4(o),Lv.radius+=u,e.ray.intersectsSphere(Lv)===!1)return;HQ.copy(o).invert(),Yw.copy(e.ray).applyMatrix4(HQ);const r=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=r*r,g=i.index,I=i.attributes.position;if(g!==null){const C=Math.max(0,h.start),E=Math.min(g.count,h.start+h.count);for(let Q=C,M=E;Q<M;Q++){const D=g.getX(Q);Pv.fromBufferAttribute(I,D),VQ(Pv,D,p,o,e,t,this)}}else{const C=Math.max(0,h.start),E=Math.min(I.count,h.start+h.count);for(let Q=C,M=E;Q<M;Q++)Pv.fromBufferAttribute(I,Q),VQ(Pv,Q,p,o,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const o=t[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=o.length;u<h;u++){const r=o[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=u}}}}}function VQ(n,e,t,i,o,u,h){const r=Yw.distanceSqToPoint(n);if(r<t){const p=new rt;Yw.closestPointToPoint(n,p),p.applyMatrix4(i);const g=o.ray.origin.distanceTo(p);if(g<o.near||g>o.far)return;u.push({distance:g,distanceToRay:Math.sqrt(r),point:p,index:e,face:null,object:h})}}class Rq extends _a{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Xi(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class ef extends _a{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xB,this.normalScale=new Yi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uf extends ef{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Yi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return hs(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Xi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Xi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Xi(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Tk extends _a{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Xi(16777215),this.specular=new Xi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xB,this.normalScale=new Yi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function bu(n,e,t){return Dk(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function kv(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Dk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Lq(n){function e(o,u){return n[o]-n[u]}const t=n.length,i=new Array(t);for(let o=0;o!==t;++o)i[o]=o;return i.sort(e),i}function WQ(n,e,t){const i=n.length,o=new n.constructor(i);for(let u=0,h=0;h!==i;++u){const r=t[u]*e;for(let p=0;p!==e;++p)o[h++]=n[r+p]}return o}function Qk(n,e,t,i){let o=1,u=n[0];for(;u!==void 0&&u[i]===void 0;)u=n[o++];if(u===void 0)return;let h=u[i];if(h!==void 0)if(Array.isArray(h))do h=u[i],h!==void 0&&(e.push(u.time),t.push.apply(t,h)),u=n[o++];while(u!==void 0);else if(h.toArray!==void 0)do h=u[i],h!==void 0&&(e.push(u.time),h.toArray(t,t.length)),u=n[o++];while(u!==void 0);else do h=u[i],h!==void 0&&(e.push(u.time),t.push(h)),u=n[o++];while(u!==void 0)}class v0{constructor(e,t,i,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=o!==void 0?o:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,o=t[i],u=t[i-1];e:{t:{let h;i:{n:if(!(e<o)){for(let r=i+2;;){if(o===void 0){if(e<u)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===r)break;if(u=o,o=t[++i],e<o)break t}h=t.length;break i}if(!(e>=u)){const r=t[1];e<r&&(i=2,u=r);for(let p=i-2;;){if(u===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===p)break;if(o=u,u=t[--i-1],e>=u)break t}h=i,i=0;break i}break e}for(;i<h;){const r=i+h>>>1;e<t[r]?h=r:i=r+1}if(o=t[i],u=t[i-1],u===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,u,o)}return this.interpolate_(i,u,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,o=this.valueSize,u=e*o;for(let h=0;h!==o;++h)t[h]=i[u+h];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Pq extends v0{constructor(e,t,i,o){super(e,t,i,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:jD,endingEnd:jD}}intervalChanged_(e,t,i){const o=this.parameterPositions;let u=e-2,h=e+1,r=o[u],p=o[h];if(r===void 0)switch(this.getSettings_().endingStart){case qD:u=e,r=2*t-i;break;case KD:u=o.length-2,r=t+o[u]-o[u+1];break;default:u=e,r=i}if(p===void 0)switch(this.getSettings_().endingEnd){case qD:h=e,p=2*i-t;break;case KD:h=1,p=i+o[1]-o[0];break;default:h=e-1,p=t}const g=(i-t)*.5,v=this.valueSize;this._weightPrev=g/(t-r),this._weightNext=g/(p-i),this._offsetPrev=u*v,this._offsetNext=h*v}interpolate_(e,t,i,o){const u=this.resultBuffer,h=this.sampleValues,r=this.valueSize,p=e*r,g=p-r,v=this._offsetPrev,I=this._offsetNext,C=this._weightPrev,E=this._weightNext,Q=(i-t)/(o-t),M=Q*Q,D=M*Q,P=-C*D+2*C*M-C*Q,O=(1+C)*D+(-1.5-2*C)*M+(-.5+C)*Q+1,F=(-1-E)*D+(1.5+E)*M+.5*Q,N=E*D-E*M;for(let z=0;z!==r;++z)u[z]=P*h[v+z]+O*h[g+z]+F*h[p+z]+N*h[I+z];return u}}class kq extends v0{constructor(e,t,i,o){super(e,t,i,o)}interpolate_(e,t,i,o){const u=this.resultBuffer,h=this.sampleValues,r=this.valueSize,p=e*r,g=p-r,v=(i-t)/(o-t),I=1-v;for(let C=0;C!==r;++C)u[C]=h[g+C]*I+h[p+C]*v;return u}}class Fq extends v0{constructor(e,t,i,o){super(e,t,i,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class Nl{constructor(e,t,i,o){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=kv(t,this.TimeBufferType),this.values=kv(i,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:kv(e.times,Array),values:kv(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(i.interpolation=o)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Fq(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new kq(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Pq(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case i0:t=this.InterpolantFactoryMethodDiscrete;break;case LA:t=this.InterpolantFactoryMethodLinear;break;case $C:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return i0;case this.InterpolantFactoryMethodLinear:return LA;case this.InterpolantFactoryMethodSmooth:return $C}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,o=t.length;i!==o;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,o=t.length;i!==o;++i)t[i]*=e}return this}trim(e,t){const i=this.times,o=i.length;let u=0,h=o-1;for(;u!==o&&i[u]<e;)++u;for(;h!==-1&&i[h]>t;)--h;if(++h,u!==0||h!==o){u>=h&&(h=Math.max(h,1),u=h-1);const r=this.getValueSize();this.times=bu(i,u,h),this.values=bu(this.values,u*r,h*r)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,o=this.values,u=i.length;u===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let h=null;for(let r=0;r!==u;r++){const p=i[r];if(typeof p=="number"&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,r,p),e=!1;break}if(h!==null&&h>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,r,p,h),e=!1;break}h=p}if(o!==void 0&&Dk(o))for(let r=0,p=o.length;r!==p;++r){const g=o[r];if(isNaN(g)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,r,g),e=!1;break}}return e}optimize(){const e=bu(this.times),t=bu(this.values),i=this.getValueSize(),o=this.getInterpolation()===$C,u=e.length-1;let h=1;for(let r=1;r<u;++r){let p=!1;const g=e[r],v=e[r+1];if(g!==v&&(r!==1||g!==e[0]))if(o)p=!0;else{const I=r*i,C=I-i,E=I+i;for(let Q=0;Q!==i;++Q){const M=t[I+Q];if(M!==t[C+Q]||M!==t[E+Q]){p=!0;break}}}if(p){if(r!==h){e[h]=e[r];const I=r*i,C=h*i;for(let E=0;E!==i;++E)t[C+E]=t[I+E]}++h}}if(u>0){e[h]=e[u];for(let r=u*i,p=h*i,g=0;g!==i;++g)t[p+g]=t[r+g];++h}return h!==e.length?(this.times=bu(e,0,h),this.values=bu(t,0,h*i)):(this.times=e,this.values=t),this}clone(){const e=bu(this.times,0),t=bu(this.values,0),i=this.constructor,o=new i(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}Nl.prototype.TimeBufferType=Float32Array;Nl.prototype.ValueBufferType=Float32Array;Nl.prototype.DefaultInterpolation=LA;class jA extends Nl{}jA.prototype.ValueTypeName="bool";jA.prototype.ValueBufferType=Array;jA.prototype.DefaultInterpolation=i0;jA.prototype.InterpolantFactoryMethodLinear=void 0;jA.prototype.InterpolantFactoryMethodSmooth=void 0;class Rk extends Nl{}Rk.prototype.ValueTypeName="color";class o0 extends Nl{}o0.prototype.ValueTypeName="number";class Nq extends v0{constructor(e,t,i,o){super(e,t,i,o)}interpolate_(e,t,i,o){const u=this.resultBuffer,h=this.sampleValues,r=this.valueSize,p=(i-t)/(o-t);let g=e*r;for(let v=g+r;g!==v;g+=4)Ll.slerpFlat(u,0,h,g-r,h,g,p);return u}}class tf extends Nl{InterpolantFactoryMethodLinear(e){return new Nq(this.times,this.values,this.getValueSize(),e)}}tf.prototype.ValueTypeName="quaternion";tf.prototype.DefaultInterpolation=LA;tf.prototype.InterpolantFactoryMethodSmooth=void 0;class qA extends Nl{}qA.prototype.ValueTypeName="string";qA.prototype.ValueBufferType=Array;qA.prototype.DefaultInterpolation=i0;qA.prototype.InterpolantFactoryMethodLinear=void 0;qA.prototype.InterpolantFactoryMethodSmooth=void 0;class a0 extends Nl{}a0.prototype.ValueTypeName="vector";class zq{constructor(e,t=-1,i,o=s9){this.name=e,this.tracks=i,this.duration=t,this.blendMode=o,this.uuid=il(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,o=1/(e.fps||1);for(let h=0,r=i.length;h!==r;++h)t.push(Oq(i[h]).scale(o));const u=new this(e.name,e.duration,t,e.blendMode);return u.uuid=e.uuid,u}static toJSON(e){const t=[],i=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let u=0,h=i.length;u!==h;++u)t.push(Nl.toJSON(i[u]));return o}static CreateFromMorphTargetSequence(e,t,i,o){const u=t.length,h=[];for(let r=0;r<u;r++){let p=[],g=[];p.push((r+u-1)%u,r,(r+1)%u),g.push(0,1,0);const v=Lq(p);p=WQ(p,1,v),g=WQ(g,1,v),!o&&p[0]===0&&(p.push(u),g.push(g[0])),h.push(new o0(".morphTargetInfluences["+t[r].name+"]",p,g).scale(1/i))}return new this(e,-1,h)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const o=e;i=o.geometry&&o.geometry.animations||o.animations}for(let o=0;o<i.length;o++)if(i[o].name===t)return i[o];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const o={},u=/^([\w-]*?)([\d]+)$/;for(let r=0,p=e.length;r<p;r++){const g=e[r],v=g.name.match(u);if(v&&v.length>1){const I=v[1];let C=o[I];C||(o[I]=C=[]),C.push(g)}}const h=[];for(const r in o)h.push(this.CreateFromMorphTargetSequence(r,o[r],t,i));return h}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(I,C,E,Q,M){if(E.length!==0){const D=[],P=[];Qk(E,D,P,Q),D.length!==0&&M.push(new I(C,D,P))}},o=[],u=e.name||"default",h=e.fps||30,r=e.blendMode;let p=e.length||-1;const g=e.hierarchy||[];for(let I=0;I<g.length;I++){const C=g[I].keys;if(!(!C||C.length===0))if(C[0].morphTargets){const E={};let Q;for(Q=0;Q<C.length;Q++)if(C[Q].morphTargets)for(let M=0;M<C[Q].morphTargets.length;M++)E[C[Q].morphTargets[M]]=-1;for(const M in E){const D=[],P=[];for(let O=0;O!==C[Q].morphTargets.length;++O){const F=C[Q];D.push(F.time),P.push(F.morphTarget===M?1:0)}o.push(new o0(".morphTargetInfluence["+M+"]",D,P))}p=E.length*h}else{const E=".bones["+t[I].name+"]";i(a0,E+".position",C,"pos",o),i(tf,E+".quaternion",C,"rot",o),i(a0,E+".scale",C,"scl",o)}}return o.length===0?null:new this(u,p,o,r)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,o=e.length;i!==o;++i){const u=this.tracks[i];t=Math.max(t,u.times[u.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Uq(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return o0;case"vector":case"vector2":case"vector3":case"vector4":return a0;case"color":return Rk;case"quaternion":return tf;case"bool":case"boolean":return jA;case"string":return qA}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Oq(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Uq(n.type);if(n.times===void 0){const t=[],i=[];Qk(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const kA={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Gq{constructor(e,t,i){const o=this;let u=!1,h=0,r=0,p;const g=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(v){r++,u===!1&&o.onStart!==void 0&&o.onStart(v,h,r),u=!0},this.itemEnd=function(v){h++,o.onProgress!==void 0&&o.onProgress(v,h,r),h===r&&(u=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(v){o.onError!==void 0&&o.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,I){return g.push(v,I),this},this.removeHandler=function(v){const I=g.indexOf(v);return I!==-1&&g.splice(I,2),this},this.getHandler=function(v){for(let I=0,C=g.length;I<C;I+=2){const E=g[I],Q=g[I+1];if(E.global&&(E.lastIndex=0),E.test(v))return Q}return null}}}const Hq=new Gq;class hf{constructor(e){this.manager=e!==void 0?e:Hq,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(o,u){i.load(e,o,t,u)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const lc={};class Vq extends Error{constructor(e,t){super(e),this.response=t}}class l0 extends hf{constructor(e){super(e)}load(e,t,i,o){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const u=kA.get(e);if(u!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(u),this.manager.itemEnd(e)},0),u;if(lc[e]!==void 0){lc[e].push({onLoad:t,onProgress:i,onError:o});return}lc[e]=[],lc[e].push({onLoad:t,onProgress:i,onError:o});const h=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),r=this.mimeType,p=this.responseType;fetch(h).then(g=>{if(g.status===200||g.status===0){if(g.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||g.body===void 0||g.body.getReader===void 0)return g;const v=lc[e],I=g.body.getReader(),C=g.headers.get("Content-Length")||g.headers.get("X-File-Size"),E=C?parseInt(C):0,Q=E!==0;let M=0;const D=new ReadableStream({start(P){O();function O(){I.read().then(({done:F,value:N})=>{if(F)P.close();else{M+=N.byteLength;const z=new ProgressEvent("progress",{lengthComputable:Q,loaded:M,total:E});for(let X=0,q=v.length;X<q;X++){const H=v[X];H.onProgress&&H.onProgress(z)}P.enqueue(N),O()}})}}});return new Response(D)}else throw new Vq(`fetch for "${g.url}" responded with ${g.status}: ${g.statusText}`,g)}).then(g=>{switch(p){case"arraybuffer":return g.arrayBuffer();case"blob":return g.blob();case"document":return g.text().then(v=>new DOMParser().parseFromString(v,r));case"json":return g.json();default:if(r===void 0)return g.text();{const I=/charset="?([^;"\s]*)"?/i.exec(r),C=I&&I[1]?I[1].toLowerCase():void 0,E=new TextDecoder(C);return g.arrayBuffer().then(Q=>E.decode(Q))}}}).then(g=>{kA.add(e,g);const v=lc[e];delete lc[e];for(let I=0,C=v.length;I<C;I++){const E=v[I];E.onLoad&&E.onLoad(g)}}).catch(g=>{const v=lc[e];if(v===void 0)throw this.manager.itemError(e),g;delete lc[e];for(let I=0,C=v.length;I<C;I++){const E=v[I];E.onError&&E.onError(g)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Wq extends hf{constructor(e){super(e)}load(e,t,i,o){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const u=this,h=kA.get(e);if(h!==void 0)return u.manager.itemStart(e),setTimeout(function(){t&&t(h),u.manager.itemEnd(e)},0),h;const r=s0("img");function p(){v(),kA.add(e,this),t&&t(this),u.manager.itemEnd(e)}function g(I){v(),o&&o(I),u.manager.itemError(e),u.manager.itemEnd(e)}function v(){r.removeEventListener("load",p,!1),r.removeEventListener("error",g,!1)}return r.addEventListener("load",p,!1),r.addEventListener("error",g,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(r.crossOrigin=this.crossOrigin),u.manager.itemStart(e),r.src=e,r}}class Yq extends hf{constructor(e){super(e)}load(e,t,i,o){const u=this,h=new Bk,r=new l0(this.manager);return r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setPath(this.path),r.setWithCredentials(u.withCredentials),r.load(e,function(p){const g=u.parse(p);g&&(g.image!==void 0?h.image=g.image:g.data!==void 0&&(h.image.width=g.width,h.image.height=g.height,h.image.data=g.data),h.wrapS=g.wrapS!==void 0?g.wrapS:po,h.wrapT=g.wrapT!==void 0?g.wrapT:po,h.magFilter=g.magFilter!==void 0?g.magFilter:$r,h.minFilter=g.minFilter!==void 0?g.minFilter:$r,h.anisotropy=g.anisotropy!==void 0?g.anisotropy:1,g.encoding!==void 0&&(h.encoding=g.encoding),g.flipY!==void 0&&(h.flipY=g.flipY),g.format!==void 0&&(h.format=g.format),g.type!==void 0&&(h.type=g.type),g.mipmaps!==void 0&&(h.mipmaps=g.mipmaps,h.minFilter=ch),g.mipmapCount===1&&(h.minFilter=$r),g.generateMipmaps!==void 0&&(h.generateMipmaps=g.generateMipmaps),h.needsUpdate=!0,t&&t(h,g))},i,o),h}}class jq extends hf{constructor(e){super(e)}load(e,t,i,o){const u=new Cs,h=new Wq(this.manager);return h.setCrossOrigin(this.crossOrigin),h.setPath(this.path),h.load(e,function(r){u.image=r,u.needsUpdate=!0,t!==void 0&&t(u)},i,o),u}}class E1 extends rr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Xi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class qq extends E1{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(rr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Xi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const bE=new sn,YQ=new rt,jQ=new rt;class TB{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Yi(512,512),this.map=null,this.mapPass=null,this.matrix=new sn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new EB,this._frameExtents=new Yi(1,1),this._viewportCount=1,this._viewports=[new er(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;YQ.setFromMatrixPosition(e.matrixWorld),t.position.copy(YQ),jQ.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jQ),t.updateMatrixWorld(),bE.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bE),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(bE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Kq extends TB{constructor(){super(new ds(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=r0*2*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,u=e.distance||t.far;(i!==t.fov||o!==t.aspect||u!==t.far)&&(t.fov=i,t.aspect=o,t.far=u,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Jq extends E1{constructor(e,t,i=0,o=Math.PI/3,u=0,h=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(rr.DEFAULT_UP),this.updateMatrix(),this.target=new rr,this.distance=i,this.angle=o,this.penumbra=u,this.decay=h,this.map=null,this.shadow=new Kq}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const qQ=new sn,Fm=new rt,BE=new rt;class Xq extends TB{constructor(){super(new ds(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Yi(4,2),this._viewportCount=6,this._viewports=[new er(2,1,1,1),new er(0,1,1,1),new er(3,1,1,1),new er(1,1,1,1),new er(3,0,1,1),new er(1,0,1,1)],this._cubeDirections=[new rt(1,0,0),new rt(-1,0,0),new rt(0,0,1),new rt(0,0,-1),new rt(0,1,0),new rt(0,-1,0)],this._cubeUps=[new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,0,1),new rt(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,o=this.matrix,u=e.distance||i.far;u!==i.far&&(i.far=u,i.updateProjectionMatrix()),Fm.setFromMatrixPosition(e.matrixWorld),i.position.copy(Fm),BE.copy(i.position),BE.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(BE),i.updateMatrixWorld(),o.makeTranslation(-Fm.x,-Fm.y,-Fm.z),qQ.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qQ)}}class DB extends E1{constructor(e,t,i=0,o=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=o,this.shadow=new Xq}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Zq extends TB{constructor(){super(new wB(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class QB extends E1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(rr.DEFAULT_UP),this.updateMatrix(),this.target=new rr,this.shadow=new Zq}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jw{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,o=e.length;i<o;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class $q extends hf{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,o){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const u=this,h=kA.get(e);if(h!==void 0)return u.manager.itemStart(e),setTimeout(function(){t&&t(h),u.manager.itemEnd(e)},0),h;const r={};r.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",r.headers=this.requestHeader,fetch(e,r).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(u.options,{colorSpaceConversion:"none"}))}).then(function(p){kA.add(e,p),t&&t(p),u.manager.itemEnd(e)}).catch(function(p){o&&o(p),u.manager.itemError(e),u.manager.itemEnd(e)}),u.manager.itemStart(e)}}const RB="\\[\\]\\.:\\/",eK=new RegExp("["+RB+"]","g"),LB="[^"+RB+"]",tK="[^"+RB.replace("\\.","")+"]",iK=/((?:WC+[\/:])*)/.source.replace("WC",LB),nK=/(WCOD+)?/.source.replace("WCOD",tK),rK=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",LB),sK=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",LB),oK=new RegExp("^"+iK+nK+rK+sK+"$"),aK=["material","materials","bones","map"];class lK{constructor(e,t,i){const o=i||Wn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,o=this._bindings[i];o!==void 0&&o.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let o=this._targetGroup.nCachedObjects_,u=i.length;o!==u;++o)i[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Wn{constructor(e,t,i){this.path=t,this.parsedPath=i||Wn.parseTrackName(t),this.node=Wn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Wn.Composite(e,t,i):new Wn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(eK,"")}static parseTrackName(e){const t=oK.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},o=i.nodeName&&i.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){const u=i.nodeName.substring(o+1);aK.indexOf(u)!==-1&&(i.nodeName=i.nodeName.substring(0,o),i.objectName=u)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(u){for(let h=0;h<u.length;h++){const r=u[h];if(r.name===t||r.uuid===t)return r;const p=i(r.children);if(p)return p}return null},o=i(e.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let o=0,u=i.length;o!==u;++o)e[t++]=i[o]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let o=0,u=i.length;o!==u;++o)i[o]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let o=0,u=i.length;o!==u;++o)i[o]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let o=0,u=i.length;o!==u;++o)i[o]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,o=t.propertyName;let u=t.propertyIndex;if(e||(e=Wn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let g=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let v=0;v<e.length;v++)if(e[v].name===g){g=v;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(g!==void 0){if(e[g]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[g]}}const h=e[o];if(h===void 0){const g=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+g+"."+o+" but it wasn't found.",e);return}let r=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?r=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(r=this.Versioning.MatrixWorldNeedsUpdate);let p=this.BindingType.Direct;if(u!==void 0){if(o==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[u]!==void 0&&(u=e.morphTargetDictionary[u])}p=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else h.fromArray!==void 0&&h.toArray!==void 0?(p=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(p=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=o;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][r]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Wn.Composite=lK;Wn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Wn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Wn.prototype.GetterByBindingType=[Wn.prototype._getValue_direct,Wn.prototype._getValue_array,Wn.prototype._getValue_arrayElement,Wn.prototype._getValue_toArray];Wn.prototype.SetterByBindingTypeAndVersioning=[[Wn.prototype._setValue_direct,Wn.prototype._setValue_direct_setNeedsUpdate,Wn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_array,Wn.prototype._setValue_array_setNeedsUpdate,Wn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_arrayElement,Wn.prototype._setValue_arrayElement_setNeedsUpdate,Wn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wn.prototype._setValue_fromArray,Wn.prototype._setValue_fromArray_setNeedsUpdate,Wn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class cK{constructor(e,t,i=0,o=1/0){this.ray=new m0(e,t),this.near=i,this.far=o,this.camera=null,this.layers=new CB,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return qw(e,this,i,t),i.sort(KQ),i}intersectObjects(e,t=!0,i=[]){for(let o=0,u=e.length;o<u;o++)qw(e[o],this,i,t);return i.sort(KQ),i}}function KQ(n,e){return n.distance-e.distance}function qw(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const o=n.children;for(let u=0,h=o.length;u<h;u++)qw(o[u],e,t,!0)}}class JQ{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(hs(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const XQ=new rt,Fv=new rt;class Tc{constructor(e=new rt,t=new rt){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){XQ.subVectors(e,this.start),Fv.subVectors(this.end,this.start);const i=Fv.dot(Fv);let u=Fv.dot(XQ)/i;return t&&(u=hs(u,0,1)),u}closestPointToPoint(e,t,i){const o=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(o).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const yc=uK();function uK(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),o=new Uint32Array(512);for(let p=0;p<256;++p){const g=p-127;g<-27?(i[p]=0,i[p|256]=32768,o[p]=24,o[p|256]=24):g<-14?(i[p]=1024>>-g-14,i[p|256]=1024>>-g-14|32768,o[p]=-g-1,o[p|256]=-g-1):g<=15?(i[p]=g+15<<10,i[p|256]=g+15<<10|32768,o[p]=13,o[p|256]=13):g<128?(i[p]=31744,i[p|256]=64512,o[p]=24,o[p|256]=24):(i[p]=31744,i[p|256]=64512,o[p]=13,o[p|256]=13)}const u=new Uint32Array(2048),h=new Uint32Array(64),r=new Uint32Array(64);for(let p=1;p<1024;++p){let g=p<<13,v=0;for(;!(g&8388608);)g<<=1,v-=8388608;g&=-8388609,v+=947912704,u[p]=g|v}for(let p=1024;p<2048;++p)u[p]=939524096+(p-1024<<13);for(let p=1;p<31;++p)h[p]=p<<23;h[31]=1199570944,h[32]=2147483648;for(let p=33;p<63;++p)h[p]=2147483648+(p-32<<23);h[63]=3347054592;for(let p=1;p<64;++p)p!==32&&(r[p]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:o,mantissaTable:u,exponentTable:h,offsetTable:r}}function hK(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=hs(n,-65504,65504),yc.floatView[0]=n;const e=yc.uint32View[0],t=e>>23&511;return yc.baseTable[t]+((e&8388607)>>yc.shiftTable[t])}function dK(n){const e=n>>10;return yc.uint32View[0]=yc.mantissaTable[yc.offsetTable[e]+(n&1023)]+yc.exponentTable[e],yc.floatView[0]}var Nv=Object.freeze({__proto__:null,fromHalfFloat:dK,toHalfFloat:hK});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_B}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_B);const ZQ={type:"change"},SE={type:"start"},$Q={type:"end"};class w1 extends lf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new rt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ap.ROTATE,MIDDLE:Ap.DOLLY,RIGHT:Ap.PAN},this.touches={ONE:gp.ROTATE,TWO:gp.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Ue){Ue.addEventListener("keydown",Dt),this._domElementKeyEvents=Ue},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(ZQ),i.update(),u=o.NONE},this.update=function(){const Ue=new rt,ot=new Ll().setFromUnitVectors(e.up,new rt(0,1,0)),ni=ot.clone().invert(),fi=new rt,Xt=new Ll,_i=2*Math.PI;return function(){const wt=i.object.position;Ue.copy(wt).sub(i.target),Ue.applyQuaternion(ot),r.setFromVector3(Ue),i.autoRotate&&u===o.NONE&&W(q()),i.enableDamping?(r.theta+=p.theta*i.dampingFactor,r.phi+=p.phi*i.dampingFactor):(r.theta+=p.theta,r.phi+=p.phi);let kt=i.minAzimuthAngle,yi=i.maxAzimuthAngle;return isFinite(kt)&&isFinite(yi)&&(kt<-Math.PI?kt+=_i:kt>Math.PI&&(kt-=_i),yi<-Math.PI?yi+=_i:yi>Math.PI&&(yi-=_i),kt<=yi?r.theta=Math.max(kt,Math.min(yi,r.theta)):r.theta=r.theta>(kt+yi)/2?Math.max(kt,r.theta):Math.min(yi,r.theta)),r.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,r.phi)),r.makeSafe(),r.radius*=g,r.radius=Math.max(i.minDistance,Math.min(i.maxDistance,r.radius)),i.enableDamping===!0?i.target.addScaledVector(v,i.dampingFactor):i.target.add(v),Ue.setFromSpherical(r),Ue.applyQuaternion(ni),wt.copy(i.target).add(Ue),i.object.lookAt(i.target),i.enableDamping===!0?(p.theta*=1-i.dampingFactor,p.phi*=1-i.dampingFactor,v.multiplyScalar(1-i.dampingFactor)):(p.set(0,0,0),v.set(0,0,0)),g=1,I||fi.distanceToSquared(i.object.position)>h||8*(1-Xt.dot(i.object.quaternion))>h?(i.dispatchEvent(ZQ),fi.copy(i.object.position),Xt.copy(i.object.quaternion),I=!1,!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",at),i.domElement.removeEventListener("pointerdown",Ze),i.domElement.removeEventListener("pointercancel",ze),i.domElement.removeEventListener("wheel",Ut),i.domElement.removeEventListener("pointermove",nt),i.domElement.removeEventListener("pointerup",ut),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Dt)};const i=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let u=o.NONE;const h=1e-6,r=new JQ,p=new JQ;let g=1;const v=new rt;let I=!1;const C=new Yi,E=new Yi,Q=new Yi,M=new Yi,D=new Yi,P=new Yi,O=new Yi,F=new Yi,N=new Yi,z=[],X={};function q(){return 2*Math.PI/60/60*i.autoRotateSpeed}function H(){return Math.pow(.95,i.zoomSpeed)}function W(Ue){p.theta-=Ue}function se(Ue){p.phi-=Ue}const de=function(){const Ue=new rt;return function(ni,fi){Ue.setFromMatrixColumn(fi,0),Ue.multiplyScalar(-ni),v.add(Ue)}}(),te=function(){const Ue=new rt;return function(ni,fi){i.screenSpacePanning===!0?Ue.setFromMatrixColumn(fi,1):(Ue.setFromMatrixColumn(fi,0),Ue.crossVectors(i.object.up,Ue)),Ue.multiplyScalar(ni),v.add(Ue)}}(),ce=function(){const Ue=new rt;return function(ni,fi){const Xt=i.domElement;if(i.object.isPerspectiveCamera){const _i=i.object.position;Ue.copy(_i).sub(i.target);let si=Ue.length();si*=Math.tan(i.object.fov/2*Math.PI/180),de(2*ni*si/Xt.clientHeight,i.object.matrix),te(2*fi*si/Xt.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(de(ni*(i.object.right-i.object.left)/i.object.zoom/Xt.clientWidth,i.object.matrix),te(fi*(i.object.top-i.object.bottom)/i.object.zoom/Xt.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function Ee(Ue){i.object.isPerspectiveCamera?g/=Ue:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*Ue)),i.object.updateProjectionMatrix(),I=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Be(Ue){i.object.isPerspectiveCamera?g*=Ue:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/Ue)),i.object.updateProjectionMatrix(),I=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function De(Ue){C.set(Ue.clientX,Ue.clientY)}function Re(Ue){O.set(Ue.clientX,Ue.clientY)}function ye(Ue){M.set(Ue.clientX,Ue.clientY)}function ht(Ue){E.set(Ue.clientX,Ue.clientY),Q.subVectors(E,C).multiplyScalar(i.rotateSpeed);const ot=i.domElement;W(2*Math.PI*Q.x/ot.clientHeight),se(2*Math.PI*Q.y/ot.clientHeight),C.copy(E),i.update()}function oe(Ue){F.set(Ue.clientX,Ue.clientY),N.subVectors(F,O),N.y>0?Ee(H()):N.y<0&&Be(H()),O.copy(F),i.update()}function Tt(Ue){D.set(Ue.clientX,Ue.clientY),P.subVectors(D,M).multiplyScalar(i.panSpeed),ce(P.x,P.y),M.copy(D),i.update()}function Fe(Ue){Ue.deltaY<0?Be(H()):Ue.deltaY>0&&Ee(H()),i.update()}function st(Ue){let ot=!1;switch(Ue.code){case i.keys.UP:Ue.ctrlKey||Ue.metaKey||Ue.shiftKey?se(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ce(0,i.keyPanSpeed),ot=!0;break;case i.keys.BOTTOM:Ue.ctrlKey||Ue.metaKey||Ue.shiftKey?se(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ce(0,-i.keyPanSpeed),ot=!0;break;case i.keys.LEFT:Ue.ctrlKey||Ue.metaKey||Ue.shiftKey?W(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ce(i.keyPanSpeed,0),ot=!0;break;case i.keys.RIGHT:Ue.ctrlKey||Ue.metaKey||Ue.shiftKey?W(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ce(-i.keyPanSpeed,0),ot=!0;break}ot&&(Ue.preventDefault(),i.update())}function Et(){if(z.length===1)C.set(z[0].pageX,z[0].pageY);else{const Ue=.5*(z[0].pageX+z[1].pageX),ot=.5*(z[0].pageY+z[1].pageY);C.set(Ue,ot)}}function Ke(){if(z.length===1)M.set(z[0].pageX,z[0].pageY);else{const Ue=.5*(z[0].pageX+z[1].pageX),ot=.5*(z[0].pageY+z[1].pageY);M.set(Ue,ot)}}function Ne(){const Ue=z[0].pageX-z[1].pageX,ot=z[0].pageY-z[1].pageY,ni=Math.sqrt(Ue*Ue+ot*ot);O.set(0,ni)}function dt(){i.enableZoom&&Ne(),i.enablePan&&Ke()}function xt(){i.enableZoom&&Ne(),i.enableRotate&&Et()}function ft(Ue){if(z.length==1)E.set(Ue.pageX,Ue.pageY);else{const ni=Ot(Ue),fi=.5*(Ue.pageX+ni.x),Xt=.5*(Ue.pageY+ni.y);E.set(fi,Xt)}Q.subVectors(E,C).multiplyScalar(i.rotateSpeed);const ot=i.domElement;W(2*Math.PI*Q.x/ot.clientHeight),se(2*Math.PI*Q.y/ot.clientHeight),C.copy(E)}function Ve(Ue){if(z.length===1)D.set(Ue.pageX,Ue.pageY);else{const ot=Ot(Ue),ni=.5*(Ue.pageX+ot.x),fi=.5*(Ue.pageY+ot.y);D.set(ni,fi)}P.subVectors(D,M).multiplyScalar(i.panSpeed),ce(P.x,P.y),M.copy(D)}function Ye(Ue){const ot=Ot(Ue),ni=Ue.pageX-ot.x,fi=Ue.pageY-ot.y,Xt=Math.sqrt(ni*ni+fi*fi);F.set(0,Xt),N.set(0,Math.pow(F.y/O.y,i.zoomSpeed)),Ee(N.y),O.copy(F)}function ae(Ue){i.enableZoom&&Ye(Ue),i.enablePan&&Ve(Ue)}function _e(Ue){i.enableZoom&&Ye(Ue),i.enableRotate&&ft(Ue)}function Ze(Ue){i.enabled!==!1&&(z.length===0&&(i.domElement.setPointerCapture(Ue.pointerId),i.domElement.addEventListener("pointermove",nt),i.domElement.addEventListener("pointerup",ut)),St(Ue),Ue.pointerType==="touch"?Ie(Ue):Qt(Ue))}function nt(Ue){i.enabled!==!1&&(Ue.pointerType==="touch"?ue(Ue):mt(Ue))}function ut(Ue){yt(Ue),z.length===0&&(i.domElement.releasePointerCapture(Ue.pointerId),i.domElement.removeEventListener("pointermove",nt),i.domElement.removeEventListener("pointerup",ut)),i.dispatchEvent($Q),u=o.NONE}function ze(Ue){yt(Ue)}function Qt(Ue){let ot;switch(Ue.button){case 0:ot=i.mouseButtons.LEFT;break;case 1:ot=i.mouseButtons.MIDDLE;break;case 2:ot=i.mouseButtons.RIGHT;break;default:ot=-1}switch(ot){case Ap.DOLLY:if(i.enableZoom===!1)return;Re(Ue),u=o.DOLLY;break;case Ap.ROTATE:if(Ue.ctrlKey||Ue.metaKey||Ue.shiftKey){if(i.enablePan===!1)return;ye(Ue),u=o.PAN}else{if(i.enableRotate===!1)return;De(Ue),u=o.ROTATE}break;case Ap.PAN:if(Ue.ctrlKey||Ue.metaKey||Ue.shiftKey){if(i.enableRotate===!1)return;De(Ue),u=o.ROTATE}else{if(i.enablePan===!1)return;ye(Ue),u=o.PAN}break;default:u=o.NONE}u!==o.NONE&&i.dispatchEvent(SE)}function mt(Ue){switch(u){case o.ROTATE:if(i.enableRotate===!1)return;ht(Ue);break;case o.DOLLY:if(i.enableZoom===!1)return;oe(Ue);break;case o.PAN:if(i.enablePan===!1)return;Tt(Ue);break}}function Ut(Ue){i.enabled===!1||i.enableZoom===!1||u!==o.NONE||(Ue.preventDefault(),i.dispatchEvent(SE),Fe(Ue),i.dispatchEvent($Q))}function Dt(Ue){i.enabled===!1||i.enablePan===!1||st(Ue)}function Ie(Ue){switch(Pt(Ue),z.length){case 1:switch(i.touches.ONE){case gp.ROTATE:if(i.enableRotate===!1)return;Et(),u=o.TOUCH_ROTATE;break;case gp.PAN:if(i.enablePan===!1)return;Ke(),u=o.TOUCH_PAN;break;default:u=o.NONE}break;case 2:switch(i.touches.TWO){case gp.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;dt(),u=o.TOUCH_DOLLY_PAN;break;case gp.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;xt(),u=o.TOUCH_DOLLY_ROTATE;break;default:u=o.NONE}break;default:u=o.NONE}u!==o.NONE&&i.dispatchEvent(SE)}function ue(Ue){switch(Pt(Ue),u){case o.TOUCH_ROTATE:if(i.enableRotate===!1)return;ft(Ue),i.update();break;case o.TOUCH_PAN:if(i.enablePan===!1)return;Ve(Ue),i.update();break;case o.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ae(Ue),i.update();break;case o.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;_e(Ue),i.update();break;default:u=o.NONE}}function at(Ue){i.enabled!==!1&&Ue.preventDefault()}function St(Ue){z.push(Ue)}function yt(Ue){delete X[Ue.pointerId];for(let ot=0;ot<z.length;ot++)if(z[ot].pointerId==Ue.pointerId){z.splice(ot,1);return}}function Pt(Ue){let ot=X[Ue.pointerId];ot===void 0&&(ot=new Yi,X[Ue.pointerId]=ot),ot.set(Ue.pageX,Ue.pageY)}function Ot(Ue){const ot=Ue.pointerId===z[0].pointerId?z[1]:z[0];return X[ot.pointerId]}i.domElement.addEventListener("contextmenu",at),i.domElement.addEventListener("pointerdown",Ze),i.domElement.addEventListener("pointercancel",ze),i.domElement.addEventListener("wheel",Ut,{passive:!1}),this.update()}}function e3(n,e){if(e===o9)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Ow||e===ck){let t=n.getIndex();if(t===null){const h=[],r=n.getAttribute("position");if(r!==void 0){for(let p=0;p<r.count;p++)h.push(p);n.setIndex(h),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,o=[];if(e===Ow)for(let h=1;h<=i;h++)o.push(t.getX(0)),o.push(t.getX(h)),o.push(t.getX(h+1));else for(let h=0;h<i;h++)h%2===0?(o.push(t.getX(h)),o.push(t.getX(h+1)),o.push(t.getX(h+2))):(o.push(t.getX(h+2)),o.push(t.getX(h+1)),o.push(t.getX(h)));o.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const u=n.clone();return u.setIndex(o),u.clearGroups(),u}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class b1 extends hf{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new mK(t)}),this.register(function(t){return new EK(t)}),this.register(function(t){return new wK(t)}),this.register(function(t){return new yK(t)}),this.register(function(t){return new vK(t)}),this.register(function(t){return new xK(t)}),this.register(function(t){return new IK(t)}),this.register(function(t){return new gK(t)}),this.register(function(t){return new CK(t)}),this.register(function(t){return new _K(t)}),this.register(function(t){return new pK(t)}),this.register(function(t){return new bK(t)}),this.register(function(t){return new BK(t)})}load(e,t,i,o){const u=this;let h;this.resourcePath!==""?h=this.resourcePath:this.path!==""?h=this.path:h=jw.extractUrlBase(e),this.manager.itemStart(e);const r=function(g){o?o(g):console.error(g),u.manager.itemError(e),u.manager.itemEnd(e)},p=new l0(this.manager);p.setPath(this.path),p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(e,function(g){try{u.parse(g,h,function(v){t(v),u.manager.itemEnd(e)},r)}catch(v){r(v)}},i,r)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,o){let u;const h={},r={},p=new TextDecoder;if(typeof e=="string")u=JSON.parse(e);else if(e instanceof ArrayBuffer)if(p.decode(new Uint8Array(e,0,4))===Lk){try{h[Bn.KHR_BINARY_GLTF]=new SK(e)}catch(I){o&&o(I);return}u=JSON.parse(h[Bn.KHR_BINARY_GLTF].content)}else u=JSON.parse(p.decode(e));else u=e;if(u.asset===void 0||u.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const g=new OK(u,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});g.fileLoader.setRequestHeader(this.requestHeader);for(let v=0;v<this.pluginCallbacks.length;v++){const I=this.pluginCallbacks[v](g);r[I.name]=I,h[I.name]=!0}if(u.extensionsUsed)for(let v=0;v<u.extensionsUsed.length;++v){const I=u.extensionsUsed[v],C=u.extensionsRequired||[];switch(I){case Bn.KHR_MATERIALS_UNLIT:h[I]=new AK;break;case Bn.KHR_DRACO_MESH_COMPRESSION:h[I]=new MK(u,this.dracoLoader);break;case Bn.KHR_TEXTURE_TRANSFORM:h[I]=new TK;break;case Bn.KHR_MESH_QUANTIZATION:h[I]=new DK;break;default:C.indexOf(I)>=0&&r[I]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+I+'".')}}g.setExtensions(h),g.setPlugins(r),g.parse(i,o)}parseAsync(e,t){const i=this;return new Promise(function(o,u){i.parse(e,t,o,u)})}}function fK(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Bn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class pK{constructor(e){this.parser=e,this.name=Bn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,o=t.length;i<o;i++){const u=t[i];u.extensions&&u.extensions[this.name]&&u.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,u.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let o=t.cache.get(i);if(o)return o;const u=t.json,p=((u.extensions&&u.extensions[this.name]||{}).lights||[])[e];let g;const v=new Xi(16777215);p.color!==void 0&&v.fromArray(p.color);const I=p.range!==void 0?p.range:0;switch(p.type){case"directional":g=new QB(v),g.target.position.set(0,0,-1),g.add(g.target);break;case"point":g=new DB(v),g.distance=I;break;case"spot":g=new Jq(v),g.distance=I,p.spot=p.spot||{},p.spot.innerConeAngle=p.spot.innerConeAngle!==void 0?p.spot.innerConeAngle:0,p.spot.outerConeAngle=p.spot.outerConeAngle!==void 0?p.spot.outerConeAngle:Math.PI/4,g.angle=p.spot.outerConeAngle,g.penumbra=1-p.spot.innerConeAngle/p.spot.outerConeAngle,g.target.position.set(0,0,-1),g.add(g.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+p.type)}return g.position.set(0,0,0),g.decay=2,Fu(g,p),p.intensity!==void 0&&(g.intensity=p.intensity),g.name=t.createUniqueName(p.name||"light_"+e),o=Promise.resolve(g),t.cache.add(i,o),o}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,u=i.json.nodes[e],r=(u.extensions&&u.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(p){return i._getNodeRef(t.cache,r,p)})}}class AK{constructor(){this.name=Bn.KHR_MATERIALS_UNLIT}getMaterialType(){return ju}extendParams(e,t,i){const o=[];e.color=new Xi(1,1,1),e.opacity=1;const u=t.pbrMetallicRoughness;if(u){if(Array.isArray(u.baseColorFactor)){const h=u.baseColorFactor;e.color.fromArray(h),e.opacity=h[3]}u.baseColorTexture!==void 0&&o.push(i.assignTexture(e,"map",u.baseColorTexture,Cn))}return Promise.all(o)}}class gK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=o.extensions[this.name].emissiveStrength;return u!==void 0&&(t.emissiveIntensity=u),Promise.resolve()}}class mK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[],h=o.extensions[this.name];if(h.clearcoatFactor!==void 0&&(t.clearcoat=h.clearcoatFactor),h.clearcoatTexture!==void 0&&u.push(i.assignTexture(t,"clearcoatMap",h.clearcoatTexture)),h.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=h.clearcoatRoughnessFactor),h.clearcoatRoughnessTexture!==void 0&&u.push(i.assignTexture(t,"clearcoatRoughnessMap",h.clearcoatRoughnessTexture)),h.clearcoatNormalTexture!==void 0&&(u.push(i.assignTexture(t,"clearcoatNormalMap",h.clearcoatNormalTexture)),h.clearcoatNormalTexture.scale!==void 0)){const r=h.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Yi(r,r)}return Promise.all(u)}}class _K{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[],h=o.extensions[this.name];return h.iridescenceFactor!==void 0&&(t.iridescence=h.iridescenceFactor),h.iridescenceTexture!==void 0&&u.push(i.assignTexture(t,"iridescenceMap",h.iridescenceTexture)),h.iridescenceIor!==void 0&&(t.iridescenceIOR=h.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),h.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=h.iridescenceThicknessMinimum),h.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=h.iridescenceThicknessMaximum),h.iridescenceThicknessTexture!==void 0&&u.push(i.assignTexture(t,"iridescenceThicknessMap",h.iridescenceThicknessTexture)),Promise.all(u)}}class yK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[];t.sheenColor=new Xi(0,0,0),t.sheenRoughness=0,t.sheen=1;const h=o.extensions[this.name];return h.sheenColorFactor!==void 0&&t.sheenColor.fromArray(h.sheenColorFactor),h.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=h.sheenRoughnessFactor),h.sheenColorTexture!==void 0&&u.push(i.assignTexture(t,"sheenColorMap",h.sheenColorTexture,Cn)),h.sheenRoughnessTexture!==void 0&&u.push(i.assignTexture(t,"sheenRoughnessMap",h.sheenRoughnessTexture)),Promise.all(u)}}class vK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[],h=o.extensions[this.name];return h.transmissionFactor!==void 0&&(t.transmission=h.transmissionFactor),h.transmissionTexture!==void 0&&u.push(i.assignTexture(t,"transmissionMap",h.transmissionTexture)),Promise.all(u)}}class xK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[],h=o.extensions[this.name];t.thickness=h.thicknessFactor!==void 0?h.thicknessFactor:0,h.thicknessTexture!==void 0&&u.push(i.assignTexture(t,"thicknessMap",h.thicknessTexture)),t.attenuationDistance=h.attenuationDistance||1/0;const r=h.attenuationColor||[1,1,1];return t.attenuationColor=new Xi(r[0],r[1],r[2]),Promise.all(u)}}class IK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=o.extensions[this.name];return t.ior=u.ior!==void 0?u.ior:1.5,Promise.resolve()}}class CK{constructor(e){this.parser=e,this.name=Bn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uf}extendMaterialParams(e,t){const i=this.parser,o=i.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const u=[],h=o.extensions[this.name];t.specularIntensity=h.specularFactor!==void 0?h.specularFactor:1,h.specularTexture!==void 0&&u.push(i.assignTexture(t,"specularIntensityMap",h.specularTexture));const r=h.specularColorFactor||[1,1,1];return t.specularColor=new Xi(r[0],r[1],r[2]),h.specularColorTexture!==void 0&&u.push(i.assignTexture(t,"specularColorMap",h.specularColorTexture,Cn)),Promise.all(u)}}class EK{constructor(e){this.parser=e,this.name=Bn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,o=i.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const u=o.extensions[this.name],h=t.options.ktx2Loader;if(!h){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,u.source,h)}}class wK{constructor(e){this.parser=e,this.name=Bn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,o=i.json,u=o.textures[e];if(!u.extensions||!u.extensions[t])return null;const h=u.extensions[t],r=o.images[h.source];let p=i.textureLoader;if(r.uri){const g=i.options.manager.getHandler(r.uri);g!==null&&(p=g)}return this.detectSupport().then(function(g){if(g)return i.loadTextureImage(e,h.source,p);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class bK{constructor(e){this.name=Bn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const o=i.extensions[this.name],u=this.parser.getDependency("buffer",o.buffer),h=this.parser.options.meshoptDecoder;if(!h||!h.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return u.then(function(r){const p=o.byteOffset||0,g=o.byteLength||0,v=o.count,I=o.byteStride,C=new Uint8Array(r,p,g);return h.decodeGltfBufferAsync?h.decodeGltfBufferAsync(v,I,C,o.mode,o.filter).then(function(E){return E.buffer}):h.ready.then(function(){const E=new ArrayBuffer(v*I);return h.decodeGltfBuffer(new Uint8Array(E),v,I,C,o.mode,o.filter),E})})}else return null}}class BK{constructor(e){this.name=Bn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const o=t.meshes[i.mesh];for(const g of o.primitives)if(g.mode!==sa.TRIANGLES&&g.mode!==sa.TRIANGLE_STRIP&&g.mode!==sa.TRIANGLE_FAN&&g.mode!==void 0)return null;const h=i.extensions[this.name].attributes,r=[],p={};for(const g in h)r.push(this.parser.getDependency("accessor",h[g]).then(v=>(p[g]=v,p[g])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(g=>{const v=g.pop(),I=v.isGroup?v.children:[v],C=g[0].count,E=[];for(const Q of I){const M=new sn,D=new rt,P=new Ll,O=new rt(1,1,1),F=new Mq(Q.geometry,Q.material,C);for(let N=0;N<C;N++)p.TRANSLATION&&D.fromBufferAttribute(p.TRANSLATION,N),p.ROTATION&&P.fromBufferAttribute(p.ROTATION,N),p.SCALE&&O.fromBufferAttribute(p.SCALE,N),F.setMatrixAt(N,M.compose(D,P,O));for(const N in p)N!=="TRANSLATION"&&N!=="ROTATION"&&N!=="SCALE"&&Q.geometry.setAttribute(N,p[N]);rr.prototype.copy.call(F,Q),F.frustumCulled=!1,this.parser.assignFinalMaterial(F),E.push(F)}return v.isGroup?(v.clear(),v.add(...E),v):E[0]}))}}const Lk="glTF",Nm=12,t3={JSON:1313821514,BIN:5130562};class SK{constructor(e){this.name=Bn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Nm),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Lk)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-Nm,u=new DataView(e,Nm);let h=0;for(;h<o;){const r=u.getUint32(h,!0);h+=4;const p=u.getUint32(h,!0);if(h+=4,p===t3.JSON){const g=new Uint8Array(e,Nm+h,r);this.content=i.decode(g)}else if(p===t3.BIN){const g=Nm+h;this.body=e.slice(g,g+r)}h+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class MK{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Bn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,o=this.dracoLoader,u=e.extensions[this.name].bufferView,h=e.extensions[this.name].attributes,r={},p={},g={};for(const v in h){const I=Kw[v]||v.toLowerCase();r[I]=h[v]}for(const v in e.attributes){const I=Kw[v]||v.toLowerCase();if(h[v]!==void 0){const C=i.accessors[e.attributes[v]],E=lA[C.componentType];g[I]=E.name,p[I]=C.normalized===!0}}return t.getDependency("bufferView",u).then(function(v){return new Promise(function(I){o.decodeDracoFile(v,function(C){for(const E in C.attributes){const Q=C.attributes[E],M=p[E];M!==void 0&&(Q.normalized=M)}I(C)},r,g)})})}}class TK{constructor(){this.name=Bn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class DK{constructor(){this.name=Bn.KHR_MESH_QUANTIZATION}}class Pk extends v0{constructor(e,t,i,o){super(e,t,i,o)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,o=this.valueSize,u=e*o*3+o;for(let h=0;h!==o;h++)t[h]=i[u+h];return t}interpolate_(e,t,i,o){const u=this.resultBuffer,h=this.sampleValues,r=this.valueSize,p=r*2,g=r*3,v=o-t,I=(i-t)/v,C=I*I,E=C*I,Q=e*g,M=Q-g,D=-2*E+3*C,P=E-C,O=1-D,F=P-C+I;for(let N=0;N!==r;N++){const z=h[M+N+r],X=h[M+N+p]*v,q=h[Q+N+r],H=h[Q+N]*v;u[N]=O*z+F*X+D*q+P*H}return u}}const QK=new Ll;class RK extends Pk{interpolate_(e,t,i,o){const u=super.interpolate_(e,t,i,o);return QK.fromArray(u).normalize().toArray(u),u}}const sa={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},lA={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},i3={9728:us,9729:$r,9984:Uw,9985:ak,9986:hx,9987:ch},n3={33071:po,33648:zx,10497:QA},ME={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Bu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},LK={CUBICSPLINE:void 0,LINEAR:LA,STEP:i0},TE={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function PK(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new ef({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:rl})),n.DefaultMaterial}function zm(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Fu(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function kK(n,e,t){let i=!1,o=!1,u=!1;for(let g=0,v=e.length;g<v;g++){const I=e[g];if(I.POSITION!==void 0&&(i=!0),I.NORMAL!==void 0&&(o=!0),I.COLOR_0!==void 0&&(u=!0),i&&o&&u)break}if(!i&&!o&&!u)return Promise.resolve(n);const h=[],r=[],p=[];for(let g=0,v=e.length;g<v;g++){const I=e[g];if(i){const C=I.POSITION!==void 0?t.getDependency("accessor",I.POSITION):n.attributes.position;h.push(C)}if(o){const C=I.NORMAL!==void 0?t.getDependency("accessor",I.NORMAL):n.attributes.normal;r.push(C)}if(u){const C=I.COLOR_0!==void 0?t.getDependency("accessor",I.COLOR_0):n.attributes.color;p.push(C)}}return Promise.all([Promise.all(h),Promise.all(r),Promise.all(p)]).then(function(g){const v=g[0],I=g[1],C=g[2];return i&&(n.morphAttributes.position=v),o&&(n.morphAttributes.normal=I),u&&(n.morphAttributes.color=C),n.morphTargetsRelative=!0,n})}function FK(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,o=t.length;i<o;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function NK(n){const e=n.extensions&&n.extensions[Bn.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+r3(e.attributes):t=n.indices+":"+r3(n.attributes)+":"+n.mode,t}function r3(n){let e="";const t=Object.keys(n).sort();for(let i=0,o=t.length;i<o;i++)e+=t[i]+":"+n[t[i]]+";";return e}function Jw(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function zK(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const UK=new sn;class OK{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fK,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,o=!1,u=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,o=navigator.userAgent.indexOf("Firefox")>-1,u=o?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||o&&u<98?this.textureLoader=new jq(this.options.manager):this.textureLoader=new $q(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new l0(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,o=this.json,u=this.extensions;this.cache.removeAll(),this._invokeAll(function(h){return h._markDefs&&h._markDefs()}),Promise.all(this._invokeAll(function(h){return h.beforeRoot&&h.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(h){const r={scene:h[0][o.scene||0],scenes:h[0],animations:h[1],cameras:h[2],asset:o.asset,parser:i,userData:{}};zm(u,r,o),Fu(r,o),Promise.all(i._invokeAll(function(p){return p.afterRoot&&p.afterRoot(r)})).then(function(){e(r)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let o=0,u=t.length;o<u;o++){const h=t[o].joints;for(let r=0,p=h.length;r<p;r++)e[h[r]].isBone=!0}for(let o=0,u=e.length;o<u;o++){const h=e[o];h.mesh!==void 0&&(this._addNodeRef(this.meshCache,h.mesh),h.skin!==void 0&&(i[h.mesh].isSkinnedMesh=!0)),h.camera!==void 0&&this._addNodeRef(this.cameraCache,h.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const o=i.clone(),u=(h,r)=>{const p=this.associations.get(h);p!=null&&this.associations.set(r,p);for(const[g,v]of h.children.entries())u(v,r.children[g])};return u(i,o),o.name+="_instance_"+e.uses[t]++,o}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const o=e(t[i]);if(o)return o}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let o=0;o<t.length;o++){const u=e(t[o]);u&&i.push(u)}return i}getDependency(e,t){const i=e+":"+t;let o=this.cache.get(i);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this._invokeOne(function(u){return u.loadNode&&u.loadNode(t)});break;case"mesh":o=this._invokeOne(function(u){return u.loadMesh&&u.loadMesh(t)});break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne(function(u){return u.loadBufferView&&u.loadBufferView(t)});break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne(function(u){return u.loadMaterial&&u.loadMaterial(t)});break;case"texture":o=this._invokeOne(function(u){return u.loadTexture&&u.loadTexture(t)});break;case"skin":o=this.loadSkin(t);break;case"animation":o=this._invokeOne(function(u){return u.loadAnimation&&u.loadAnimation(t)});break;case"camera":o=this.loadCamera(t);break;default:if(o=this._invokeOne(function(u){return u!=this&&u.getDependency&&u.getDependency(e,t)}),!o)throw new Error("Unknown type: "+e);break}this.cache.add(i,o)}return o}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(o.map(function(u,h){return i.getDependency(e,h)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Bn.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(u,h){i.load(jw.resolveURL(t.uri,o.path),u,void 0,function(){h(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const o=t.byteLength||0,u=t.byteOffset||0;return i.slice(u,u+o)})}loadAccessor(e){const t=this,i=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0){const h=ME[o.type],r=lA[o.componentType],p=o.normalized===!0,g=new r(o.count*h);return Promise.resolve(new es(g,h,p))}const u=[];return o.bufferView!==void 0?u.push(this.getDependency("bufferView",o.bufferView)):u.push(null),o.sparse!==void 0&&(u.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),u.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(u).then(function(h){const r=h[0],p=ME[o.type],g=lA[o.componentType],v=g.BYTES_PER_ELEMENT,I=v*p,C=o.byteOffset||0,E=o.bufferView!==void 0?i.bufferViews[o.bufferView].byteStride:void 0,Q=o.normalized===!0;let M,D;if(E&&E!==I){const P=Math.floor(C/E),O="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+P+":"+o.count;let F=t.cache.get(O);F||(M=new g(r,P*E,o.count*E/v),F=new Eq(M,E/v),t.cache.add(O,F)),D=new BB(F,p,C%E/v,Q)}else r===null?M=new g(o.count*p):M=new g(r,C,o.count*p),D=new es(M,p,Q);if(o.sparse!==void 0){const P=ME.SCALAR,O=lA[o.sparse.indices.componentType],F=o.sparse.indices.byteOffset||0,N=o.sparse.values.byteOffset||0,z=new O(h[1],F,o.sparse.count*P),X=new g(h[2],N,o.sparse.count*p);r!==null&&(D=new es(D.array.slice(),D.itemSize,D.normalized));for(let q=0,H=z.length;q<H;q++){const W=z[q];if(D.setX(W,X[q*p]),p>=2&&D.setY(W,X[q*p+1]),p>=3&&D.setZ(W,X[q*p+2]),p>=4&&D.setW(W,X[q*p+3]),p>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return D})}loadTexture(e){const t=this.json,i=this.options,u=t.textures[e].source,h=t.images[u];let r=this.textureLoader;if(h.uri){const p=i.manager.getHandler(h.uri);p!==null&&(r=p)}return this.loadTextureImage(e,u,r)}loadTextureImage(e,t,i){const o=this,u=this.json,h=u.textures[e],r=u.images[t],p=(r.uri||r.bufferView)+":"+h.sampler;if(this.textureCache[p])return this.textureCache[p];const g=this.loadImageSource(t,i).then(function(v){v.flipY=!1,v.name=h.name||r.name||"";const C=(u.samplers||{})[h.sampler]||{};return v.magFilter=i3[C.magFilter]||$r,v.minFilter=i3[C.minFilter]||ch,v.wrapS=n3[C.wrapS]||QA,v.wrapT=n3[C.wrapT]||QA,o.associations.set(v,{textures:e}),v}).catch(function(){return null});return this.textureCache[p]=g,g}loadImageSource(e,t){const i=this,o=this.json,u=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(I=>I.clone());const h=o.images[e],r=self.URL||self.webkitURL;let p=h.uri||"",g=!1;if(h.bufferView!==void 0)p=i.getDependency("bufferView",h.bufferView).then(function(I){g=!0;const C=new Blob([I],{type:h.mimeType});return p=r.createObjectURL(C),p});else if(h.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const v=Promise.resolve(p).then(function(I){return new Promise(function(C,E){let Q=C;t.isImageBitmapLoader===!0&&(Q=function(M){const D=new Cs(M);D.needsUpdate=!0,C(D)}),t.load(jw.resolveURL(I,u.path),Q,void 0,E)})}).then(function(I){return g===!0&&r.revokeObjectURL(p),I.userData.mimeType=h.mimeType||zK(h.uri),I}).catch(function(I){throw console.error("THREE.GLTFLoader: Couldn't load texture",p),I});return this.sourceCache[e]=v,v}assignTexture(e,t,i,o){const u=this;return this.getDependency("texture",i.index).then(function(h){if(!h)return null;if(i.texCoord!==void 0&&i.texCoord!=0&&!(t==="aoMap"&&i.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),u.extensions[Bn.KHR_TEXTURE_TRANSFORM]){const r=i.extensions!==void 0?i.extensions[Bn.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const p=u.associations.get(h);h=u.extensions[Bn.KHR_TEXTURE_TRANSFORM].extendTexture(h,r),u.associations.set(h,p)}}return o!==void 0&&(h.encoding=o),e[t]=h,h})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const o=t.attributes.tangent===void 0,u=t.attributes.color!==void 0,h=t.attributes.normal===void 0;if(e.isPoints){const r="PointsMaterial:"+i.uuid;let p=this.cache.get(r);p||(p=new Mk,_a.prototype.copy.call(p,i),p.color.copy(i.color),p.map=i.map,p.sizeAttenuation=!1,this.cache.add(r,p)),i=p}else if(e.isLine){const r="LineBasicMaterial:"+i.uuid;let p=this.cache.get(r);p||(p=new Sk,_a.prototype.copy.call(p,i),p.color.copy(i.color),this.cache.add(r,p)),i=p}if(o||u||h){let r="ClonedMaterial:"+i.uuid+":";o&&(r+="derivative-tangents:"),u&&(r+="vertex-colors:"),h&&(r+="flat-shading:");let p=this.cache.get(r);p||(p=i.clone(),u&&(p.vertexColors=!0),h&&(p.flatShading=!0),o&&(p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(r,p),this.associations.set(p,this.associations.get(i))),i=p}i.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return ef}loadMaterial(e){const t=this,i=this.json,o=this.extensions,u=i.materials[e];let h;const r={},p=u.extensions||{},g=[];if(p[Bn.KHR_MATERIALS_UNLIT]){const I=o[Bn.KHR_MATERIALS_UNLIT];h=I.getMaterialType(),g.push(I.extendParams(r,u,t))}else{const I=u.pbrMetallicRoughness||{};if(r.color=new Xi(1,1,1),r.opacity=1,Array.isArray(I.baseColorFactor)){const C=I.baseColorFactor;r.color.fromArray(C),r.opacity=C[3]}I.baseColorTexture!==void 0&&g.push(t.assignTexture(r,"map",I.baseColorTexture,Cn)),r.metalness=I.metallicFactor!==void 0?I.metallicFactor:1,r.roughness=I.roughnessFactor!==void 0?I.roughnessFactor:1,I.metallicRoughnessTexture!==void 0&&(g.push(t.assignTexture(r,"metalnessMap",I.metallicRoughnessTexture)),g.push(t.assignTexture(r,"roughnessMap",I.metallicRoughnessTexture))),h=this._invokeOne(function(C){return C.getMaterialType&&C.getMaterialType(e)}),g.push(Promise.all(this._invokeAll(function(C){return C.extendMaterialParams&&C.extendMaterialParams(e,r)})))}u.doubleSided===!0&&(r.side=fa);const v=u.alphaMode||TE.OPAQUE;if(v===TE.BLEND?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,v===TE.MASK&&(r.alphaTest=u.alphaCutoff!==void 0?u.alphaCutoff:.5)),u.normalTexture!==void 0&&h!==ju&&(g.push(t.assignTexture(r,"normalMap",u.normalTexture)),r.normalScale=new Yi(1,1),u.normalTexture.scale!==void 0)){const I=u.normalTexture.scale;r.normalScale.set(I,I)}return u.occlusionTexture!==void 0&&h!==ju&&(g.push(t.assignTexture(r,"aoMap",u.occlusionTexture)),u.occlusionTexture.strength!==void 0&&(r.aoMapIntensity=u.occlusionTexture.strength)),u.emissiveFactor!==void 0&&h!==ju&&(r.emissive=new Xi().fromArray(u.emissiveFactor)),u.emissiveTexture!==void 0&&h!==ju&&g.push(t.assignTexture(r,"emissiveMap",u.emissiveTexture,Cn)),Promise.all(g).then(function(){const I=new h(r);return u.name&&(I.name=u.name),Fu(I,u),t.associations.set(I,{materials:e}),u.extensions&&zm(o,I,u),I})}createUniqueName(e){const t=Wn.sanitizeNodeName(e||"");let i=t;for(let o=1;this.nodeNamesUsed[i];++o)i=t+"_"+o;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,o=this.primitiveCache;function u(r){return i[Bn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,t).then(function(p){return s3(p,r,t)})}const h=[];for(let r=0,p=e.length;r<p;r++){const g=e[r],v=NK(g),I=o[v];if(I)h.push(I.promise);else{let C;g.extensions&&g.extensions[Bn.KHR_DRACO_MESH_COMPRESSION]?C=u(g):C=s3(new Oo,g,t),o[v]={primitive:g,promise:C},h.push(C)}}return Promise.all(h)}loadMesh(e){const t=this,i=this.json,o=this.extensions,u=i.meshes[e],h=u.primitives,r=[];for(let p=0,g=h.length;p<g;p++){const v=h[p].material===void 0?PK(this.cache):this.getDependency("material",h[p].material);r.push(v)}return r.push(t.loadGeometries(h)),Promise.all(r).then(function(p){const g=p.slice(0,p.length-1),v=p[p.length-1],I=[];for(let E=0,Q=v.length;E<Q;E++){const M=v[E],D=h[E];let P;const O=g[E];if(D.mode===sa.TRIANGLES||D.mode===sa.TRIANGLE_STRIP||D.mode===sa.TRIANGLE_FAN||D.mode===void 0)P=u.isSkinnedMesh===!0?new bq(M,O):new nr(M,O),P.isSkinnedMesh===!0&&!P.geometry.attributes.skinWeight.normalized&&P.normalizeSkinWeights(),D.mode===sa.TRIANGLE_STRIP?P.geometry=e3(P.geometry,ck):D.mode===sa.TRIANGLE_FAN&&(P.geometry=e3(P.geometry,Ow));else if(D.mode===sa.LINES)P=new Tq(M,O);else if(D.mode===sa.LINE_STRIP)P=new MB(M,O);else if(D.mode===sa.LINE_LOOP)P=new Dq(M,O);else if(D.mode===sa.POINTS)P=new Qq(M,O);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+D.mode);Object.keys(P.geometry.morphAttributes).length>0&&FK(P,u),P.name=t.createUniqueName(u.name||"mesh_"+e),Fu(P,u),D.extensions&&zm(o,P,D),t.assignFinalMaterial(P),I.push(P)}for(let E=0,Q=I.length;E<Q;E++)t.associations.set(I[E],{meshes:e,primitives:E});if(I.length===1)return I[0];const C=new Md;t.associations.set(C,{meshes:e});for(let E=0,Q=I.length;E<Q;E++)C.add(I[E]);return C})}loadCamera(e){let t;const i=this.json.cameras[e],o=i[i.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new ds(E9.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):i.type==="orthographic"&&(t=new wB(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Fu(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let o=0,u=t.joints.length;o<u;o++)i.push(this.getDependency("node",t.joints[o]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(o){const u=o.pop(),h=o,r=[],p=[];for(let g=0,v=h.length;g<v;g++){const I=h[g];if(I){r.push(I);const C=new sn;u!==null&&C.fromArray(u.array,g*16),p.push(C)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[g])}return new SB(r,p)})}loadAnimation(e){const i=this.json.animations[e],o=[],u=[],h=[],r=[],p=[];for(let g=0,v=i.channels.length;g<v;g++){const I=i.channels[g],C=i.samplers[I.sampler],E=I.target,Q=E.node,M=i.parameters!==void 0?i.parameters[C.input]:C.input,D=i.parameters!==void 0?i.parameters[C.output]:C.output;o.push(this.getDependency("node",Q)),u.push(this.getDependency("accessor",M)),h.push(this.getDependency("accessor",D)),r.push(C),p.push(E)}return Promise.all([Promise.all(o),Promise.all(u),Promise.all(h),Promise.all(r),Promise.all(p)]).then(function(g){const v=g[0],I=g[1],C=g[2],E=g[3],Q=g[4],M=[];for(let P=0,O=v.length;P<O;P++){const F=v[P],N=I[P],z=C[P],X=E[P],q=Q[P];if(F===void 0)continue;F.updateMatrix();let H;switch(Bu[q.path]){case Bu.weights:H=o0;break;case Bu.rotation:H=tf;break;case Bu.position:case Bu.scale:default:H=a0;break}const W=F.name?F.name:F.uuid,se=X.interpolation!==void 0?LK[X.interpolation]:LA,de=[];Bu[q.path]===Bu.weights?F.traverse(function(ce){ce.morphTargetInfluences&&de.push(ce.name?ce.name:ce.uuid)}):de.push(W);let te=z.array;if(z.normalized){const ce=Jw(te.constructor),Ee=new Float32Array(te.length);for(let Be=0,De=te.length;Be<De;Be++)Ee[Be]=te[Be]*ce;te=Ee}for(let ce=0,Ee=de.length;ce<Ee;ce++){const Be=new H(de[ce]+"."+Bu[q.path],N.array,te,se);X.interpolation==="CUBICSPLINE"&&(Be.createInterpolant=function(Re){const ye=this instanceof tf?RK:Pk;return new ye(this.times,this.values,this.getValueSize()/3,Re)},Be.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),M.push(Be)}}const D=i.name?i.name:"animation_"+e;return new zq(D,void 0,M)})}createNodeMesh(e){const t=this.json,i=this,o=t.nodes[e];return o.mesh===void 0?null:i.getDependency("mesh",o.mesh).then(function(u){const h=i._getNodeRef(i.meshCache,o.mesh,u);return o.weights!==void 0&&h.traverse(function(r){if(r.isMesh)for(let p=0,g=o.weights.length;p<g;p++)r.morphTargetInfluences[p]=o.weights[p]}),h})}loadNode(e){const t=this.json,i=this.extensions,o=this,u=t.nodes[e],h=u.name?o.createUniqueName(u.name):"";return function(){const r=[],p=o._invokeOne(function(C){return C.createNodeMesh&&C.createNodeMesh(e)});p&&r.push(p),u.camera!==void 0&&r.push(o.getDependency("camera",u.camera).then(function(C){return o._getNodeRef(o.cameraCache,u.camera,C)})),o._invokeAll(function(C){return C.createNodeAttachment&&C.createNodeAttachment(e)}).forEach(function(C){r.push(C)});const g=[],v=u.children||[];for(let C=0,E=v.length;C<E;C++)g.push(o.getDependency("node",v[C]));const I=u.skin===void 0?Promise.resolve(null):o.getDependency("skin",u.skin);return Promise.all([Promise.all(r),Promise.all(g),I])}().then(function(r){const p=r[0],g=r[1],v=r[2];let I;if(u.isBone===!0?I=new bk:p.length>1?I=new Md:p.length===1?I=p[0]:I=new rr,I!==p[0])for(let C=0,E=p.length;C<E;C++)I.add(p[C]);if(u.name&&(I.userData.name=u.name,I.name=h),Fu(I,u),u.extensions&&zm(i,I,u),u.matrix!==void 0){const C=new sn;C.fromArray(u.matrix),I.applyMatrix4(C)}else u.translation!==void 0&&I.position.fromArray(u.translation),u.rotation!==void 0&&I.quaternion.fromArray(u.rotation),u.scale!==void 0&&I.scale.fromArray(u.scale);o.associations.has(I)||o.associations.set(I,{}),o.associations.get(I).nodes=e,v!==null&&I.traverse(function(C){C.isSkinnedMesh&&C.bind(v,UK)});for(let C=0,E=g.length;C<E;C++)I.add(g[C]);return I})}loadScene(e){const t=this.extensions,i=this.json.scenes[e],o=this,u=new Md;i.name&&(u.name=o.createUniqueName(i.name)),Fu(u,i),i.extensions&&zm(t,u,i);const h=i.nodes||[],r=[];for(let p=0,g=h.length;p<g;p++)r.push(o.getDependency("node",h[p]));return Promise.all(r).then(function(p){for(let v=0,I=p.length;v<I;v++)u.add(p[v]);const g=v=>{const I=new Map;for(const[C,E]of o.associations)(C instanceof _a||C instanceof Cs)&&I.set(C,E);return v.traverse(C=>{const E=o.associations.get(C);E!=null&&I.set(C,E)}),I};return o.associations=g(u),u})}}function GK(n,e,t){const i=e.attributes,o=new xa;if(i.POSITION!==void 0){const r=t.json.accessors[i.POSITION],p=r.min,g=r.max;if(p!==void 0&&g!==void 0){if(o.set(new rt(p[0],p[1],p[2]),new rt(g[0],g[1],g[2])),r.normalized){const v=Jw(lA[r.componentType]);o.min.multiplyScalar(v),o.max.multiplyScalar(v)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const u=e.targets;if(u!==void 0){const r=new rt,p=new rt;for(let g=0,v=u.length;g<v;g++){const I=u[g];if(I.POSITION!==void 0){const C=t.json.accessors[I.POSITION],E=C.min,Q=C.max;if(E!==void 0&&Q!==void 0){if(p.setX(Math.max(Math.abs(E[0]),Math.abs(Q[0]))),p.setY(Math.max(Math.abs(E[1]),Math.abs(Q[1]))),p.setZ(Math.max(Math.abs(E[2]),Math.abs(Q[2]))),C.normalized){const M=Jw(lA[C.componentType]);p.multiplyScalar(M)}r.max(p)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(r)}n.boundingBox=o;const h=new cf;o.getCenter(h.center),h.radius=o.min.distanceTo(o.max)/2,n.boundingSphere=h}function s3(n,e,t){const i=e.attributes,o=[];function u(h,r){return t.getDependency("accessor",h).then(function(p){n.setAttribute(r,p)})}for(const h in i){const r=Kw[h]||h.toLowerCase();r in n.attributes||o.push(u(i[h],r))}if(e.indices!==void 0&&!n.index){const h=t.getDependency("accessor",e.indices).then(function(r){n.setIndex(r)});o.push(h)}return Fu(n,e),GK(n,e,t),Promise.all(o).then(function(){return e.targets!==void 0?kK(n,e.targets,t):n})}const DE=new WeakMap;class B1 extends hf{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,o){const u=new l0(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,h=>{this.decodeDracoFile(h,t).catch(o)},i,o)}decodeDracoFile(e,t,i,o){const u={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,u).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(DE.has(e)){const p=DE.get(e);if(p.key===i)return p.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const u=this.workerNextTaskID++,h=e.byteLength,r=this._getWorker(u,h).then(p=>(o=p,new Promise((g,v)=>{o._callbacks[u]={resolve:g,reject:v},o.postMessage({type:"decode",id:u,taskConfig:t,buffer:e},[e])}))).then(p=>this._createGeometry(p.geometry));return r.catch(()=>!0).then(()=>{o&&u&&this._releaseTask(o,u)}),DE.set(e,{key:i,promise:r}),r}_createGeometry(e){const t=new Oo;e.index&&t.setIndex(new es(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const o=e.attributes[i],u=o.name,h=o.array,r=o.itemSize;t.setAttribute(u,new es(h,r))}return t}_loadLibrary(e,t){const i=new l0(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((o,u)=>{i.load(e,o,void 0,u)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const o=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const u=HK.toString(),h=["/* draco decoder */",o,"","/* worker */",u.substring(u.indexOf("{")+1,u.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([h]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const o=new Worker(this.workerSourceURL);o._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:this.decoderConfig}),o.onmessage=function(u){const h=u.data;switch(h.type){case"decode":o._callbacks[h.id].resolve(h);break;case"error":o._callbacks[h.id].reject(h);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+h.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,u){return o._taskLoad>u._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function HK(){let n,e;onmessage=function(h){const r=h.data;switch(r.type){case"init":n=r.decoderConfig,e=new Promise(function(v){n.onModuleLoaded=function(I){v({draco:I})},DracoDecoderModule(n)});break;case"decode":const p=r.buffer,g=r.taskConfig;e.then(v=>{const I=v.draco,C=new I.Decoder,E=new I.DecoderBuffer;E.Init(new Int8Array(p),p.byteLength);try{const Q=t(I,C,E,g),M=Q.attributes.map(D=>D.array.buffer);Q.index&&M.push(Q.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:Q},M)}catch(Q){console.error(Q),self.postMessage({type:"error",id:r.id,error:Q.message})}finally{I.destroy(E),I.destroy(C)}});break}};function t(h,r,p,g){const v=g.attributeIDs,I=g.attributeTypes;let C,E;const Q=r.GetEncodedGeometryType(p);if(Q===h.TRIANGULAR_MESH)C=new h.Mesh,E=r.DecodeBufferToMesh(p,C);else if(Q===h.POINT_CLOUD)C=new h.PointCloud,E=r.DecodeBufferToPointCloud(p,C);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!E.ok()||C.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+E.error_msg());const M={index:null,attributes:[]};for(const D in v){const P=self[I[D]];let O,F;if(g.useUniqueIDs)F=v[D],O=r.GetAttributeByUniqueId(C,F);else{if(F=r.GetAttributeId(C,h[v[D]]),F===-1)continue;O=r.GetAttribute(C,F)}M.attributes.push(o(h,r,C,D,P,O))}return Q===h.TRIANGULAR_MESH&&(M.index=i(h,r,C)),h.destroy(C),M}function i(h,r,p){const v=p.num_faces()*3,I=v*4,C=h._malloc(I);r.GetTrianglesUInt32Array(p,I,C);const E=new Uint32Array(h.HEAPF32.buffer,C,v).slice();return h._free(C),{array:E,itemSize:1}}function o(h,r,p,g,v,I){const C=I.num_components(),Q=p.num_points()*C,M=Q*v.BYTES_PER_ELEMENT,D=u(h,v),P=h._malloc(M);r.GetAttributeDataArrayForAllPoints(p,I,D,M,P);const O=new v(h.HEAPF32.buffer,P,Q).slice();return h._free(P),{name:g,array:O,itemSize:C}}function u(h,r){switch(r){case Float32Array:return h.DT_FLOAT32;case Int8Array:return h.DT_INT8;case Int16Array:return h.DT_INT16;case Int32Array:return h.DT_INT32;case Uint8Array:return h.DT_UINT8;case Uint16Array:return h.DT_UINT16;case Uint32Array:return h.DT_UINT32}}}class S1 extends Yq{constructor(e){super(e),this.type=Ec}parse(e){const r=function(F,N){switch(F){case 1:console.error("THREE.RGBELoader Read Error: "+(N||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(N||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(N||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(N||""))}return-1},I=`
`,C=function(F,N,z){N=N||1024;let q=F.pos,H=-1,W=0,se="",de=String.fromCharCode.apply(null,new Uint16Array(F.subarray(q,q+128)));for(;0>(H=de.indexOf(I))&&W<N&&q<F.byteLength;)se+=de,W+=de.length,q+=128,de+=String.fromCharCode.apply(null,new Uint16Array(F.subarray(q,q+128)));return-1<H?(z!==!1&&(F.pos+=W+H+1),se+de.slice(0,H)):!1},E=function(F){const N=/^#\?(\S+)/,z=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,X=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,q=/^\s*FORMAT=(\S+)\s*$/,H=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,W={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let se,de;if(F.pos>=F.byteLength||!(se=C(F)))return r(1,"no header found");if(!(de=se.match(N)))return r(3,"bad initial token");for(W.valid|=1,W.programtype=de[1],W.string+=se+`
`;se=C(F),se!==!1;){if(W.string+=se+`
`,se.charAt(0)==="#"){W.comments+=se+`
`;continue}if((de=se.match(z))&&(W.gamma=parseFloat(de[1])),(de=se.match(X))&&(W.exposure=parseFloat(de[1])),(de=se.match(q))&&(W.valid|=2,W.format=de[1]),(de=se.match(H))&&(W.valid|=4,W.height=parseInt(de[1],10),W.width=parseInt(de[2],10)),W.valid&2&&W.valid&4)break}return W.valid&2?W.valid&4?W:r(3,"missing image size specifier"):r(3,"missing format specifier")},Q=function(F,N,z){const X=N;if(X<8||X>32767||F[0]!==2||F[1]!==2||F[2]&128)return new Uint8Array(F);if(X!==(F[2]<<8|F[3]))return r(3,"wrong scanline width");const q=new Uint8Array(4*N*z);if(!q.length)return r(4,"unable to allocate buffer space");let H=0,W=0;const se=4*X,de=new Uint8Array(4),te=new Uint8Array(se);let ce=z;for(;ce>0&&W<F.byteLength;){if(W+4>F.byteLength)return r(1);if(de[0]=F[W++],de[1]=F[W++],de[2]=F[W++],de[3]=F[W++],de[0]!=2||de[1]!=2||(de[2]<<8|de[3])!=X)return r(3,"bad rgbe scanline format");let Ee=0,Be;for(;Ee<se&&W<F.byteLength;){Be=F[W++];const Re=Be>128;if(Re&&(Be-=128),Be===0||Ee+Be>se)return r(3,"bad scanline data");if(Re){const ye=F[W++];for(let ht=0;ht<Be;ht++)te[Ee++]=ye}else te.set(F.subarray(W,W+Be),Ee),Ee+=Be,W+=Be}const De=X;for(let Re=0;Re<De;Re++){let ye=0;q[H]=te[Re+ye],ye+=X,q[H+1]=te[Re+ye],ye+=X,q[H+2]=te[Re+ye],ye+=X,q[H+3]=te[Re+ye],H+=4}ce--}return q},M=function(F,N,z,X){const q=F[N+3],H=Math.pow(2,q-128)/255;z[X+0]=F[N+0]*H,z[X+1]=F[N+1]*H,z[X+2]=F[N+2]*H,z[X+3]=1},D=function(F,N,z,X){const q=F[N+3],H=Math.pow(2,q-128)/255;z[X+0]=Nv.toHalfFloat(Math.min(F[N+0]*H,65504)),z[X+1]=Nv.toHalfFloat(Math.min(F[N+1]*H,65504)),z[X+2]=Nv.toHalfFloat(Math.min(F[N+2]*H,65504)),z[X+3]=Nv.toHalfFloat(1)},P=new Uint8Array(e);P.pos=0;const O=E(P);if(O!==-1){const F=O.width,N=O.height,z=Q(P.subarray(P.pos),F,N);if(z!==-1){let X,q,H;switch(this.type){case Za:H=z.length/4;const W=new Float32Array(H*4);for(let de=0;de<H;de++)M(z,de*4,W,de*4);X=W,q=Za;break;case Ec:H=z.length/4;const se=new Uint16Array(H*4);for(let de=0;de<H;de++)D(z,de*4,se,de*4);X=se,q=Ec;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:F,height:N,data:X,header:O.string,gamma:O.gamma,exposure:O.exposure,type:q}}}return null}setDataType(e){return this.type=e,this}load(e,t,i,o){function u(h,r){switch(h.type){case Za:case Ec:h.encoding=uh,h.minFilter=$r,h.magFilter=$r,h.generateMipmaps=!1,h.flipY=!0;break}t&&t(h,r)}return super.load(e,u,i,o)}}const VK=kn({__name:"FaceBackground",emits:["scene-ready"],setup(n,{emit:e}){const t=hB(),i=Fc(),{orientation:o}=No(t),{isMobileDevice:u,getCurrentColor:h}=No(i),r=Gt(null),p=Gt(),g=Gt(),v=Gt(),I=Gt(),C=Gt(),E=Gt({x:0,y:0}),Q=F=>{E.value.x=F.pageX-window.innerWidth/2,E.value.y=F.pageY-window.innerHeight/2},M=()=>{var z;p.value=new ds(60,window.innerWidth/window.innerHeight,.01,100),p.value.position.z=1,p.value.focalLength=3,g.value=new C1;const F=new B1;F.setDecoderPath("/libs/draco/"),new S1().setPath("/images/").load("empty_warehouse_01_1k.hdr",X=>{X.mapping=Jd,g.value.environment=X,D();const q=new b1().setPath("/models/");q.setDRACOLoader(F),q.load("face5.glb",H=>{e("scene-ready",!0),I.value=H.scene,I.value.traverse(se=>{se.isMesh&&(se.material.color.set(Number("0x"+h.value.slice(1))),se.material.roughness=.1),se.isGeometry&&se.geometry.computeVertexNormals(!0)}),I.value.scale.set(20,20,20),I.value.position.set(1,-.5,0),I.value.rotation.x=-1;const W=new DB(1048575,1,1);W.position.set(5,0,1),g.value.add(W),g.value.add(I.value),D()})}),v.value=new y0({antialias:!0,alpha:!0}),v.value.setClearColor(0,0),v.value.setPixelRatio(window.devicePixelRatio),v.value.setSize(window.innerWidth,window.innerHeight),v.value.outputEncoding=Cn,(z=r.value)==null||z.appendChild(v.value.domElement),C.value=new w1(p.value,v.value.domElement),C.value.addEventListener("change",D),C.value.minDistance=0,C.value.maxDistance=10,C.value.target.set(1,0,0),C.value.update();const N=()=>{I.value&&(u.value()?(I.value.rotation.x=O(I.value.rotation.x,(o.value.b??0)/300-.1,.075),I.value.rotation.y=O(I.value.rotation.y,(o.value.g??0)/300,.075)):(I.value.rotation.x=O(I.value.rotation.x,E.value.y/(3*window.innerWidth),.075),I.value.rotation.y=O(I.value.rotation.y,E.value.x/(3*window.innerHeight),.075))),g.value&&p.value&&(requestAnimationFrame(N),v.value.render(rn(g.value),p.value),C.value.update())};N(),window.addEventListener("resize",P)},D=()=>{p.value.lookAt(g.value.position),v.value.render(rn(g.value),p.value)},P=()=>{p.value.aspect=window.innerWidth/window.innerHeight,p.value.updateProjectionMatrix(),v.value.setSize(window.innerWidth,window.innerHeight),D()},O=(F,N,z)=>(1-z)*F+z*N;return qi(h,F=>{I.value&&I.value.traverse(N=>{N.isMesh&&N.material.color.set(Number("0x"+F.slice(1))),N.isGeometry&&N.geometry.computeVertexNormals(!0)})}),Br(()=>{M(),D(),window.addEventListener("mousemove",Q)}),of(()=>{var F;if(window.removeEventListener("mousemove",Q),window.removeEventListener("resize",P),C.value.removeEventListener("change",D),p.value&&(p.value=null),g.value&&(g.value.traverse(N=>{N instanceof nr&&(N.material&&N.material.dispose(),N.geometry&&N.geometry.dispose())}),g.value=null),v.value){const N=v.value.domElement;(F=N.parentNode)==null||F.removeChild(N),v.value.dispose(),v.value=null}I.value&&(I.value.traverse(N=>{N instanceof nr&&(N.material&&N.material.dispose(),N.geometry&&N.geometry.dispose())}),g.value&&g.value.remove(I.value),I.value=null)}),(F,N)=>(Qi(),tn("div",{ref_key:"faceBackground",ref:r,class:mn(["face-bg",{"mobile-overlay":Bi(u)()}])},null,2))}});const WK=ns(VK,[["__scopeId","data-v-6a6b6eb5"]]),YK={class:"loading-wrapper"},jK={key:0},qK=kn({__name:"Loading",props:{isMobile:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0}},emits:["grant-permission"],setup(n,{emit:e}){const{setOrientation:t}=hB();function i(p){t(p.alpha,p.beta,p.gamma)}let o=!1;function u(){DeviceMotionEvent&&typeof DeviceMotionEvent.requestPermission=="function"&&DeviceMotionEvent.requestPermission(),o?(window.removeEventListener("deviceorientation",i),o=!1):(window.addEventListener("deviceorientation",i),o=!0)}function h(){e("grant-permission",!0),u()}function r(){e("grant-permission",!0)}return Br(()=>{}),(p,g)=>(Qi(),tn("div",YK,[Di(kU,null,{default:Fs(()=>[n.isMobile&&!n.isLoading?(Qi(),tn("div",jK,[Yt("button",{class:"cta__button",onClick:g[0]||(g[0]=v=>h())}," Give me full experience "),Yt("button",{class:"cta__button",onClick:g[1]||(g[1]=v=>r())}," Just let me in ")])):rh("",!0)]),_:1})]))}});const KK=ns(qK,[["__scopeId","data-v-2c3663da"]]);class Cl{constructor(e,t={}){if(!(e instanceof Node))throw"Can't initialize VanillaTilt because "+e+" is not a Node.";this.width=null,this.height=null,this.clientWidth=null,this.clientHeight=null,this.left=null,this.top=null,this.gammazero=null,this.betazero=null,this.lastgammazero=null,this.lastbetazero=null,this.transitionTimeout=null,this.updateCall=null,this.event=null,this.updateBind=this.update.bind(this),this.resetBind=this.reset.bind(this),this.element=e,this.settings=this.extendSettings(t),this.reverse=this.settings.reverse?-1:1,this.resetToStart=Cl.isSettingTrue(this.settings["reset-to-start"]),this.glare=Cl.isSettingTrue(this.settings.glare),this.glarePrerender=Cl.isSettingTrue(this.settings["glare-prerender"]),this.fullPageListening=Cl.isSettingTrue(this.settings["full-page-listening"]),this.gyroscope=Cl.isSettingTrue(this.settings.gyroscope),this.gyroscopeSamples=this.settings.gyroscopeSamples,this.elementListener=this.getElementListener(),this.glare&&this.prepareGlare(),this.fullPageListening&&this.updateClientSize(),this.addEventListeners(),this.reset(),this.resetToStart===!1&&(this.settings.startX=0,this.settings.startY=0)}static isSettingTrue(e){return e===""||e===!0||e===1}getElementListener(){if(this.fullPageListening)return window.document;if(typeof this.settings["mouse-event-element"]=="string"){const e=document.querySelector(this.settings["mouse-event-element"]);if(e)return e}return this.settings["mouse-event-element"]instanceof Node?this.settings["mouse-event-element"]:this.element}addEventListeners(){this.onMouseEnterBind=this.onMouseEnter.bind(this),this.onMouseMoveBind=this.onMouseMove.bind(this),this.onMouseLeaveBind=this.onMouseLeave.bind(this),this.onWindowResizeBind=this.onWindowResize.bind(this),this.onDeviceOrientationBind=this.onDeviceOrientation.bind(this),this.elementListener.addEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.addEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.addEventListener("mousemove",this.onMouseMoveBind),(this.glare||this.fullPageListening)&&window.addEventListener("resize",this.onWindowResizeBind),this.gyroscope&&window.addEventListener("deviceorientation",this.onDeviceOrientationBind)}removeEventListeners(){this.elementListener.removeEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.removeEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.removeEventListener("mousemove",this.onMouseMoveBind),this.gyroscope&&window.removeEventListener("deviceorientation",this.onDeviceOrientationBind),(this.glare||this.fullPageListening)&&window.removeEventListener("resize",this.onWindowResizeBind)}destroy(){clearTimeout(this.transitionTimeout),this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.reset(),this.removeEventListeners(),this.element.vanillaTilt=null,delete this.element.vanillaTilt,this.element=null}onDeviceOrientation(e){if(e.gamma===null||e.beta===null)return;this.updateElementPosition(),this.gyroscopeSamples>0&&(this.lastgammazero=this.gammazero,this.lastbetazero=this.betazero,this.gammazero===null?(this.gammazero=e.gamma,this.betazero=e.beta):(this.gammazero=(e.gamma+this.lastgammazero)/2,this.betazero=(e.beta+this.lastbetazero)/2),this.gyroscopeSamples-=1);const t=this.settings.gyroscopeMaxAngleX-this.settings.gyroscopeMinAngleX,i=this.settings.gyroscopeMaxAngleY-this.settings.gyroscopeMinAngleY,o=t/this.width,u=i/this.height,h=e.gamma-(this.settings.gyroscopeMinAngleX+this.gammazero),r=e.beta-(this.settings.gyroscopeMinAngleY+this.betazero),p=h/o,g=r/u;this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.event={clientX:p+this.left,clientY:g+this.top},this.updateCall=requestAnimationFrame(this.updateBind)}onMouseEnter(){this.updateElementPosition(),this.element.style.willChange="transform",this.setTransition()}onMouseMove(e){this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.event=e,this.updateCall=requestAnimationFrame(this.updateBind)}onMouseLeave(){this.setTransition(),this.settings.reset&&requestAnimationFrame(this.resetBind)}reset(){this.onMouseEnter(),this.fullPageListening?this.event={clientX:(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.clientWidth,clientY:(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.clientHeight}:this.event={clientX:this.left+(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.width,clientY:this.top+(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.height};let e=this.settings.scale;this.settings.scale=1,this.update(),this.settings.scale=e,this.resetGlare()}resetGlare(){this.glare&&(this.glareElement.style.transform="rotate(180deg) translate(-50%, -50%)",this.glareElement.style.opacity="0")}getValues(){let e,t;this.fullPageListening?(e=this.event.clientX/this.clientWidth,t=this.event.clientY/this.clientHeight):(e=(this.event.clientX-this.left)/this.width,t=(this.event.clientY-this.top)/this.height),e=Math.min(Math.max(e,0),1),t=Math.min(Math.max(t,0),1);let i=(this.reverse*(this.settings.max-e*this.settings.max*2)).toFixed(2),o=(this.reverse*(t*this.settings.max*2-this.settings.max)).toFixed(2),u=Math.atan2(this.event.clientX-(this.left+this.width/2),-(this.event.clientY-(this.top+this.height/2)))*(180/Math.PI);return{tiltX:i,tiltY:o,percentageX:e*100,percentageY:t*100,angle:u}}updateElementPosition(){let e=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=e.left,this.top=e.top}update(){let e=this.getValues();this.element.style.transform="perspective("+this.settings.perspective+"px) rotateX("+(this.settings.axis==="x"?0:e.tiltY)+"deg) rotateY("+(this.settings.axis==="y"?0:e.tiltX)+"deg) scale3d("+this.settings.scale+", "+this.settings.scale+", "+this.settings.scale+")",this.glare&&(this.glareElement.style.transform=`rotate(${e.angle}deg) translate(-50%, -50%)`,this.glareElement.style.opacity=`${e.percentageY*this.settings["max-glare"]/100}`),this.element.dispatchEvent(new CustomEvent("tiltChange",{detail:e})),this.updateCall=null}prepareGlare(){if(!this.glarePrerender){const e=document.createElement("div");e.classList.add("js-tilt-glare");const t=document.createElement("div");t.classList.add("js-tilt-glare-inner"),e.appendChild(t),this.element.appendChild(e)}this.glareElementWrapper=this.element.querySelector(".js-tilt-glare"),this.glareElement=this.element.querySelector(".js-tilt-glare-inner"),!this.glarePrerender&&(Object.assign(this.glareElementWrapper.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden","pointer-events":"none","border-radius":"inherit"}),Object.assign(this.glareElement.style,{position:"absolute",top:"50%",left:"50%","pointer-events":"none","background-image":"linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)",transform:"rotate(180deg) translate(-50%, -50%)","transform-origin":"0% 0%",opacity:"0"}),this.updateGlareSize())}updateGlareSize(){if(this.glare){const e=(this.element.offsetWidth>this.element.offsetHeight?this.element.offsetWidth:this.element.offsetHeight)*2;Object.assign(this.glareElement.style,{width:`${e}px`,height:`${e}px`})}}updateClientSize(){this.clientWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.clientHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}onWindowResize(){this.updateGlareSize(),this.updateClientSize()}setTransition(){clearTimeout(this.transitionTimeout),this.element.style.transition=this.settings.speed+"ms "+this.settings.easing,this.glare&&(this.glareElement.style.transition=`opacity ${this.settings.speed}ms ${this.settings.easing}`),this.transitionTimeout=setTimeout(()=>{this.element.style.transition="",this.glare&&(this.glareElement.style.transition="")},this.settings.speed)}extendSettings(e){let t={reverse:!1,max:15,startX:0,startY:0,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:1,speed:300,transition:!0,axis:null,glare:!1,"max-glare":1,"glare-prerender":!1,"full-page-listening":!1,"mouse-event-element":null,reset:!0,"reset-to-start":!0,gyroscope:!0,gyroscopeMinAngleX:-45,gyroscopeMaxAngleX:45,gyroscopeMinAngleY:-45,gyroscopeMaxAngleY:45,gyroscopeSamples:10},i={};for(var o in t)if(o in e)i[o]=e[o];else if(this.element.hasAttribute("data-tilt-"+o)){let u=this.element.getAttribute("data-tilt-"+o);try{i[o]=JSON.parse(u)}catch{i[o]=u}}else i[o]=t[o];return i}static init(e,t){e instanceof Node&&(e=[e]),e instanceof NodeList&&(e=[].slice.call(e)),e instanceof Array&&e.forEach(i=>{"vanillaTilt"in i||(i.vanillaTilt=new Cl(i,t))})}}typeof document<"u"&&(window.VanillaTilt=Cl,Cl.init(document.querySelectorAll("[data-tilt]")));const JK=kn({__name:"HeadView",setup(n){const e=Fc(),{isMobileDevice:t}=No(e),i=Gt(!0),o=Gt(!0);return qi(i,u=>{u||Gr(()=>{const h=document.querySelectorAll(".hoverable");Cl.init(h,{max:25,speed:400,scale:t.value()?1:1.125,glare:!t.value(),gyroscope:t.value()})})}),(u,h)=>(Qi(),tn(ir,null,[Di(AA,null,{default:Fs(()=>[H_(Di(KK,{onGrantPermission:h[0]||(h[0]=r=>o.value=!r),"is-mobile":Bi(t)(),"is-loading":i.value},null,8,["is-mobile","is-loading"]),[[Ob,i.value&&Bi(t)()||o.value&&Bi(t)()]])]),_:1}),Di(AV,{id:"scroll-section"}),Di(WK,{onSceneReady:h[1]||(h[1]=r=>i.value=!r)})],64))}});const XK=ns(JK,[["__scopeId","data-v-7bba476e"]]);var ZK=Object.defineProperty,$K=(n,e,t)=>e in n?ZK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ai=(n,e,t)=>($K(n,typeof e!="symbol"?e+"":e,t),t);function eJ(n){let e=0,t;for(let i=0,o=n.length;i<o;i++)t=n[i].y+n[i].h,t>e&&(e=t);return e}function Xw(n){const e=Array(n.length);for(let t=0,i=n.length;t<i;t++)e[t]=tJ(n[t]);return e}function tJ(n){return JSON.parse(JSON.stringify(n))}function kk(n,e){return!(n===e||n.x+n.w<=e.x||n.x>=e.x+e.w||n.y+n.h<=e.y||n.y>=e.y+e.h)}function zp(n,e,t){const i=Nk(n),o=zk(n),u=Array(n.length);for(let h=0,r=o.length;h<r;h++){let p=o[h];p.static||(p=iJ(i,p,e,t),i.push(p)),u[n.indexOf(p)]=p,p.moved=!1}return u}function iJ(n,e,t,i){if(t)for(;e.y>0&&!L_(n,e);)e.y--;else if(i){const u=i[e.i].y;for(;e.y>u&&!L_(n,e);)e.y--}let o;for(;o=L_(n,e);)e.y=o.y+o.h;return e}function nJ(n,e){const t=Nk(n);for(let i=0,o=n.length;i<o;i++){const u=n[i];if(u.x+u.w>e.cols&&(u.x=e.cols-u.w),u.x<0&&(u.x=0,u.w=e.cols),!u.static)t.push(u);else for(;L_(t,u);)u.y++}return n}function o3(n,e){for(let t=0,i=n.length;t<i;t++)if(n[t].i===e)return n[t]}function L_(n,e){for(let t=0,i=n.length;t<i;t++)if(kk(n[t],e))return n[t]}function Fk(n,e){return n.filter(t=>kk(t,e))}function Nk(n){return n.filter(e=>e.static)}function Zw(n,e,t,i,o,u){if(e.static)return n;const h=e.x,r=e.y,p=i&&e.y>i;typeof t=="number"&&(e.x=t),typeof i=="number"&&(e.y=i),e.moved=!0;let g=zk(n);p&&(g=g.reverse());const v=Fk(g,e);if(u&&v.length)return e.x=h,e.y=r,e.moved=!1,n;for(let I=0,C=v.length;I<C;I++){const E=v[I];E.moved||e.y>E.y&&e.y-E.y>E.h/4||(E.static?n=a3(n,E,e,o):n=a3(n,e,E,o))}return n}function a3(n,e,t,i){if(i){const o={x:t.x,y:t.y,w:t.w,h:t.h,i:"-1"};if(o.y=Math.max(e.y-t.h,0),!L_(n,o))return Zw(n,t,void 0,o.y,!1)}return Zw(n,t,void 0,t.y+1,!1)}function rJ(n,e,t,i){const o="translate3d("+e+"px,"+n+"px, 0)";return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:t+"px",height:i+"px",position:"absolute"}}function sJ(n,e,t,i){const o="translate3d("+e*-1+"px,"+n+"px, 0)";return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:t+"px",height:i+"px",position:"absolute"}}function oJ(n,e,t,i){return{top:n+"px",left:e+"px",width:t+"px",height:i+"px",position:"absolute"}}function aJ(n,e,t,i){return{top:n+"px",right:e+"px",width:t+"px",height:i+"px",position:"absolute"}}function zk(n){return[].concat(n).sort(function(e,t){return e.y===t.y&&e.x===t.x?0:e.y>t.y||e.y===t.y&&e.x>t.x?1:-1})}function lJ(n,e){e=e||"Layout";const t=["x","y","w","h"],i=[];if(!Array.isArray(n))throw new Error(e+" must be an array!");for(let o=0,u=n.length;o<u;o++){const h=n[o];for(let r=0;r<t.length;r++)if(typeof h[t[r]]!="number")throw new Error("VueGridLayout: "+e+"["+o+"]."+t[r]+" must be a number!");if(h.i===void 0||h.i===null)throw new Error("VueGridLayout: "+e+"["+o+"].i cannot be null!");if(typeof h.i!="number"&&typeof h.i!="string")throw new Error("VueGridLayout: "+e+"["+o+"].i must be a string or number!");if(i.indexOf(h.i)>=0)throw new Error("VueGridLayout: "+e+"["+o+"].i must be unique!");if(i.push(h.i),h.static!==void 0&&typeof h.static!="boolean")throw new Error("VueGridLayout: "+e+"["+o+"].static must be a boolean!")}}function l3(n){return cJ(n)}function cJ(n){const e=n.target,t=e.offsetParent||document.body,i=e.offsetParent===document.body?{left:0,top:0}:t.getBoundingClientRect(),o=n.clientX+t.scrollLeft-i.left,u=n.clientY+t.scrollTop-i.top;return{x:o,y:u}}function c3(n,e,t,i){return uJ(n)?{deltaX:t-n,deltaY:i-e,lastX:n,lastY:e,x:t,y:i}:{deltaX:0,deltaY:0,lastX:t,lastY:i,x:t,y:i}}function uJ(n){return typeof n=="number"&&!isNaN(n)}function hJ(n,e){const t=Uk(n);let i=t[0];for(let o=1,u=t.length;o<u;o++){const h=t[o];e>n[h]&&(i=h)}return i}function $w(n,e){if(!e[n])throw new Error("ResponsiveGridLayout: `cols` entry for breakpoint "+n+" is missing!");return e[n]}function dJ(n,e,t,i,o,u,h){if(e[i])return Xw(e[i]);let r=n;const p=Uk(t),g=p.slice(p.indexOf(i));for(let v=0,I=g.length;v<I;v++){const C=g[v];if(e[C]){r=e[C];break}}return r=Xw(r||[]),zp(nJ(r,{cols:u}),h)}function Uk(n){return Object.keys(n).sort(function(e,t){return n[e]-n[t]})}let fJ="auto";function pJ(){return typeof document<"u"}function Ok(){return typeof window<"u"}function u3(){return pJ()?typeof document.dir<"u"?document.dir:document.getElementsByTagName("html")[0].getAttribute("dir")||"auto":fJ}function AJ(n,e){return Ok?(window.addEventListener(n,e),!0):(e(),!1)}function gJ(n,e){!Ok||window.removeEventListener(n,e)}const ta={init:mJ,document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function Dp(){}const ho=ta;function mJ(n){const e=n;ta.document=e.document,ta.DocumentFragment=e.DocumentFragment||Dp,ta.SVGElement=e.SVGElement||Dp,ta.SVGSVGElement=e.SVGSVGElement||Dp,ta.SVGElementInstance=e.SVGElementInstance||Dp,ta.Element=e.Element||Dp,ta.HTMLElement=e.HTMLElement||ta.Element,ta.Event=e.Event,ta.Touch=e.Touch||Dp,ta.PointerEvent=e.PointerEvent||e.MSPointerEvent}const Gk=n=>!!(n&&n.Window)&&n instanceof n.Window;let Hk,ph;function Vk(n){Hk=n;const e=n.document.createTextNode("");e.ownerDocument!==n.document&&typeof n.wrap=="function"&&n.wrap(e)===e&&(n=n.wrap(n)),ph=n}typeof window<"u"&&window&&Vk(window);function nf(n){return Gk(n)?n:(n.ownerDocument||n).defaultView||ph.window}const _J=n=>n===ph||Gk(n),yJ=n=>M1(n)&&n.nodeType===11,M1=n=>!!n&&typeof n=="object",Wk=n=>typeof n=="function",vJ=n=>typeof n=="number",xJ=n=>typeof n=="boolean",IJ=n=>typeof n=="string",CJ=n=>{if(!n||typeof n!="object")return!1;const e=nf(n)||ph;return/object|function/.test(typeof Element)?n instanceof Element||n instanceof e.Element:n.nodeType===1&&typeof n.nodeName=="string"},EJ=n=>M1(n)&&!!n.constructor&&/function Object\b/.test(n.constructor.toString()),wJ=n=>M1(n)&&typeof n.length<"u"&&Wk(n.splice),ui={window:_J,docFrag:yJ,object:M1,func:Wk,number:vJ,bool:xJ,string:IJ,element:CJ,plainObject:EJ,array:wJ},ia={init:bJ,supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null};function bJ(n){const e=ho.Element,t=n.navigator||{};ia.supportsTouch="ontouchstart"in n||ui.func(n.DocumentTouch)&&ho.document instanceof n.DocumentTouch,ia.supportsPointerEvent=t.pointerEnabled!==!1&&!!ho.PointerEvent,ia.isIOS=/iP(hone|od|ad)/.test(t.platform),ia.isIOS7=/iP(hone|od|ad)/.test(t.platform)&&/OS 7[^\d]/.test(t.appVersion),ia.isIe9=/MSIE 9/.test(t.userAgent),ia.isOperaMobile=t.appName==="Opera"&&ia.supportsTouch&&/Presto/.test(t.userAgent),ia.prefixedMatchesSelector="matches"in e.prototype?"matches":"webkitMatchesSelector"in e.prototype?"webkitMatchesSelector":"mozMatchesSelector"in e.prototype?"mozMatchesSelector":"oMatchesSelector"in e.prototype?"oMatchesSelector":"msMatchesSelector",ia.pEventTypes=ia.supportsPointerEvent?ho.PointerEvent===n.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,ia.wheelEvent=ho.document&&"onmousewheel"in ho.document?"mousewheel":"wheel"}const sl=ia;function Hd(n,e){if(n.contains)return n.contains(e);for(;e;){if(e===n)return!0;e=e.parentNode}return!1}function Yk(n,e){for(;ui.element(n);){if(rf(n,e))return n;n=Ah(n)}return null}function Ah(n){let e=n.parentNode;if(ui.docFrag(e)){for(;(e=e.host)&&ui.docFrag(e););return e}return e}function rf(n,e){return ph!==Hk&&(e=e.replace(/\/deep\//g," ")),n[sl.prefixedMatchesSelector](e)}function eb(n,e,t){for(;ui.element(n);){if(rf(n,e))return!0;if(n=Ah(n),n===t)return rf(n,e)}return!1}function h3(n){return n.correspondingUseElement||n}function BJ(n){return n=n||ph,{x:n.scrollX||n.document.documentElement.scrollLeft,y:n.scrollY||n.document.documentElement.scrollTop}}function PB(n){const e=n instanceof ho.SVGElement?n.getBoundingClientRect():n.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}function kB(n){const e=PB(n);if(!sl.isIOS7&&e){const t=BJ(nf(n));e.left+=t.x,e.right+=t.x,e.top+=t.y,e.bottom+=t.y}return e}function d3(n){return ui.string(n)?(ho.document.querySelector(n),!0):!1}function Ui(n,e){for(const t in e)n[t]=e[t];return n}function c0(n,e){let t=!1;return function(){return t||(ph.console.warn(e),t=!0),n.apply(this,arguments)}}function jk(n,e){return n.name=e.name,n.axis=e.axis,n.edges=e.edges,n}function SJ(n){const{Interactable:e}=n;e.prototype.getAction=function(t,i,o,u){const h=MJ(this,i,o,u,n);return this.options.actionChecker?this.options.actionChecker(t,i,h,this,u,o):h},e.prototype.ignoreFrom=c0(function(t){return this._backCompatOption("ignoreFrom",t)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),e.prototype.allowFrom=c0(function(t){return this._backCompatOption("allowFrom",t)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),e.prototype.actionChecker=DJ,e.prototype.styleCursor=TJ}function MJ(n,e,t,i,o){const u=n.getRect(i),h=e.buttons||{0:1,1:4,3:8,4:16}[e.button],r={action:null,interactable:n,interaction:t,element:i,rect:u,buttons:h};return o.fire("auto-start:check",r),r.action}function TJ(n){return ui.bool(n)?(this.options.styleCursor=n,this):n===null?(delete this.options.styleCursor,this):this.options.styleCursor}function DJ(n){return ui.func(n)?(this.options.actionChecker=n,this):n===null?(delete this.options.actionChecker,this):this.options.actionChecker}const QJ={id:"auto-start/interactableMethods",install:SJ};function RJ(n){const{interactStatic:e,defaults:t}=n;n.usePlugin(QJ),t.base.actionChecker=null,t.base.styleCursor=!0,Ui(t.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),e.maxInteractions=i=>Xk(i,n),n.autoStart={maxInteractions:1/0,withinInteractionLimit:T1,cursorElement:null}}function LJ({interaction:n,pointer:e,event:t,eventTarget:i},o){if(n.interacting())return;const u=Kk(n,e,t,i,o);Jk(n,u,o)}function PJ({interaction:n,pointer:e,event:t,eventTarget:i},o){if(n.pointerType!=="mouse"||n.pointerIsDown||n.interacting())return;const u=Kk(n,e,t,i,o);Jk(n,u,o)}function kJ(n,e){const{interaction:t}=n;if(!t.pointerIsDown||t.interacting()||!t.pointerWasMoved||!t.prepared.name)return;e.fire("autoStart:before-start",n);const{interactable:i}=t,o=t.prepared.name;o&&i&&(i.options[o].manualStart||!T1(i,t.element,t.prepared,e)?t.stop():(t.start(t.prepared,i,t.element),Zk(t,e)))}function FJ({interaction:n},e){const{interactable:t}=n;t&&t.options.styleCursor&&tb(n.element,"",e)}function qk(n,e,t,i,o){return e.testIgnoreAllow(e.options[n.name],t,i)&&e.options[n.name].enabled&&T1(e,t,n,o)?n:null}function NJ(n,e,t,i,o,u,h){for(let r=0,p=i.length;r<p;r++){const g=i[r],v=o[r],I=g.getAction(e,t,n,v);if(!I)continue;const C=qk(I,g,v,u,h);if(C)return{action:C,interactable:g,element:v}}return{action:null,interactable:null,element:null}}function Kk(n,e,t,i,o){let u=[],h=[],r=i;function p(g){u.push(g),h.push(r)}for(;ui.element(r);){u=[],h=[],o.interactables.forEachMatch(r,p);const g=NJ(n,e,t,u,h,i,o);if(g.action&&!g.interactable.options[g.action.name].manualStart)return g;r=Ah(r)}return{action:null,interactable:null,element:null}}function Jk(n,{action:e,interactable:t,element:i},o){e=e||{name:null},n.interactable=t,n.element=i,jk(n.prepared,e),n.rect=t&&e.name?t.getRect(i):null,Zk(n,o),o.fire("autoStart:prepared",{interaction:n})}function T1(n,e,t,i){const o=n.options,u=o[t.name].max,h=o[t.name].maxPerElement,r=i.autoStart.maxInteractions;let p=0,g=0,v=0;if(!(u&&h&&r))return!1;for(const I of i.interactions.list){const C=I.prepared.name;if(I.interacting()&&(p++,p>=r||I.interactable===n&&(g+=C===t.name?1:0,g>=u||I.element===e&&(v++,C===t.name&&v>=h))))return!1}return r>0}function Xk(n,e){return ui.number(n)?(e.autoStart.maxInteractions=n,this):e.autoStart.maxInteractions}function tb(n,e,t){const{cursorElement:i}=t.autoStart;i&&i!==n&&(i.style.cursor=""),n.ownerDocument.documentElement.style.cursor=e,n.style.cursor=e,t.autoStart.cursorElement=e?n:null}function Zk(n,e){const{interactable:t,element:i,prepared:o}=n;if(!(n.pointerType==="mouse"&&t&&t.options.styleCursor)){e.autoStart.cursorElement&&tb(e.autoStart.cursorElement,"",e);return}let u="";if(o.name){const h=t.options[o.name].cursorChecker;ui.func(h)?u=h(o,t,i,n._interacting):u=e.actions.map[o.name].getCursor(o)}tb(n.element,u||"",e)}const zJ={id:"auto-start/base",before:["actions"],install:RJ,listeners:{"interactions:down":LJ,"interactions:move":(n,e)=>{PJ(n,e),kJ(n,e)},"interactions:stop":FJ},maxInteractions:Xk,withinInteractionLimit:T1,validateAction:qk},FB=zJ;function UJ({interaction:n,eventTarget:e,dx:t,dy:i},o){if(n.prepared.name!=="drag")return;const u=Math.abs(t),h=Math.abs(i),r=n.interactable.options.drag,p=r.startAxis,g=u>h?"x":u<h?"y":"xy";if(n.prepared.axis=r.lockAxis==="start"?g[0]:r.lockAxis,g!=="xy"&&p!=="xy"&&p!==g){n.prepared.name=null;let v=e;const I=function(C){if(C===n.interactable)return;const E=n.interactable.options.drag;if(!E.manualStart&&C.testIgnoreAllow(E,v,e)){const Q=C.getAction(n.downPointer,n.downEvent,n,v);if(Q&&Q.name==="drag"&&OJ(g,C)&&FB.validateAction(Q,C,v,e,o))return C}};for(;ui.element(v);){const C=o.interactables.forEachMatch(v,I);if(C){n.prepared.name="drag",n.interactable=C,n.element=v;break}v=Ah(v)}}}function OJ(n,e){if(!e)return!1;const t=e.options.drag.startAxis;return n==="xy"||t==="xy"||t===n}const GJ={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":UJ}};function HJ(n){const{defaults:e}=n;n.usePlugin(FB),e.perAction.hold=0,e.perAction.delay=0}function QE(n){const e=n.prepared&&n.prepared.name;if(!e)return null;const t=n.interactable.options;return t[e].hold||t[e].delay}const VJ={id:"auto-start/hold",install:HJ,listeners:{"interactions:new":({interaction:n})=>{n.autoStartHoldTimer=null},"autoStart:prepared":({interaction:n})=>{const e=QE(n);e>0&&(n.autoStartHoldTimer=setTimeout(()=>{n.start(n.prepared,n.interactable,n.element)},e))},"interactions:move":({interaction:n,duplicate:e})=>{n.autoStartHoldTimer&&n.pointerWasMoved&&!e&&(clearTimeout(n.autoStartHoldTimer),n.autoStartHoldTimer=null)},"autoStart:before-start":({interaction:n})=>{QE(n)>0&&(n.prepared.name=null)}},getHoldDuration:QE},WJ=VJ,YJ={id:"auto-start",install(n){n.usePlugin(FB),n.usePlugin(WJ),n.usePlugin(GJ)}},jJ=(n,e)=>n.indexOf(e)!==-1,$k=(n,e)=>{for(const t of e)n.push(t);return n},eF=n=>$k([],n),D1=(n,e)=>{for(let t=0;t<n.length;t++)if(e(n[t],t,n))return t;return-1},ib=(n,e)=>n[D1(n,e)];function FA(n){const e={};for(const t in n){const i=n[t];ui.plainObject(i)?e[t]=FA(i):ui.array(i)?e[t]=eF(i):e[t]=i}return e}let f3=0,hc,md;function qJ(n){if(hc=n.requestAnimationFrame,md=n.cancelAnimationFrame,!hc){const e=["ms","moz","webkit","o"];for(const t of e)hc=n[`${t}RequestAnimationFrame`],md=n[`${t}CancelAnimationFrame`]||n[`${t}CancelRequestAnimationFrame`]}hc=hc&&hc.bind(n),md=md&&md.bind(n),hc||(hc=e=>{const t=Date.now(),i=Math.max(0,16-(t-f3)),o=n.setTimeout(()=>{e(t+i)},i);return f3=t+i,o},md=e=>clearTimeout(e))}const Up={request:n=>hc(n),cancel:n=>md(n),init:qJ};function cA(n,e,t){if(t=t||{},ui.string(n)&&n.search(" ")!==-1&&(n=p3(n)),ui.array(n))return n.reduce((i,o)=>Ui(i,cA(o,e,t)),t);if(ui.object(n)&&(e=n,n=""),ui.func(e))t[n]=t[n]||[],t[n].push(e);else if(ui.array(e))for(const i of e)cA(n,i,t);else if(ui.object(e))for(const i in e){const o=p3(i).map(u=>`${n}${u}`);cA(o,e[i],t)}return t}function p3(n){return n.trim().split(/ +/)}function A3(n,e){for(const t of e){if(n.immediatePropagationStopped)break;t(n)}}class tF{constructor(e){ai(this,"options"),ai(this,"types",{}),ai(this,"propagationStopped",!1),ai(this,"immediatePropagationStopped",!1),ai(this,"global"),this.options=Ui({},e||{})}fire(e){let t;const i=this.global;(t=this.types[e.type])&&A3(e,t),!e.propagationStopped&&i&&(t=i[e.type])&&A3(e,t)}on(e,t){const i=cA(e,t);for(e in i)this.types[e]=$k(this.types[e]||[],i[e])}off(e,t){const i=cA(e,t);for(e in i){const o=this.types[e];if(!(!o||!o.length))for(const u of i[e]){const h=o.indexOf(u);h!==-1&&o.splice(h,1)}}}getRect(e){return null}}function iF(n,e,t){return n==="parent"?Ah(t):n==="self"?e.getRect(t):Yk(t,n)}function u0(n,e,t,i){let o=n;return ui.string(o)?o=iF(o,e,t):ui.func(o)&&(o=o(...i)),ui.element(o)&&(o=kB(o)),o}function Q1(n){return n&&{x:"x"in n?n.x:n.left,y:"y"in n?n.y:n.top}}function KJ(n){return n&&!("left"in n&&"top"in n)&&(n=Ui({},n),n.left=n.x||0,n.top=n.y||0,n.right=n.right||n.left+n.width,n.bottom=n.bottom||n.top+n.height),n}function g3(n){return n&&!("x"in n&&"y"in n)&&(n=Ui({},n),n.x=n.left||0,n.y=n.top||0,n.width=n.width||(n.right||0)-n.x,n.height=n.height||(n.bottom||0)-n.y),n}function NB(n,e,t){n.left&&(e.left+=t.x),n.right&&(e.right+=t.x),n.top&&(e.top+=t.y),n.bottom&&(e.bottom+=t.y),e.width=e.right-e.left,e.height=e.bottom-e.top}function zB(n,e,t){const i=n.options[t],o=i&&i.origin||n.options.origin,u=u0(o,n,e,[n&&e]);return Q1(u)||{x:0,y:0}}const R1=(n,e)=>Math.sqrt(n*n+e*e);class nF{constructor(e){ai(this,"immediatePropagationStopped",!1),ai(this,"propagationStopped",!1),this._interaction=e}preventDefault(){}stopPropagation(){this.propagationStopped=!0}stopImmediatePropagation(){this.immediatePropagationStopped=this.propagationStopped=!0}}Object.defineProperty(nF.prototype,"interaction",{get(){return this._interaction._proxy},set(){}});const rF={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}};class UB extends nF{constructor(e,t,i,o,u,h,r){super(e),ai(this,"relatedTarget",null),ai(this,"screenX"),ai(this,"screenY"),ai(this,"button"),ai(this,"buttons"),ai(this,"ctrlKey"),ai(this,"shiftKey"),ai(this,"altKey"),ai(this,"metaKey"),ai(this,"page"),ai(this,"client"),ai(this,"delta"),ai(this,"rect"),ai(this,"x0"),ai(this,"y0"),ai(this,"t0"),ai(this,"dt"),ai(this,"duration"),ai(this,"clientX0"),ai(this,"clientY0"),ai(this,"velocity"),ai(this,"speed"),ai(this,"swipe"),ai(this,"axes"),ai(this,"preEnd"),u=u||e.element;const p=e.interactable,g=(p&&p.options||rF).deltaSource,v=zB(p,u,i),I=o==="start",C=o==="end",E=I?this:e.prevEvent,Q=I?e.coords.start:C?{page:E.page,client:E.client,timeStamp:e.coords.cur.timeStamp}:e.coords.cur;this.page=Ui({},Q.page),this.client=Ui({},Q.client),this.rect=Ui({},e.rect),this.timeStamp=Q.timeStamp,C||(this.page.x-=v.x,this.page.y-=v.y,this.client.x-=v.x,this.client.y-=v.y),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.target=u,this.currentTarget=u,this.preEnd=h,this.type=r||i+(o||""),this.interactable=p,this.t0=I?e.pointers[e.pointers.length-1].downTime:E.t0,this.x0=e.coords.start.page.x-v.x,this.y0=e.coords.start.page.y-v.y,this.clientX0=e.coords.start.client.x-v.x,this.clientY0=e.coords.start.client.y-v.y,I||C?this.delta={x:0,y:0}:this.delta={x:this[g].x-E[g].x,y:this[g].y-E[g].y},this.dt=e.coords.delta.timeStamp,this.duration=this.timeStamp-this.t0,this.velocity=Ui({},e.coords.velocity[g]),this.speed=R1(this.velocity.x,this.velocity.y),this.swipe=C||o==="inertiastart"?this.getSwipe():null}getSwipe(){const e=this._interaction;if(e.prevEvent.speed<600||this.timeStamp-e.prevEvent.timeStamp>150)return null;let t=180*Math.atan2(e.prevEvent.velocityY,e.prevEvent.velocityX)/Math.PI;const i=22.5;t<0&&(t+=360);const o=135-i<=t&&t<225+i,u=225-i<=t&&t<315+i,h=!o&&(315-i<=t||t<45+i),r=!u&&45-i<=t&&t<135+i;return{up:u,down:r,left:o,right:h,angle:t,speed:e.prevEvent.speed,velocity:{x:e.prevEvent.velocityX,y:e.prevEvent.velocityY}}}preventDefault(){}stopImmediatePropagation(){this.immediatePropagationStopped=this.propagationStopped=!0}stopPropagation(){this.propagationStopped=!0}}Object.defineProperties(UB.prototype,{pageX:{get(){return this.page.x},set(n){this.page.x=n}},pageY:{get(){return this.page.y},set(n){this.page.y=n}},clientX:{get(){return this.client.x},set(n){this.client.x=n}},clientY:{get(){return this.client.y},set(n){this.client.y=n}},dx:{get(){return this.delta.x},set(n){this.delta.x=n}},dy:{get(){return this.delta.y},set(n){this.delta.y=n}},velocityX:{get(){return this.velocity.x},set(n){this.velocity.x=n}},velocityY:{get(){return this.velocity.y},set(n){this.velocity.y=n}}});function sF(n,e){n.__set||(n.__set={});for(const t in e)typeof n[t]!="function"&&t!=="__set"&&Object.defineProperty(n,t,{get(){return t in n.__set?n.__set[t]:n.__set[t]=e[t]},set(i){n.__set[t]=i},configurable:!0});return n}function RE(n,e){n.page=n.page||{},n.page.x=e.page.x,n.page.y=e.page.y,n.client=n.client||{},n.client.x=e.client.x,n.client.y=e.client.y,n.timeStamp=e.timeStamp}function JJ(n,e,t){n.page.x=t.page.x-e.page.x,n.page.y=t.page.y-e.page.y,n.client.x=t.client.x-e.client.x,n.client.y=t.client.y-e.client.y,n.timeStamp=t.timeStamp-e.timeStamp}function XJ(n,e){const t=Math.max(e.timeStamp/1e3,.001);n.page.x=e.page.x/t,n.page.y=e.page.y/t,n.client.x=e.client.x/t,n.client.y=e.client.y/t,n.timeStamp=t}function ZJ(n){n.page.x=0,n.page.y=0,n.client.x=0,n.client.y=0}function oF(n){return n instanceof ho.Event||n instanceof ho.Touch}function Ox(n,e,t){return t=t||{},n=n||"page",t.x=e[n+"X"],t.y=e[n+"Y"],t}function $J(n,e){return e=e||{x:0,y:0},sl.isOperaMobile&&oF(n)?(Ox("screen",n,e),e.x+=window.scrollX,e.y+=window.scrollY):Ox("page",n,e),e}function eX(n,e){return e=e||{},sl.isOperaMobile&&oF(n)?Ox("screen",n,e):Ox("client",n,e),e}function Gx(n){return ui.number(n.pointerId)?n.pointerId:n.identifier}function tX(n,e,t){const i=e.length>1?aF(e):e[0];$J(i,n.page),eX(i,n.client),n.timeStamp=t}function OB(n){const e=[];return ui.array(n)?(e[0]=n[0],e[1]=n[1]):n.type==="touchend"?n.touches.length===1?(e[0]=n.touches[0],e[1]=n.changedTouches[0]):n.touches.length===0&&(e[0]=n.changedTouches[0],e[1]=n.changedTouches[1]):(e[0]=n.touches[0],e[1]=n.touches[1]),e}function aF(n){const e={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0};for(const t of n)for(const i in e)e[i]+=t[i];for(const t in e)e[t]/=n.length;return e}function iX(n){if(!n.length)return null;const e=OB(n),t=Math.min(e[0].pageX,e[1].pageX),i=Math.min(e[0].pageY,e[1].pageY),o=Math.max(e[0].pageX,e[1].pageX),u=Math.max(e[0].pageY,e[1].pageY);return{x:t,y:i,left:t,top:i,right:o,bottom:u,width:o-t,height:u-i}}function nX(n,e){const t=e+"X",i=e+"Y",o=OB(n),u=o[0][t]-o[1][t],h=o[0][i]-o[1][i];return R1(u,h)}function rX(n,e){const t=e+"X",i=e+"Y",o=OB(n),u=o[1][t]-o[0][t],h=o[1][i]-o[0][i];return 180*Math.atan2(h,u)/Math.PI}function sX(n){return ui.string(n.pointerType)?n.pointerType:ui.number(n.pointerType)?[void 0,void 0,"touch","pen","mouse"][n.pointerType]:/touch/.test(n.type||"")||n instanceof ho.Touch?"touch":"mouse"}function lF(n){const e=ui.func(n.composedPath)?n.composedPath():n.path;return[h3(e?e[0]:n.target),h3(n.currentTarget)]}function Um(){return{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}}function nb(n,e){if(e.phaselessTypes[n])return!0;for(const t in e.map)if(n.indexOf(t)===0&&n.substr(t.length)in e.phases)return!0;return!1}function oX(n){const e=(t,i)=>{let o=n.interactables.get(t,i);return o||(o=n.interactables.new(t,i),o.events.global=e.globalEvents),o};return e.getPointerAverage=aF,e.getTouchBBox=iX,e.getTouchDistance=nX,e.getTouchAngle=rX,e.getElementRect=kB,e.getElementClientRect=PB,e.matchesSelector=rf,e.closest=Yk,e.globalEvents={},e.version="1.10.18",e.scope=n,e.use=function(t,i){return this.scope.usePlugin(t,i),this},e.isSet=function(t,i){return!!this.scope.interactables.get(t,i&&i.context)},e.on=c0(function(t,i,o){if(ui.string(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),ui.array(t)){for(const u of t)this.on(u,i,o);return this}if(ui.object(t)){for(const u in t)this.on(u,t[u],i);return this}return nb(t,this.scope.actions)?this.globalEvents[t]?this.globalEvents[t].push(i):this.globalEvents[t]=[i]:this.scope.events.add(this.scope.document,t,i,{options:o}),this},"The interact.on() method is being deprecated"),e.off=c0(function(t,i,o){if(ui.string(t)&&t.search(" ")!==-1&&(t=t.trim().split(/ +/)),ui.array(t)){for(const u of t)this.off(u,i,o);return this}if(ui.object(t)){for(const u in t)this.off(u,t[u],i);return this}if(nb(t,this.scope.actions)){let u;t in this.globalEvents&&(u=this.globalEvents[t].indexOf(i))!==-1&&this.globalEvents[t].splice(u,1)}else this.scope.events.remove(this.scope.document,t,i,o);return this},"The interact.off() method is being deprecated"),e.debug=function(){return this.scope},e.supportsTouch=function(){return sl.supportsTouch},e.supportsPointerEvent=function(){return sl.supportsPointerEvent},e.stop=function(){for(const t of this.scope.interactions.list)t.stop();return this},e.pointerMoveTolerance=function(t){return ui.number(t)?(this.scope.interactions.pointerMoveTolerance=t,this):this.scope.interactions.pointerMoveTolerance},e.addDocument=function(t,i){this.scope.addDocument(t,i)},e.removeDocument=function(t){this.scope.removeDocument(t)},e}class aX{constructor(e,t,i,o){ai(this,"options"),ai(this,"_actions"),ai(this,"target"),ai(this,"events",new tF),ai(this,"_context"),ai(this,"_win"),ai(this,"_doc"),ai(this,"_scopeEvents"),ai(this,"_rectChecker"),this._actions=t.actions,this.target=e,this._context=t.context||i,this._win=nf(d3(e)?this._context:e),this._doc=this._win.document,this._scopeEvents=o,this.set(t)}get _defaults(){return{base:{},perAction:{},actions:{}}}setOnEvents(e,t){return ui.func(t.onstart)&&this.on(`${e}start`,t.onstart),ui.func(t.onmove)&&this.on(`${e}move`,t.onmove),ui.func(t.onend)&&this.on(`${e}end`,t.onend),ui.func(t.oninertiastart)&&this.on(`${e}inertiastart`,t.oninertiastart),this}updatePerActionListeners(e,t,i){(ui.array(t)||ui.object(t))&&this.off(e,t),(ui.array(i)||ui.object(i))&&this.on(e,i)}setPerAction(e,t){const i=this._defaults;for(const o in t){const u=o,h=this.options[e],r=t[u];u==="listeners"&&this.updatePerActionListeners(e,h.listeners,r),ui.array(r)?h[u]=eF(r):ui.plainObject(r)?(h[u]=Ui(h[u]||{},FA(r)),ui.object(i.perAction[u])&&"enabled"in i.perAction[u]&&(h[u].enabled=r.enabled!==!1)):ui.bool(r)&&ui.object(i.perAction[u])?h[u].enabled=r:h[u]=r}}getRect(e){return e=e||(ui.element(this.target)?this.target:null),ui.string(this.target)&&(e=e||this._context.querySelector(this.target)),kB(e)}rectChecker(e){return ui.func(e)?(this._rectChecker=e,this.getRect=t=>{const i=Ui({},this._rectChecker(t));return"width"in i||(i.width=i.right-i.left,i.height=i.bottom-i.top),i},this):e===null?(delete this.getRect,delete this._rectChecker,this):this.getRect}_backCompatOption(e,t){if(d3(t)||ui.object(t)){this.options[e]=t;for(const i in this._actions.map)this.options[i][e]=t;return this}return this.options[e]}origin(e){return this._backCompatOption("origin",e)}deltaSource(e){return e==="page"||e==="client"?(this.options.deltaSource=e,this):this.options.deltaSource}context(){return this._context}inContext(e){return this._context===e.ownerDocument||Hd(this._context,e)}testIgnoreAllow(e,t,i){return!this.testIgnore(e.ignoreFrom,t,i)&&this.testAllow(e.allowFrom,t,i)}testAllow(e,t,i){return e?ui.element(i)?ui.string(e)?eb(i,e,t):ui.element(e)?Hd(e,i):!1:!1:!0}testIgnore(e,t,i){return!e||!ui.element(i)?!1:ui.string(e)?eb(i,e,t):ui.element(e)?Hd(e,i):!1}fire(e){return this.events.fire(e),this}_onOff(e,t,i,o){ui.object(t)&&!ui.array(t)&&(o=i,i=null);const u=e==="on"?"add":"remove",h=cA(t,i);for(let r in h){r==="wheel"&&(r=sl.wheelEvent);for(const p of h[r])nb(r,this._actions)?this.events[e](r,p):ui.string(this.target)?this._scopeEvents[`${u}Delegate`](this.target,this._context,r,p,o):this._scopeEvents[u](this.target,r,p,o)}return this}on(e,t,i){return this._onOff("on",e,t,i)}off(e,t,i){return this._onOff("off",e,t,i)}set(e){const t=this._defaults;ui.object(e)||(e={}),this.options=FA(t.base);for(const i in this._actions.methodDict){const o=i,u=this._actions.methodDict[o];this.options[o]={},this.setPerAction(o,Ui(Ui({},t.perAction),t.actions[o])),this[u](e[o])}for(const i in e)ui.func(this[i])&&this[i](e[i]);return this}unset(){if(ui.string(this.target))for(const e in this._scopeEvents.delegatedEvents){const t=this._scopeEvents.delegatedEvents[e];for(let i=t.length-1;i>=0;i--){const{selector:o,context:u,listeners:h}=t[i];o===this.target&&u===this._context&&t.splice(i,1);for(let r=h.length-1;r>=0;r--)this._scopeEvents.removeDelegate(this.target,this._context,e,h[r][0],h[r][1])}}else this._scopeEvents.remove(this.target,"all")}}class lX{constructor(e){ai(this,"list",[]),ai(this,"selectorMap",{}),ai(this,"scope"),this.scope=e,e.addListeners({"interactable:unset":({interactable:t})=>{const{target:i,_context:o}=t,u=ui.string(i)?this.selectorMap[i]:i[this.scope.id],h=D1(u,r=>r.context===o);u[h]&&(u[h].context=null,u[h].interactable=null),u.splice(h,1)}})}new(e,t){t=Ui(t||{},{actions:this.scope.actions});const i=new this.scope.Interactable(e,t,this.scope.document,this.scope.events),o={context:i._context,interactable:i};return this.scope.addDocument(i._doc),this.list.push(i),ui.string(e)?(this.selectorMap[e]||(this.selectorMap[e]=[]),this.selectorMap[e].push(o)):(i.target[this.scope.id]||Object.defineProperty(e,this.scope.id,{value:[],configurable:!0}),e[this.scope.id].push(o)),this.scope.fire("interactable:new",{target:e,options:t,interactable:i,win:this.scope._win}),i}get(e,t){const i=t&&t.context||this.scope.document,o=ui.string(e),u=o?this.selectorMap[e]:e[this.scope.id];if(!u)return null;const h=ib(u,r=>r.context===i&&(o||r.interactable.inContext(e)));return h&&h.interactable}forEachMatch(e,t){for(const i of this.list){let o;if((ui.string(i.target)?ui.element(e)&&rf(e,i.target):e===i.target)&&i.inContext(e)&&(o=t(i)),o!==void 0)return o}}}function cX(n){var e;const t=[],i={},o=[],u={add:h,remove:r,addDelegate:p,removeDelegate:g,delegateListener:v,delegateUseCapture:I,delegatedEvents:i,documents:o,targets:t,supportsOptions:!1,supportsPassive:!1};(e=n.document)==null||e.createElement("div").addEventListener("test",null,{get capture(){return u.supportsOptions=!0},get passive(){return u.supportsPassive=!0}}),n.events=u;function h(C,E,Q,M){const D=Om(M);let P=ib(t,O=>O.eventTarget===C);P||(P={eventTarget:C,events:{}},t.push(P)),P.events[E]||(P.events[E]=[]),C.addEventListener&&!jJ(P.events[E],Q)&&(C.addEventListener(E,Q,u.supportsOptions?D:D.capture),P.events[E].push(Q))}function r(C,E,Q,M){const D=Om(M),P=D1(t,z=>z.eventTarget===C),O=t[P];if(!O||!O.events)return;if(E==="all"){for(E in O.events)O.events.hasOwnProperty(E)&&r(C,E,"all");return}let F=!1;const N=O.events[E];if(N){if(Q==="all"){for(let z=N.length-1;z>=0;z--)r(C,E,N[z],D);return}else for(let z=0;z<N.length;z++)if(N[z]===Q){C.removeEventListener(E,Q,u.supportsOptions?D:D.capture),N.splice(z,1),N.length===0&&(delete O.events[E],F=!0);break}}F&&!Object.keys(O.events).length&&t.splice(P,1)}function p(C,E,Q,M,D){const P=Om(D);if(!i[Q]){i[Q]=[];for(const N of o)h(N,Q,v),h(N,Q,I,!0)}const O=i[Q];let F=ib(O,N=>N.selector===C&&N.context===E);F||(F={selector:C,context:E,listeners:[]},O.push(F)),F.listeners.push([M,P])}function g(C,E,Q,M,D){const P=Om(D),O=i[Q];let F=!1,N;if(O)for(N=O.length-1;N>=0;N--){const z=O[N];if(z.selector===C&&z.context===E){const{listeners:X}=z;for(let q=X.length-1;q>=0;q--){const[H,{capture:W,passive:se}]=X[q];if(H===M&&W===P.capture&&se===P.passive){X.splice(q,1),X.length||(O.splice(N,1),r(E,Q,v),r(E,Q,I,!0)),F=!0;break}}if(F)break}}}function v(C,E){const Q=Om(E),M=new uX(C),D=i[C.type],[P]=lF(C);let O=P;for(;ui.element(O);){for(let F=0;F<D.length;F++){const N=D[F],{selector:z,context:X}=N;if(rf(O,z)&&Hd(X,P)&&Hd(X,O)){const{listeners:q}=N;M.currentTarget=O;for(const[H,{capture:W,passive:se}]of q)W===Q.capture&&se===Q.passive&&H(M)}}O=Ah(O)}}function I(C){return v.call(this,C,!0)}return u}class uX{constructor(e){ai(this,"currentTarget"),ai(this,"originalEvent"),ai(this,"type"),this.originalEvent=e,sF(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function Om(n){if(!ui.object(n))return{capture:!!n,passive:!1};const e=Ui({},n);return e.capture=!!n.capture,e.passive=!!n.passive,e}const hX={id:"events",install:cX};class dX{constructor(e,t,i,o,u){ai(this,"id"),ai(this,"pointer"),ai(this,"event"),ai(this,"downTime"),ai(this,"downTarget"),this.id=e,this.pointer=t,this.event=i,this.downTime=o,this.downTarget=u}}let rb;(function(n){n.interactable="",n.element="",n.prepared="",n.pointerIsDown="",n.pointerWasMoved="",n._proxy=""})(rb||(rb={}));let sb;(function(n){n.start="",n.move="",n.end="",n.stop="",n.interacting=""})(sb||(sb={}));let fX=0;class pX{constructor({pointerType:e,scopeFire:t}){ai(this,"interactable",null),ai(this,"element",null),ai(this,"rect",null),ai(this,"_rects"),ai(this,"edges",null),ai(this,"_scopeFire"),ai(this,"prepared",{name:null,axis:null,edges:null}),ai(this,"pointerType"),ai(this,"pointers",[]),ai(this,"downEvent",null),ai(this,"downPointer",{}),ai(this,"_latestPointer",{pointer:null,event:null,eventTarget:null}),ai(this,"prevEvent",null),ai(this,"pointerIsDown",!1),ai(this,"pointerWasMoved",!1),ai(this,"_interacting",!1),ai(this,"_ending",!1),ai(this,"_stopped",!0),ai(this,"_proxy",null),ai(this,"simulation",null),ai(this,"doMove",c0(function(o){this.move(o)},"The interaction.doMove() method has been renamed to interaction.move()")),ai(this,"coords",{start:Um(),prev:Um(),cur:Um(),delta:Um(),velocity:Um()}),ai(this,"_id",fX++),this._scopeFire=t,this.pointerType=e;const i=this;this._proxy={};for(const o in rb)Object.defineProperty(this._proxy,o,{get(){return i[o]}});for(const o in sb)Object.defineProperty(this._proxy,o,{value:(...u)=>i[o](...u)});this._scopeFire("interactions:new",{interaction:this})}get pointerMoveTolerance(){return 1}pointerDown(e,t,i){const o=this.updatePointer(e,t,i,!0),u=this.pointers[o];this._scopeFire("interactions:down",{pointer:e,event:t,eventTarget:i,pointerIndex:o,pointerInfo:u,type:"down",interaction:this})}start(e,t,i){return this.interacting()||!this.pointerIsDown||this.pointers.length<(e.name==="gesture"?2:1)||!t.options[e.name].enabled?!1:(jk(this.prepared,e),this.interactable=t,this.element=i,this.rect=t.getRect(i),this.edges=this.prepared.edges?Ui({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}pointerMove(e,t,i){!this.simulation&&!(this.modification&&this.modification.endResult)&&this.updatePointer(e,t,i,!1);const o=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;let u,h;this.pointerIsDown&&!this.pointerWasMoved&&(u=this.coords.cur.client.x-this.coords.start.client.x,h=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=R1(u,h)>this.pointerMoveTolerance);const r=this.getPointerIndex(e),p={pointer:e,pointerIndex:r,pointerInfo:this.pointers[r],event:t,type:"move",eventTarget:i,dx:u,dy:h,duplicate:o,interaction:this};o||XJ(this.coords.velocity,this.coords.delta),this._scopeFire("interactions:move",p),!o&&!this.simulation&&(this.interacting()&&(p.type=null,this.move(p)),this.pointerWasMoved&&RE(this.coords.prev,this.coords.cur))}move(e){(!e||!e.event)&&ZJ(this.coords.delta),e=Ui({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},e||{}),e.phase="move",this._doPhase(e)}pointerUp(e,t,i,o){let u=this.getPointerIndex(e);u===-1&&(u=this.updatePointer(e,t,i,!1));const h=/cancel$/i.test(t.type)?"cancel":"up";this._scopeFire(`interactions:${h}`,{pointer:e,pointerIndex:u,pointerInfo:this.pointers[u],event:t,eventTarget:i,type:h,curEventTarget:o,interaction:this}),this.simulation||this.end(t),this.removePointer(e,t)}documentBlur(e){this.end(e),this._scopeFire("interactions:blur",{event:e,type:"blur",interaction:this})}end(e){this._ending=!0,e=e||this._latestPointer.event;let t;this.interacting()&&(t=this._doPhase({event:e,interaction:this,phase:"end"})),this._ending=!1,t===!0&&this.stop()}currentAction(){return this._interacting?this.prepared.name:null}interacting(){return this._interacting}stop(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}getPointerIndex(e){const t=Gx(e);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:D1(this.pointers,i=>i.id===t)}getPointerInfo(e){return this.pointers[this.getPointerIndex(e)]}updatePointer(e,t,i,o){const u=Gx(e);let h=this.getPointerIndex(e),r=this.pointers[h];return o=o===!1?!1:o||/(down|start)$/i.test(t.type),r?r.pointer=e:(r=new dX(u,e,t,null,null),h=this.pointers.length,this.pointers.push(r)),tX(this.coords.cur,this.pointers.map(p=>p.pointer),this._now()),JJ(this.coords.delta,this.coords.prev,this.coords.cur),o&&(this.pointerIsDown=!0,r.downTime=this.coords.cur.timeStamp,r.downTarget=i,sF(this.downPointer,e),this.interacting()||(RE(this.coords.start,this.coords.cur),RE(this.coords.prev,this.coords.cur),this.downEvent=t,this.pointerWasMoved=!1)),this._updateLatestPointer(e,t,i),this._scopeFire("interactions:update-pointer",{pointer:e,event:t,eventTarget:i,down:o,pointerInfo:r,pointerIndex:h,interaction:this}),h}removePointer(e,t){const i=this.getPointerIndex(e);if(i===-1)return;const o=this.pointers[i];this._scopeFire("interactions:remove-pointer",{pointer:e,event:t,eventTarget:null,pointerIndex:i,pointerInfo:o,interaction:this}),this.pointers.splice(i,1),this.pointerIsDown=!1}_updateLatestPointer(e,t,i){this._latestPointer.pointer=e,this._latestPointer.event=t,this._latestPointer.eventTarget=i}destroy(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}_createPreparedEvent(e,t,i,o){return new UB(this,e,this.prepared.name,t,this.element,i,o)}_fireEvent(e){var t;(t=this.interactable)==null||t.fire(e),(!this.prevEvent||e.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=e)}_doPhase(e){const{event:t,phase:i,preEnd:o,type:u}=e,{rect:h}=this;if(h&&i==="move"&&(NB(this.edges,h,this.coords.delta[this.interactable.options.deltaSource]),h.width=h.right-h.left,h.height=h.bottom-h.top),this._scopeFire(`interactions:before-action-${i}`,e)===!1)return!1;const r=e.iEvent=this._createPreparedEvent(t,i,o,u);return this._scopeFire(`interactions:action-${i}`,e),i==="start"&&(this.prevEvent=r),this._fireEvent(r),this._scopeFire(`interactions:after-action-${i}`,e),!0}_now(){return Date.now()}}const AX=pX;function gX(n){return/^(always|never|auto)$/.test(n)?(this.options.preventDefault=n,this):ui.bool(n)?(this.options.preventDefault=n?"always":"never",this):this.options.preventDefault}function mX(n,e,t){const i=n.options.preventDefault;if(i!=="never"){if(i==="always"){t.preventDefault();return}if(e.events.supportsPassive&&/^touch(start|move)$/.test(t.type)){const o=nf(t.target).document,u=e.getDocOptions(o);if(!(u&&u.events)||u.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(t.type)||ui.element(t.target)&&rf(t.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||t.preventDefault()}}function _X({interaction:n,event:e}){n.interactable&&n.interactable.checkAndPreventDefault(e)}function yX(n){const{Interactable:e}=n;e.prototype.preventDefault=gX,e.prototype.checkAndPreventDefault=function(t){return mX(this,n,t)},n.interactions.docEvents.push({type:"dragstart",listener(t){for(const i of n.interactions.list)if(i.element&&(i.element===t.target||Hd(i.element,t.target))){i.interactable.checkAndPreventDefault(t);return}}})}const vX={id:"core/interactablePreventDefault",install:yX,listeners:["down","move","up","cancel"].reduce((n,e)=>(n[`interactions:${e}`]=_X,n),{})},ob={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search(n){for(const e of ob.methodOrder){const t=ob[e](n);if(t)return t}return null},simulationResume({pointerType:n,eventType:e,eventTarget:t,scope:i}){if(!/down|start/i.test(e))return null;for(const o of i.interactions.list){let u=t;if(o.simulation&&o.simulation.allowResume&&o.pointerType===n)for(;u;){if(u===o.element)return o;u=Ah(u)}}return null},mouseOrPen({pointerId:n,pointerType:e,eventType:t,scope:i}){if(e!=="mouse"&&e!=="pen")return null;let o;for(const u of i.interactions.list)if(u.pointerType===e){if(u.simulation&&!m3(u,n))continue;if(u.interacting())return u;o||(o=u)}if(o)return o;for(const u of i.interactions.list)if(u.pointerType===e&&!(/down/i.test(t)&&u.simulation))return u;return null},hasPointer({pointerId:n,scope:e}){for(const t of e.interactions.list)if(m3(t,n))return t;return null},idle({pointerType:n,scope:e}){for(const t of e.interactions.list){if(t.pointers.length===1){const i=t.interactable;if(i&&!(i.options.gesture&&i.options.gesture.enabled))continue}else if(t.pointers.length>=2)continue;if(!t.interacting()&&n===t.pointerType)return t}return null}};function m3(n,e){return n.pointers.some(({id:t})=>t===e)}const xX=ob,cF=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function IX(n){const e={};for(const u of cF)e[u]=uF(u,n);const t=sl.pEventTypes;let i;ho.PointerEvent?i=[{type:t.down,listener:o},{type:t.down,listener:e.pointerDown},{type:t.move,listener:e.pointerMove},{type:t.up,listener:e.pointerUp},{type:t.cancel,listener:e.pointerUp}]:i=[{type:"mousedown",listener:e.pointerDown},{type:"mousemove",listener:e.pointerMove},{type:"mouseup",listener:e.pointerUp},{type:"touchstart",listener:o},{type:"touchstart",listener:e.pointerDown},{type:"touchmove",listener:e.pointerMove},{type:"touchend",listener:e.pointerUp},{type:"touchcancel",listener:e.pointerUp}],i.push({type:"blur",listener(u){for(const h of n.interactions.list)h.documentBlur(u)}}),n.prevTouchTime=0,n.Interaction=class extends AX{get pointerMoveTolerance(){return n.interactions.pointerMoveTolerance}set pointerMoveTolerance(u){n.interactions.pointerMoveTolerance=u}_now(){return n.now()}},n.interactions={list:[],new(u){u.scopeFire=(r,p)=>n.fire(r,p);const h=new n.Interaction(u);return n.interactions.list.push(h),h},listeners:e,docEvents:i,pointerMoveTolerance:1};function o(){for(const u of n.interactions.list)if(!(!u.pointerIsDown||u.pointerType!=="touch"||u._interacting))for(const h of u.pointers)n.documents.some(({doc:r})=>Hd(r,h.downTarget))||u.removePointer(h.pointer,h.event)}n.usePlugin(vX)}function uF(n,e){return function(t){const i=e.interactions.list,o=sX(t),[u,h]=lF(t),r=[];if(/^touch/.test(t.type)){e.prevTouchTime=e.now();for(const p of t.changedTouches){const g=p,v=Gx(g),I={pointer:g,pointerId:v,pointerType:o,eventType:t.type,eventTarget:u,curEventTarget:h,scope:e},C=_3(I);r.push([I.pointer,I.eventTarget,I.curEventTarget,C])}}else{let p=!1;if(!sl.supportsPointerEvent&&/mouse/.test(t.type)){for(let g=0;g<i.length&&!p;g++)p=i[g].pointerType!=="mouse"&&i[g].pointerIsDown;p=p||e.now()-e.prevTouchTime<500||t.timeStamp===0}if(!p){const g={pointer:t,pointerId:Gx(t),pointerType:o,eventType:t.type,curEventTarget:h,eventTarget:u,scope:e},v=_3(g);r.push([g.pointer,g.eventTarget,g.curEventTarget,v])}}for(const[p,g,v,I]of r)I[n](p,t,g,v)}}function _3(n){const{pointerType:e,scope:t}=n,i={interaction:xX.search(n),searchDetails:n};return t.fire("interactions:find",i),i.interaction||t.interactions.new({pointerType:e})}function LE({doc:n,scope:e,options:t},i){const{interactions:{docEvents:o},events:u}=e,h=u[i];e.browser.isIOS&&!t.events&&(t.events={passive:!1});for(const p in u.delegatedEvents)h(n,p,u.delegateListener),h(n,p,u.delegateUseCapture,!0);const r=t&&t.events;for(const{type:p,listener:g}of o)h(n,p,g,r)}const CX={id:"core/interactions",install:IX,listeners:{"scope:add-document":n=>LE(n,"add"),"scope:remove-document":n=>LE(n,"remove"),"interactable:unset":({interactable:n},e)=>{for(let t=e.interactions.list.length-1;t>=0;t--){const i=e.interactions.list[t];i.interactable===n&&(i.stop(),e.fire("interactions:destroy",{interaction:i}),i.destroy(),e.interactions.list.length>2&&e.interactions.list.splice(t,1))}}},onDocSignal:LE,doOnInteractions:uF,methodNames:cF},EX=CX;class wX{constructor(){ai(this,"id",`__interact_scope_${Math.floor(Math.random()*100)}`),ai(this,"isInitialized",!1),ai(this,"listenerMaps",[]),ai(this,"browser",sl),ai(this,"defaults",FA(rF)),ai(this,"Eventable",tF),ai(this,"actions",{map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}}),ai(this,"interactStatic",oX(this)),ai(this,"InteractEvent",UB),ai(this,"Interactable"),ai(this,"interactables",new lX(this)),ai(this,"_win"),ai(this,"document"),ai(this,"window"),ai(this,"documents",[]),ai(this,"_plugins",{list:[],map:{}}),ai(this,"onWindowUnload",t=>this.removeDocument(t.target));const e=this;this.Interactable=class extends aX{get _defaults(){return e.defaults}set(t){return super.set(t),e.fire("interactable:set",{options:t,interactable:this}),this}unset(){super.unset();const t=e.interactables.list.indexOf(this);t<0||(super.unset(),e.interactables.list.splice(t,1),e.fire("interactable:unset",{interactable:this}))}}}addListeners(e,t){this.listenerMaps.push({id:t,map:e})}fire(e,t){for(const{map:{[e]:i}}of this.listenerMaps)if(i&&i(t,this,e)===!1)return!1}init(e){return this.isInitialized?this:bX(this,e)}pluginIsInstalled(e){return this._plugins.map[e.id]||this._plugins.list.indexOf(e)!==-1}usePlugin(e,t){if(!this.isInitialized)return this;if(this.pluginIsInstalled(e))return this;if(e.id&&(this._plugins.map[e.id]=e),this._plugins.list.push(e),e.install&&e.install(this,t),e.listeners&&e.before){let i=0;const o=this.listenerMaps.length,u=e.before.reduce((h,r)=>(h[r]=!0,h[y3(r)]=!0,h),{});for(;i<o;i++){const h=this.listenerMaps[i].id;if(u[h]||u[y3(h)])break}this.listenerMaps.splice(i,0,{id:e.id,map:e.listeners})}else e.listeners&&this.listenerMaps.push({id:e.id,map:e.listeners});return this}addDocument(e,t){if(this.getDocIndex(e)!==-1)return!1;const i=nf(e);t=t?Ui({},t):{},this.documents.push({doc:e,options:t}),this.events.documents.push(e),e!==this.document&&this.events.add(i,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:e,window:i,scope:this,options:t})}removeDocument(e){const t=this.getDocIndex(e),i=nf(e),o=this.documents[t].options;this.events.remove(i,"unload",this.onWindowUnload),this.documents.splice(t,1),this.events.documents.splice(t,1),this.fire("scope:remove-document",{doc:e,window:i,scope:this,options:o})}getDocIndex(e){for(let t=0;t<this.documents.length;t++)if(this.documents[t].doc===e)return t;return-1}getDocOptions(e){const t=this.getDocIndex(e);return t===-1?null:this.documents[t].options}now(){return(this.window.Date||Date).now()}}function bX(n,e){return n.isInitialized=!0,ui.window(e)&&Vk(e),ho.init(e),sl.init(e),Up.init(e),n.window=e,n.document=e.document,n.usePlugin(EX),n.usePlugin(hX),n}function y3(n){return n&&n.replace(/\/.*$/,"")}const hF=new wX,BX=hF.interactStatic,Dc=BX,SX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:globalThis;hF.init(SX);Dc.use(YJ);function MX(n){const{defaults:e,actions:t}=n;n.autoScroll=ji,ji.now=()=>n.now(),t.phaselessTypes.autoscroll=!0,e.perAction.autoScroll=ji.defaults}const ji={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start(n){ji.isScrolling=!0,Up.cancel(ji.i),n.autoScroll=ji,ji.interaction=n,ji.prevTime=ji.now(),ji.i=Up.request(ji.scroll)},stop(){ji.isScrolling=!1,ji.interaction&&(ji.interaction.autoScroll=null),Up.cancel(ji.i)},scroll(){const{interaction:n}=ji,{interactable:e,element:t}=n,i=n.prepared.name,o=e.options[i].autoScroll,u=v3(o.container,e,t),h=ji.now(),r=(h-ji.prevTime)/1e3,p=o.speed*r;if(p>=1){const g={x:ji.x*p,y:ji.y*p};if(g.x||g.y){const v=x3(u);ui.window(u)?u.scrollBy(g.x,g.y):u&&(u.scrollLeft+=g.x,u.scrollTop+=g.y);const I=x3(u),C={x:I.x-v.x,y:I.y-v.y};(C.x||C.y)&&e.fire({type:"autoscroll",target:t,interactable:e,delta:C,interaction:n,container:u})}ji.prevTime=h}ji.isScrolling&&(Up.cancel(ji.i),ji.i=Up.request(ji.scroll))},check(n,e){var t;return(t=n.options[e].autoScroll)==null?void 0:t.enabled},onInteractionMove({interaction:n,pointer:e}){if(!(n.interacting()&&ji.check(n.interactable,n.prepared.name)))return;if(n.simulation){ji.x=ji.y=0;return}let t,i,o,u;const{interactable:h,element:r}=n,p=n.prepared.name,g=h.options[p].autoScroll,v=v3(g.container,h,r);if(ui.window(v))u=e.clientX<ji.margin,t=e.clientY<ji.margin,i=e.clientX>v.innerWidth-ji.margin,o=e.clientY>v.innerHeight-ji.margin;else{const I=PB(v);u=e.clientX<I.left+ji.margin,t=e.clientY<I.top+ji.margin,i=e.clientX>I.right-ji.margin,o=e.clientY>I.bottom-ji.margin}ji.x=i?1:u?-1:0,ji.y=o?1:t?-1:0,ji.isScrolling||(ji.margin=g.margin,ji.speed=g.speed,ji.start(n))}};function v3(n,e,t){return(ui.string(n)?iF(n,e,t):n)||nf(t)}function x3(n){return ui.window(n)&&(n=window.document.body),{x:n.scrollLeft,y:n.scrollTop}}const TX={id:"auto-scroll",install:MX,listeners:{"interactions:new":({interaction:n})=>{n.autoScroll=null},"interactions:destroy":({interaction:n})=>{n.autoScroll=null,ji.stop(),ji.interaction&&(ji.interaction=null)},"interactions:stop":ji.stop,"interactions:action-move":n=>ji.onInteractionMove(n)}},DX=TX;Dc.use(DX);function QX(n){const{actions:e,Interactable:t,defaults:i}=n;t.prototype.draggable=px.draggable,e.map.drag=px,e.methodDict.drag="draggable",i.actions.drag=px.defaults}function PE({interaction:n}){if(n.prepared.name!=="drag")return;const e=n.prepared.axis;e==="x"?(n.coords.cur.page.y=n.coords.start.page.y,n.coords.cur.client.y=n.coords.start.client.y,n.coords.velocity.client.y=0,n.coords.velocity.page.y=0):e==="y"&&(n.coords.cur.page.x=n.coords.start.page.x,n.coords.cur.client.x=n.coords.start.client.x,n.coords.velocity.client.x=0,n.coords.velocity.page.x=0)}function I3({iEvent:n,interaction:e}){if(e.prepared.name!=="drag")return;const t=e.prepared.axis;if(t==="x"||t==="y"){const i=t==="x"?"y":"x";n.page[i]=e.coords.start.page[i],n.client[i]=e.coords.start.client[i],n.delta[i]=0}}const RX=function(n){return ui.object(n)?(this.options.drag.enabled=n.enabled!==!1,this.setPerAction("drag",n),this.setOnEvents("drag",n),/^(xy|x|y|start)$/.test(n.lockAxis)&&(this.options.drag.lockAxis=n.lockAxis),/^(xy|x|y)$/.test(n.startAxis)&&(this.options.drag.startAxis=n.startAxis),this):ui.bool(n)?(this.options.drag.enabled=n,this):this.options.drag},px={id:"actions/drag",install:QX,listeners:{"interactions:before-action-move":PE,"interactions:action-resume":PE,"interactions:action-move":I3,"auto-start:check":n=>{const{interaction:e,interactable:t,buttons:i}=n,o=t.options.drag;if(!(!(o&&o.enabled)||e.pointerIsDown&&/mouse|pointer/.test(e.pointerType)&&!(i&t.options.drag.mouseButtons)))return n.action={name:"drag",axis:o.lockAxis==="start"?o.startAxis:o.lockAxis},!1}},draggable:RX,beforeMove:PE,move:I3,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor(){return"move"}},LX=px;Dc.use(LX);function PX(n){const{actions:e,browser:t,Interactable:i,defaults:o}=n;bc.cursors=zX(t),bc.defaultMargin=t.supportsTouch||t.supportsPointerEvent?20:10,i.prototype.resizable=function(u){return FX(this,u,n)},e.map.resize=bc,e.methodDict.resize="resizable",o.actions.resize=bc.defaults}function kX(n){const{interaction:e,interactable:t,element:i,rect:o,buttons:u}=n;if(!o)return;const h=Ui({},e.coords.cur.page),r=t.options.resize;if(!(!(r&&r.enabled)||e.pointerIsDown&&/mouse|pointer/.test(e.pointerType)&&!(u&r.mouseButtons))){if(ui.object(r.edges)){const p={left:!1,right:!1,top:!1,bottom:!1};for(const g in p)p[g]=NX(g,r.edges[g],h,e._latestPointer.eventTarget,i,o,r.margin||bc.defaultMargin);p.left=p.left&&!p.right,p.top=p.top&&!p.bottom,(p.left||p.right||p.top||p.bottom)&&(n.action={name:"resize",edges:p})}else{const p=r.axis!=="y"&&h.x>o.right-bc.defaultMargin,g=r.axis!=="x"&&h.y>o.bottom-bc.defaultMargin;(p||g)&&(n.action={name:"resize",axes:(p?"x":"")+(g?"y":"")})}return n.action?!1:void 0}}function FX(n,e,t){return ui.object(e)?(n.options.resize.enabled=e.enabled!==!1,n.setPerAction("resize",e),n.setOnEvents("resize",e),ui.string(e.axis)&&/^x$|^y$|^xy$/.test(e.axis)?n.options.resize.axis=e.axis:e.axis===null&&(n.options.resize.axis=t.defaults.actions.resize.axis),ui.bool(e.preserveAspectRatio)?n.options.resize.preserveAspectRatio=e.preserveAspectRatio:ui.bool(e.square)&&(n.options.resize.square=e.square),n):ui.bool(e)?(n.options.resize.enabled=e,n):n.options.resize}function NX(n,e,t,i,o,u,h){if(!e)return!1;if(e===!0){const r=ui.number(u.width)?u.width:u.right-u.left,p=ui.number(u.height)?u.height:u.bottom-u.top;if(h=Math.min(h,Math.abs((n==="left"||n==="right"?r:p)/2)),r<0&&(n==="left"?n="right":n==="right"&&(n="left")),p<0&&(n==="top"?n="bottom":n==="bottom"&&(n="top")),n==="left"){const g=r>=0?u.left:u.right;return t.x<g+h}if(n==="top"){const g=p>=0?u.top:u.bottom;return t.y<g+h}if(n==="right")return t.x>(r>=0?u.right:u.left)-h;if(n==="bottom")return t.y>(p>=0?u.bottom:u.top)-h}return ui.element(i)?ui.element(e)?e===i:eb(i,e,o):!1}function zX(n){return n.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}function UX({iEvent:n,interaction:e}){if(e.prepared.name!=="resize"||!e.prepared.edges)return;const t=n,i=e.rect;e._rects={start:Ui({},i),corrected:Ui({},i),previous:Ui({},i),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},t.edges=e.prepared.edges,t.rect=e._rects.corrected,t.deltaRect=e._rects.delta}function OX({iEvent:n,interaction:e}){if(e.prepared.name!=="resize"||!e.prepared.edges)return;const t=n,i=e.interactable.options.resize.invert,o=i==="reposition"||i==="negate",u=e.rect,{start:h,corrected:r,delta:p,previous:g}=e._rects;if(Ui(g,r),o){if(Ui(r,u),i==="reposition"){if(r.top>r.bottom){const v=r.top;r.top=r.bottom,r.bottom=v}if(r.left>r.right){const v=r.left;r.left=r.right,r.right=v}}}else r.top=Math.min(u.top,h.bottom),r.bottom=Math.max(u.bottom,h.top),r.left=Math.min(u.left,h.right),r.right=Math.max(u.right,h.left);r.width=r.right-r.left,r.height=r.bottom-r.top;for(const v in r)p[v]=r[v]-g[v];t.edges=e.prepared.edges,t.rect=r,t.deltaRect=p}function GX({iEvent:n,interaction:e}){if(e.prepared.name!=="resize"||!e.prepared.edges)return;const t=n;t.edges=e.prepared.edges,t.rect=e._rects.corrected,t.deltaRect=e._rects.delta}function C3({iEvent:n,interaction:e}){if(e.prepared.name!=="resize"||!e.resizeAxes)return;const t=e.interactable.options,i=n;t.resize.square?(e.resizeAxes==="y"?i.delta.x=i.delta.y:i.delta.y=i.delta.x,i.axes="xy"):(i.axes=e.resizeAxes,e.resizeAxes==="x"?i.delta.y=0:e.resizeAxes==="y"&&(i.delta.x=0))}const bc={id:"actions/resize",before:["actions/drag"],install:PX,listeners:{"interactions:new":({interaction:n})=>{n.resizeAxes="xy"},"interactions:action-start":n=>{UX(n),C3(n)},"interactions:action-move":n=>{OX(n),C3(n)},"interactions:action-end":GX,"auto-start:check":kX},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor({edges:n,axis:e,name:t}){const i=bc.cursors;let o=null;if(e)o=i[t+e];else if(n){let u="";for(const h of["top","bottom","left","right"])n[h]&&(u+=h);o=i[u]}return o},defaultMargin:null},HX=bc;Dc.use(HX);const VX=()=>{},WX=()=>{},YX=n=>{const e=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(([i,o])=>i in n||o in n),t=(i,o)=>{const{range:u,limits:h={left:-1/0,right:1/0,top:-1/0,bottom:1/0},offset:r={x:0,y:0}}=n,p={range:u,grid:n,x:null,y:null};for(const[g,v]of e){const I=Math.round((i-r.x)/n[g]),C=Math.round((o-r.y)/n[v]);p[g]=Math.max(h.left,Math.min(h.right,I*n[g]+r.x)),p[v]=Math.max(h.top,Math.min(h.bottom,C*n[v]+r.y))}return p};return t.grid=n,t.coordFields=e,t},jX=Object.freeze(Object.defineProperty({__proto__:null,edgeTarget:VX,elements:WX,grid:YX},Symbol.toStringTag,{value:"Module"})),qX={id:"snappers",install(n){const{interactStatic:e}=n;e.snappers=Ui(e.snappers||{},jX),e.createSnapGrid=e.snappers.grid}},KX=qX;class dF{constructor(e){ai(this,"states",[]),ai(this,"startOffset",{left:0,right:0,top:0,bottom:0}),ai(this,"startDelta"),ai(this,"result"),ai(this,"endResult"),ai(this,"startEdges"),ai(this,"edges"),ai(this,"interaction"),this.interaction=e,this.result=zv(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}start({phase:e},t){const{interaction:i}=this,o=JX(i);this.prepareStates(o),this.startEdges=Ui({},i.edges),this.edges=Ui({},this.startEdges),this.startOffset=XX(i.rect,t),this.startDelta={x:0,y:0};const u=this.fillArg({phase:e,pageCoords:t,preEnd:!1});return this.result=zv(),this.startAll(u),this.result=this.setAll(u)}fillArg(e){const{interaction:t}=this;return e.interaction=t,e.interactable=t.interactable,e.element=t.element,e.rect||(e.rect=t.rect),e.edges||(e.edges=this.startEdges),e.startOffset=this.startOffset,e}startAll(e){for(const t of this.states)t.methods.start&&(e.state=t,t.methods.start(e))}setAll(e){const{phase:t,preEnd:i,skipModifiers:o,rect:u,edges:h}=e;e.coords=Ui({},e.pageCoords),e.rect=Ui({},u),e.edges=Ui({},h);const r=o?this.states.slice(o):this.states,p=zv(e.coords,e.rect);for(const C of r){var g;const{options:E}=C,Q=Ui({},e.coords);let M=null;(g=C.methods)!=null&&g.set&&this.shouldDo(E,i,t)&&(e.state=C,M=C.methods.set(e),NB(e.edges,e.rect,{x:e.coords.x-Q.x,y:e.coords.y-Q.y})),p.eventProps.push(M)}Ui(this.edges,e.edges),p.delta.x=e.coords.x-e.pageCoords.x,p.delta.y=e.coords.y-e.pageCoords.y,p.rectDelta.left=e.rect.left-u.left,p.rectDelta.right=e.rect.right-u.right,p.rectDelta.top=e.rect.top-u.top,p.rectDelta.bottom=e.rect.bottom-u.bottom;const v=this.result.coords,I=this.result.rect;if(v&&I){const C=p.rect.left!==I.left||p.rect.right!==I.right||p.rect.top!==I.top||p.rect.bottom!==I.bottom;p.changed=C||v.x!==p.coords.x||v.y!==p.coords.y}return p}applyToInteraction(e){const{interaction:t}=this,{phase:i}=e,o=t.coords.cur,u=t.coords.start,{result:h,startDelta:r}=this,p=h.delta;i==="start"&&Ui(this.startDelta,h.delta);for(const[I,C]of[[u,r],[o,p]])I.page.x+=C.x,I.page.y+=C.y,I.client.x+=C.x,I.client.y+=C.y;const{rectDelta:g}=this.result,v=e.rect||t.rect;v.left+=g.left,v.right+=g.right,v.top+=g.top,v.bottom+=g.bottom,v.width=v.right-v.left,v.height=v.bottom-v.top}setAndApply(e){const{interaction:t}=this,{phase:i,preEnd:o,skipModifiers:u}=e,h=this.setAll(this.fillArg({preEnd:o,phase:i,pageCoords:e.modifiedCoords||t.coords.cur.page}));if(this.result=h,!h.changed&&(!u||u<this.states.length)&&t.interacting())return!1;if(e.modifiedCoords){const{page:r}=t.coords.cur,p={x:e.modifiedCoords.x-r.x,y:e.modifiedCoords.y-r.y};h.coords.x+=p.x,h.coords.y+=p.y,h.delta.x+=p.x,h.delta.y+=p.y}this.applyToInteraction(e)}beforeEnd(e){const{interaction:t,event:i}=e,o=this.states;if(!o||!o.length)return;let u=!1;for(const h of o){e.state=h;const{options:r,methods:p}=h,g=p.beforeEnd&&p.beforeEnd(e);if(g)return this.endResult=g,!1;u=u||!u&&this.shouldDo(r,!0,e.phase,!0)}u&&t.move({event:i,preEnd:!0})}stop(e){const{interaction:t}=e;if(!this.states||!this.states.length)return;const i=Ui({states:this.states,interactable:t.interactable,element:t.element,rect:null},e);this.fillArg(i);for(const o of this.states)i.state=o,o.methods.stop&&o.methods.stop(i);this.states=null,this.endResult=null}prepareStates(e){this.states=[];for(let t=0;t<e.length;t++){const{options:i,methods:o,name:u}=e[t];this.states.push({options:i,methods:o,index:t,name:u})}return this.states}restoreInteractionCoords({interaction:{coords:e,rect:t,modification:i}}){if(!i.result)return;const{startDelta:o}=i,{delta:u,rectDelta:h}=i.result,r=[[e.start,o],[e.cur,u]];for(const[p,g]of r)p.page.x-=g.x,p.page.y-=g.y,p.client.x-=g.x,p.client.y-=g.y;t.left-=h.left,t.right-=h.right,t.top-=h.top,t.bottom-=h.bottom}shouldDo(e,t,i,o){return!(!e||e.enabled===!1||o&&!e.endOnly||e.endOnly&&!t||i==="start"&&!e.setStart)}copyFrom(e){this.startOffset=e.startOffset,this.startDelta=e.startDelta,this.startEdges=e.startEdges,this.edges=e.edges,this.states=e.states.map(t=>FA(t)),this.result=zv(Ui({},e.result.coords),Ui({},e.result.rect))}destroy(){for(const e in this)this[e]=null}}function zv(n,e){return{rect:e,coords:n,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function JX(n){const e=n.interactable.options[n.prepared.name],t=e.modifiers;return t&&t.length?t:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(i=>{const o=e[i];return o&&o.enabled&&{options:o,methods:o._methods}}).filter(i=>!!i)}function XX(n,e){return n?{left:e.x-n.left,top:e.y-n.top,right:n.right-e.x,bottom:n.bottom-e.y}:{left:0,top:0,right:0,bottom:0}}function gh(n,e){const{defaults:t}=n,i={start:n.start,set:n.set,beforeEnd:n.beforeEnd,stop:n.stop},o=u=>{const h=u||{};h.enabled=h.enabled!==!1;for(const p in t)p in h||(h[p]=t[p]);const r={options:h,methods:i,name:e,enable:()=>(h.enabled=!0,r),disable:()=>(h.enabled=!1,r)};return r};return e&&typeof e=="string"&&(o._defaults=t,o._methods=i),o}function kE({iEvent:n,interaction:e}){const t=e.modification.result;t&&(n.modifiers=t.eventProps)}const ZX={id:"modifiers/base",before:["actions"],install:n=>{n.defaults.perAction.modifiers=[]},listeners:{"interactions:new":({interaction:n})=>{n.modification=new dF(n)},"interactions:before-action-start":n=>{const{interaction:e}=n,t=n.interaction.modification;t.start(n,e.coords.start.page),e.edges=t.edges,t.applyToInteraction(n)},"interactions:before-action-move":n=>{const{interaction:e}=n,{modification:t}=e,i=t.setAndApply(n);return e.edges=t.edges,i},"interactions:before-action-end":n=>{const{interaction:e}=n,{modification:t}=e,i=t.beforeEnd(n);return e.edges=t.startEdges,i},"interactions:action-start":kE,"interactions:action-move":kE,"interactions:action-end":kE,"interactions:after-action-start":n=>n.interaction.modification.restoreInteractionCoords(n),"interactions:after-action-move":n=>n.interaction.modification.restoreInteractionCoords(n),"interactions:stop":n=>n.interaction.modification.stop(n)}},$X=ZX,eZ={start(n){const{state:e,rect:t,edges:i,pageCoords:o}=n;let{ratio:u,enabled:h}=e.options;const{equalDelta:r,modifiers:p}=e.options;u==="preserve"&&(u=t.width/t.height),e.startCoords=Ui({},o),e.startRect=Ui({},t),e.ratio=u,e.equalDelta=r;const g=e.linkedEdges={top:i.top||i.left&&!i.bottom,left:i.left||i.top&&!i.right,bottom:i.bottom||i.right&&!i.top,right:i.right||i.bottom&&!i.left};if(e.xIsPrimaryAxis=!!(i.left||i.right),e.equalDelta){const I=(g.left?1:-1)*(g.top?1:-1);e.edgeSign={x:I,y:I}}else e.edgeSign={x:g.left?-1:1,y:g.top?-1:1};if(h!==!1&&Ui(i,g),!(p!=null&&p.length))return;const v=new dF(n.interaction);v.copyFrom(n.interaction.modification),v.prepareStates(p),e.subModification=v,v.startAll({...n})},set(n){const{state:e,rect:t,coords:i}=n,{linkedEdges:o}=e,u=Ui({},i),h=e.equalDelta?tZ:iZ;if(Ui(n.edges,o),h(e,e.xIsPrimaryAxis,i,t),!e.subModification)return null;const r=Ui({},t);NB(o,r,{x:i.x-u.x,y:i.y-u.y});const p=e.subModification.setAll({...n,rect:r,edges:o,pageCoords:i,prevCoords:i,prevRect:r}),{delta:g}=p;if(p.changed){const v=Math.abs(g.x)>Math.abs(g.y);h(e,v,p.coords,p.rect),Ui(i,p.coords)}return p.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function tZ({startCoords:n,edgeSign:e},t,i){t?i.y=n.y+(i.x-n.x)*e.y:i.x=n.x+(i.y-n.y)*e.x}function iZ({startRect:n,startCoords:e,ratio:t,edgeSign:i},o,u,h){if(o){const r=h.width/t;u.y=e.y+(r-n.height)*i.y}else{const r=h.height*t;u.x=e.x+(r-n.width)*i.x}}const nZ=gh(eZ,"aspectRatio"),fF=()=>{};fF._defaults={};const Uv=fF;function rZ({rect:n,startOffset:e,state:t,interaction:i,pageCoords:o}){const{options:u}=t,{elementRect:h}=u,r=Ui({left:0,top:0,right:0,bottom:0},u.offset||{});if(n&&h){const p=sf(u.restriction,i,o);if(p){const g=p.right-p.left-n.width,v=p.bottom-p.top-n.height;g<0&&(r.left+=g,r.right+=g),v<0&&(r.top+=v,r.bottom+=v)}r.left+=e.left-n.width*h.left,r.top+=e.top-n.height*h.top,r.right+=e.right-n.width*(1-h.right),r.bottom+=e.bottom-n.height*(1-h.bottom)}t.offset=r}function sZ({coords:n,interaction:e,state:t}){const{options:i,offset:o}=t,u=sf(i.restriction,e,n);if(!u)return;const h=KJ(u);n.x=Math.max(Math.min(h.right-o.right,n.x),h.left+o.left),n.y=Math.max(Math.min(h.bottom-o.bottom,n.y),h.top+o.top)}function sf(n,e,t){return ui.func(n)?u0(n,e.interactable,e.element,[t.x,t.y,e]):u0(n,e.interactable,e.element)}const oZ={restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1},Hx={start:rZ,set:sZ,defaults:oZ},aZ=gh(Hx,"restrict"),pF={top:1/0,left:1/0,bottom:-1/0,right:-1/0},AF={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function lZ({interaction:n,startOffset:e,state:t}){const{options:i}=t;let o;if(i){const u=sf(i.offset,n,n.coords.start.page);o=Q1(u)}o=o||{x:0,y:0},t.offset={top:o.y+e.top,left:o.x+e.left,bottom:o.y-e.bottom,right:o.x-e.right}}function cZ({coords:n,edges:e,interaction:t,state:i}){const{offset:o,options:u}=i;if(!e)return;const h=Ui({},n),r=sf(u.inner,t,h)||{},p=sf(u.outer,t,h)||{};E3(r,pF),E3(p,AF),e.top?n.y=Math.min(Math.max(p.top+o.top,h.y),r.top+o.top):e.bottom&&(n.y=Math.max(Math.min(p.bottom+o.bottom,h.y),r.bottom+o.bottom)),e.left?n.x=Math.min(Math.max(p.left+o.left,h.x),r.left+o.left):e.right&&(n.x=Math.max(Math.min(p.right+o.right,h.x),r.right+o.right))}function E3(n,e){for(const t of["top","left","bottom","right"])t in n||(n[t]=e[t]);return n}const uZ={inner:null,outer:null,offset:null,endOnly:!1,enabled:!1},P_={noInner:pF,noOuter:AF,start:lZ,set:cZ,defaults:uZ},hZ=gh(P_,"restrictEdges"),dZ=Ui({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(n){}},Hx.defaults),fZ={start:Hx.start,set:Hx.set,defaults:dZ},pZ=gh(fZ,"restrictRect"),AZ={width:-1/0,height:-1/0},gZ={width:1/0,height:1/0};function mZ(n){return P_.start(n)}function _Z(n){const{interaction:e,state:t,rect:i,edges:o}=n,{options:u}=t;if(!o)return;const h=g3(sf(u.min,e,n.coords))||AZ,r=g3(sf(u.max,e,n.coords))||gZ;t.options={endOnly:u.endOnly,inner:Ui({},P_.noInner),outer:Ui({},P_.noOuter)},o.top?(t.options.inner.top=i.bottom-h.height,t.options.outer.top=i.bottom-r.height):o.bottom&&(t.options.inner.bottom=i.top+h.height,t.options.outer.bottom=i.top+r.height),o.left?(t.options.inner.left=i.right-h.width,t.options.outer.left=i.right-r.width):o.right&&(t.options.inner.right=i.left+h.width,t.options.outer.right=i.left+r.width),P_.set(n),t.options=u}const yZ={min:null,max:null,endOnly:!1,enabled:!1},vZ={start:mZ,set:_Z,defaults:yZ},xZ=gh(vZ,"restrictSize");function IZ(n){const{interaction:e,interactable:t,element:i,rect:o,state:u,startOffset:h}=n,{options:r}=u,p=r.offsetWithOrigin?EZ(n):{x:0,y:0};let g;if(r.offset==="startCoords")g={x:e.coords.start.page.x,y:e.coords.start.page.y};else{const I=u0(r.offset,t,i,[e]);g=Q1(I)||{x:0,y:0},g.x+=p.x,g.y+=p.y}const{relativePoints:v}=r;u.offsets=o&&v&&v.length?v.map((I,C)=>({index:C,relativePoint:I,x:h.left-o.width*I.x+g.x,y:h.top-o.height*I.y+g.y})):[{index:0,relativePoint:null,x:g.x,y:g.y}]}function CZ(n){const{interaction:e,coords:t,state:i}=n,{options:o,offsets:u}=i,h=zB(e.interactable,e.element,e.prepared.name),r=Ui({},t),p=[];o.offsetWithOrigin||(r.x-=h.x,r.y-=h.y);for(const v of u){const I=r.x-v.x,C=r.y-v.y;for(let E=0,Q=o.targets.length;E<Q;E++){const M=o.targets[E];let D;ui.func(M)?D=M(I,C,e._proxy,v,E):D=M,D&&p.push({x:(ui.number(D.x)?D.x:I)+v.x,y:(ui.number(D.y)?D.y:C)+v.y,range:ui.number(D.range)?D.range:o.range,source:M,index:E,offset:v})}}const g={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}};for(const v of p){const I=v.range,C=v.x-r.x,E=v.y-r.y,Q=R1(C,E);let M=Q<=I;I===1/0&&g.inRange&&g.range!==1/0&&(M=!1),(!g.target||(M?g.inRange&&I!==1/0?Q/I<g.distance/g.range:I===1/0&&g.range!==1/0||Q<g.distance:!g.inRange&&Q<g.distance))&&(g.target=v,g.distance=Q,g.range=I,g.inRange=M,g.delta.x=C,g.delta.y=E)}return g.inRange&&(t.x=g.target.x,t.y=g.target.y),i.closest=g,g}function EZ(n){const{element:e}=n.interaction;return Q1(u0(n.state.options.origin,null,null,[e]))||zB(n.interactable,e,n.interaction.prepared.name)}const wZ={range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1},GB={start:IZ,set:CZ,defaults:wZ},bZ=gh(GB,"snap");function BZ(n){const{state:e,edges:t}=n,{options:i}=e;if(!t)return null;n.state={options:{targets:null,relativePoints:[{x:t.left?0:1,y:t.top?0:1}],offset:i.offset||"self",origin:{x:0,y:0},range:i.range}},e.targetFields=e.targetFields||[["width","height"],["x","y"]],GB.start(n),e.offsets=n.state.offsets,n.state=e}function SZ(n){const{interaction:e,state:t,coords:i}=n,{options:o,offsets:u}=t,h={x:i.x-u[0].x,y:i.y-u[0].y};t.options=Ui({},o),t.options.targets=[];for(const p of o.targets||[]){let g;if(ui.func(p)?g=p(h.x,h.y,e):g=p,!!g){for(const[v,I]of t.targetFields)if(v in g||I in g){g.x=g[v],g.y=g[I];break}t.options.targets.push(g)}}const r=GB.set(n);return t.options=o,r}const MZ={range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1},Vx={start:BZ,set:SZ,defaults:MZ},TZ=gh(Vx,"snapSize");function DZ(n){const{edges:e}=n;return e?(n.state.targetFields=n.state.targetFields||[[e.left?"left":"right",e.top?"top":"bottom"]],Vx.start(n)):null}const QZ={start:DZ,set:Vx.set,defaults:Ui(FA(Vx.defaults),{targets:null,range:null,offset:{x:0,y:0}})},RZ=gh(QZ,"snapEdges"),FE={aspectRatio:nZ,restrictEdges:hZ,restrict:aZ,restrictRect:pZ,restrictSize:xZ,snapEdges:RZ,snap:bZ,snapSize:TZ,spring:Uv,avoid:Uv,transform:Uv,rubberband:Uv},LZ={id:"modifiers",install(n){const{interactStatic:e}=n;n.usePlugin($X),n.usePlugin(KX),e.modifiers=FE;for(const t in FE){const{_defaults:i,_methods:o}=FE[t];i._methods=o,n.defaults.perAction[t]=i}}},PZ=LZ;Dc.use(PZ);const kZ={};var uA;(function(n){n.touchAction="touchAction",n.boxSizing="boxSizing",n.noListeners="noListeners"})(uA||(uA={}));const w3="[interact.js] ",ab={touchAction:"https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action",boxSizing:"https://developer.mozilla.org/en-US/docs/Web/CSS/box-sizing"};function FZ(n,{logger:e}={}){const{Interactable:t,defaults:i}=n;n.logger=e||console,i.base.devTools={ignore:{}},t.prototype.devTools=function(o){return o?(Ui(this.options.devTools,o),this):this.options.devTools},n.usePlugin(kZ)}const b3=[{name:uA.touchAction,perform({element:n}){return!NZ(n,"touchAction",/pan-|pinch|none/)},getInfo({element:n}){return[n,ab.touchAction]},text:`Consider adding CSS "touch-action: none" to this element
`},{name:uA.boxSizing,perform(n){const{element:e}=n;return n.prepared.name==="resize"&&e instanceof ho.HTMLElement&&!gF(e,"boxSizing",/border-box/)},text:'Consider adding CSS "box-sizing: border-box" to this resizable element',getInfo({element:n}){return[n,ab.boxSizing]}},{name:uA.noListeners,perform(n){const e=n.prepared.name;return!(n.interactable.events.types[`${e}move`]||[]).length},getInfo(n){return[n.prepared.name,n.interactable]},text:"There are no listeners set for this action"}];function gF(n,e,t){const i=n.style[e]||ph.getComputedStyle(n)[e];return t.test((i||"").toString())}function NZ(n,e,t){let i=n;for(;ui.element(i);){if(gF(i,e,t))return!0;i=Ah(i)}return!1}const zZ="dev-tools",UZ={id:zZ,install:FZ,listeners:{"interactions:action-start":({interaction:n},e)=>{for(const t of b3){const i=n.interactable&&n.interactable.options;!(i&&i.devTools&&i.devTools.ignore[t.name])&&t.perform(n)&&e.logger.warn(w3+t.text,...t.getInfo(n))}}},checks:b3,CheckName:uA,links:ab,prefix:w3},OZ=UZ;Dc.use(OZ);function GZ(){const{appContext:n,proxy:e}=hh(),t=n.config.globalProperties;return{proxy:e,appContext:n,globalProperties:t}}const HZ={name:"GridItem"},HB=kn({...HZ,props:{isDraggable:{type:[Boolean,null],default:null},isResizable:{type:[Boolean,null],default:null},isBounded:{type:[Boolean,null],default:null},static:{type:Boolean,default:!1},minH:{default:1},minW:{default:1},maxH:{default:1/0},maxW:{default:1/0},x:{},y:{},w:{},h:{},i:{},dragIgnoreFrom:{default:"a, button"},dragAllowFrom:{default:null},resizeIgnoreFrom:{default:"a, button"},preserveAspectRatio:{type:Boolean,default:!1},dragOption:{default:()=>({})},resizeOption:{default:()=>({})}},emits:["container-resized","resize","resized","move","moved"],setup(n,{expose:e,emit:t}){const i=n,{proxy:o}=GZ(),u=o==null?void 0:o.$parent,h=Aa("eventBus"),r=Gt({}),p=Gt(1),g=Gt(100),v=Gt(30),I=Gt([10,10]),C=Gt(1/0),E=Gt(null),Q=Gt(null),M=Gt(1),D=Gt(!0),P=Gt(!0),O=Gt(!1),F=Gt(null),N=Gt(!1),z=Gt(null),X=Gt(NaN),q=Gt(NaN),H=Gt(NaN),W=Gt(NaN),se=Gt({}),de=Gt(!1),te=Gt(!1),ce=Gt(!1),Ee=Gt(null),Be=Gt(null),De=Gt(null),Re=Gt(null),ye=Gt(i.x),ht=Gt(i.y),oe=Gt(i.w),Tt=Gt(i.h),Fe=Gt(null),st=Gt(null),Et=cn(()=>Q.value&&!i.static),Ke=cn(()=>(E.value||Q.value)&&!i.static),Ne=cn(()=>navigator.userAgent.toLowerCase().indexOf("android")!==-1),dt=cn(()=>u!=null&&u.isMirrored?!de.value:de.value),xt=cn(()=>({"vue-resizable":Et.value,static:i.static,resizing:N.value,"vue-draggable-dragging":O.value,cssTransforms:D.value,"render-rtl":dt.value,"disable-userselect":O.value,"no-touch":Ne.value&&Ke.value})),ft=cn(()=>dt.value?"vue-resizable-handle vue-rtl-resizable-handle":"vue-resizable-handle");qi(()=>i.isDraggable,wt=>{E.value=wt}),qi(()=>i.static,()=>{fi(),Xt()}),qi(E,()=>{fi()}),qi(()=>i.isResizable,wt=>{Q.value=wt}),qi(()=>i.isBounded,wt=>{Fe.value=wt}),qi(Q,()=>{Xt()}),qi(v,()=>{Ut(),Dt()}),qi(p,()=>{Xt(),Ut(),Dt()}),qi(g,()=>{Xt(),Ut()}),qi(()=>i.x,wt=>{ye.value=wt,Ut()}),qi(()=>i.y,wt=>{ht.value=wt,Ut()}),qi(()=>i.h,wt=>{Tt.value=wt,Ut()}),qi(()=>i.w,wt=>{oe.value=wt,Ut()}),qi(dt,()=>{Xt(),Ut()}),qi(()=>i.minH,()=>{Xt()}),qi(()=>i.maxH,()=>{Xt()}),qi(()=>i.minW,()=>{Xt()}),qi(()=>i.maxW,()=>{Xt()}),qi(()=>u==null?void 0:u.margin,wt=>{!wt||wt[0]==I.value[0]&&wt[1]==I.value[1]||(I.value=wt.map(kt=>Number(kt)),Ut(),Dt())});function Ve(wt){ot(wt)}function Ye(wt){ni()}function ae(wt){i.isDraggable===null&&(E.value=wt)}function _e(wt){i.isResizable===null&&(Q.value=wt)}function Ze(wt){i.isBounded===null&&(Fe.value=wt)}function nt(wt){M.value=wt}function ut(wt){v.value=wt}function ze(wt){C.value=wt}function Qt(){de.value=u3()==="rtl",ni()}function mt(wt){const kt=wt.toString();p.value=parseInt(kt)}h.on("updateWidth",Ve),h.on("compact",Ye),h.on("setDraggable",ae),h.on("setResizable",_e),h.on("setBounded",Ze),h.on("setTransformScale",nt),h.on("setRowHeight",ut),h.on("setMaxRows",ze),h.on("directionchange",Qt),h.on("setColNum",mt),de.value=u3()==="rtl",p0(()=>{h.off("updateWidth",Ve),h.off("compact",Ye),h.off("setDraggable",ae),h.off("setResizable",_e),h.off("setBounded",Ze),h.off("setTransformScale",nt),h.off("setRowHeight",ut),h.off("setMaxRows",ze),h.off("directionchange",Qt),h.off("setColNum",mt),st.value&&st.value.unset()}),Br(()=>{u!=null&&u.responsive&&u.lastBreakpoint?p.value=$w(u.lastBreakpoint,u==null?void 0:u.cols):p.value=u==null?void 0:u.colNum,v.value=u==null?void 0:u.rowHeight,g.value=(u==null?void 0:u.width)!==null?u==null?void 0:u.width:100,I.value=(u==null?void 0:u.margin)!==void 0?u.margin:[10,10],C.value=u==null?void 0:u.maxRows,i.isDraggable===null?E.value=u==null?void 0:u.isDraggable:E.value=i.isDraggable,i.isResizable===null?Q.value=u==null?void 0:u.isResizable:Q.value=i.isResizable,i.isBounded===null?Fe.value=u==null?void 0:u.isBounded:Fe.value=i.isBounded,M.value=u==null?void 0:u.transformScale,D.value=u==null?void 0:u.useCssTransforms,P.value=u==null?void 0:u.useStyleCursor,Ut()});function Ut(){var wt,kt,yi,ee,J;i.x+i.w>p.value?(ye.value=0,oe.value=i.w>p.value?p.value:i.w):(ye.value=i.x,oe.value=i.w);let Z=at(ye.value,ht.value,oe.value,Tt.value);O.value&&(Z.top=(wt=F.value)==null?void 0:wt.top,dt.value?Z.right=(kt=F.value)==null?void 0:kt.left:Z.left=(yi=F.value)==null?void 0:yi.left),N.value&&(Z.width=(ee=z.value)==null?void 0:ee.width,Z.height=(J=z.value)==null?void 0:J.height);let Ae;D.value?dt.value?Ae=sJ(Z.top,Z.right,Z.width,Z.height):Ae=rJ(Z.top,Z.left,Z.width,Z.height):dt.value?Ae=aJ(Z.top,Z.right,Z.width,Z.height):Ae=oJ(Z.top,Z.left,Z.width,Z.height),se.value=Ae}function Dt(){let wt={};for(let kt of["width","height"]){let yi=se.value[kt].match(/^(\d+)px$/);if(!yi)return;wt[kt]=yi[1]}t("container-resized",i.i,i.h,i.w,wt.height,wt.width)}function Ie(wt){var kt,yi,ee;{if(i.static)return;const J=l3(wt);if(J==null)return;const{x:Z,y:Ae}=J,Ce={width:0,height:0};let Le;switch(wt.type){case"resizestart":{Xt(),Ee.value=oe.value,Be.value=Tt.value,Le=at(ye.value,ht.value,oe.value,Tt.value),Ce.width=Le.width,Ce.height=Le.height,z.value=Ce,N.value=!0;break}case"resizemove":{const le=c3(H.value,W.value,Z,Ae);dt.value?Ce.width=Number((kt=z.value)==null?void 0:kt.width)-le.deltaX/M.value:Ce.width=Number((yi=z.value)==null?void 0:yi.width)+le.deltaX/M.value,Ce.height=Number((ee=z.value)==null?void 0:ee.height)+le.deltaY/M.value,z.value=Ce;break}case"resizeend":{Le=at(ye.value,ht.value,oe.value,Tt.value),Ce.width=Le.width,Ce.height=Le.height,z.value=null,N.value=!1;break}}Le=Ue(Ce.height,Ce.width),Le.w<i.minW&&(Le.w=i.minW),Le.w>i.maxW&&(Le.w=i.maxW),Le.h<i.minH&&(Le.h=i.minH),Le.h>i.maxH&&(Le.h=i.maxH),Le.h<1&&(Le.h=1),Le.w<1&&(Le.w=1),H.value=Z,W.value=Ae,(oe.value!==Le.w||Tt.value!==Le.h)&&t("resize",i.i,Le.h,Le.w,Ce.height,Ce.width),wt.type==="resizeend"&&(Ee.value!==oe.value||Be.value!==Tt.value)&&t("resized",i.i,Le.h,Le.w,Ce.height,Ce.width);const Oe={eventType:wt.type,i:i.i,x:ye.value,y:ht.value,h:Le.h,w:Le.w};h.emit("resizeEvent",Oe)}}function ue(wt){var kt,yi,ee;if(i.static||N.value)return;const J=l3(wt);if(J===null)return;const{x:Z,y:Ae}=J;let Ce={top:0,left:0};switch(wt.type){case"dragstart":{De.value=ye.value,Re.value=ht.value;const le=wt.target;let me=le.offsetParent.getBoundingClientRect(),he=le.getBoundingClientRect();const Qe=he.left/M.value,Je=me.left/M.value,Xe=he.right/M.value,Ft=me.right/M.value,Wt=he.top/M.value,qt=me.top/M.value;dt.value?Ce.left=(Xe-Ft)*-1:Ce.left=Qe-Je,Ce.top=Wt-qt,F.value=Ce,O.value=!0;break}case"dragend":{if(!O.value)return;const le=wt.target;let me=le.offsetParent.getBoundingClientRect(),he=le.getBoundingClientRect();const Qe=he.left/M.value,Je=me.left/M.value,Xe=he.right/M.value,Ft=me.right/M.value,Wt=he.top/M.value,qt=me.top/M.value;dt.value?Ce.left=(Xe-Ft)*-1:Ce.left=Qe-Je,Ce.top=Wt-qt,F.value=null,O.value=!1;break}case"dragmove":{const le=c3(X.value,q.value,Z,Ae);if(dt.value?Ce.left=Number((kt=F.value)==null?void 0:kt.left)-le.deltaX/M.value:Ce.left=Number((yi=F.value)==null?void 0:yi.left)+le.deltaX/M.value,Ce.top=Number((ee=F.value)==null?void 0:ee.top)+le.deltaY/M.value,Fe.value){const me=wt.target.offsetParent.clientHeight-Pt(i.h,v.value,I.value[1]);Ce.top=Ot(Ce.top,0,me);const he=yt(),Qe=g.value-Pt(i.w,he,I.value[0]);Ce.left=Ot(Ce.left,0,Qe)}F.value=Ce;break}}let Le;dt.value,Le=St(Ce.top,Ce.left),X.value=Z,q.value=Ae,(ye.value!==Le.x||ht.value!==Le.y)&&t("move",i.i,Le.x,Le.y),wt.type==="dragend"&&(De.value!==ye.value||Re.value!==ht.value)&&t("moved",i.i,Le.x,Le.y);const Oe={eventType:wt.type,i:i.i,x:Le.x,y:Le.y,h:Tt.value,w:oe.value};h.emit("dragEvent",Oe)}function at(wt,kt,yi,ee){const J=yt();let Z;return dt.value?Z={right:Math.round(J*wt+(wt+1)*I.value[0]),top:Math.round(v.value*kt+(kt+1)*I.value[1]),width:yi===1/0?yi:Math.round(J*yi+Math.max(0,yi-1)*I.value[0]),height:ee===1/0?ee:Math.round(v.value*ee+Math.max(0,ee-1)*I.value[1])}:Z={left:Math.round(J*wt+(wt+1)*I.value[0]),top:Math.round(v.value*kt+(kt+1)*I.value[1]),width:yi===1/0?yi:Math.round(J*yi+Math.max(0,yi-1)*I.value[0]),height:ee===1/0?ee:Math.round(v.value*ee+Math.max(0,ee-1)*I.value[1])},Z}function St(wt,kt){const yi=yt();let ee=Math.round((kt-I.value[0])/(yi+I.value[0])),J=Math.round((wt-I.value[1])/(v.value+I.value[1]));return ee=Math.max(Math.min(ee,p.value-oe.value),0),J=Math.max(Math.min(J,C.value-Tt.value),0),{x:ee,y:J}}function yt(){return(g.value-I.value[0]*(p.value+1))/p.value}function Pt(wt,kt,yi){return Number.isFinite(wt)?Math.round(kt*wt+Math.max(0,wt-1)*yi):wt}function Ot(wt,kt,yi){return Math.max(Math.min(wt,yi),kt)}function Ue(wt,kt,yi=!1){const ee=yt();let J=Math.round((kt+I.value[0])/(ee+I.value[0])),Z=0;return yi?Z=Math.ceil((wt+I.value[1])/(v.value+I.value[1])):Z=Math.round((wt+I.value[1])/(v.value+I.value[1])),J=Math.max(Math.min(J,p.value-ye.value),0),Z=Math.max(Math.min(Z,C.value-ht.value),0),{w:J,h:Z}}function ot(wt,kt){g.value=wt,kt!=null&&(p.value=kt)}function ni(wt){Ut()}function fi(){if((st.value===null||st.value===void 0)&&(st.value=Dc(r.value),P.value||st.value.styleCursor(!1)),E.value&&!i.static){const wt={ignoreFrom:i.dragIgnoreFrom,allowFrom:i.dragAllowFrom,...i.dragOption};st.value.draggable(wt),te.value||(te.value=!0,st.value.on("dragstart dragmove dragend",function(kt){ue(kt)}))}else st.value.draggable({enabled:!1})}function Xt(){if((st.value===null||st.value===void 0)&&(st.value=Dc(r.value),P.value||st.value.styleCursor(!1)),Q.value&&!i.static){let wt=at(0,0,i.maxW,i.maxH),kt=at(0,0,i.minW,i.minH);const yi={edges:{left:!1,right:"."+ft.value.trim().replace(" ","."),bottom:"."+ft.value.trim().replace(" ","."),top:!1},ignoreFrom:i.resizeIgnoreFrom,restrictSize:{min:{height:kt.height*M.value,width:kt.width*M.value},max:{height:wt.height*M.value,width:wt.width*M.value}},...i.resizeOption};i.preserveAspectRatio&&(yi.modifiers=[Dc.modifiers.aspectRatio({ratio:"preserve"})]),st.value.resizable(yi),ce.value||(ce.value=!0,st.value.on("resizestart resizemove resizeend",function(ee){Ie(ee)}))}else st.value.resizable({enabled:!1})}const _i=uU();function si(){Ee.value=oe.value,Be.value=Tt.value;let wt=_i==null?void 0:_i.default[0].elm.getBoundingClientRect(),kt=Ue(wt.height,wt.width,!0);if(kt.w<i.minW&&(kt.w=i.minW),kt.w>i.maxW&&(kt.w=i.maxW),kt.h<i.minH&&(kt.h=i.minH),kt.h>i.maxH&&(kt.h=i.maxH),kt.h<1&&(kt.h=1),kt.w<1&&(kt.w=1),(oe.value!==kt.w||Tt.value!==kt.h)&&t("resize",i.i,kt.h,kt.w,wt.height,wt.width),Ee.value!==kt.w||Be.value!==kt.h){t("resized",i.i,kt.h,kt.w,wt.height,wt.width);const yi={eventType:"resizeend",i:i.i,x:ye.value,y:ht.value,h:kt.h,w:kt.w};h.emit("resizeEvent",yi)}}return e({autoSize:si,calcXY:St,dragging:F,...i}),(wt,kt)=>(Qi(),tn("div",{ref_key:"this$refsItem",ref:r,class:mn(["vue-grid-item",xt.value]),style:ya(se.value)},[VA(wt.$slots,"default",{style:ya(se.value)}),Et.value?(Qi(),tn("span",{key:0,ref:"handle",class:mn(ft.value)},null,2)):rh("",!0)],6))}});function VZ(n){return{all:n=n||new Map,on:function(e,t){var i=n.get(e);i?i.push(t):n.set(e,[t])},off:function(e,t){var i=n.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var i=n.get(e);i&&i.slice().map(function(o){o(t)}),(i=n.get("*"))&&i.slice().map(function(o){o(e,t)})}}}var VB={exports:{}},WZ=VB.exports={};WZ.forEach=function(n,e){for(var t=0;t<n.length;t++){var i=e(n[t]);if(i)return i}};var YZ=function(n){var e=n.stateHandler.getState;function t(h){var r=e(h);return r&&!!r.isDetectable}function i(h){e(h).isDetectable=!0}function o(h){return!!e(h).busy}function u(h,r){e(h).busy=!!r}return{isDetectable:t,markAsDetectable:i,isBusy:o,markBusy:u}},jZ=function(n){var e={};function t(h){var r=n.get(h);return r===void 0?[]:e[r]||[]}function i(h,r){var p=n.get(h);e[p]||(e[p]=[]),e[p].push(r)}function o(h,r){for(var p=t(h),g=0,v=p.length;g<v;++g)if(p[g]===r){p.splice(g,1);break}}function u(h){var r=t(h);!r||(r.length=0)}return{get:t,add:i,removeListener:o,removeAllListeners:u}},qZ=function(){var n=1;function e(){return n++}return{generate:e}},KZ=function(n){var e=n.idGenerator,t=n.stateHandler.getState;function i(u){var h=t(u);return h&&h.id!==void 0?h.id:null}function o(u){var h=t(u);if(!h)throw new Error("setId required the element to have a resize detection state.");var r=e.generate();return h.id=r,r}return{get:i,set:o}},JZ=function(n){function e(){}var t={log:e,warn:e,error:e};if(!n&&window.console){var i=function(o,u){o[u]=function(){var h=console[u];if(h.apply)h.apply(console,arguments);else for(var r=0;r<arguments.length;r++)h(arguments[r])}};i(t,"log"),i(t,"warn"),i(t,"error")}return t},WB={exports:{}},mF=WB.exports={};mF.isIE=function(n){function e(){var i=navigator.userAgent.toLowerCase();return i.indexOf("msie")!==-1||i.indexOf("trident")!==-1||i.indexOf(" edge/")!==-1}if(!e())return!1;if(!n)return!0;var t=function(){var i,o=3,u=document.createElement("div"),h=u.getElementsByTagName("i");do u.innerHTML="<!--[if gt IE "+ ++o+"]><i></i><![endif]-->";while(h[0]);return o>4?o:i}();return n===t};mF.isLegacyOpera=function(){return!!window.opera};var _F={exports:{}},XZ=_F.exports={};XZ.getOption=ZZ;function ZZ(n,e,t){var i=n[e];return i==null&&t!==void 0?t:i}var B3=_F.exports,$Z=function(n){n=n||{};var e=n.reporter,t=B3.getOption(n,"async",!0),i=B3.getOption(n,"auto",!0);i&&!t&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),t=!0);var o=S3(),u,h=!1;function r(E,Q){!h&&i&&t&&o.size()===0&&v(),o.add(E,Q)}function p(){for(h=!0;o.size();){var E=o;o=S3(),E.process()}h=!1}function g(E){h||(E===void 0&&(E=t),u&&(I(u),u=null),E?v():p())}function v(){u=C(p)}function I(E){var Q=clearTimeout;return Q(E)}function C(E){var Q=function(M){return setTimeout(M,0)};return Q(E)}return{add:r,force:g}};function S3(){var n={},e=0,t=0,i=0;function o(r,p){p||(p=r,r=0),r>t?t=r:r<i&&(i=r),n[r]||(n[r]=[]),n[r].push(p),e++}function u(){for(var r=i;r<=t;r++)for(var p=n[r],g=0;g<p.length;g++){var v=p[g];v()}}function h(){return e}return{add:o,process:u,size:h}}var YB="_erd";function e$(n){return n[YB]={},yF(n)}function yF(n){return n[YB]}function t$(n){delete n[YB]}var i$={initState:e$,getState:yF,cleanState:t$},Gm=WB.exports,n$=function(n){n=n||{};var e=n.reporter,t=n.batchProcessor,i=n.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function o(g,v){function I(){v(g)}if(Gm.isIE(8))i(g).object={proxy:I},g.attachEvent("onresize",I);else{var C=r(g);if(!C)throw new Error("Element is not detectable by this strategy.");C.contentDocument.defaultView.addEventListener("resize",I)}}function u(g){var v=n.important?" !important; ":"; ";return(g.join(v)+v).trim()}function h(g,v,I){I||(I=v,v=g,g=null),g=g||{},g.debug;function C(E,Q){var M=u(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),D=!1,P=window.getComputedStyle(E),O=E.offsetWidth,F=E.offsetHeight;i(E).startSize={width:O,height:F};function N(){function z(){if(P.position==="static"){E.style.setProperty("position","relative",g.important?"important":"");var H=function(W,se,de,te){function ce(Be){return Be.replace(/[^-\d\.]/g,"")}var Ee=de[te];Ee!=="auto"&&ce(Ee)!=="0"&&(W.warn("An element that is positioned static has style."+te+"="+Ee+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+te+" will be set to 0. Element: ",se),se.style.setProperty(te,"0",g.important?"important":""))};H(e,E,P,"top"),H(e,E,P,"right"),H(e,E,P,"bottom"),H(e,E,P,"left")}}function X(){D||z();function H(se,de){if(!se.contentDocument){var te=i(se);te.checkForObjectDocumentTimeoutId&&window.clearTimeout(te.checkForObjectDocumentTimeoutId),te.checkForObjectDocumentTimeoutId=setTimeout(function(){te.checkForObjectDocumentTimeoutId=0,H(se,de)},100);return}de(se.contentDocument)}var W=this;H(W,function(se){Q(E)})}P.position!==""&&(z(),D=!0);var q=document.createElement("object");q.style.cssText=M,q.tabIndex=-1,q.type="text/html",q.setAttribute("aria-hidden","true"),q.onload=X,Gm.isIE()||(q.data="about:blank"),i(E)&&(E.appendChild(q),i(E).object=q,Gm.isIE()&&(q.data="about:blank"))}t?t.add(N):N()}Gm.isIE(8)?I(v):C(v,I)}function r(g){return i(g).object}function p(g){if(i(g)){var v=r(g);!v||(Gm.isIE(8)?g.detachEvent("onresize",v.proxy):g.removeChild(v),i(g).checkForObjectDocumentTimeoutId&&window.clearTimeout(i(g).checkForObjectDocumentTimeoutId),delete i(g).object)}}return{makeDetectable:h,addListener:o,uninstall:p}},r$=VB.exports.forEach,s$=function(n){n=n||{};var e=n.reporter,t=n.batchProcessor,i=n.stateHandler.getState;n.stateHandler.hasState;var o=n.idHandler;if(!t)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var u=v(),h="erd_scroll_detection_scrollbar_style",r="erd_scroll_detection_container";function p(N){I(N,h,r)}p(window.document);function g(N){var z=n.important?" !important; ":"; ";return(N.join(z)+z).trim()}function v(){var N=500,z=500,X=document.createElement("div");X.style.cssText=g(["position: absolute","width: "+N*2+"px","height: "+z*2+"px","visibility: hidden","margin: 0","padding: 0"]);var q=document.createElement("div");q.style.cssText=g(["position: absolute","width: "+N+"px","height: "+z+"px","overflow: scroll","visibility: none","top: "+-N*3+"px","left: "+-z*3+"px","visibility: hidden","margin: 0","padding: 0"]),q.appendChild(X),document.body.insertBefore(q,document.body.firstChild);var H=N-q.clientWidth,W=z-q.clientHeight;return document.body.removeChild(q),{width:H,height:W}}function I(N,z,X){function q(de,te){te=te||function(Ee){N.head.appendChild(Ee)};var ce=N.createElement("style");return ce.innerHTML=de,ce.id=z,te(ce),ce}if(!N.getElementById(z)){var H=X+"_animation",W=X+"_animation_active",se=`/* Created by the element-resize-detector library. */
`;se+="."+X+" > div::-webkit-scrollbar { "+g(["display: none"])+` }

`,se+="."+W+" { "+g(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+H,"animation-name: "+H])+` }
`,se+="@-webkit-keyframes "+H+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,se+="@keyframes "+H+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",q(se)}}function C(N){N.className+=" "+r+"_animation_active"}function E(N,z,X){if(N.addEventListener)N.addEventListener(z,X);else if(N.attachEvent)N.attachEvent("on"+z,X);else return e.error("[scroll] Don't know how to add event listeners.")}function Q(N,z,X){if(N.removeEventListener)N.removeEventListener(z,X);else if(N.detachEvent)N.detachEvent("on"+z,X);else return e.error("[scroll] Don't know how to remove event listeners.")}function M(N){return i(N).container.childNodes[0].childNodes[0].childNodes[0]}function D(N){return i(N).container.childNodes[0].childNodes[0].childNodes[1]}function P(N,z){var X=i(N).listeners;if(!X.push)throw new Error("Cannot add listener to an element that is not detectable.");i(N).listeners.push(z)}function O(N,z,X){X||(X=z,z=N,N=null),N=N||{};function q(){if(N.debug){var ft=Array.prototype.slice.call(arguments);if(ft.unshift(o.get(z),"Scroll: "),e.log.apply)e.log.apply(null,ft);else for(var Ve=0;Ve<ft.length;Ve++)e.log(ft[Ve])}}function H(ft){function Ve(Ye){var ae=Ye.getRootNode&&Ye.getRootNode().contains(Ye);return Ye===Ye.ownerDocument.body||Ye.ownerDocument.body.contains(Ye)||ae}return!Ve(ft)||window.getComputedStyle(ft)===null}function W(ft){var Ve=i(ft).container.childNodes[0],Ye=window.getComputedStyle(Ve);return!Ye.width||Ye.width.indexOf("px")===-1}function se(){var ft=window.getComputedStyle(z),Ve={};return Ve.position=ft.position,Ve.width=z.offsetWidth,Ve.height=z.offsetHeight,Ve.top=ft.top,Ve.right=ft.right,Ve.bottom=ft.bottom,Ve.left=ft.left,Ve.widthCSS=ft.width,Ve.heightCSS=ft.height,Ve}function de(){var ft=se();i(z).startSize={width:ft.width,height:ft.height},q("Element start size",i(z).startSize)}function te(){i(z).listeners=[]}function ce(){if(q("storeStyle invoked."),!i(z)){q("Aborting because element has been uninstalled");return}var ft=se();i(z).style=ft}function Ee(ft,Ve,Ye){i(ft).lastWidth=Ve,i(ft).lastHeight=Ye}function Be(ft){return M(ft).childNodes[0]}function De(){return 2*u.width+1}function Re(){return 2*u.height+1}function ye(ft){return ft+10+De()}function ht(ft){return ft+10+Re()}function oe(ft){return ft*2+De()}function Tt(ft){return ft*2+Re()}function Fe(ft,Ve,Ye){var ae=M(ft),_e=D(ft),Ze=ye(Ve),nt=ht(Ye),ut=oe(Ve),ze=Tt(Ye);ae.scrollLeft=Ze,ae.scrollTop=nt,_e.scrollLeft=ut,_e.scrollTop=ze}function st(){var ft=i(z).container;if(!ft){ft=document.createElement("div"),ft.className=r,ft.style.cssText=g(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),i(z).container=ft,C(ft),z.appendChild(ft);var Ve=function(){i(z).onRendered&&i(z).onRendered()};E(ft,"animationstart",Ve),i(z).onAnimationStart=Ve}return ft}function Et(){function ft(){var Ot=i(z).style;if(Ot.position==="static"){z.style.setProperty("position","relative",N.important?"important":"");var Ue=function(ot,ni,fi,Xt){function _i(wt){return wt.replace(/[^-\d\.]/g,"")}var si=fi[Xt];si!=="auto"&&_i(si)!=="0"&&(ot.warn("An element that is positioned static has style."+Xt+"="+si+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Xt+" will be set to 0. Element: ",ni),ni.style[Xt]=0)};Ue(e,z,Ot,"top"),Ue(e,z,Ot,"right"),Ue(e,z,Ot,"bottom"),Ue(e,z,Ot,"left")}}function Ve(Ot,Ue,ot,ni){return Ot=Ot?Ot+"px":"0",Ue=Ue?Ue+"px":"0",ot=ot?ot+"px":"0",ni=ni?ni+"px":"0",["left: "+Ot,"top: "+Ue,"right: "+ni,"bottom: "+ot]}if(q("Injecting elements"),!i(z)){q("Aborting because element has been uninstalled");return}ft();var Ye=i(z).container;Ye||(Ye=st());var ae=u.width,_e=u.height,Ze=g(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),nt=g(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(Ve(-(1+ae),-(1+_e),-_e,-ae))),ut=g(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),ze=g(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Qt=g(["position: absolute","left: 0","top: 0"]),mt=g(["position: absolute","width: 200%","height: 200%"]),Ut=document.createElement("div"),Dt=document.createElement("div"),Ie=document.createElement("div"),ue=document.createElement("div"),at=document.createElement("div"),St=document.createElement("div");Ut.dir="ltr",Ut.style.cssText=Ze,Ut.className=r,Dt.className=r,Dt.style.cssText=nt,Ie.style.cssText=ut,ue.style.cssText=Qt,at.style.cssText=ze,St.style.cssText=mt,Ie.appendChild(ue),at.appendChild(St),Dt.appendChild(Ie),Dt.appendChild(at),Ut.appendChild(Dt),Ye.appendChild(Ut);function yt(){var Ot=i(z);Ot&&Ot.onExpand?Ot.onExpand():q("Aborting expand scroll handler: element has been uninstalled")}function Pt(){var Ot=i(z);Ot&&Ot.onShrink?Ot.onShrink():q("Aborting shrink scroll handler: element has been uninstalled")}E(Ie,"scroll",yt),E(at,"scroll",Pt),i(z).onExpandScroll=yt,i(z).onShrinkScroll=Pt}function Ke(){function ft(ut,ze,Qt){var mt=Be(ut),Ut=ye(ze),Dt=ht(Qt);mt.style.setProperty("width",Ut+"px",N.important?"important":""),mt.style.setProperty("height",Dt+"px",N.important?"important":"")}function Ve(ut){var ze=z.offsetWidth,Qt=z.offsetHeight,mt=ze!==i(z).lastWidth||Qt!==i(z).lastHeight;q("Storing current size",ze,Qt),Ee(z,ze,Qt),t.add(0,function(){if(mt){if(!i(z)){q("Aborting because element has been uninstalled");return}if(!Ye()){q("Aborting because element container has not been initialized");return}if(N.debug){var Ut=z.offsetWidth,Dt=z.offsetHeight;(Ut!==ze||Dt!==Qt)&&e.warn(o.get(z),"Scroll: Size changed before updating detector elements.")}ft(z,ze,Qt)}}),t.add(1,function(){if(!i(z)){q("Aborting because element has been uninstalled");return}if(!Ye()){q("Aborting because element container has not been initialized");return}Fe(z,ze,Qt)}),mt&&ut&&t.add(2,function(){if(!i(z)){q("Aborting because element has been uninstalled");return}if(!Ye()){q("Aborting because element container has not been initialized");return}ut()})}function Ye(){return!!i(z).container}function ae(){function ut(){return i(z).lastNotifiedWidth===void 0}q("notifyListenersIfNeeded invoked");var ze=i(z);if(ut()&&ze.lastWidth===ze.startSize.width&&ze.lastHeight===ze.startSize.height)return q("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(ze.lastWidth===ze.lastNotifiedWidth&&ze.lastHeight===ze.lastNotifiedHeight)return q("Not notifying: Size already notified");q("Current size not notified, notifying..."),ze.lastNotifiedWidth=ze.lastWidth,ze.lastNotifiedHeight=ze.lastHeight,r$(i(z).listeners,function(Qt){Qt(z)})}function _e(){if(q("startanimation triggered."),W(z)){q("Ignoring since element is still unrendered...");return}q("Element rendered.");var ut=M(z),ze=D(z);(ut.scrollLeft===0||ut.scrollTop===0||ze.scrollLeft===0||ze.scrollTop===0)&&(q("Scrollbars out of sync. Updating detector elements..."),Ve(ae))}function Ze(){if(q("Scroll detected."),W(z)){q("Scroll event fired while unrendered. Ignoring...");return}Ve(ae)}if(q("registerListenersAndPositionElements invoked."),!i(z)){q("Aborting because element has been uninstalled");return}i(z).onRendered=_e,i(z).onExpand=Ze,i(z).onShrink=Ze;var nt=i(z).style;ft(z,nt.width,nt.height)}function Ne(){if(q("finalizeDomMutation invoked."),!i(z)){q("Aborting because element has been uninstalled");return}var ft=i(z).style;Ee(z,ft.width,ft.height),Fe(z,ft.width,ft.height)}function dt(){X(z)}function xt(){q("Installing..."),te(),de(),t.add(0,ce),t.add(1,Et),t.add(2,Ke),t.add(3,Ne),t.add(4,dt)}q("Making detectable..."),H(z)?(q("Element is detached"),st(),q("Waiting until element is attached..."),i(z).onRendered=function(){q("Element is now attached"),xt()}):xt()}function F(N){var z=i(N);!z||(z.onExpandScroll&&Q(M(N),"scroll",z.onExpandScroll),z.onShrinkScroll&&Q(D(N),"scroll",z.onShrinkScroll),z.onAnimationStart&&Q(z.container,"animationstart",z.onAnimationStart),z.container&&N.removeChild(z.container))}return{makeDetectable:O,addListener:P,uninstall:F,initDocument:p}},o_=VB.exports.forEach,o$=YZ,a$=jZ,l$=qZ,c$=KZ,u$=JZ,M3=WB.exports,h$=$Z,Su=i$,d$=n$,f$=s$;function T3(n){return Array.isArray(n)||n.length!==void 0}function D3(n){if(Array.isArray(n))return n;var e=[];return o_(n,function(t){e.push(t)}),e}function Q3(n){return n&&n.nodeType===1}var p$=function(n){n=n||{};var e;if(n.idHandler)e={get:function(O){return n.idHandler.get(O,!0)},set:n.idHandler.set};else{var t=l$(),i=c$({idGenerator:t,stateHandler:Su});e=i}var o=n.reporter;if(!o){var u=o===!1;o=u$(u)}var h=Mu(n,"batchProcessor",h$({reporter:o})),r={};r.callOnAdd=!!Mu(n,"callOnAdd",!0),r.debug=!!Mu(n,"debug",!1);var p=a$(e),g=o$({stateHandler:Su}),v,I=Mu(n,"strategy","object"),C=Mu(n,"important",!1),E={reporter:o,batchProcessor:h,stateHandler:Su,idHandler:e,important:C};if(I==="scroll"&&(M3.isLegacyOpera()?(o.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),I="object"):M3.isIE(9)&&(o.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),I="object")),I==="scroll")v=f$(E);else if(I==="object")v=d$(E);else throw new Error("Invalid strategy name: "+I);var Q={};function M(O,F,N){function z(de){var te=p.get(de);o_(te,function(ce){ce(de)})}function X(de,te,ce){p.add(te,ce),de&&ce(te)}if(N||(N=F,F=O,O={}),!F)throw new Error("At least one element required.");if(!N)throw new Error("Listener required.");if(Q3(F))F=[F];else if(T3(F))F=D3(F);else return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var q=0,H=Mu(O,"callOnAdd",r.callOnAdd),W=Mu(O,"onReady",function(){}),se=Mu(O,"debug",r.debug);o_(F,function(de){Su.getState(de)||(Su.initState(de),e.set(de));var te=e.get(de);if(se&&o.log("Attaching listener to element",te,de),!g.isDetectable(de)){if(se&&o.log(te,"Not detectable."),g.isBusy(de)){se&&o.log(te,"System busy making it detectable"),X(H,de,N),Q[te]=Q[te]||[],Q[te].push(function(){q++,q===F.length&&W()});return}return se&&o.log(te,"Making detectable..."),g.markBusy(de,!0),v.makeDetectable({debug:se,important:C},de,function(ce){if(se&&o.log(te,"onElementDetectable"),Su.getState(ce)){g.markAsDetectable(ce),g.markBusy(ce,!1),v.addListener(ce,z),X(H,ce,N);var Ee=Su.getState(ce);if(Ee&&Ee.startSize){var Be=ce.offsetWidth,De=ce.offsetHeight;(Ee.startSize.width!==Be||Ee.startSize.height!==De)&&z(ce)}Q[te]&&o_(Q[te],function(Re){Re()})}else se&&o.log(te,"Element uninstalled before being detectable.");delete Q[te],q++,q===F.length&&W()})}se&&o.log(te,"Already detecable, adding listener."),X(H,de,N),q++}),q===F.length&&W()}function D(O){if(!O)return o.error("At least one element is required.");if(Q3(O))O=[O];else if(T3(O))O=D3(O);else return o.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");o_(O,function(F){p.removeAllListeners(F),v.uninstall(F),Su.cleanState(F)})}function P(O){v.initDocument&&v.initDocument(O)}return{listenTo:M,removeListener:p.removeListener,removeAllListeners:p.removeAllListeners,uninstall:D,initDocument:P}};function Mu(n,e,t){var i=n[e];return i==null&&t!==void 0?t:i}const A$={name:"GridLayout"},vF=kn({...A$,props:{autoSize:{type:Boolean,default:!0},colNum:{default:12},rowHeight:{default:100},maxRows:{default:1/0},margin:{default:()=>[10,10]},isDraggable:{type:Boolean,default:!0},isResizable:{type:Boolean,default:!0},isMirrored:{type:Boolean,default:!1},isBounded:{type:Boolean,default:!1},useCssTransforms:{type:Boolean,default:!0},verticalCompact:{type:Boolean,default:!0},restoreOnDrag:{type:Boolean,default:!1},layout:{},responsive:{type:Boolean,default:!1},responsiveLayouts:{default:()=>({})},transformScale:{default:1},breakpoints:{default:()=>({lg:1200,md:996,sm:768,xs:480,xxs:0})},cols:{default:()=>({lg:12,md:10,sm:6,xs:4,xxs:2})},preventCollision:{type:Boolean,default:!1},useStyleCursor:{type:Boolean,default:!0}},emits:["layout-created","layout-before-mount","layout-mounted","layout-updated","layout-ready","update:layout","breakpoint-changed"],setup(n,{expose:e,emit:t}){const i=n,o=Gt(null),u=Gt({}),h=Gt(0),r=Gt(!1),p=Gt({x:0,y:0,w:0,h:0,i:-1}),g=Gt({}),v=Gt(null),I=Gt(null),C=Gt(null),E=Gt(),Q=Gt({}),M=Gt(),D=VZ();c_("eventBus",D);function P(te){if(!te)H();else{const{eventType:ce,i:Ee,x:Be,y:De,h:Re,w:ye}=te;H(ce,Ee,Be,De,Re,ye)}}function O(te){if(!te)q();else{const{eventType:ce,i:Ee,x:Be,y:De,h:Re,w:ye}=te;q(ce,Ee,Be,De,Re,ye)}}D.on("resizeEvent",P),D.on("dragEvent",O),t("layout-created",i.layout),p0(()=>{D.off("resizeEvent",P),D.off("dragEvent",O),gJ("resize",z),C.value&&C.value.uninstall(Q.value)}),QR(()=>{t("layout-before-mount",i.layout)}),Br(()=>{t("layout-mounted",i.layout),Gr(function(){lJ(i.layout),I.value=i.layout,Gr(()=>{se(),z(),AJ("resize",z),zp(i.layout,i.verticalCompact),t("layout-updated",i.layout),N(),Gr(()=>{C.value=p$({strategy:"scroll",callOnAdd:!1}),C.value.listenTo(Q.value,function(){z()})})})})}),qi(o,(te,ce)=>{Gr(()=>{D.emit("updateWidth",te),ce===null&&Gr(()=>{t("layout-ready",i.layout)}),N()})}),qi(()=>i.layout,()=>{F()}),qi(()=>i.layout.length,()=>{F()}),qi(()=>i.colNum,te=>{D.emit("setColNum",te)}),qi(()=>i.rowHeight,te=>{D.emit("setRowHeight",te)}),qi(()=>i.isDraggable,te=>{D.emit("setDraggable",te)}),qi(()=>i.isResizable,te=>{D.emit("setResizable",te)}),qi(()=>i.isBounded,te=>{D.emit("setBounded",te)}),qi(()=>i.transformScale,te=>{D.emit("setTransformScale",te)}),qi(()=>i.responsive,te=>{te||(t("update:layout",I.value||[]),D.emit("setColNum",i.colNum)),z()}),qi(()=>i.maxRows,te=>{D.emit("setMaxRows",te)}),qi(()=>i.margin,()=>{N()});function F(){if(i.layout!==void 0&&I.value!==null){if(i.layout.length!==I.value.length){let te=de(i.layout,I.value);te.length>0&&(i.layout.length>I.value.length?I.value=I.value.concat(te):I.value=I.value.filter(ce=>!te.some(Ee=>ce.i===Ee.i))),h.value=i.layout.length,se()}zp(i.layout,i.verticalCompact),D.emit("updateWidth",o.value),N(),t("layout-updated",i.layout)}}function N(){u.value={height:X()}}function z(){Q.value!==null&&Q.value!==void 0&&(o.value=Q.value.offsetWidth),D.emit("resizeEvent")}function X(){return i.autoSize?eJ(i.layout)*(i.rowHeight+i.margin[1])+i.margin[1]+"px":""}function q(te,ce,Ee,Be,De,Re){let ye=o3(i.layout,ce);ye==null&&(ye={x:0,y:0}),te==="dragstart"&&!i.verticalCompact&&(E.value=i.layout.reduce((oe,{i:Tt,x:Fe,y:st})=>({...oe,[Tt]:{x:Fe,y:st}}),{})),te==="dragmove"||te==="dragstart"?(p.value.i=ce,p.value.x=ye.x,p.value.y=ye.y,p.value.w=Re,p.value.h=De,Gr(function(){r.value=!0}),D.emit("updateWidth",o.value)):Gr(function(){r.value=!1});const ht=Zw(i.layout,ye,Ee,Be,!0,i.preventCollision);t("update:layout",ht),i.restoreOnDrag?(ye.static=!0,zp(i.layout,i.verticalCompact,E.value),ye.static=!1):zp(i.layout,i.verticalCompact),D.emit("compact"),N(),te==="dragend"&&(E.value=void 0,t("layout-updated",ht))}function H(te,ce,Ee,Be,De,Re){let ye=o3(i.layout,ce);ye==null&&(ye={h:0,w:0}),Re=Number(Re),De=Number(De);let ht;if(i.preventCollision){const oe=Fk(i.layout,{...ye,w:Re,h:De}).filter(Tt=>Tt.i!==(ye==null?void 0:ye.i));if(ht=oe.length>0,ht){let Tt=1/0,Fe=1/0;oe.forEach(st=>{st.x>Number(ye==null?void 0:ye.x)&&(Tt=Math.min(Tt,st.x)),st.y>Number(ye==null?void 0:ye.y)&&(Fe=Math.min(Fe,st.y))}),Number.isFinite(Tt)&&(ye.w=Tt-ye.x),Number.isFinite(Fe)&&(ye.h=Fe-ye.y)}}ht||(ye.w=Re,ye.h=De),te==="resizestart"||te==="resizemove"?(p.value.i=ce,p.value.x=Ee,p.value.y=Be,p.value.w=ye.w,p.value.h=ye.h,Gr(function(){r.value=!0}),D.emit("updateWidth",o.value)):Gr(function(){r.value=!1}),i.responsive&&W(),zp(i.layout,i.verticalCompact),D.emit("compact"),N(),te==="resizeend"&&t("layout-updated",i.layout)}function W(){let te=hJ(i.breakpoints,o.value),ce=$w(te,i.cols);v.value!=null&&!g.value[v.value]&&(g.value[v.value]=Xw(i.layout));let Ee=dJ(I.value,g.value,i.breakpoints,te,v.value,ce,i.verticalCompact);g.value[te]=Ee,v.value!==te&&t("breakpoint-changed",te,Ee),t("update:layout",Ee),v.value=te,D.emit("setColNum",$w(te,i.cols))}function se(){g.value=Object.assign({},i.responsiveLayouts)}function de(te,ce){let Ee=te.filter(function(De){return!ce.some(function(Re){return De.i===Re.i})}),Be=ce.filter(function(De){return!te.some(function(Re){return De.i===Re.i})});return Ee.concat(Be)}return e({...i,width:o,mergeStyle:u,lastLayoutLength:h,isDragging:r,placeholder:p,layouts:g,lastBreakpoint:v,originalLayout:I,erd:C,defaultGridItem:M,dragEvent:q}),(te,ce)=>(Qi(),tn("div",{ref_key:"this$refsLayout",ref:Q,class:"vue-grid-layout",style:ya(u.value)},[VA(te.$slots,"default"),H_(Di(HB,{ref_key:"defaultGridItem",ref:M,class:"vue-grid-placeholder",x:p.value.x,y:p.value.y,w:p.value.w,h:p.value.h,i:p.value.i},null,8,["x","y","w","h","i"]),[[Ob,r.value]])],4))}}),g$=kn({name:"WindowPortal",components:{},props:{open:Boolean,showIcon:{type:Boolean,default:!1},windowTitle:{type:String,default:"Popup window"}},emits:["update:open"],setup(n,e){const t=Gt(null),i=Gt(null),o=Gt(null),u=(v,I)=>{Array.from(v.styleSheets).forEach(C=>{if(C instanceof CSSStyleSheet){const E=v.createElement("style");Array.from(C.cssRules).forEach(Q=>{E.appendChild(v.createTextNode(Q.cssText))}),I.head.appendChild(E)}else if("href"in C&&C.href){const E=v.createElement("link");E.rel="stylesheet",E.href=C.href,I.head.appendChild(E)}})},h=()=>{if(o.value){const v=o.value.children[0].getBoundingClientRect();if(console.log(v),v)return{h:v.height,w:v.width,t:v.top,l:v.left}}return{h:400,w:500,t:200,l:200}},r=()=>{const v=h();t.value=window.open("","",`popup,width=${v.w},height=${v.h},left=${v.l},top=${v.t}`),t.value&&o.value&&(e.slots&&e.slots.default&&console.log(e.slots.default()[0]),i.value=o.value.parentElement,t.value.document.title=n.windowTitle,t.value.document.body.append(o.value),u(document,t.value.document),t.value.addEventListener("beforeunload",p))},p=()=>{var v;t.value&&((v=i.value)==null||v.append(...Array.from(t.value.document.body.childNodes)),t.value.close(),t.value=null,e.emit("update:open",!1))},g=()=>{n.open?e.emit("update:open",!1):(e.emit("update:open",!0),r())};return qi(()=>n.open,v=>{v&&r()}),p0(()=>{t.value&&p()}),{togglePortal:g,detachableWindow:o}}});const m$={class:"detachable__window",ref:"detachableWindow"};function _$(n,e,t,i,o,u){return Qi(),tn("div",m$,[VA(n.$slots,"default",{},void 0,!0)],512)}const y$=ns(g$,[["render",_$],["__scopeId","data-v-6e35e3d6"]]),v$=n=>(OA("data-v-6e150443"),n=n(),GA(),n),x$=["onMousedown"],I$=v$(()=>Yt("button",{class:"h-3 w-3 rounded-full bg-amber-500 hover:bg-amber-400"},null,-1)),C$={class:"flex-1 overflow-auto bg-zinc-200/20"},E$=kn({__name:"Window",props:{windowId:{type:String,required:!0},open:{type:Boolean,required:!0}},emits:["update:open"],setup(n,{emit:e}){const t=window.innerWidth,i=window.innerHeight,o=RP(),{layoutBounds:u}=No(o),h=Gt(!1),r=Gt(null),p=Gt({x:t/2,y:i/5}),g=Gt({left:t/2,top:i/5}),v=Gt(!1),I=()=>{e("update:open",!1)},C=M=>{v.value=!0,p.value.x=M.clientX-g.value.left,p.value.y=M.clientY-g.value.top,window.addEventListener("mousemove",E),window.addEventListener("touchmove",E),window.addEventListener("mouseup",Q),window.addEventListener("touchend",Q)},E=M=>{if(M.preventDefault(),v.value){const D=r.value.getBoundingClientRect(),P=M instanceof MouseEvent?M.clientX:M.touches[0].clientX,O=M instanceof MouseEvent?M.clientY:M.touches[0].clientY;let F=P-p.value.x,N=O-p.value.y;const z=u.value??document.body.getBoundingClientRect();F<z.left?F=z.left:F+D.width>z.right&&(F=z.right-D.width),N<z.top?N=z.top:N+D.height>z.bottom&&(N=z.bottom-D.height),g.value.left=F,g.value.top=N}},Q=()=>{v.value=!1,window.removeEventListener("mousemove",E),window.removeEventListener("touchmove",E),window.removeEventListener("mouseup",Q),window.removeEventListener("touchend",Q)};return Br(()=>{const M=r.value.getBoundingClientRect();let D=t/2,P=i/5;const O=u.value??document.body.getBoundingClientRect();D<O.left?D=O.left:D+M.width>O.right&&(D=O.right-M.width),P<O.top?P=O.top:P+M.height>O.bottom&&(P=O.bottom-M.height),g.value.left=D,g.value.top=P}),(M,D)=>(Qi(),ys(Jz,{to:"body"},[Di(AA,{name:"bounce"},{default:Fs(()=>[H_(Yt("div",{ref_key:"directoryWindow",ref:r,class:"icons-container fixed flex h-[35rem] max-h-[50rem] min-h-[12rem] w-[43rem] min-w-[24rem] max-w-3xl flex-1 resize flex-col overflow-hidden rounded-xl border border-primary border-opacity-25 backdrop-blur-md",style:ya(`top: ${g.value.top}px; left: ${g.value.left}px`)},[Yt("div",{onMousedown:Cx(C,["prevent"]),onTouchmove:D[1]||(D[1]=Cx(()=>{},["prevent"])),class:"flex w-full gap-1 bg-primary p-2"},[Yt("button",{onClick:I,class:"h-3 w-3 rounded-full bg-red-500 hover:bg-red-400"}),I$,Yt("button",{onClick:D[0]||(D[0]=P=>h.value=!0),class:"h-3 w-3 rounded-full bg-green-500 hover:bg-green-400"})],40,x$),Di(y$,{open:h.value,"onUpdate:open":D[2]||(D[2]=P=>h.value=P)},{default:Fs(()=>[Yt("div",C$,[VA(M.$slots,"default",{},void 0,!0)])]),_:3},8,["open"])],4),[[Ob,n.open&&!h.value]])]),_:3})]))}});const xF=ns(E$,[["__scopeId","data-v-6e150443"]]),zc=n=>(OA("data-v-2d02c1b9"),n=n(),GA(),n),w$={class:"flex w-full flex-1 select-none items-center justify-center"},b$=zc(()=>Yt("div",{class:"font-header"},"whoami",-1)),B$=zc(()=>Yt("div",{style:{"view-transition-name":"head-title"},class:"flex w-full flex-1 select-none items-center justify-center rounded-3xl bg-background p-2 text-center font-header text-xl leading-6"}," jordan andrzejczak ",-1)),S$=zc(()=>Yt("div",{class:"font-header"},"me.html",-1)),M$=[B$,S$],T$=zc(()=>Yt("div",{style:{"view-transition-name":"building"},class:"flex w-full flex-1 select-none items-center justify-center rounded-3xl bg-background p-2 text-center font-header text-xl leading-6"}," blender shit ",-1)),D$=zc(()=>Yt("div",{class:"font-header"},"building.gltf",-1)),Q$=[T$,D$],R$=zc(()=>Yt("div",{style:{"view-transition-name":"matyldzia"},class:"flex w-full flex-1 select-none items-center justify-center rounded-3xl bg-background p-2 text-center font-header text-xl leading-6"}," Hello Matyldziu ",-1)),L$=zc(()=>Yt("div",{class:"font-header"},"matyldzia.txt",-1)),P$=[R$,L$],k$=zc(()=>Yt("div",{style:{"view-transition-name":"city"},class:"flex w-full flex-1 select-none items-center justify-center rounded-3xl bg-background p-2 text-center font-header text-xl leading-6"}," city boiiii ",-1)),F$=zc(()=>Yt("div",{class:"font-header"},"city.gltf",-1)),N$=[k$,F$],z$={key:4},U$=kn({__name:"Directory",setup(n){const e=A0(),t=Gt([{x:0,y:0,w:1,h:1,i:"0",static:!1},{x:1,y:0,w:1,h:1,i:"1",static:!1},{x:1,y:1,w:1,h:1,i:"2",static:!1},{x:0,y:1,w:1,h:1,i:"3",static:!1}]),i=Gt(!0),o=Gt(!1),u=g1("directory-open",!1);Gt(!1),Gt(null);const h=r=>{P1({async updateDOM(){e.push({path:r}),await Gr()}})};return(r,p)=>{const g=HA("v-icon");return Qi(),tn(ir,null,[Yt("div",{onDblclick:p[0]||(p[0]=v=>u.value=!Bi(u)),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},[Yt("div",w$,[Bi(u)?(Qi(),ys(g,{key:0,class:"h-16 w-16",name:"oi-file-directory-open-fill"})):(Qi(),ys(g,{key:1,class:"h-16 w-16",name:"oi-file-directory-fill"}))]),b$],32),Di(xF,{"window-id":"whoami",open:Bi(u),"onUpdate:open":p[11]||(p[11]=v=>lr(u)?u.value=v:null)},{default:Fs(()=>[Di(Bi(vF),{layout:t.value,"onUpdate:layout":p[10]||(p[10]=v=>t.value=v),cols:{lg:8,md:6,sm:4,xs:4,xxs:2},"row-height":150,"is-draggable":i.value,"is-resizable":o.value,"is-bounded":!0,responsive:!0,"auto-size":!1,"vertical-compact":!1,"prevent-collision":!0,"use-css-transforms":!0},{default:Fs(()=>[(Qi(!0),tn(ir,null,s1(t.value,v=>(Qi(),ys(Bi(HB),{onTouchmove:p[9]||(p[9]=Cx(()=>{},["prevent"])),static:v.static,x:v.x,y:v.y,w:v.w,h:v.h,i:v.i},{default:Fs(()=>[v.i==="0"?(Qi(),tn("div",{key:0,onDblclick:p[1]||(p[1]=I=>h("/head")),onTouchend:p[2]||(p[2]=I=>h("/head")),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},M$,32)):v.i==="1"?(Qi(),tn("div",{key:1,onTouchend:p[3]||(p[3]=I=>h("/building")),onDblclick:p[4]||(p[4]=I=>h("/building")),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},Q$,32)):v.i==="2"?(Qi(),tn("div",{key:2,onTouchend:p[5]||(p[5]=I=>h("/hello_matyldzia")),onDblclick:p[6]||(p[6]=I=>h("/hello_matyldzia")),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},P$,32)):v.i==="3"?(Qi(),tn("div",{key:3,onTouchend:p[7]||(p[7]=I=>h("/city")),onDblclick:p[8]||(p[8]=I=>h("/city")),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},N$,32)):(Qi(),tn("div",z$,Vd(v.i),1))]),_:2},1032,["static","x","y","w","h","i"]))),256))]),_:1},8,["layout","is-draggable","is-resizable"])]),_:1},8,["open"])],64)}}});const O$=ns(U$,[["__scopeId","data-v-2d02c1b9"]]),G$={class:"flex w-full flex-1 select-none items-center justify-center"},H$={class:"font-header"},V$=kn({__name:"File",props:{iconName:{type:String,required:!0},fileName:{type:String,required:!0},opened:{type:Boolean,default:!1}},emits:["update:open"],setup(n,{emit:e}){const t=n;A0(),Gt([{x:0,y:0,w:1,h:1,i:"0",static:!1}]),Gt(!0),Gt(!1);const i=g1(t.iconName,t.opened);return Gt(!1),Gt(null),(o,u)=>{const h=HA("v-icon");return Qi(),tn(ir,null,[Yt("div",{onDblclick:u[0]||(u[0]=r=>i.value=!Bi(i)),class:"flex h-full w-full cursor-pointer flex-col items-center justify-center gap-1"},[Yt("div",G$,[Di(h,{class:"h-16 w-16",name:n.iconName},null,8,["name"])]),Yt("div",H$,Vd(n.fileName),1)],32),Di(xF,{"window-id":n.fileName,open:Bi(i),"onUpdate:open":u[1]||(u[1]=r=>lr(i)?i.value=r:null)},{default:Fs(()=>[VA(o.$slots,"default",{},void 0,!0)]),_:3},8,["window-id","open"])],64)}}});const R3=ns(V$,[["__scopeId","data-v-5c864ee8"]]);/**
 * @logue/markdown-wasm
 *
 * @description Markdown parser and html generator implemented in WebAssembly
 * @author rsms
 * @license MIT
 * @version 1.4.11
 * @see {@link https://github.com/logue/markdown-wasm}
 */var W$=(()=>{var n=import.meta.url;return async function(e={}){var t;t||(t=typeof e<"u"?e:{});var i,o;t.ready=new Promise((Ve,Ye)=>{i=Ve,o=Ye});var u=Object.assign({},t),h=typeof window=="object",r=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g="",v,I;if(p){const{createRequire:Ve}=await Promise.resolve().then(function(){return eee});var C=Ve(import.meta.url),E=C("fs"),Q=C("path");r?g=Q.dirname(g)+"/":g=C("url").fileURLToPath(new URL("data:application/javascript;base64,aW1wb3J0IGluaXQgZnJvbSAnLi9tYXJrZG93bi5qcyc7CgovKiogQHR5cGUge2ltcG9ydCgnLi4vc3JjL21hcmtkb3duJykuTWFya2Rvd25Nb2R1bGV9IE1hcmtkb3duIFdhc20gTW9kdWxlICovCmxldCBNb2R1bGU7Ci8qKiBAdHlwZSB7bnVtYmVyfSB1c2VkIGJ5IHN0ckZyb21VVEY4UHRyIGFzIGEgdGVtcG9yYXJ5IGFkZHJlc3Mtc2l6ZWQgaW50ZWdlciAqLwpsZXQgdG1wUHRyID0gMDsKCi8qKiBJbml0aWFsaXplIE1hcmtkb3duIFdhc20gKi8KZXhwb3J0IGNvbnN0IHJlYWR5ID0gYXN5bmMgKCkgPT4gewogIE1vZHVsZSA9IGF3YWl0IGluaXQoKTsKCiAgTW9kdWxlLmFkZE9uUG9zdFJ1bigoKSA9PiB7CiAgICB0bXBQdHIgPSBNb2R1bGUuX3dyZWFsbG9jKDAsIDQpOwogIH0pOwoKICByZXR1cm4gYXdhaXQgTW9kdWxlLnJlYWR5Owp9OwoKLyoqIEB0eXBlIHtSZWNvcmQ8c3RyaW5nLCBudW1iZXI+fSAtIFBhcnNlRmxhZ3MgKi8KZXhwb3J0IGNvbnN0IFBhcnNlRmxhZ3MgPSB7CiAgLyoqIEluIFRFWFQsIGNvbGxhcHNlIG5vbi10cml2aWFsIHdoaXRlc3BhY2UgaW50byBzaW5nbGUgJyAnICovCiAgQ09MTEFQU0VfV0hJVEVTUEFDRTogMHgwMDAxLAogIC8qKiBEbyBub3QgcmVxdWlyZSBzcGFjZSBpbiBBVFggaGVhZGVycyAoICMjI2hlYWRlciApICovCiAgUEVSTUlTU0lWRV9BVFhfSEVBREVSUzogMHgwMDAyLAogIC8qKiBSZWNvZ25pemUgVVJMcyBhcyBsaW5rcyBldmVuIHdpdGhvdXQgPC4uLj4gKi8KICBQRVJNSVNTSVZFX1VSTF9BVVRPX0xJTktTOiAweDAwMDQsCiAgLyoqIFJlY29nbml6ZSBlLW1haWxzIGFzIGxpbmtzIGV2ZW4gd2l0aG91dCA8Li4uPiAqLwogIFBFUk1JU1NJVkVfRU1BSUxfQVVUT19MSU5LUzogMHgwMDA4LAogIC8qKiBEaXNhYmxlIGluZGVudGVkIGNvZGUgYmxvY2tzLiAoT25seSBmZW5jZWQgY29kZSB3b3JrcykgKi8KICBOT19JTkRFTlRFRF9DT0RFX0JMT0NLUzogMHgwMDEwLAogIC8qKiBEaXNhYmxlIHJhdyBIVE1MIGJsb2Nrcy4gKi8KICBOT19IVE1MX0JMT0NLUzogMHgwMDIwLAogIC8qKiBEaXNhYmxlIHJhdyBIVE1MIChpbmxpbmUpLiAqLwogIE5PX0hUTUxfU1BBTlM6IDB4MDA0MCwKICAvKiogRW5hYmxlIHRhYmxlcyBleHRlbnNpb24uICovCiAgVEFCTEVTOiAweDAxMDAsCiAgLyoqIEVuYWJsZSBzdHJpa2V0aHJvdWdoIGV4dGVuc2lvbi4gKi8KICBTVFJJS0VUSFJPVUdIOiAweDAyMDAsCiAgLyoqIEVuYWJsZSBXV1cgYXV0b2xpbmtzICh3aXRob3V0IHByb3RvOyBqdXN0ICd3d3cuJykgKi8KICBQRVJNSVNTSVZFX1dXV19BVVRPTElOS1M6IDB4MDQwMCwKICAvKiogRW5hYmxlIHRhc2sgbGlzdCBleHRlbnNpb24uICovCiAgVEFTS19MSVNUUzogMHgwODAwLAogIC8qKiBFbmFibGUgJCBhbmQgJCQgY29udGFpbmluZyBMYVRlWCBlcXVhdGlvbnMuICovCiAgTEFURVhfTUFUSF9TUEFOUzogMHgxMDAwLAogIC8qKiBFbmFibGUgd2lraSBsaW5rcyBleHRlbnNpb24uICovCiAgV0lLSV9MSU5LUzogMHgyMDAwLAogIC8qKiBFbmFibGUgdW5kZXJsaW5lIGV4dGVuc2lvbiAoZGlzYWJsZXMgJ18nIGZvciBlbXBoYXNpcykgKi8KICBVTkRFUkxJTkU6IDB4NDAwMCwKCiAgLyoqIERlZmF1bHQgZmxhZ3MgKi8KICBERUZBVUxUOiAweDAwMDEgfCAweDAwMDIgfCAweDAwMDQgfCAweDAyMDAgfCAweDAxMDAgfCAweDA4MDAsCiAgLy8gQ09MTEFQU0VfV0hJVEVTUEFDRQogIC8vIFBFUk1JU1NJVkVfQVRYX0hFQURFUlMKICAvLyBQRVJNSVNTSVZFX1VSTF9BVVRPX0xJTktTCiAgLy8gU1RSSUtFVEhST1VHSAogIC8vIFRBQkxFUwogIC8vIFRBU0tfTElTVFMKCiAgLyoqIE5vIEhUTUwgKi8KICBOT19IVE1MOiAweDAwMjAgfCAweDAwNDAsIC8vIE5PX0hUTUxfQkxPQ0tTIHwgTk9fSFRNTF9TUEFOUwoKICAvKiogQ29tbW9ubWFyayBDb21wbHkgKi8KICBDT01NT05NQVJLOiAwLAogIC8qKiBHaXRodWIgU3R5bGUgKi8KICBHSVRIVUI6IDB4MDAwNCB8IDB4MDEwMCB8IDB4MDIwMCB8IDB4MDgwMCwgLy8gUEVSTUlTU0lWRV9VUkxfQVVUT19MSU5LUyB8IFRBQkxFUyB8IFNUUklLRVRIUk9VR0ggfCBUQVNLX0xJU1RTCn07CgovKiogQHR5cGUge1JlY29yZDxzdHJpbmcsIG51bWJlcj59IHRoZXNlIHNob3VsZCBiZSBpbiBzeW5jIHdpdGggIk91dHB1dEZsYWdzIiBpbiBjb21tb24uaCAqLwpjb25zdCBPdXRwdXRGbGFncyA9IHsKICAvKiogT3V0cHV0IEhUTUwgKi8KICBIVE1MOiAxIDw8IDAsCiAgLyoqIE91dHB1dCBYSFRNTCAob25seSBoYXMgZWZmZWN0IHdpdGggSFRNTCBmbGFnIHNldCkgICovCiAgWEhUTUw6IDEgPDwgMSwKICAvKiogQWxsb3cgImphdmFzY3JpcHQ6IiBVUklzICovCiAgQWxsb3dKU1VSSTogMSA8PCAyLAogIC8qKiBEaXNhYmxlIGFuY2hvciB0YWcgaW4gaGVhZGxpbmVzLiAqLwogIERpc2FibGVIZWFkbGluZUFuY2hvcnM6IDEgPDwgMywKfTsKCi8qKgogKiBQYXJzZSBtYXJrZG93bgogKgogKiBAcGFyYW0ge3N0cmluZyB8IFVpbnQ4QXJyYXl9IHNvdXJjZSAtIG1hcmtkb3duIHRleHQKICogQHBhcmFtIHtpbXBvcnQoJy4uL21hcmtkb3duJykuUGFyc2VPcHRpb25zfSBvcHRpb25zIC0gUGFyc2VyIG9wdGlvbnMKICoKICogQHJldHVybiB7c3RyaW5nIHwgVWludDhBcnJheSB8IG51bGx9CiAqLwpleHBvcnQgZnVuY3Rpb24gcGFyc2Uoc291cmNlLCBvcHRpb25zID0ge30pIHsKICBpZiAoIU1vZHVsZSkgewogICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAnW21hcmtkb3duLXdhc21dIG1hcmtkb3duLXdhc20gZG9lcyBub3QgaW5pdGlhbGl6ZWQuIFVzZSBgYXdhaXQgcmVhZHkoKTtgIGJlZm9yZSBgcGFyc2UoKWAgZnVuY3Rpb24uJwogICAgKTsKICB9CiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgY29uc3QgcGFyc2VGbGFncyA9CiAgICBvcHRpb25zLnBhcnNlRmxhZ3MgPT09IHVuZGVmaW5lZCA/IFBhcnNlRmxhZ3MuREVGQVVMVCA6IG9wdGlvbnMucGFyc2VGbGFnczsKCiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCiAgbGV0IG91dHB1dEZsYWdzID0gb3B0aW9ucy5hbGxvd0pTVVJJcyA/IE91dHB1dEZsYWdzLkFsbG93SlNVUkkgOiAwOwoKICBzd2l0Y2ggKG9wdGlvbnMuZm9ybWF0KSB7CiAgICBjYXNlICd4aHRtbCc6CiAgICAgIG91dHB1dEZsYWdzIHw9IE91dHB1dEZsYWdzLkhUTUwgfCBPdXRwdXRGbGFncy5YSFRNTDsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnaHRtbCc6CiAgICBjYXNlIHVuZGVmaW5lZDoKICAgIGNhc2UgbnVsbDoKICAgICAgb3V0cHV0RmxhZ3MgfD0gT3V0cHV0RmxhZ3MuSFRNTDsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgdGhyb3cgbmV3IEVycm9yKGBbbWFya2Rvd24td2FzbV0gaW52YWxpZCBmb3JtYXQgIiR7b3B0aW9ucy5mb3JtYXR9ImApOwogIH0KCiAgaWYgKG9wdGlvbnMuZGlzYWJsZUhlYWRsaW5lQW5jaG9ycykgewogICAgb3V0cHV0RmxhZ3MgfD0gT3V0cHV0RmxhZ3MuRGlzYWJsZUhlYWRsaW5lQW5jaG9yczsKICB9CgogIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogIGNvbnN0IG9uQ29kZUJsb2NrUHRyID0gb3B0aW9ucy5vbkNvZGVCbG9jawogICAgPyBjcmVhdGVfb25Db2RlQmxvY2tfZm4ob3B0aW9ucy5vbkNvZGVCbG9jaykKICAgIDogMDsKCiAgLyoqIEB0eXBlIHtVaW50OEFycmF5fSAqLwogIGNvbnN0IGJ1ZiA9IGFzX2J5dGVfYXJyYXkoc291cmNlKTsKICAvKiogQHR5cGUge1VpbnQ4QXJyYXl9ICovCiAgY29uc3Qgb3V0YnVmID0gd2l0aE91dFB0cihvdXRwdHIgPT4KICAgIHdpdGhUbXBCeXRlUHRyKGJ1ZiwgKGlucHRyLCBpbmxlbikgPT4KICAgICAgTW9kdWxlLl9wYXJzZVVURjgoCiAgICAgICAgaW5wdHIsCiAgICAgICAgaW5sZW4sCiAgICAgICAgcGFyc2VGbGFncywKICAgICAgICBvdXRwdXRGbGFncywKICAgICAgICBvdXRwdHIsCiAgICAgICAgb25Db2RlQmxvY2tQdHIKICAgICAgKQogICAgKQogICk7CgogIGlmIChvcHRpb25zLm9uQ29kZUJsb2NrKSB7CiAgICBNb2R1bGUucmVtb3ZlRnVuY3Rpb24ob25Db2RlQmxvY2tQdHIpOwogIH0KCiAgLy8gY2hlY2sgZm9yIGVycm9yIGFuZCB0aHJvdyBpZiBuZWVkZWQKICB3ZXJyQ2hlY2soKTsKCiAgaWYgKCFvdXRidWYpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgcmV0dXJuIG9wdGlvbnMuYnl0ZXMgPyBvdXRidWYgOiBuZXcgVGV4dERlY29kZXIoJ3V0Zi04JykuZGVjb2RlKG91dGJ1Zik7Cn0KCi8qKgogKiBGdW5jdGlvbidzIEMgdHlwZTogSlNUZXh0RmlsdGVyRnVuCiAqIChtZXRhcHRyIHB0ciwgbWV0YWxlbiBwdHIsIGlucHRyIHB0ciwgaW5sZW4gcHRyLCBvdXRwdHIgcHRyKSAtPiBvdXRsZW4gaW50CiAqCiAqIEludGVyYWN0aW5nLXdpdGgtY29kZS5odG1sI2NhbGxpbmctamF2YXNjcmlwdC1mdW5jdGlvbnMtYXMtZnVuY3Rpb24tcG9pbnRlcnMtZnJvbS1jCiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZW1zY3JpcHRlbi5vcmcvZG9jcy9wb3J0aW5nL2Nvbm5lY3RpbmdfY3BwX2FuZF9qYXZhc2NyaXB0L30KICoKICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db2RlQmxvY2sKICogQHJldHVybiB7bnVtYmVyfQogKi8KZnVuY3Rpb24gY3JlYXRlX29uQ29kZUJsb2NrX2ZuKG9uQ29kZUJsb2NrKSB7CiAgY29uc3QgZm5wdHIgPSBNb2R1bGUuYWRkRnVuY3Rpb24oKG1ldGFwdHIsIG1ldGFsZW4sIGlucHRyLCBpbmxlbiwgb3V0cHRyKSA9PiB7CiAgICB0cnkgewogICAgICAvLyBsYW5nIGlzIHRoZSAibGFuZ3VhZ2UiIHRhZywgaWYgYW55LCBwcm92aWRlZCB3aXRoIHRoZSBjb2RlIGJsb2NrCiAgICAgIGNvbnN0IGxhbmcgPQogICAgICAgIG1ldGFsZW4gPiAwCiAgICAgICAgICA/IG5ldyBUZXh0RGVjb2RlcigndXRmLTgnKS5kZWNvZGUoCiAgICAgICAgICAgICAgTW9kdWxlLkhFQVBVOC5zdWJhcnJheShtZXRhcHRyLCBtZXRhcHRyICsgbWV0YWxlbikKICAgICAgICAgICAgKQogICAgICAgICAgOiAnJzsKCiAgICAgIC8qKiBAdHlwZSB7VWludDhBcnJheX0gYm9keSBpcyBhIHZpZXcgaW50byBoZWFwIG1lbW9yeSBvZiB0aGUgc2VnbWVudCBvZiBzb3VyY2UgKFVURjggYnl0ZXMpICovCiAgICAgIGNvbnN0IGJvZHkgPSBNb2R1bGUuSEVBUFU4LnN1YmFycmF5KGlucHRyLCBpbnB0ciArIGlubGVuKTsKCiAgICAgIC8qKiByZXN1bHQgZnJvbSB0aGUgb25Db2RlQmxvY2sgZnVuY3Rpb24gKi8KICAgICAgY29uc3QgcmVzdWx0ID0gb25Db2RlQmxvY2sobGFuZywgbmV3IFRleHREZWNvZGVyKCd1dGYtOCcpLmRlY29kZShib2R5KSk7CgogICAgICBpZiAocmVzdWx0ID09PSBudWxsIHx8IHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gQ2FsbGJhY2sgaW5kaWNhdGVzIHRoYXQgaXQgZG9lcyBub3Qgd2lzaCB0byBmaWx0ZXIuCiAgICAgICAgLy8gVGhlIG1kLmMgaW1wbGVtZW50YXRpb24gd2lsbCBodG1sLWVuY29kZSB0aGUgYm9keS4KICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlc2J1ZiA9IGFzX2J5dGVfYXJyYXkocmVzdWx0KTsKICAgICAgaWYgKHJlc2J1Zi5sZW5ndGggPiAwKSB7CiAgICAgICAgLy8gY29weSByZXNidWYgdG8gV0FTTSBoZWFwIG1lbW9yeQogICAgICAgIGNvbnN0IHJlc3B0ciA9IG1hbGxvY2J1ZihyZXNidWYsIHJlc2J1Zi5sZW5ndGgpOwogICAgICAgIC8vIHdyaXRlIHBvaW50ZXIgdmFsdWUKICAgICAgICBNb2R1bGUuSEVBUFUzMltvdXRwdHIgPj4gMiAvKiA9PSBvdXRwdHIgLyA0ICovXSA9IHJlc3B0cjsKICAgICAgICAvLyBOb3RlOiBmbXRfaHRtbC5jIGNhbGxzIGZyZWUocmVzcHRyKQogICAgICB9CgogICAgICByZXR1cm4gcmVzYnVmLmxlbmd0aDsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBjb25zb2xlLmVycm9yKAogICAgICAgIGBbbWFya2Rvd24td2FzbV0gZXJyb3IgaW4gbWFya2Rvd24gb25Db2RlQmxvY2sgY2FsbGJhY2s6ICR7CiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyCiAgICAgICAgfWAKICAgICAgKTsKICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0sICdpaWlpaWknKTsKICByZXR1cm4gZm5wdHI7Cn0KCi8qKgogKiB0byBCeXRlIEFycmF5CiAqCiAqIEBwYXJhbSB7VWludDhBcnJheSB8IHN0cmluZyB8IG51bWJlcltdfSBzb21ldGhpbmcKICoKICogQHJldHVybiB7VWludDhBcnJheX0KICovCmZ1bmN0aW9uIGFzX2J5dGVfYXJyYXkoc29tZXRoaW5nKSB7CiAgaWYgKHR5cGVvZiBzb21ldGhpbmcgPT09ICdzdHJpbmcnKSB7CiAgICByZXR1cm4gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNvbWV0aGluZyk7CiAgfSBlbHNlIGlmIChzb21ldGhpbmcgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICByZXR1cm4gc29tZXRoaW5nOwogIH0KICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoc29tZXRoaW5nKTsKfQoKLyoqCiAqIHdpdGhPdXRQdHIgZmFjaWxpdGF0ZXMgdGhlIGZvbGxvd2luZzoKICogMS4gY2FsbHMgZm4gd2l0aCBhbiBhZGRyZXNzIHRvIG1lbW9yeSB0aGF0IGZpdHMgYSBwb2ludGVyLgogKiAgICAgZm4ob3V0cHRyKSBpcyBleHBlY3RlZCB0bzoKICogICAgIGEuIFdyaXRlIHNvbWUgZGF0YSBpbnRvIGhlYXAgbWVtb3J5CiAqICAgICBiLiBXcml0ZSB0aGUgYWRkcmVzcyBvZiB0aGF0IGRhdGEgYXQgb3V0cHRyIChpLmUuICpvdXRwdHIgPSBoZWFwYWRkcikKICogICAgIGMuIFJldHVybiB0aGUgbGVuZ3RoIG9mIGRhdGEgd3JpdHRlbgogKgogKiAgMi4gd2l0aE91dFB0ciByZWFkcyB0aGUgYWRkcmVzcyBmcm9tIG91dHB0cgogKiAgICAgYS4gSWYgdGhlIGFkZHJlc3MgaXMgMCAoTlVMTCksIHJldHVybnMgbnVsbAogKiAgICAgYi4gRWxzZSBhIHNsaWNlIG9mIHRoZSBoZWFwIG1lbW9yeSBpcyBjcmVhdGVkLCBzdGFydGluZyBhdCAqb3V0cHRyCiAqICAgICAgICBhbmQgZW5kaW5nIGF0ICgoKm91dHB0cikgKyBsZW5ndGhfcmV0dXJuZWRfYnlfZm4pLgogKiAgICAgICAgQSBmcmVlKCkgZnVuY3Rpb24gaXMgYWRkZWQgdG8gdGhlIGJ1ZmZlciBhbmQgaXQgaXMgcmV0dXJuZWQuCiAqCiAqICBJdCBpcyBpbXBvcnRhbnQgdG8gZnJlZSgpIHRoZSBtZW1vcnkgb2YgdGhlIHJldHVybmVkIGJ1ZmZlciB3aGVuIHRoZSBjYWxsZXIgaXMgZG9uZS4KICogIFRoaXMgaXMgaW1wbGVtZW50YXRpb24gc3BlY2lmaWMsIHNvIHRoaXMgZnVuY3Rpb24gY2FuIG5vdCBoZWxwIHlvdSB3aXRoIHRoYXQuCiAqCiAqICBUaGUgcmV0dXJuIHR5cGUgaXMgYXMgZm9sbG93czoKICogICAgaW50ZXJmYWNlIEhlYXBEYXRhIGV4dGVuZHMgVWludDhBcnJheSB7CiAqICAgICAgcmVhZG9ubHkgaGVhcEFkZHIgOm51bWJlciAgLy8gYWRkcmVzcyBpbiBoZWFwID09ICpvdXRwdHIKICogICAgfQogKgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbgogKgogKiBAcmV0dXJuIHtVaW50OEFycmF5ICYge2hlYXBBZGRyOiBudW1lcn19CiAqCiAqIEBleGFtcGxlCiAqICAgIC8vIFdBU00gbW9kdWxlLCBpbiBDOgogKiAgICB0eXBlZGVmIHN0cnVjdCBDb2xvcl8geyBjaGFyIHIsIGcsIGI7IH0gQ29sb3I7CiAqICAgIHNpemVfdCBuZXdDb2xvcihjb25zdCBDb2xvcioqIG91dHApIHsKICogICAgICBDb2xvciogYyA9IChDb2xvciopbWFsbG9jKHNpemVvZihDb2xvcikpOwogKiAgICAgIGMtPnIgPSAweEZGOwogKiAgICAgIGMtPmcgPSAweENBOwogKiAgICAgIGMtPmIgPSAweDA7CiAqICAgICAgKm91dHAgPSBjOwogKiAgICAgIHJldHVybiBzaXplb2YoQ29sb3IpOwogKiAgICB9CiAqICAgIHZvaWQgZnJlZUNvbG9yKGNvbnN0IENvbG9yKiBwKSB7CiAqICAgICAgZnJlZShwKTsKICogICB9CiAqCiAqICAgIC8vIEphdmFTY3JpcHQKICogICAgbGV0IGNvbG9yID0gd2l0aE91dFB0cihfbmV3Q29sb3IpCiAqICAgIGNvbnNvbGUubG9nKCJSR0I6IiwgY29sb3JbMF0sIGNvbG9yWzFdLCBjb2xvclsyXSkKICogICBfZnJlZUNvbG9yKGNvbG9yLmhlYXBBZGRyKQogKi8KZnVuY3Rpb24gd2l0aE91dFB0cihmbikgewogIGNvbnN0IGxlbiA9IGZuKHRtcFB0cik7CiAgY29uc3QgYWRkciA9IE1vZHVsZS5IRUFQMzJbdG1wUHRyID4+IDJdOwogIGlmIChhZGRyID09PSAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgY29uc3QgYnVmID0gTW9kdWxlLkhFQVBVOC5zdWJhcnJheShhZGRyLCBhZGRyICsgbGVuKTsKICBidWYuaGVhcEFkZHIgPSBhZGRyOwogIHJldHVybiBidWY7Cn0KCi8qKgogKiB3aXRoVG1wQnl0ZVB0ciB0YWtlcyBhbiBBcnJheUJ1ZmZlciBvciBVaW50OEFycmF5IGFuZDoKICogMS4gY29waWVzIGl0IGludG8gdGhlIFdBU00gbW9kdWxlIG1lbW9yeQogKiAyLiBjYWxscyBmbihwb2ludGVyLCBzaXplKQogKiAzLiBjYWxscyBmcmVlKHBvaW50ZXIpCiAqCiAqIEBwYXJhbSB7VWludDhBcnJheX0gYnVmCiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuCiAqCiAqIEByZXR1cm4ge251bWJlcn0KICovCmZ1bmN0aW9uIHdpdGhUbXBCeXRlUHRyKGJ1ZiwgZm4pIHsKICBjb25zdCBzaXplID0gYnVmLmxlbmd0aDsKICBjb25zdCBwdHIgPSBtYWxsb2NidWYoYnVmLCBzaXplKTsKICBjb25zdCByID0gZm4ocHRyLCBzaXplKTsKICBNb2R1bGUuX3dmcmVlKHB0cik7CiAgcmV0dXJuIHI7Cn0KCi8qKgogKiBtYWxsb2NidWYgYWxsb2NhdGVzIG1lbW9yeSBpbiB0aGUgV0FTTSBoZWFwIGFuZCBjb3BpZXMgbGVuZ3RoIGJ5dGVzCiAqIGZyb20gYnl0ZUFycmF5IGludG8gdGhlIGFsbG9jYXRlZCBsb2NhdGlvbi4KICogUmV0dXJucyB0aGUgYWRkcmVzcyB0byB0aGUgYWxsb2NhdGVkIG1lbW9yeS4KICoKICogQHBhcmFtIHtVaW50OEFycmF5fSBieXRlQXJyYXkKICogQHBhcmFtIHtudW1iZXJ9IGxlbmd0aAogKi8KZnVuY3Rpb24gbWFsbG9jYnVmKGJ5dGVBcnJheSwgbGVuZ3RoKSB7CiAgY29uc3Qgb2ZmcyA9IE1vZHVsZS5fd3JlYWxsb2MoMCwgbGVuZ3RoKTsKICBNb2R1bGUuSEVBUFU4LnNldChieXRlQXJyYXksIG9mZnMpOwogIHJldHVybiBvZmZzOwp9CgovKioKICogV0Vycm9yIHJlcHJlc2VudHMgYW4gZXJyb3IgZnJvbSBhIHdhc20gbW9kdWxlCiAqLwpjbGFzcyBXRXJyb3IgZXh0ZW5kcyBFcnJvciB7CiAgY29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgZmlsZSwgbGluZSkgewogICAgc3VwZXIobWVzc2FnZSwgZmlsZSB8fCAnd2FzbScsIGxpbmUgfHwgMCk7CiAgICB0aGlzLm5hbWUgPSAnV0Vycm9yJzsKICAgIHRoaXMuY29kZSA9IGNvZGU7CiAgfQp9CgovKioKICogR2V0ICYgY2xlYXIgbGFzdCBXRXJyLiBSZXR1cm5zIG51bGwgaWYgdGhlcmUgd2FzIG5vIGVycm9yLgogKiBVc2VzIGEgZGVzY3JpcHRpdmUgbmFtZSBzbyB0byBoZWxwIGluIHN0YWNrIHRyYWNlcy4KICoKICogQHJldHVybiB7V0Vycm9yIHwgdW5kZWZpbmVkfQogKi8KZnVuY3Rpb24gZXJyb3JfZnJvbV93YXNtKCkgewogIC8qKiBAdHlwZSB7bnVtYmVyfSAqLwogIGNvbnN0IGNvZGUgPSBNb2R1bGUuX1dFcnJHZXRDb2RlKCk7CiAgaWYgKGNvZGUgIT09IDApIHsKICAgIC8qKiBAdHlwZSB7c3RyaW5nfSAqLwogICAgY29uc3QgbXNncHRyID0gTW9kdWxlLl9XRXJyR2V0TXNnKCk7CiAgICBjb25zdCBtZXNzYWdlID0KICAgICAgbXNncHRyICE9PSAnJyA/IE1vZHVsZS5VVEY4QXJyYXlUb1N0cmluZyhNb2R1bGUuSEVBUFU4LCBtc2dwdHIpIDogJyc7CiAgICBNb2R1bGUuX1dFcnJDbGVhcigpOwogICAgcmV0dXJuIG5ldyBXRXJyb3IoY29kZSwgbWVzc2FnZSk7CiAgfQp9CgpmdW5jdGlvbiB3ZXJyQ2hlY2soKSB7CiAgY29uc3QgZXJyID0gZXJyb3JfZnJvbV93YXNtKCk7CiAgaWYgKGVycikgewogICAgdGhyb3cgZXJyOwogIH0KfQo=",self.location)),v=(Ye,ae)=>(Ye=Ye.startsWith("file://")?new URL(Ye):Q.normalize(Ye),E.readFileSync(Ye,ae?void 0:"utf8")),I=Ye=>(Ye=v(Ye,!0),Ye.buffer||(Ye=new Uint8Array(Ye)),Ye),process.argv.slice(2),t.inspect=()=>"[Emscripten Module object]"}else(h||r)&&(r?g=self.location.href:typeof document<"u"&&document.currentScript&&(g=document.currentScript.src),n&&(g=n),g.indexOf("blob:")!==0?g=g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):g="",v=Ve=>{var Ye=new XMLHttpRequest;return Ye.open("GET",Ve,!1),Ye.send(null),Ye.responseText},r&&(I=Ve=>{var Ye=new XMLHttpRequest;return Ye.open("GET",Ve,!1),Ye.responseType="arraybuffer",Ye.send(null),new Uint8Array(Ye.response)}));t.print||console.log.bind(console);var M=t.printErr||console.error.bind(console);Object.assign(t,u),u=null;var D;t.wasmBinary&&(D=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&ce("no native wasm support detected");var P,O=!1,F;function N(){var Ve=P.buffer;t.HEAP8=new Int8Array(Ve),t.HEAP16=new Int16Array(Ve),t.HEAP32=new Int32Array(Ve),t.HEAPU8=F=new Uint8Array(Ve),t.HEAPU16=new Uint16Array(Ve),t.HEAPU32=new Uint32Array(Ve),t.HEAPF32=new Float32Array(Ve),t.HEAPF64=new Float64Array(Ve)}var z,X=[],q=[],H=[];function W(){var Ve=t.preRun.shift();X.unshift(Ve)}function se(Ve){H.unshift(Ve)}var de=0,te=null;function ce(Ve){throw t.onAbort&&t.onAbort(Ve),Ve="Aborted("+Ve+")",M(Ve),O=!0,Ve=new WebAssembly.RuntimeError(Ve+". Build with -sASSERTIONS for more info."),o(Ve),Ve}function Ee(Ve){return Ve.startsWith("data:application/octet-stream;base64,")}var Be;if(t.locateFile){if(Be="markdown.wasm",!Ee(Be)){var De=Be;Be=t.locateFile?t.locateFile(De,g):g+De}}else Be=new URL("data:application/wasm;base64,AGFzbQEAAAABbQ9gAn9/AGADf39/AX9gBH9/f38Bf2ACf38Bf2ABfwF/YAZ/f39/f38Bf2ADf39/AGABfwBgBX9/f39/AX9gBH9/f38AYAAAYAABf2AGf39/f39/AGAIf39/f39/f38Bf2AJf39/f39/f39/AX8CDQIBYQFhAAQBYQFiAAYDPDsDBwEEAQQBAwEACQkBBgUCAQAMAAMEAQYGBAgBAgMDCgADAQUDDQIFAgICAA4FCAEHAQEBAgUDBwsLCgQEAXAABwUHAQGAAoCAAgYIAX8BQaDJBAsHJQkBYwIAAWQAIQFlADgBZgA5AWcAOwFoADoBaQA8AWoANwFrAQAJDAEAQQELBjY1NDMkCQrajwQ73QUBCX8CfyAARQRAIAEQBwwBCyABRQRAIAAQA0EADAELAkAgAUFHSw0AIAACf0EIIAFBA2pBfHEgAUEITRsiB0EIaiEBAkACfwJAIABBBGsiCiIEKAIAIgUgBGoiAigCACIJIAIgCWoiCEEEaygCAEcEQCAIIAEgBGoiA0EQak8EQCACKAIEIgUgAigCCDYCCCACKAIIIAU2AgQgAyAIIANrIgI2AgAgAkF8cSADakEEayACQQFyNgIAIAMCfyADKAIAQQhrIgJB/wBNBEAgAkEDdkEBawwBCyACQR0gAmciBWt2QQRzIAVBAnRrQe4AaiACQf8fTQ0AGkE/IAJBHiAFa3ZBAnMgBUEBdGtBxwBqIgIgAkE/TxsLIgJBBHQiBUGAwQBqNgIEIAMgBUGIwQBqIgUoAgA2AgggBSADNgIAIAMoAgggAzYCBEGIyQBBiMkAKQMAQgEgAq2GhDcDACAEIAE2AgAMBAsgAyAISw0BIAIoAgQiASACKAIINgIIIAIoAgggATYCBCAEIAUgCWoiATYCAAwDCyAFIAFBEGpPBEAgBCABNgIAIAFBfHEgBGpBBGsgATYCACABIARqIgMgBSABayIBNgIAIAFBfHEgA2pBBGsgAUEBcjYCACADAn8gAygCAEEIayIBQf8ATQRAIAFBA3ZBAWsMAQsgAUEdIAFnIgRrdkEEcyAEQQJ0a0HuAGogAUH/H00NABpBPyABQR4gBGt2QQJzIARBAXRrQccAaiIBIAFBP08bCyIBQQR0IgRBgMEAajYCBCADIARBiMEAaiIEKAIANgIIIAQgAzYCACADKAIIIAM2AgRBiMkAQYjJACkDAEIBIAGthoQ3AwBBAQwEC0EBIAEgBU0NARoLQQALDAELIAFBfHEgBGpBBGsgATYCAEEBCw0BGiAHEAciAUUNACABIAAgByAKKAIAQQhrIgYgBiAHSxsQBBogABADIAEhBgsgBgsL0AIBBX8gAARAIABBBGsiASgCACIFIQMgASECIABBCGsoAgAiACAAQX5xIgRHBEAgASAEayICKAIEIgAgAigCCDYCCCACKAIIIAA2AgQgBCAFaiEDCyABIAVqIgQoAgAiASABIARqQQRrKAIARwRAIAQoAgQiACAEKAIINgIIIAQoAgggADYCBCABIANqIQMLIAIgAzYCACADQXxxIAJqQQRrIANBAXI2AgAgAgJ/IAIoAgBBCGsiAUH/AE0EQCABQQN2QQFrDAELIAFBHSABZyIAa3ZBBHMgAEECdGtB7gBqIAFB/x9NDQAaQT8gAUEeIABrdkECcyAAQQF0a0HHAGoiACAAQT9PGwsiAUEEdCIAQYDBAGo2AgQgAiAAQYjBAGoiACgCADYCCCAAIAI2AgAgAigCCCACNgIEQYjJAEGIyQApAwBCASABrYaENwMACwuABAEDfyACQYAETwRAIAAgASACEAEgAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCAAQQNxRQRAIAAhAgwBCyACRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAkEDcUUNASACIANJDQALCwJAIANBfHEiBEHAAEkNACACIARBQGoiBUsNAANAIAIgASgCADYCACACIAEoAgQ2AgQgAiABKAIINgIIIAIgASgCDDYCDCACIAEoAhA2AhAgAiABKAIUNgIUIAIgASgCGDYCGCACIAEoAhw2AhwgAiABKAIgNgIgIAIgASgCJDYCJCACIAEoAig2AiggAiABKAIsNgIsIAIgASgCMDYCMCACIAEoAjQ2AjQgAiABKAI4NgI4IAIgASgCPDYCPCABQUBrIQEgAkFAayICIAVNDQALCyACIARPDQEDQCACIAEoAgA2AgAgAUEEaiEBIAJBBGoiAiAESQ0ACwwBCyADQQRJBEAgACECDAELIAAgA0EEayIESwRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAiABLQABOgABIAIgAS0AAjoAAiACIAEtAAM6AAMgAUEEaiEBIAJBBGoiAiAETQ0ACwsgAiADSQRAA0AgAiABLQAAOgAAIAFBAWohASACQQFqIgIgA0cNAAsLIAAL3hYBF38jAEEgayIGJAACQCAAKALkAyIDRQ0AAkACQAJAIAMoAgAiAUH/AXFBBmsOBAACAgECCyABQYAQcUUNAQsgACgCACADKAIIai0AAEHbAEcNACADQQhqIQkgAygCBCEXA0ACQCASIBdODQAgACgCACIHIAkgEkEDdGoiFSgCACICai0AAEHbAEcNACACQQFqIQtBfyEWQQEgFyASayITIBNBAUwbQQFrIQxBACEDQQAhDkEAIQhBACEPA0BB5wcgDyAPQecHTBshFCAVIAhBA3RqKAIEIQQDQAJ/AkACQAJAAkAgBCALSwRAIAcgC2oiCi0AACIBwCENAn8CQAJAAkAgAUHbAGsOAwwABQELIAtBAWoiAiAAKAIETw0BAkAgAiAHai0AACICQSFrQf8BcUEPSQ0AIAJBCmsOdQACAgACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgAAAAAAAAACAgICAgICAgICAgICAgICAgICAgICAgICAgAAAAAAAAICAgICAgICAgICAgICAgICAgICAgICAgICAAAAAAILIAMgCyAOGyEDIBYgCCAOGyEWIAtBAmoiDgwICyANQQBODQAgACgCBCALayECIAFB4AFxQcABRgRAIAJBAkkNASAKLQABIgJBwAFxQYABRw0BIAJBP3EgDUEfcUEGdHIhDUECDAILIAFB8AFxQeABRgRAIAJBA0kNASAKLQABIgFBwAFxQYABRw0BIAotAAIiAkHAAXFBgAFHDQEgAkE/cSABQT9xQQZ0IA1BD3FBDHRyciENQQMMAgsgAUH4AXFB8AFHDQAgAkEESQ0AIAotAAEiBUHAAXFBgAFHDQAgCi0AAiIBQcABcUGAAUcNACAKLQADIgJBwAFxQYABRw0AIAJBP3EgBUE/cUEMdCANQQdxQRJ0ciABQT9xQQZ0cnIhDUEEDAELQQELIREgDUH/AE0NAkEAIRBBByEBA0ACQAJAIA0gASAQakECbSIKQQJ0QaAZaigCACICQR91IApqIgVBAnRBoBlqKAIAQf///wdxSQRAIAVBAWshAQwBCyACQR52QQFxIApqIgJBAnRBoBlqKAIAQf///wdxIA1PDQEgAkEBaiEQCyABIBBODQEMBQsLIAVBAE4NBAwDCyAIIAxGDQcgD0EBaiEPIBUgCEEBaiIIQQN0aigCACELDAYLIAMgDk8NBiALQQFqIgIgBE8NBiACIAdqLQAAQTpHDQYCQCAEIAtBAmoiAUsEQANAIAEgB2otAABBCWsiAkEXSwRAIAghAgwDC0EBIAJ0QY2AgARxRQRAIAghAgwDCyABQQFqIgEgBEcNAAsLIAhBAWoiAiATTg0HIBUgAkEDdGoiASgCBCEEIAEoAgAhAQsgBiABNgIIIAcgASAEIAZBCGogBkEcaiAGQRhqEC9FDQYgACAVIAJBA3RqIBMgAmsgBigCCCAGQQhqIAZBDGogBkEEaiAGQRRqIAZBEGoQLiEBIAYoAgghDAJAAkAgAUUNACAMIBUgBigCBCIUIAJqIgVBA3RqKAIEIgFJDQAgAiAGKAIMIgRqIRAgBCAURyEKIAEhBCAFIQIMAQsgBiAMNgIQIAYgDDYCFEEAIRBBACEKCyAGIBA2AgwgBCAMSw0GAkAgACgCQCIPIAAoAkQiAUgEQCAAKAI8IQQMAQsgAEEQIAFBAXYgAWogAUEATBsiATYCRCAAKAI8IAFBBXQQAiIERQRAIAAoAiQiAkUNCEH9DiAAKAIsIAIRAAAMCAsgACAENgI8IAAoAkAhDwsgBCAPQQV0aiIHQgA3AgAgB0IANwIYIAdCADcCECAHQgA3AggCQAJAAkACQCAIIBZHBEAgDiADaxAHIghFDQIgFSAWQQN0aiEMQQAhESAIIQEDQCADIAwgEUEDdGooAgQiBSAOIAUgDkkbIhNJBH8gEyADQX9zaiEUQQAhECATIANrQQNxIgUEQANAIAEgACgCACADai0AADoAACADQQFqIQMgAUEBaiEBIBBBAWoiECAFRw0ACwsgFEEDTwRAA0AgASAAKAIAIANqLQAAOgAAIAEgAyAAKAIAai0AAToAASABIAMgACgCAGotAAI6AAIgASADIAAoAgBqLQADOgADIAFBBGohASADQQRqIgMgE0cNAAsLIBMFIAMLIA5JBEAgAUEgOgAAIAFBAWohASAMIBFBAWoiEUEDdGooAgAhAwwBCwsgByABIAhrNgIMIAcgCDYCACAHIActABxBAXI6ABwMAQsgByAAKAIAIANqNgIAIAcgDiADazYCDAsgCgRAIAYoAgwhASAGKAIQIgogBigCFCIDaxAHIghFDQEgFSABQQN0aiEUQQAhDCAIIQEDQCADIBQgDEEDdGooAgQiBSAKIAUgCkkbIhFJBH8gESADQX9zaiEEQQAhECARIANrQQNxIgUEQANAIAEgACgCACADai0AADoAACADQQFqIQMgAUEBaiEBIBBBAWoiECAFRw0ACwsgBEEDTwRAA0AgASAAKAIAIANqLQAAOgAAIAEgAyAAKAIAai0AAToAASABIAMgACgCAGotAAI6AAIgASADIAAoAgBqLQADOgADIAFBBGohASADQQRqIgMgEUcNAAsLIBEFIAMLIApPDQMgAUEKOgAAIAFBAWohASAUIAxBAWoiDEEDdGooAgAhAwwACwALIAcgBigCFCIIIAAoAgBqNgIEIAcgBigCECAIazYCEAwCCyAAKAIkIgIEQEHsDiAAKAIsIAIRAAALIAQgD0EFdGoiAi0AHCIAQQFxBH8gBygCABADIAItABwFIAALQQJxBEAgBCAPQQV0aigCBBADC0F/IQEMCwsgByABIAhrNgIQIAcgCDYCBCAHIActABxBAnI6ABwLIAcgBigCHDYCFCAHIAYoAhg2AhggACAAKAJAQQFqNgJAIAJBAWoiAkEAIAJBAEobIBJqIRIgAkUNBkF/IQEgAkEATg0HDAkLIA1BCUYNASANQSBGDQEgDUELa0ECSQ0BCyADIAsgDhshAyAWIAggDhshFiALIBFqIQ4LIAsgEWoLIQsgDyAURiECIA9BAWohDyACRQ0ACwsLCwJAAkAgEkEASgRAIBIgF0cNAUEAIQEgAEEANgLkAyAAIAAoAugDIBdBA3RrQQhrNgLoAwwECyAAKALkAyIDDQFBACEBDAMLIBcgEmtBA3QhBAJAIAkgEkEDdCIIaiIFIAlGDQAgBSAEIAlqIgJrQQAgBEEBdGtNBEAgCSAFIAQQBBoMAQsgBSAJc0EDcSEBAkACQCAFIAlLBEAgAQ0CIAlBA3FFDQEDQCAERQ0EIAkgBS0AADoAACAFQQFqIQUgBEEBayEEIAlBAWoiCUEDcQ0ACwwBCwJAIAENACACQQNxBEADQCAERQ0FIAkgBEEBayIEaiICIAQgBWotAAA6AAAgAkEDcQ0ACwsgBEEDTQ0AA0AgCSAEQQRrIgRqIAQgBWooAgA2AgAgBEEDSw0ACwsgBEUNAgNAIAkgBEEBayIEaiAEIAVqLQAAOgAAIAQNAAsMAgsgBEEDTQ0AA0AgCSAFKAIANgIAIAVBBGohBSAJQQRqIQkgBEEEayIEQQNLDQALCyAERQ0AA0AgCSAFLQAAOgAAIAlBAWohCSAFQQFqIQUgBEEBayIEDQALCyAAKALkAyIDIAMoAgQgEms2AgQgACAAKALoAyAIazYC6AMLIAMoAgAhAQsCQCABQf8RcUGGEEYEQCADKAIEIgJBAkgNASADIAJBAWs2AgQgACAAKALoA0EIazYC6AMLQQAhASAAQQA2AuQDDAELIAMgAUGAfnFBCXI2AgBBACEBCyAGQSBqJAAgAQvjAQECfyACQQBHIQMCQAJAAkAgAEEDcUUNACACRQ0AIAFB/wFxIQQDQCAALQAAIARGDQIgAkEBayICQQBHIQMgAEEBaiIAQQNxRQ0BIAINAAsLIANFDQECQCAALQAAIAFB/wFxRg0AIAJBBEkNACABQf8BcUGBgoQIbCEDA0AgACgCACADcyIEQX9zIARBgYKECGtxQYCBgoR4cQ0CIABBBGohACACQQRrIgJBA0sNAAsLIAJFDQELIAFB/wFxIQEDQCABIAAtAABGBEAgAA8LIABBAWohACACQQFrIgINAAsLQQALqgQCB38CfkEIIQUCQAJAIABBR0sNAANAQQggBSAFQQhNGyEFQYjJACkDACIIAn9BCCAAQQNqQXxxIABBCE0bIgBB/wBNBEAgAEEDdkEBawwBCyAAQR0gAGciAWt2QQRzIAFBAnRrQe4AaiAAQf8fTQ0AGkE/IABBHiABa3ZBAnMgAUEBdGtBxwBqIgEgAUE/TxsLIgOtiCIJQgBSBEADQCAJIAl6IgmIIQgCfiADIAmnaiIDQQR0IgZBiMEAaigCACIEIAZBgMEAaiICRwRAIAQgBSAAEBgiBw0FIAQoAgQiASAEKAIINgIIIAQoAgggATYCBCAEIAI2AgggBCAGQYTBAGoiASgCADYCBCABIAQ2AgAgBCgCBCAENgIIIANBAWohAyAIQgGIDAELQYjJAEGIyQApAwBCfiADrYmDNwMAIAhCAYULIglCAFINAAtBiMkAKQMAIQgLAkAgCEIAUgRAQT8gCHmnayIGQQR0IgFBiMEAaigCACECAkAgCEKAgICABFQNAEHjACEDIAIgAUGAwQBqIgFGDQADQCADRQ0BIAIgBSAAEBgiBw0FIANBAWshAyACKAIIIgIgAUcNAAsgASECCyAAQTBqEBsNASACRQ0EIAIgBkEEdEGAwQBqIgFGDQQDQCACIAUgABAYIgcNBCACKAIIIgIgAUcNAAsMBAsgAEEwahAbRQ0DC0EAIQcgBSAFQQFrcQ0BIABBR00NAAsLIAcPC0EAC/ICAgJ/AX4CQCACRQ0AIAAgAToAACAAIAJqIgNBAWsgAToAACACQQNJDQAgACABOgACIAAgAToAASADQQNrIAE6AAAgA0ECayABOgAAIAJBB0kNACAAIAE6AAMgA0EEayABOgAAIAJBCUkNACAAQQAgAGtBA3EiBGoiAyABQf8BcUGBgoQIbCIBNgIAIAMgAiAEa0F8cSIEaiICQQRrIAE2AgAgBEEJSQ0AIAMgATYCCCADIAE2AgQgAkEIayABNgIAIAJBDGsgATYCACAEQRlJDQAgAyABNgIYIAMgATYCFCADIAE2AhAgAyABNgIMIAJBEGsgATYCACACQRRrIAE2AgAgAkEYayABNgIAIAJBHGsgATYCACAEIANBBHFBGHIiBGsiAkEgSQ0AIAGtQoGAgIAQfiEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkEgayICQR9LDQALCyAAC2YBBX9BfyECAkAgACgCACIDKAIIIgUgASgCACIEKAIIIgZJDQBBASECIAUgBksNACADKAIAIAMoAgwgBCgCACAEKAIMEBEiAg0AQX8gACgCACIAIAEoAgAiAUsgACABSRshAgsgAgugAQECfwJ/AkAgAkEETwRAIAAgAXJBA3ENAQNAIAAoAgAgASgCAEcNAiABQQRqIQEgAEEEaiEAIAJBBGsiAkEDSw0ACwtBAAwBC0EBCyEDA0ACQCADRQRAIAINAUEADwsCQCAALQAAIgMgAS0AACIERgRAIAFBAWohASAAQQFqIQAgAkEBayECDAELIAMgBGsPC0EAIQMMAQtBASEDDAALAAuRAwEIfyABKAIMIgMoAgAiAiABKAIESQRAA0AgB0ECdCEEIAEoAgAgAmohCCADIAdBAWoiB0ECdCIJaigCACACayEFAkACQAJAAkAgBCABKAIIaigCAEEBaw4EAAICAQILIAAoAggiBSgCBCICIAUoAggiA2tBAk0EQCACIAUoAgAiBGshAiADIARrIQMDQCACQQF0QYAEIAIbIgIgA2tBA0kNAAsgBSAEIAIQAiIENgIAIAUgAyAEaiIDNgIIIAUgAiAEajYCBAsgA0G6PC0AADoAAiADQbg8LwAAOwAAIAUgBSgCCEEDajYCCAwCCyAFIAAoAggiAygCBCICIAMoAggiBGtLBEAgAiADKAIAIgZrIQIgBCAGayEEA0AgAkEBdEGABCACGyICIARrIAVJDQALIAMgBiACEAIiBjYCACADIAQgBmoiBDYCCCADIAIgBmo2AgQLIAQgCCAFEAQaIAMgAygCCCAFajYCCAwBCyAAIAggBRAaCyABKAIMIgMgCWooAgAiAiABKAIESQ0ACwsL8woBE38gASAAKALwAiIETARAIAAoAlAhCQNAIAkgBEEUbGooAggiBCABTg0ACyAAIAQ2AvACCyAAQewCaiIJIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAL4AiIETARAIAAoAlAhCgNAIAogBEEUbGooAggiBCABTg0ACyAAIAQ2AvgCCyAAQfQCaiIKIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKAAyIETARAIAAoAlAhCwNAIAsgBEEUbGooAggiBCABTg0ACyAAIAQ2AoADCyAAQfwCaiILIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKIAyIETARAIAAoAlAhDANAIAwgBEEUbGooAggiBCABTg0ACyAAIAQ2AogDCyAAQYQDaiIMIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKQAyIETARAIAAoAlAhDQNAIA0gBEEUbGooAggiBCABTg0ACyAAIAQ2ApADCyAAQYwDaiINIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKYAyIETARAIAAoAlAhDgNAIA4gBEEUbGooAggiBCABTg0ACyAAIAQ2ApgDCyAAQZQDaiIOIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKgAyIETARAIAAoAlAhDwNAIA8gBEEUbGooAggiBCABTg0ACyAAIAQ2AqADCyAAQZwDaiIPIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKoAyIETARAIAAoAlAhBgNAIAYgBEEUbGooAggiBCABTg0ACyAAIAQ2AqgDCyAAQaQDaiITIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAKwAyIETARAIAAoAlAhBgNAIAYgBEEUbGooAggiBCABTg0ACyAAIAQ2ArADCyAAQawDaiIUIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKAK4AyIETARAIAAoAlAhBgNAIAYgBEEUbGooAggiBCABTg0ACyAAIAQ2ArgDCyAAQbQDaiIGIQUgBEEATgR/IAAoAlAgBEEUbGpBDGoFIAULQX82AgAgASAAKALAAyIETARAIAAoAlAhBQNAIAUgBEEUbGooAggiBCABTg0ACyAAIAQ2AsADCyAEQQBIBH8gAEG8A2oFIAAoAlAgBEEUbGpBDGoLQX82AgAgASACQQFrIgRIBEAgAEHkAmohAiAAKAJQIhAgAUEUbGohByADQQFHIRUDQAJAAkACQCAQIARBFGxqIgUtABFBCHEiFkUNACAFKAIIIhEgAU4NACAQIBFBFGxqIhIgEi0AEUHjAXE6ABEgDyEAAkACQAJAAkACQCAHLAAQIghB2wBrDiQCBQUFBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUDBQEACyAIQSpHDQQgDCEAAkACQAJAAkACQCAHLQARQeABcUFAakEFdkEBaw4FCAMABAECCyANIQAMBwsgDiEADAYLIAkhAAwFCyAKIQAMBAsgCyEADAMLIBMgFCAHKAIEIAcoAgBrQQFGGyEADAILIAYhAAwBCyACIQALIAAgECAAKAIEIghBFGxqQQxqIAhBAEgbIBE2AgAgEkF/NgIMIBIgCDYCCCAAIBE2AgQMAQsgAw0BCyAFIAUtABFB4wFxOgARCwJAAkAgFQ0AIBZFDQAgBSgCCCIAIAFKDQELIARBAWshAAsgASAAIgRIDQALCwukHgEcfyMAQSBrIg4kACABIAJIBEAgAEHIA2ohHyAAQeQCaiEaIABBhANqIREgAEGMA2ohEiAAQZQDaiETIABB7AJqIRQgAEH0AmohFSAAQfwCaiEWIABBnANqIRsgAEG0A2ohECAAQawDaiEcIABBpANqIR0gAEHAA2ohDyAAQbwDaiEXIAAoAlAhCgNAAkAgCiABQRRsIgtqIggtABEiDEEQcQRAIAxBBHFFDQEgCCgCDCEBDAELIAgtABAiDUUNAAJ/IAMhBAJAIA3AIgZB/wFxIgcEQCAEQQNxBEADQCAELQAAIgVFDQMgBSAGQf8BcUYNAyAEQQFqIgRBA3ENAAsLAkAgBCgCACIFQX9zIAVBgYKECGtxQYCBgoR4cQ0AIAdBgYKECGwhBwNAIAUgB3MiBUF/cyAFQYGChAhrcUGAgYKEeHENASAEKAIEIQUgBEEEaiEEIAVBgYKECGsgBUF/c3FBgIGChHhxRQ0ACwsDQCAEIgUtAAAiBwRAIAVBAWohBCAHIAZB/wFxRw0BCwsgBQwCCyAEEBcgBGoMAQsgBAsiBEEAIAQtAAAgBkH/AXFGG0UNAAJAAkACQAJAAkACQAJAAkAgBkEhaw5eAAgIBQgBCAgIAwgICAYICAgICAgICAgICAYICAgICAcICAgICAgICAgICAgICAgICAgICAgICAgICAAIAAgDCAgICAgICAgICAgICAgICAgICAgICAgICAgICAIIBAgLIAAoArgDIQQgDEEBcQRAIBAgCiAEQRRsakEMaiAEQQBIGyABNgIAIAhBfzYCDCAIIAQ2AgggACABNgK4AwwICyAEQQBIDQcgECAKIAogBEEUbGoiBSgCCCIGQRRsakEMaiAGQQBIG0F/NgIAIAAgBjYCuAMgBSABNgIMIAggBDYCCCAfIAogACgCzAMiBkEUbGpBCGogBkEASBsgBDYCACAAIAQ2AswDIAVBfzYCCAwHCyABQQFqIgUgACgCVE4NBiAKIAVBFGxqIgQtABBBO0cNBiAAKAIAIAgoAgAgBCgCBCIGIA4QK0UNBiAIIAU2AgwgCCAMQRRyOgARIAQgATYCCCAEIAQtABFBGHI6ABEgCCAGNgIEDAYLIAggDEEQcjoAESAaIAogACgC6AIiBEEUbGpBDGogBEEASBsgATYCACAIQX82AgwgCCAENgIIIAAgATYC6AIgACAAKALEA0EBajYCxAMMBQtBACEFAkACQAJAAkAgBkHbAGsOBQIDAwMBAAsgBkEqRw0CIBEhBQJAAkACQAJAAkAgDEHgAXFBQGpBBXZBAWsOBQcDAAQBAgsgEiEFDAYLIBMhBQwFCyAUIQUMBAsgFSEFDAMLIBYhBQwCCyAbIQUMAQsgECEFCwJAIAxBAnFFDQACQCANQSpGBEAgDiARNgIAQQEhBiAOAn8gDEHAAXEiB0HAAUcEQCAOIBI2AgRBACEEQQIiBiAHQYABRg0BGgsgDiAGQQJ0ciATNgIAQQEhBCAGQQFqCyIGQQJ0aiAUNgIAIAZBAWohByAMQeABcUHgAUcEQCAOIAdBAnRqIBU2AgAgBkECaiEHCyAEQQFzIAxBIHFBAEdxRQRAIA4gB0ECdGogFjYCACAHQQFqIQcLIAogDigCACgCBCIGQRRsakEAIAZBAE4iCRshBCAGQQAgCRshBgJAIA4oAgQoAgQiCUEASA0AIAlBFGwhDSAEBEAgCiANaigCBCAEKAIETQ0BCyAKIA1qIQQgCSEGCwJAIA4oAggoAgQiCUEASA0AIAlBFGwhDSAEBEAgCiANaigCBCAEKAIETQ0BCyAKIA1qIQQgCSEGCyAHQQNGDQECQCAOKAIMKAIEIglBAEgNACAJQRRsIQ0gBARAIAogDWooAgQgBCgCBE0NAQsgCiANaiEEIAkhBgsgB0EERg0BAkAgDigCECgCBCIJQQBIDQAgCUEUbCENIAQEQCAKIA1qKAIEIAQoAgRNDQELIAogDWohBCAJIQYLIAdBBUYNASAOKAIUKAIEIgdBAEgNASAHQRRsIQkgBARAIAkgCmooAgQgBCgCBE0NAgsgCSAKaiEEIAchBgwBCyAFKAIEIgZBAEgNASAKIAZBFGxqIQQLIARFDQAgBCgCBCAEKAIAayEJIAgoAgQgCCgCAGshB0EAIQQCQAJAAkACQAJAAkAgCiAGQRRsaiIFLAAQIgxB2wBrDiQDBQUFAQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUEBQIACyAMQSpHDQQgESEEAkACQAJAAkACQCAFLQARQeABcUFAakEFdkEBaw4FCQMABAECCyASIQQMCAsgEyEEDAcLIBQhBAwGCyAVIQQMBQsgFiEEDAQLIBshBAwDCyAdIBwgBSgCBCAFKAIAa0EBRhshBAwCCyAQIQQMAQsgGiEECwJAAkAgByAJSQRAIAogBSgCBCAFKAIAayAHayAGaiIGQRRsIghqIgkgBSkCADcCACAJIAUoAhA2AhAgCSAFKQIINwIIIAUgBSgCBCAHayIFNgIEIAkgBTYCAAJAIAQoAgQiB0EATgRAIAAoAlAiBSAHQRRsaiAGNgIMDAELIAQgBjYCACAAKAJQIQULIAUgCGoiBUF/NgIMIAUgBzYCCCAEIAY2AgQgACAGIAFBARAMIAAoAlAhCgwBCyAHIAlLBEAgCiABIAlqQRRsaiIFIAgpAgA3AgAgBSAIKAIQNgIQIAUgCCkCCDcCCCAIIAgoAgQgCSAHa2oiBzYCBCAFIAc2AgALIAAgBiABQQEQDCAAKAJQIQogBEUNAQsgCiAGQRRsaiIHKAIMIQUCQCAHKAIIIglBAE4EQCAKIAlBFGxqIAU2AgwgBygCDCEFDAELIAQgBTYCAAsgBEEEaiAKIAVBFGxqQQhqIAVBAEgbIAk2AgALIAogBkEUbGoiBCABNgIMIAQgBC0AEUEUcjoAESAKIAtqIgQgBjYCCCAEIAQtABFBGHI6ABEMBQsgDEEBcUUNBCAFIAogBSgCBCIEQRRsakEMaiAEQQBIGyABNgIAIAhBfzYCDCAIIAQ2AgggBSABNgIEDAQLIB0gHCAIKAIEIAgoAgBrQQFGGyEEAkAgDEECcUUNACAEKAIAIgdBAEgNACAAIAcgAUEBEAwgACgCUCIKIAdBFGxqIgYoAgwhBQJAIAYoAggiCUEATgRAIAogCUEUbGogBTYCDCAGKAIMIQUMAQsgBCAFNgIACyAEQQRqIAogBUEUbGpBCGogBUEASBsgCTYCACAGIAE2AgwgBiAGLQARQRRyOgARIAogC2oiBCAHNgIIIAQgBC0AEUEYcjoAEQwECyAMQQFxRQ0DIAQgCiAEKAIEIgVBFGxqQQxqIAVBAEgbIAE2AgAgCEF/NgIMIAggBTYCCCAEIAE2AgQMAwsgFygCACIGQQBOBEAgACAGIAFBABAMIAogBkEUbCIEaiIFKAIEIAUoAgBrIAgoAgQgCCgCAGtGBEAgACgCUCIKIARqIgQoAgwhBQJAIAQoAggiB0EATgRAIAogB0EUbGogBTYCDCAEKAIMIQUMAQsgFyAFNgIACyAPIAogBUEUbGpBCGogBUEASBsgBzYCACAEIAE2AgwgBCAELQARQRRyOgARIAogC2oiBCAGNgIIIAQgBC0AEUEYcjoAEQwECwJAIA8oAgAiBEEATgRAIAAoAlAiCiAEQRRsaiABNgIMDAELIAAgATYCvAMgACgCUCEKCyAKIAtqIgVBfzYCDCAFIAQ2AgggDyABNgIADAMLIBcgCiAPKAIAIgRBFGxqQQxqIARBAEgbIAE2AgAgCEF/NgIMIAggBDYCCCAPIAE2AgAMAgtBACEHQQAhBCAIKAIEIhghBUEAIQsCQCAYIAAoAgQiCU8NACAAKAIAIR5BACEGAkADQCAGIQQCQCAFIB5qLQAAIhlBMGtB/wFxQQpJDQAgGUHfAXFBwQBrQf8BcUEaSQ0AAkACQCAZQS1rDgICAQALIBlB3wBHDQNBASEGDAELIAtBAWohC0EAIQYgBCEHCyAFQQFqIgUgCUcNAAsgCSEFIAYhBAsgBSAYTQ0AIAVBAWsiBiAFIAYgHmotAABBLkYiBhshBSALIAZrIQsLIAUgGE0NASALRQ0BIAcNASAEDQEgAUEBaiELIAhBFGohBgNAIAYiBEEUaiEGIAQtACRBxABGDQAgBC0AJUEQcUUNAAsgACgCACEJQQAhB0EAIQQCQCAFIAYoAgAiBk8NAANAAkACQAJAIAUgCWotAABBCWsONAQEBAQEAgICAgICAgICAgICAgICAgICBAICAgICAgIAAQICAgICAgICAgICAgICAgICAgQCCyAEQQFqIQQMAQsgBEEASgRAIARBAWshBAwBCyAHQQFqIQcLIAVBAWoiBSAGRw0ACyAGIQULAkAgCSAFQQFrIgRqLQAAIgZFDQADQEGACCAGwEEJEAZFBEAgBkH/AXFBKUcNAiAHQQBMDQIgB0EBayEHCyAJIAQiBUEBayIEai0AACIGDQALCyAIIAgoAgA2AgQgCiALQRRsaiIEIA06ABAgCCAFNgIUIAQgBTYCBCAIIAs2AgwgCCAMQRRyOgARIAQgATYCCCAEIAQtABFBGHI6ABEMAQsgCCgCBCEGIAAoAgAhC0EAIQdBACEFAkAgCCgCACIERQ0AA0ACQCALIAQiBUEBayIEaiwAACIJQTBrQf8BcUEKSQ0AIAlBX3FBwQBrQf8BcUEaSQ0AIAlFDQJBww8gCUEFEAZFDQILIAQNAAtBACEFCwJAIAYgACgCBCIETw0AA0ACQCAGIAtqLAAAIglBMGtB/wFxQQpJDQAgCUFfcUHBAGtB/wFxQRpJDQAgCUUNAkGrCyAJQQQQBkUNAgsgByAJQS5GaiEHIAZBAWoiBiAERw0ACyAEIQYLAkACQAJAIAsgBkEBayIJai0AACIEQS1rDgIDAQALIARB3wBHDQEMAgsgB0EBayEHIAYgC2pBAmstAAAhBCAJIQYLIARB/wFxQcAARg0AIAdFDQAgCCAFNgIAIAggBTYCBCAIIAFBAWo2AgwgCCAGNgIYIAggBjYCFCAIIA06ACQgCCAMQRRyOgARIAggATYCHCAIIAgtACVBGHI6ACULIAFBAWoiASACSA0ACwsgDkEgaiQAC/YCAQN/AkAgAC0AACIDwCIEQQBODQAgA0HgAXFBwAFGBEAgAUECSQ0BIAAtAAEiA0HAAXFBgAFHDQEgAgRAIAJBAjYCACAALQABIQMgAC0AACEECyADQT9xIARBH3FBBnRyDwsgA0HwAXFB4AFGBEAgAUEDSQ0BIAAtAAEiA0HAAXFBgAFHDQEgAC0AAiIBQcABcUGAAUcNASACBH8gAkEDNgIAIAAtAAEhAyAALQAAIQQgAC0AAgUgAQtBP3EgA0E/cUEGdCAEQQ9xQQx0cnIPCyABQQRJDQAgA0H4AXFB8AFHDQAgAC0AASIDQcABcUGAAUcNACAALQACIgFBwAFxQYABRw0AIAAtAAMiBUHAAXFBgAFHDQAgAgRAIAJBBDYCACAALQADIQUgAC0AASEDIAAtAAAhBCAALQACIQELIAVBP3EgA0E/cUEMdCAEQQdxQRJ0ciABQT9xQQZ0cnIPCyACBH8gAkEBNgIAIAAtAAAFIAQLwAt9AQN/IAIgACgCBCIDIAAoAggiBGtLBEAgAyAAKAIAIgVrIQMgBCAFayEEA0AgA0EBdEGABCADGyIDIARrIAJJDQALIAAgBSADEAIiBTYCACAAIAQgBWoiBDYCCCAAIAMgBWo2AgQLIAQgASACEAQaIAAgACgCCCACajYCCAvqBQEFfyMAQRBrIgokACAFQgA3AgAgBUEYaiIHQgA3AgAgBUIANwIQIAVCADcCCAJAAkACQAJAAkAgAgRAA0AgASAGai0AACIJRQ0CIAlBJkYNAiAJQdwARg0CIAZBAWoiBiACRw0ACyABIQYLIAVCADcCFCAFQgE3AgwgBSAGNgIAIAUgAjYCHCAFIAc2AgggBSAFQRRqIgE2AgQMAQsgBSACEAciBjYCACAGRQ0BIANBAXEhCUEAIQNBACEGA0ACfwJAIAEgBmoiBy0AACIIQSZHBEAgCA0BIAAgBUEBIAMQHkEASA0GIAUoAgAgA2ogBy0AADoAACADQQFqIQMgBkEBagwCCyABIAYgAiAKQQxqECtFDQAgACAFQQQgAxAeQQBIDQUgBSgCACADaiAHIAooAgwiByAGayIGEAQaIAMgBmohAyAHDAELAkAgBSgCDCIIBEAgBSgCBCAIQQJ0akEEaygCAEUNAQsgACAFQQAgAxAeQQBIDQULAkAgCQ0AIActAABB3ABHDQAgBkEBaiIHIAJPDQACQCABIAdqLQAAIghBIWtB/wFxQQ9JDQAgCEEKaw51AAEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAAAAQsgByEGCyAFKAIAIANqIAEgBmotAAA6AAAgA0EBaiEDIAZBAWoLIgYgAkkNAAsgBSgCACEGIAUoAgQhASAFKAIIIgcgBSgCDEECdGogAzYCACADIQILIAQgBzYCDCAEIAI2AgQgBCAGNgIAIAQgATYCCEEAIQYMAgsgACgCJCIBRQ0AQewOIAAoAiwgAREAAAtBfyEGIAUoAhBBAEwNACAFKAIAEAMgBSgCBBADIAUoAggQAwsgCkEQaiQAIAYL9QEBCX8jAEEgayIEJAAgBEIANwMYIARCADcDECAEQgA3AwggBEIANwMAIABBACABEBIhCCACQQAgAxASIQkCQAJAAkAgASAISwRADAELIAMgCU0NAQsDQCAKRQRAIAAgCCABIARBEGoQLCEIQQAhBQsgB0EBcUUEQCACIAkgAyAEECwhCUEAIQYLIAQgBkECdGooAgAgBEEQaiAFQQJ0aigCAGsiBw0CIAZBAWoiBiAEKAIMIgtJIQcgBUEBaiIFIAQoAhwiDEkhCiABIAhLDQAgBSAMSQ0AIAMgCUsNACAGIAtJDQALC0EAIQcLIARBIGokACAHC4QCAQh/IwBBEGsiBSQAAkAgASACTw0AA0ACQAJAIAAgAWoiCSACIAFrIAVBDGoQDiIDQf8ASwRAQQAhBEEHIQYDQAJAAkAgAyAEIAZqQQJtIgdBAnRBoBlqKAIAIgpBH3UgB2oiCEECdEGgGWooAgBB////B3FJBEAgCEEBayEGDAELIApBHnZBAXEgB2oiBEECdEGgGWooAgBB////B3EgA08NASAEQQFqIQQLIAQgBkwNAQwDCwsgCEEASA0BDAILIANBCUYNASADQSBGDQEgA0ELa0ECSQ0BCyAJLQAAQQprDgQAAgIAAgsgBSgCDCABaiIBIAJJDQALCyAFQRBqJAAgAQtIAQJ/An8gAUEfTQRAIAAoAgAhAiAAQQRqDAELIAFBIGshASAACygCACEDIAAgAiABdDYCACAAIAMgAXQgAkEgIAFrdnI2AgQLpQIBBX8jAEHwAWsiBiQAIAYgAjYC7AEgBiABNgLoASAGIAA2AgACQAJAAkACQCABQQFHBEAgACEIQQEhCQwBCyAAIQhBASEJIAINACAAIQcMAQsDQCAIIAUgA0ECdGooAgBrIgcgABAJQQBMBEAgCCEHDAILAkACQCAEDQAgA0ECSA0AIANBAnQgBWpBCGsoAgAhBCAIQQRrIgogBxAJQQBODQEgCiAEayAHEAlBAE4NAQsgBiAJQQJ0aiAHNgIAIAZB6AFqIAEgAhAjIgEQFSAJQQFqIQkgASADaiEDQQAhBCAGKALsASECIAchCCAGKALoASIBQQFHDQEgAg0BDAMLCyAIIQcMAQsgBA0BCyAGIAkQIiAHIAMgBRAZCyAGQfABaiQAC0sBAn8gACgCBCECIAACfyABQR9NBEAgACgCACEDIAIMAQsgAUEgayEBIAIhA0EACyICIAF2NgIEIAAgAkEgIAFrdCADIAF2cjYCAAuzAwEEfyAAKALsAyECIAAoAugDIQMCQAJAAkACQAJAIAAoAuQDIgQtAABBB2tBAU0EQCACIANBDGoiBUgEQEEAIQQgAEGABCACQQF2IAJqIAJBAEwbIgI2AuwDIAAoAuADIAIQAiICRQRAIAAoAiQiAUUNAwwHCyAAKALkAyIDBEAgACACIAMgACgC4ANraiIENgLkAwsgACACNgLgAyAAIAAoAugDIgNBDGo2AugDDAQLIAAgBTYC6AMgACgC4AMiAg0DDAELIAIgA0EIaiIFSARAQQAhBCAAQYAEIAJBAXYgAmogAkEATBsiAjYC7AMgACgC4AMgAhACIgJFBEAgACgCJCIBRQ0CDAYLIAAoAuQDIgMEQCAAIAIgAyAAKALgA2tqIgQ2AuQDCyAAIAI2AuADIAAgACgC6AMiA0EIajYC6AMMAgsgACAFNgLoAyAAKALgAyICDQELQX8PCyACIANqIgAgASgCBDYCAAwBCyACIANqIgAgASgCDDYCCCAAIAEoAgQ2AgALIAAgASgCCDYCBCAEIAQoAgRBAWo2AgRBAA8LQf0OIAAoAiwgAREAAEF/C3oBA38CQAJAIAAiAUEDcUUNACAALQAARQRAQQAPCwNAIAFBAWoiAUEDcUUNASABLQAADQALDAELA0AgASICQQRqIQEgAigCACIDQX9zIANBgYKECGtxQYCBgoR4cUUNAAsDQCACIgFBAWohAiABLQAADQALCyABIABrC6QDAQN/IAEgAEEEaiIEakEBa0EAIAFrcSIFIAJqIAAgACgCACIBakEEa00EfyAAKAIEIgMgACgCCDYCCCAAKAIIIAM2AgQgBCAFRwRAIAAgAEEEaygCAEF+cWsiAyAFIARrIgQgAygCAGoiBTYCACAFQXxxIANqQQRrIAU2AgAgACAEaiIAIAEgBGsiATYCAAsCQCABIAJBGGpPBEAgACACakEIaiIDIAEgAmtBCGsiATYCACABQXxxIANqQQRrIAFBAXI2AgAgAwJ/IAMoAgBBCGsiAUH/AE0EQCABQQN2QQFrDAELIAFnIQQgAUEdIARrdkEEcyAEQQJ0a0HuAGogAUH/H00NABpBPyABQR4gBGt2QQJzIARBAXRrQccAaiIBIAFBP08bCyIBQQR0IgRBgMEAajYCBCADIARBiMEAaiIEKAIANgIIIAQgAzYCACADKAIIIAM2AgRBiMkAQYjJACkDAEIBIAGthoQ3AwAgACACQQhqIgE2AgAgAUF8cSAAakEEayABNgIADAELIAAgAWpBBGsgATYCAAsgAEEEagVBAAsLnAEBBX8jAEHwAWsiBCQAIAQgADYCAEEBIQUCQCABQQJIDQAgACEDA0AgACADQQRrIgMgAiABQQJrIgdBAnRqKAIAayIGEAlBAE4EQCAAIAMQCUEATg0CCyAEIAVBAnRqIAYgAyAGIAMQCUEATiIGGyIDNgIAIAVBAWohBSABQQFrIAcgBhsiAUEBSg0ACwsgBCAFECIgBEHwAWokAAvbBwEIfyAAIQgDQCAEIgAhBgJAIABBA2oiAyACTw0AA0AgACABaiIGLQAAQcA8ai0AAARAIAAhBgwCCyAGLQABQcA8ai0AAARAIAAhBgwCCyAGLQACQcA8ai0AAARAIAAhBgwCCyABIANqLQAAQcA8ai0AAARAIAAhBgwCCyAAQQdqIQMgAEEEaiIGIQAgAiADSw0ACwsCf0EAIAIgBk0NABpBASABIAZqLQAAQcA8ai0AAA0AGgJAA0AgAiAGQQFqIgZHBEAgASAGai0AAEHAPGotAABFDQEMAgsLIAIhBgsgAiAGSwshBSAEIAZJBEAgBiAEayIKIAgoAggiAygCBCIAIAMoAggiB2tLBEAgACADKAIAIglrIQAgByAJayEHA0AgAEEBdEGABCAAGyIAIAdrIApJDQALIAMgCSAAEAIiCTYCACADIAcgCWoiBzYCCCADIAAgCWo2AgQLIAcgASAEaiAKEAQaIAMgAygCCCAKajYCCAsgBQRAAkACfwJAAkACQAJAIAEgBmosAABBImsOHQMFBQUABQUFBQUFBQUFBQUFBQUFBQUFBQUFAQUCBQsgCCgCCCIEKAIEIgAgBCgCCCIDa0EETQRAIAAgBCgCACIFayEAIAMgBWshAwNAIABBAXRBgAQgABsiACADa0EFSQ0ACyAEIAUgABACIgU2AgAgBCADIAVqIgM2AgggBCAAIAVqNgIECyADQZsNLQAAOgAEIANBlw0oAAA2AABBBSEDIARBCGoMAwsgCCgCCCIEKAIEIgAgBCgCCCIDa0EDTQRAIAAgBCgCACIFayEAIAMgBWshAwNAIABBAXRBgAQgABsiACADa0EESQ0ACyAEIAUgABACIgU2AgAgBCADIAVqIgM2AgggBCAAIAVqNgIECyADQabY0dsDNgAAQQQhAyAEQQhqDAILIAgoAggiBCgCBCIAIAQoAggiA2tBA00EQCAAIAQoAgAiBWshACADIAVrIQMDQCAAQQF0QYAEIAAbIgAgA2tBBEkNAAsgBCAFIAAQAiIFNgIAIAQgAyAFaiIDNgIIIAQgACAFajYCBAsgA0GmztHbAzYAAEEEIQMgBEEIagwBCyAIKAIIIgQoAgQiACAEKAIIIgNrQQVNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQZJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANBlA0vAAA7AAQgA0GQDSgAADYAAEEGIQMgBEEIagsiACAAKAIAIANqNgIACyAGQQFqIQQMAQsLC/IDAQV/An9B4MAAKAIAIgEgAEEHakF4cSIDaiECAkAgA0EAIAEgAk8bDQAgAj8AQRB0SwRAIAIQAEUNAQtB4MAAIAI2AgAgAQwBC0HwwABBMDYCAEF/CyICQX9HBEAgACACaiIAQQRrQRA2AgAgAEEQayIDQRA2AgACQAJ/QYDJACgCACIBBH8gASgCCAVBAAsgAkYEQCACIAJBBGsoAgBBfnFrIgRBBGsoAgAhBSABIAA2AghBcCAEIAVBfnFrIgAgACgCAGpBBGstAABBAXFFDQEaIAAoAgQiASAAKAIINgIIIAAoAgggATYCBCAAIAMgAGsiATYCAAwCCyACQRA2AgwgAkEQNgIAIAIgADYCCCACIAE2AgRBgMkAIAI2AgBBEAsgAmoiACADIABrIgE2AgALIAFBfHEgAGpBBGsgAUEBcjYCACAAAn8gACgCAEEIayIBQf8ATQRAIAFBA3ZBAWsMAQsgAUEdIAFnIgNrdkEEcyADQQJ0a0HuAGogAUH/H00NABpBPyABQR4gA2t2QQJzIANBAXRrQccAaiIBIAFBP08bCyIBQQR0IgNBgMEAajYCBCAAIANBiMEAaiIDKAIANgIIIAMgADYCACAAKAIIIAA2AgRBiMkAQYjJACkDAEIBIAGthoQ3AwALIAJBf0cLnwYBCX8jAEEwayIJJAAgA0EBayEHQQJBASAAKAIAIgUgAmotAABBIUYbIAJqIQIDQCABIghBCGohASACIAgoAgQiA08NAAsgCCEBA0AgASIGQQhqIQEgByAGKAIETw0ACwJAAn8gBiAIRiIMRQRAAkAgByACaxAHIgYEQCAGIQEDQCACIAMgByADIAdJGyIFSQR/IAUgAkF/c2ohCkEAIQMgBSACa0EDcSILBEADQCABIAAoAgAgAmotAAA6AAAgAkEBaiECIAFBAWohASADQQFqIgMgC0cNAAsLIApBA08EQANAIAEgACgCACACai0AADoAACABIAIgACgCAGotAAE6AAEgASACIAAoAgBqLQACOgACIAEgAiAAKAIAai0AAzoAAyABQQRqIQEgAkEEaiICIAVHDQALCyAFBSACCyAHTw0CIAFBIDoAACABQQFqIQEgCCANQQFqIg1BA3RqIgIoAgQhAyACKAIAIQIMAAsAC0F/IQEgACgCJCICRQ0DQewOIAAoAiwgAhEAAAwDCyABIAZrDAELIAIgBWohBiAHIAJrCyEDQQAhAQJAIAAoAkxFDQAgBiADEB8hAiAAKAJIIAIgACgCTHBBAnRqKAIAIgJFDQACQAJAIAAoAjwiCCACSw0AIAIgCCAAKAJAQQV0ak8NACACKAIAIAIoAgwgBiADEBFFDQEMAgsgCSADNgIcIAkgBjYCECAJIAlBEGo2AgwgCSAGIAMQHzYCGCACQQhqIQgCQCACKAIAIgIEQCAJKAIMIQADQAJ/AkAgACgCCCIKIAggAkEBdiIHQQJ0aiIDKAIAIgUoAggiC0kNACAKIAtNBEAgACgCACAAKAIMIAUoAgAgBSgCDBARIQUgCSgCDCEAIAVBAEgNASAFRQ0FCyADQQRqIQggAiAHQX9zagwBCyAHCyICDQALC0EAIQMLIAMiAEUNASAAKAIAIgJFDQELIAQgAigCFDYCACAEIAIoAhg2AgQgBCACKAIENgIIIAIoAhAhACAEQQA2AhAgBCAANgIMQQEhAQsgDA0AIAYQAwsgCUEwaiQAIAELyhoBDX8jAEEwayIJJAACQCAAIAEgAkEAEChBAEgEQEF/IQQMAQsgACgCUCEDIAJBA3QgAWpBBGsoAgAhDiABKAIAIQYDQCADIgdBFGohAyAHLQARQRBxRQ0ACwNAAn8CQAJAAkAgBiABKAIEIgMgBygCACICIAIgA0sbIgNPBEAgBiEDDAELIAsgACgCACAGaiADIAZrIAAoAiwgACgCIBECACIEDQEgBygCACECQQAhBAsgAiADTQ0BIAMhBiABDAILIAAoAiQiAUUNA0G8DSAAKAIsIAERAAAMAwsgCCEFAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAcsABAiCg6AAQsODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4OAQcODgYOCg4ODgQODg4JDg4ODg4ODg4ODg4JDggOCA4JDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4HAAcOAwIODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODgURDgtBASEFAkAgAiAAKAIAakEBaiICLQAAQQprDgQOAAAOAAtBACEEIAghBSALIAJBASAAKAIsIAAoAiARAgAiAkUNDSAAKAIkIgEEQEG8DSAAKAIsIAERAAALIAIhBAwQC0EAIQQgC0HMEUEBIAAoAiwgACgCIBECACICRQ0MIAAoAiQiAUUEQCACIQQMEAtBvA0gACgCLCABEQAAIAIhBAwPCyAAKAIsIQIgBy0AEUEEcQRAQQUhC0EAIQRBBEEAIAIgACgCGBEBACICRQ0MIAAoAiQiAUUEQCACIQQMEAtB2g0gACgCLCABEQAAIAIhBAwPC0EAIQRBACELQQRBACACIAAoAhwRAQAiAkUNCyAAKAIkIgFFBEAgAiEEDA8LQf4NIAAoAiwgAREAACACIQQMDgsgAC0ADUHAAHFFDQAgBygCBCECAkACQCAHLQARQQRxBEAgAiADSw0BDA0LIAIgA0sNAQwMCwJAA0BBCUEAIAAoAiwgACgCGBEBACIEDQFBACEEIANBAWoiAyAHKAIESQ0ACyAIIQUMDAsgACgCJCIBRQ0OQdoNIAAoAiwgAREAAAwOCwJAA0BBCUEAIAAoAiwgACgCHBEBACIEDQFBACEEIANBAWoiAyAHKAIESQ0ACyAIIQUMCwsgACgCJCIBRQ0NQf4NIAAoAiwgAREAAAwNCyAHLQARQQRxDQggBygCBCIKIANBAWpLBEADQEEBQQAgACgCLCAAKAIcEQEAIgQEQCAAKAIkIgFFDQ9B/g0gACgCLCABEQAADA8LIANBA2ohAiADQQJqIQMgAiAHKAIEIgpJDQALQQAhBAsgCiADa0EBcUUEQCAIIQUMCgtBACEEIAghBUEAQQAgACgCLCAAKAIcEQEAIgJFDQkgACgCJCIBRQRAIAIhBAwNC0H+DSAAKAIsIAERAAAgAiEEDAwLIAAoAiwhAiAHLQARQQRxBEBBACEEQQVBACACIAAoAhgRAQAiAkUNCSAAKAIkIgFFBEAgAiEEDA0LQdoNIAAoAiwgAREAACACIQQMDAtBACEEQQVBACACIAAoAhwRAQAiAkUNCCAAKAIkIgFFBEAgAiEEDAwLQf4NIAAoAiwgAREAACACIQQMCwsgBygCBCADa0EBcUEHcyECIAAoAiwhAyAHLQARQQRxBEBBByELQQAhBCACQQAgAyAAKAIYEQEAIgJFDQggACgCJCIBRQRAIAIhBAwMC0HaDSAAKAIsIAERAAAgAiEEDAsLQQAhBEEAIQsgAkEAIAMgACgCHBEBACICRQ0HIAAoAiQiAUUEQCACIQQMCwtB/g0gACgCLCABEQAAIAIhBAwKCyAAKAJQIQIgByEDAkAgCiIGQd0ARyINBH8gBgUgAiAHKAIIQRRsaiIDLQAQC0H/AXEiBkHbAEcNACACIAMoAgxBFGxqIgUtABBB3QBHDQAgAygCBCIEIAMoAgAiDGsiD0ECSQ0AIAUoAgQgBSgCACIFa0ECSQ0AIAAoAgAhAiAJQgA3AyggCUIANwMgIAlCADcDGCAJQgA3AxAgCUIANwMIIAlCADcDAAJAIAAgAiAMQQJqIgMgBCAPQQJLIgYbaiAEIANrIAUgBGsgBhtBACAJIAlBEGoQEEEASARAQX8hBAwBCyAAKAIsIQIgCkHdAEcEQEEIIAkgAiAAKAIYEQEAIgRFBEBBACEEDAILIAAoAiQiAkUNAUHaDSAAKAIsIAIRAAAMAQtBCCAJIAIgACgCHBEBACIERQRAQQAhBAwBCyAAKAIkIgJFDQBB/g0gACgCLCACEQAACyAJKAIgQQBKBEAgCSgCEBADIAkoAhQQAyAJKAIYEAMLIAghBSAEQQBIDQoMBwsgACANQQNBAiAGQSFGGyADKAIUIgQgACgCAGogAygCGCAEa0EAIAIgAyACa0EoakEUbUEUbGooAgAgAygCMBAnIgRBAEgNCSAHLQAQQd0ARwRAIAghBQwHCyAHKAIEIQUDQCABIgJBCGohASAFIAIoAgRLDQALIAghBSACIQEMBgsgBy0AESICQSBxDQAgAkEddEEfdUEGcSELDAULIAAoAlAhAiAHIgMtABFBBHEiBkUEQCACIAcoAghBFGxqIQMLIAMoAgQhBSAAKAIAIQogAiADKAIMQRRsaiINKAIAIQIgBgRAIA0gDS0AEUEgcjoAEQsgBSAKaiEKIAIgBWshAgJAAkAgAy0AECIMQS5rDhMAAQEBAQEBAQEBAQEBAQEBAQEAAQsCQCACQQdqIgYgACgCOE0EQCAAKAI0IQUMAQsgACgCNCAGQQF2IAZqQYB/cUGAAWoiDBACIgVFBEAgACgCJCIBRQRAQX8hBAwLC0H9DiAAKAIsIAERAABBfyEEDAoLIAAgDDYCOCAAIAU2AjQgAy0AECEMCyAFQakNQbQNIAxBwABGGyIDKAAANgAAIAUgAygAAzYAAyAAKAI0QQdqIAogAhAEGiAAKAI0IQogBiECCyANLQARQSBxDQIgCCEFDAQLIAIgBygCBCIDRgRADAQLQQAhBEEEIAAoAgAgAmogAyACayAAKAIsIAAoAiARAgAiAkUNAyAAKAIkIgFFBEAgAiEEDAcLQbwNIAAoAiwgAREAACACIQQMBgtBACEEQQFBoxNBASAAKAIsIAAoAiARAgAiAkUNAiAAKAIkIgFFBEAgAiEEDAYLQbwNIAAoAiwgAREAACACIQQMBQsgCCEFIAAgBy0AEUEEcUECIAogAkEBQQBBABAnIgRBAEgNBAwBCyAHKAIEIgIgA2tBAXEEQEEAQQAgACgCLCAAKAIYEQEAIgQEQCAAKAIkIgFFDQVB2g0gACgCLCABEQAADAULIANBAWohA0EAIQQgBygCBCECCyACIANBAWpNBEAgCCEFDAELAkADQEEBQQAgACgCLCAAKAIYEQEAIgQNASADQQNqIQJBACEEIANBAmohAyACIAcoAgRJDQALIAghBQwBCyAAKAIkIgFFDQNB2g0gACgCLCABEQAADAMLIAcoAgQhBiAHIQMDQCADIgJBFGohAyACLQAlQRBxRQ0AIAMoAgAgBkkNAAsgBSEIIAchBSADIQcgAQsiCigCBCIDIAZLDQAgBiAOTw0BAkACQCALQX1xQQVGBEAgACgCBCIBIAZNBEAgBiEDDAILIAAoAgAhAiAGIQMCQANAIAIgA2otAAAiCEEgRyAIQQlHcQ0BIANBAWoiAyABRw0ACyABIQMLIAMgBk0NAUEAIQQgCyACIAZqIAMgBmsgACgCLCAAKAIgEQIAIgFFDQEgACgCJCICRQRAIAEhBAwFC0G8DSAAKAIsIAIRAAAgASEEDAQLQQMhAgJAAkACQCALDgcBAgICAgIAAgsgACgCACEBIAYhAwJAA0AgASADai0AACICQSBHIAJBCUdxDQEgA0EBaiIDIA5HDQALIA4hAwsCQCADIAZNDQBBBiABIAZqIAMgBmsgACgCLCAAKAIgEQIAIgRFDQAgACgCJCIBRQ0GQbwNIAAoAiwgAREAAAwGC0EAIQRBBkGiE0EBIAAoAiwgACgCIBECACIBRQ0DIAAoAiQiAkUEQCABIQQMBgtBvA0gACgCLCACEQAAIAEhBAwFC0ECIQIgCA0AQQMhAiAAKAIAIANqIgEtAABBIEcNAEECQQMgAS0AAUEgRhshAgtBACEEIAJBohNBASAAKAIsIAAoAiARAgAiAUUNASAAKAIkIgJFBEAgASEEDAQLQbwNIAAoAiwgAhEAACABIQQMAwsgBSgCBCADTw0AIAMgBygCAE8NAEEAIQQgC0HMEUEBIAAoAiwgACgCIBECACIBRQ0AIAAoAiQiAkUEQCABIQQMAwtBvA0gACgCLCACEQAAIAEhBAwCCyAKQQhqIQEgCigCCCEGQQAhCAwACwALIAAoAtwCIgNBAE4EQCAAKAJQIQIDQCACIANBFGwiAWooAgAQAyAAKAJQIgIgAWooAgwiA0EATg0ACwsgAEJ/NwLcAiAJQTBqJAAgBAvlAQECfwJ/AkAgASgCDCIFIAEoAhAiBEgEQCABKAIEIQQMAQsgAUEIIARBAXYgBGogBEEATBsiBDYCECABKAIEIARBAnQQAiIERQRAQX8gACgCJCICRQ0CGkH9DiAAKAIsIAIRAABBfw8LIAEoAgggASgCEEECdEEEahACIgVFBEAgACgCJCIBBEBB/Q4gACgCLCABEQAACyAEEANBfw8LIAEgBTYCCCABIAQ2AgQgASgCDCEFCyAEIAVBAnRqIAI2AgAgASgCCCABKAIMQQJ0aiADNgIAIAEgASgCDEEBajYCDEEACwunAwEKfyMAQSBrIgUkAEHFu/KIeCEGIAEgAEEAIAEQEiIHSwRAA0ACfwJAAkACQCAAIAdqIgogASAHayAFQRxqEA4iBEH/AEsEQEEAIQNBByECA0ACQAJAIAQgAiADakECbSIIQQJ0QaAZaigCACILQR91IAhqIglBAnRBoBlqKAIAQf///wdxSQRAIAlBAWshAgwBCyALQR52QQFxIAhqIgNBAnRBoBlqKAIAQf///wdxIARPDQEgA0EBaiEDCyACIANODQEMAwsLIAlBAEgNAQwCCyAEQQlGDQEgBEEgRg0BIARBC2tBAkkNAQsgCi0AAEEKaw4EAAEBAAELIAZBIHNBkf6wgQVsIQYgACAHIAEQEgwBCyAEIAVBDGoQLUEAIQIgBSgCGEECdCIEBEADQCAFQQxqIgMgAkEDcmotAAAgAkECciADai0AACACQQFyIANqLQAAIAYgAiADai0AAHNBk4OACGxzQZODgAhsc0GTg4AIbHNBk4OACGwhBiACQQRqIgIgBEcNAAsLIAUoAhwgB2oLIgcgAUkNAAsLIAVBIGokACAGC+sFAQd/AkACQCAAKAL0AyICIAFMDQADQEGCBCEEAkACQAJAAkACQAJAQQEgACgC8AMgAkEBa0EYbGoiAiwAAEEpa3QiA0EWcUUEQCADQSFxRQ0BQYMEIQQLIAIoAhQhBUEAIQcgAi8AAUGAAk8EQCAAKAIAIAVqLAAAIQcLIAAQBSIDQQBIDQcCQCAAKALoAyIGQQhqIgggACgC7AMiA0oEQCAAQYAEIANBAXYgA2ogA0EATBsiAzYC7AMgACgC4AMgAxACIgNFBEAgACgCJCICDQQMCwsgACgC5AMiBgRAIAAgAyAGIAAoAuADa2o2AuQDCyAAIAM2AuADIAAgACgC6AMiBkEIajYC6AMMAQsgACAINgLoAyAAKALgAyIDRQ0JCyADIAZqIgMgBTYCBCADIAdBEHRBhARyNgIAIAIsAAAhB0F/IQMgABAFQQBIDQcCQCAAKALoAyIFQQhqIgYgACgC7AMiAkoEQCAAQYAEIAJBAXYgAmogAkEATBsiAjYC7AMgACgC4AMgAhACIgJFBEAgACgCJCICDQQMCgsgACgC5AMiAwRAIAAgAiADIAAoAuADa2o2AuQDCyAAIAI2AuADIAAgACgC6AMiBUEIajYC6AMMAQsgACAGNgLoAyAAKALgAyICRQ0ICyACIAVqIgIgB0EQdCAEcjYCAEEAIQMMBQsgABAFIgNBAEgNBiAAKALoAyIEQQhqIgUgACgC7AMiAkwNAiAAQYAEIAJBAXYgAmogAkEATBsiAjYC7AMgACgC4AMgAhACIgINASAAKAIkIgJFDQcLQf0OIAAoAiwgAhEAAAwGCyAAKALkAyIEBEAgACACIAQgACgC4ANrajYC5AMLIAAgAjYC4AMgACAAKALoAyIEQQhqNgLoAwwBCyAAIAU2AugDIAAoAuADIgJFDQQLIAIgBGoiAkGBBDYCAAsgAkEANgIEIAAgACgC9ANBAWsiAjYC9AMgASACSA0ACwsgAw8LQX8LPQEDfwNAIABBBHQiAUGEwQBqIAFBgMEAaiICNgIAIAFBiMEAaiACNgIAIABBAWoiAEHAAEcNAAtBMBAbGgtwAQN/IwBBgAJrIgMkACABQQJOBEAgACABQQJ0aiADNgIAIAMgACgCAEEEEAQaA0AgACACQQJ0aiIEKAIAIAAgAkEBaiICQQJ0aigCAEEEEAQaIAQgBCgCAEEEajYCACABIAJHDQALCyADQYACaiQACykAIABBAWsiAGhBACAAGyIABH8gAAUgAWhBACABGyIAQSBqQQAgABsLC9AeAQZ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEEBaw4PAAECAwQFBhUHCAkKCwwNFQsgAigCCCIBKAIEIgAgASgCCCICa0EMTQRAIAAgASgCACIDayEAIAIgA2shAgNAIABBAXRBgAQgABsiACACa0ENSQ0ACyABIAMgABACIgM2AgAgASACIANqIgI2AgggASAAIANqNgIECyACQaQSKQAANwAFIAJBnxIpAAA3AAAgASABKAIIQQ1qNgIIDBQLIAIoAggiASgCBCIAIAEoAggiAmtBBE0EQCAAIAEoAgAiA2shACACIANrIQIDQCAAQQF0QYAEIAAbIgAgAmtBBUkNAAsgASADIAAQAiIDNgIAIAEgAiADaiICNgIIIAEgACADajYCBAsgAkH7ES0AADoABCACQfcRKAAANgAADA4LIAIoAggiBCgCBCIAIAQoAggiA2shBSABKAIAQQFGBEAgBUEETQRAIAAgBCgCACIBayEAIAMgAWshAgNAIABBAXRBgAQgABsiACACa0EFSQ0ACyAEIAEgABACIgE2AgAgBCABIAJqIgM2AgggBCAAIAFqNgIECyADQYgSLQAAOgAEIANBhBIoAAA2AAAgBCAEKAIIQQVqNgIIDBMLIAVBCk0EQCAAIAQoAgAiBWshACADIAVrIQMDQCAAQQF0QYAEIAAbIgAgA2tBC0kNAAsgBCAFIAAQAiIFNgIAIAQgAyAFaiIDNgIIIAQgACAFajYCBAsgA0H4ECgAADYAByADQfEQKQAANwAAIAQgBCgCCEELajYCCCABKAIAIQAgAigCCCIGKAIEIgEgBigCCCIDa0EfTQRAIAEgBigCACIEayEBIAMgBGshAwNAIAFBAXRBgAQgARsiASADa0EgSQ0ACyAGIAQgARACIgQ2AgAgBiADIARqIgM2AgggBiABIARqNgIECyAARQ0LQSAhAQNAIAMgASIEQQFrIgFqIgcgAEEKbiIFQfYBbCAAakEwajoAACAAQQlLIQggBSEAIAgNAAtBISAEayIFQRBNBEAgBEEgSg0NIANBIGohAANAIAMgBygCADYCACADQQRqIQMgB0EEaiIHIABJDQALDA0LIARBAmtBHksNDAJAIAVBA3EiCEUEQCADIQAMAQtBACEHIAMhAANAIAAgASADai0AADoAACAAQQFqIQAgAUEBaiEBIAdBAWoiByAIRw0ACwsgBEEea0EDSQ0MA0AgACABIANqIgQtAAA6AAAgACAELQABOgABIAAgBC0AAjoAAiAAIAQtAAM6AAMgAEEEaiEAIAFBBGoiAUEgRw0ACwwMCyACKAIIIgQoAgQiACAEKAIIIgNrQQJNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQNJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANBpgotAAA6AAIgA0GkCi8AADsAACAEIAQoAghBA2o2AggCQCABKAIARQ0AIAJBCGooAgAiBCgCBCIAIAQoAggiA2tBzQBNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQc4ASQ0ACyAEIAUgABACIgU2AgAgBCADIAVqIgM2AgggBCAAIAVqNgIECyADQfoPQc4AEAQaIAQgBCgCCEHOAGo2AgggAigCCCIEKAIEIgAgBCgCCCIDayEFIAItAABBAnEEQCAFQRNNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQRRJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANB2RAoAAA2ABAgA0HRECkAADcACCADQckQKQAANwAAIAQgBCgCCEEUajYCCCABLQAEQSByQfgARgRAIAIoAghB3hBBEhAPCyACKAIIIgMoAgQiACADKAIIIgFrQQFNBEAgACADKAIAIgRrIQAgASAEayEBA0AgAEEBdEGABCAAGyIAIAFrQQJJDQALIAMgBCAAEAIiBDYCACADIAEgBGoiATYCCCADIAAgBGo2AgQLIAFBoN4AOwAAIAMgAygCCEECajYCCAwBCyAFQQhNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQlJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANBkAstAAA6AAggA0GICykAADcAACAEIAQoAghBCWo2AgggAS0ABEEgckH4AEcNACACKAIIQZILQQgQDwsgAigCCCIAKAIEIgEgACgCCCICRgRAIAAgACgCACICQYAEIAEgAmsiA0EBdCABIAJGGyIEEAIiATYCACAAIAEgA2oiAjYCCCAAIAEgBGo2AgQLIAJBPjoAACAAIAAoAghBAWo2AggMEQtBkBNB5REgAigCAEECcSIAGyEFIABBBXIiAyACKAIIIgIoAgQiACACKAIIIgFrSwRAIAAgAigCACIEayEAIAEgBGshAQNAIABBAXRBgAQgABsiACABayADSQ0ACyACIAQgABACIgQ2AgAgAiABIARqIgE2AgggAiAAIARqNgIECyABIAUgAxAEGiACIAIoAgggA2o2AggMEAsgAigCCCIEKAIEIgAgBCgCCCIDayABKAIAQQJ0QZw8aigCACIGEBciAUkEQCAAIAQoAgAiBWshACADIAVrIQMDQCAAQQF0QYAEIAAbIgAgA2sgAUkNAAsgBCAFIAAQAiIFNgIAIAQgAyAFaiIDNgIIIAQgACAFajYCBAsgAyAGIAEQBBogBCAEKAIIIAFqNgIIIAIgAigCAEF/c0EDdkEBcTYCFAwPCyACKAIIIgQoAgQiACAEKAIIIgNrQQlNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQpJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANB7QovAAA7AAggA0HlCikAADcAACAEIAQoAghBCmo2AgggASgCEARAIAFBEGohBSACQQhqKAIAIgMoAgQiACADKAIIIgFrQRBNBEAgACADKAIAIgRrIQAgASAEayEBA0AgAEEBdEGABCAAGyIAIAFrQRFJDQALIAMgBCAAEAIiBDYCACADIAEgBGoiATYCCCADIAAgBGo2AgQLIAFBvA8tAAA6ABAgAUG0DykAADcACCABQawPKQAANwAAIAMgAygCCEERajYCCCACIAUQCyACKAIIIgAoAgQiAyAAKAIIIgFGBEAgACAAKAIAIgFBgAQgAyABayIEQQF0IAEgA0YbIgMQAiIBNgIAIAAgASADajYCBCABIARqIQELIAAgAUEBajYCCCABQSI6AAALIAIoAggiACgCBCIDIAAoAggiAUYEQCAAIAAoAgAiAUGABCADIAFrIgRBAXQgASADRhsiAxACIgE2AgAgACABIANqNgIEIAEgBGohAQsgACABQQFqNgIIIAFBPjoAACACIAIoAhhBAWo2AhgMDgsgAigCCCIBKAIEIgAgASgCCCICa0ECTQRAIAAgASgCACIDayEAIAIgA2shAgNAIABBAXRBgAQgABsiACACa0EDSQ0ACyABIAMgABACIgM2AgAgASACIANqIgI2AgggASAAIANqNgIECyACQbsLLQAAOgACIAJBuQsvAAA7AAAgASABKAIIQQNqNgIIDA0LIAIoAggiASgCBCIAIAEoAggiAmtBB00EQCAAIAEoAgAiA2shACACIANrIQIDQCAAQQF0QYAEIAAbIgAgAmtBCEkNAAsgASADIAAQAiIDNgIAIAEgAiADaiICNgIIIAEgACADajYCBAsgAkK86IWTxq2Znwo3AAAMCAsgAigCCCIBKAIEIgAgASgCCCICa0EHTQRAIAAgASgCACIDayEAIAIgA2shAgNAIABBAXRBgAQgABsiACACa0EISQ0ACyABIAMgABACIgM2AgAgASACIANqIgI2AgggASAAIANqNgIECyACQrzooauWjJmfCjcAAAwHCyACKAIIIgEoAgQiACABKAIIIgJrQQdNBEAgACABKAIAIgNrIQAgAiADayECA0AgAEEBdEGABCAAGyIAIAJrQQhJDQALIAEgAyAAEAIiAzYCACABIAIgA2oiAjYCCCABIAAgA2o2AgQLIAJCvOiJ+8asnp8KNwAADAYLIAIoAggiASgCBCIAIAEoAggiAmtBBE0EQCAAIAEoAgAiA2shACACIANrIQIDQCAAQQF0QYAEIAAbIgAgAmtBBUkNAAsgASADIAAQAiIDNgIAIAEgAiADaiICNgIIIAEgACADajYCBAsgAkHcES0AADoABCACQdgRKAAANgAADAQLIAIoAggiBCgCBCIAIAQoAggiA2tBAk0EQCAAIAQoAgAiBWshACADIAVrIQMDQCAAQQF0QYAEIAAbIgAgA2tBA0kNAAsgBCAFIAAQAiIFNgIAIAQgAyAFaiIDNgIIIAQgACAFajYCBAsgA0GqCi0AADoAAiADQagKLwAAOwAAIAQgBCgCCEEDajYCCAJAIAEoAgBBAWsOAwYHCAALIAIoAggQMgwICyACKAIIIgQoAgQiACAEKAIIIgNrQQJNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQNJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANB/wotAAA6AAIgA0H9Ci8AADsAACAEIAQoAghBA2o2AggCQCABKAIAQQFrDgMFBgcACyACKAIIEDIMBwsgA0EwOgAAQQEhBQsgBiAGKAIIIAVqNgIIIAIoAggiASgCBCIAIAEoAggiAmtBAk0EQCAAIAEoAgAiA2shACACIANrIQIDQCAAQQF0QYAEIAAbIgAgAmtBA0kNAAsgASADIAAQAiIDNgIAIAEgAiADaiICNgIIIAEgACADajYCBAsgAkGiEy0AADoAAiACQaATLwAAOwAAIAEgASgCCEEDajYCCEEADwsgASABKAIIQQVqNgIIDAQLIAEgASgCCEEIajYCCAwDCyACKAIIQfAMQQ4QDwwCCyACKAIIQf8MQRAQDwwBCyACKAIIQeAMQQ8QDwtBAAvKBgEHfwJAIANBAWoiBiABIAAgAkEAShsoAgQiB08NACADQQJqIAYgACgCACIKIAZqLQAAQS9GIgYbIgAgB08NACAAIApqLQAAQd8BcUHBAGtB/wFxQRlLDQACQCAAQQFqIgMgB08NAANAAkAgAyAKai0AACIAQd8BcUHBAGtB/wFxQRpJDQAgAEEtRg0AIABBMGtB/wFxQQlLDQILIANBAWoiAyAHRw0ACyAHIQMLQX9BACAGGyEAQQEgAiACQQFMG0EBayEMA0ACQAJAIAMgB08NAANAAkAgAyAKaiwAACIIQf8BcSIJQQprDgQCAAACAAsCQAJAIABBKU4EQAJAAkACQCAAQSlrDgMAAQIEC0EpIQACQAJAAkAgCQ4KBgEBAQEBAQEBAgALIAlBIEYNAQtBpAsgCEEHEAZFDQQLIANBAWshA0EAIQAMAwtBKkEAIAhBJ0cbIQAMAgtBK0EAIAhBIkcbIQAMAQsCQCAJQQlrIgZBF0sNAEEBIAZ0QY2AgARxRQ0AQQEgACAAQQFNGyEADAELAkAgAEECSiIGDQAgCEE+Rw0AIAMhBgwFCwJAIAYNAAJAIAhBL0cNACADQQFqIgYgB08NACAGIApqLQAAQT5GDQYLIABBAWtBAUsNAAJAIAhB3wFxQcEAa0H/AXFBGkkNACAJQd8ARg0AIAlBOkcNAQsgByADQQFqIgNNBEBBAiEADAMLA0ACQAJAIAMgCmosAAAiAEEwa0H/AXFBCkkNACAAQV9xQcEAa0H/AXFBGkkNACAARQRAQQIhAAwGC0G+DyAAQQUQBkUNAQtBAiEAIAcgA0EBaiIDRw0BDAYLC0ECIQAMAgsCQAJAIABBAmsOAgABCAsgCEE9Rw0HIANBAWohA0EDIQAMAgtBKyEAAkACQAJAIAlBImsOBgMCAgICAQALIAkNAUEpIQAMAgtBKiEADAELQaQLIAhBBxAGDQZBKSEAIAhBDUYNBgsgA0EBaiEDCyADIAdJDQALCyACRQ0CIAsgDEYNAkEBIAAgAEEpRhtBASAAGyEAIAEgC0EBaiILQQN0aiIDKAIEIQcgAygCACIDIARJDQEMAgsLIAQgBk0NACAFIAZBAWo2AgBBAQ8LQQALhwIBBH8gACABaiIDQQFrLAAAIQACQCABQQJJDQAgAEEATg0AIANBAmstAAAhAgJAIABBQHFBgH9HDQAgAkFgcUHAAUcNACAAQT9xIAJBH3FBBnRyDwsgAUEDSQ0AIABBwAFxIQUCQCADQQNrLQAAIgRB8AFxQeABRw0AIAVBgAFHDQAgAkHAAXFBgAFHDQAgAEE/cSACQT9xQQZ0IARBD3FBDHRycg8LIAFBBEkNACADQQRrLQAAIgFB+AFxQfABRw0AIARBwAFxQYABRw0AIAVBgAFHDQAgAkHAAXFBgAFHDQAgAEE/cSAEQT9xQQx0IAFBB3FBEnRyIAJBP3FBBnRyciEACyAAC9cCAQN/IwBB4ABrIggkACAIQgA3A1ggCEIANwNQIAhCADcDSCAIQgA3A0AgCEIANwM4IAhCADcDMCAIQgA3AyggCEIANwMgIAhCADcDGCAIQRBqIgpCADcDACAIQgA3AwggCEIANwMAQX8hCQJAIAAgAyAEIAVBAEcgCCAIQUBrEBBBAEgNACAAIAYgB0EAIAogCEEgahAQQQBIDQAgACgCLCEDIAEEQCACIAggAyAAKAIYEQEAIglFBEBBACEJDAILIAAoAiQiAUUNAUHaDSAAKAIsIAERAAAMAQsgAiAIIAMgACgCHBEBACIJRQRAQQAhCQwBCyAAKAIkIgFFDQBB/g0gACgCLCABEQAACyAIKAJQQQBKBEAgCCgCQBADIAgoAkQQAyAIKAJIEAMLIAgoAjBBAEoEQCAIKAIgEAMgCCgCJBADIAgoAigQAwsgCEHgAGokACAJC9FkARx/IwBBoAFrIgQkACAAQQA2AlQgBEEAQYABEAghEAJ/AkACQAJAAkAgAkEATA0AIAJBA3QgAWpBBGshFQNAIAEgD0EDdGoiFCgCBCEMIBQoAgAhBQNAIBIhBANAIAQhEgJAIAwgBUEDaiIHTQRAIAUhCgwBCyAAKAIAIQQDQCAAIAQgBWoiBi0AAGotAFwEQCAFIQoMAgsgACAGLQABai0AXARAIAUhCgwCCyAAIAYtAAJqLQBcBEAgBSEKDAILIAAgBCAHai0AAGotAFwEQCAFIQoMAgsgBUEHaiEHIAVBBGoiCiEFIAcgDEkNAAsLAkAgCiAMSQRAIAAoAgAhDgNAIAAgCiAOaiILLQAAIgZqLQBcDQIgCkEBaiIKIAxHDQALCyAPQQFqIg8gAkgNAyAAKAJUIQoMBAsCfwJAAkACQAJAAkACQAJAAkACQAJAAkACQCAGQdwARgRAIApBAWoiBCAAKAIETw0BAkAgBCAOai0AACIEQSFrQf8BcUEPSQ0AAkAgBEEKaw51AAMDAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAQEBAQEBAQMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAQEBAQEBAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMBAQEBAwsgD0EBaiACSA0AIApBAmohBQwQCwJAIAAoAlQiBSAAKAJYIgROBEAgAEHAACAEQQF2IARqIARBAEwbIgQ2AlggACgCUCAEQRRsEAIiB0UEQCAAKAIkIgFFDRVB/Q4gACgCLCABEQAAQX8MGAsgACAHNgJQIAAgACgCVCIFQQFqNgJUDAELIAAgBUEBajYCVCAAKAJQIgdFDRMLIAcgBUEUbGoiBEHcIDsBECAEQn83AgggBCAKQQJqIgU2AgQgBCAKNgIADA8LQQEhBQJAAkACQAJAAkACQAJAAkACQAJAAkAgBkEhaw5ABQsLCwsCCwsLAAsLCwoLCwsLCwsLCwsLCwkDBAsLCwgLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwYLBwsAAQsLIApBAWoiCyEIAkAgCyAMTw0AA0AgCCAOai0AACAGRw0BIAhBAWoiCCAMSQ0ACyAMIQgLQQAhE0EAIQlBACAKIBQoAgBGDRYaIA4gChAmIgVB/wBNDRRBByEEAkADQAJAIAUgBCAJakECbSIHQQJ0QaAZaigCACIRQR91IAdqIg1BAnRBoBlqKAIAQf///wdxSQRAIA1BAWshBAwBCyARQR52QQFxIAdqIglBAnRBoBlqKAIAQf///wdxIAVPDQIgCUEBaiEJCyAEIAlODQALQQAhCQwUC0EAIQkgDUEASA0TQQAMFgtBACERAkAgASAPQQN0aiITKAIEIgcgCiIFTQ0AAkADQCAFIA5qLQAAIgRB4ABHDQEgBUEBaiIFIAdHDQALIAchBQwBCyAEQSBGIRELIBIhBCAFIAprIhdBIEsNFiAXQQJ0IBBqQQRrKAIAIgkgAiAPayIGQQN0IBNqQQRrKAIATw0WIBIEQEEBIQQgBSAJSw0XC0EBIQtBASAGIAZBAUwbQQFrIRhBACEWIAUhBiAHIQQCQAJ/A0ACQAJAIAQgBk0NAANAIAYgDmotAAAiCUEgRwRAIAlB4ABGDQJBACELCyAGQQFqIgYgBEcNAAtBACENIAQiCSEGDAELQQAhDSAEIAZNBEAgBiEJDAELQQEhDSAGIQggBiAOai0AAEHgAEcEQCAGIQkMAQsCQANAIAQgCEEBaiIIRwRAIAggDmotAABB4ABGDQEMAgsLIAQhCAsgBCAISyENIAYhCSAIIQYLAkAgFyAGIAlrIghGBEBBACEIIBMgFkEDdGoiBCgCACINIAlJBEAgCSAOakEBay0AAEEgRiEICyARQQFzIAUgB0dxDQQgCw0EIAkgDUYgCHJFDQQgEUUNASAFQQFqDAMLAkAgBiAJRg0AQQAhCyAIQR9LDQAgCEECdCAQakEEayIIIAkgCCgCACIIIAggCUkbNgIACyANDQEgFiAYRgRAQQEhBAwbCyATIBZBAWoiFkEDdGoiBCgCACEGIAQoAgQhBAwBCwsgEygCCAshBSAIBEAgCUEBayEJDAELIARBBGsoAgAiCSAAKAIEIgRPDQADQCAJIA5qLQAAIghBIEcgCEEJR3ENASAJQQFqIgkgBEcNAAsgBCEJCwJAIAAoAlQiCyAAKAJYIghOBEAgAEHAACAIQQF2IAhqIAhBAEwbIgQ2AlggACgCUCAEQRRsEAIiBEUEQCAAKAIkIgFFDR1B/Q4gACgCLCABEQAAQX8MIAsgACAENgJQIAAgACgCVCILQQFqIgc2AlQgACgCWCEIDAELIAAgC0EBaiIHNgJUIAAoAlAiBEUNGwsgBCALQRRsaiILQeAoOwEQIAtCfzcCCCALIAU2AgQgCyAKNgIAIAcgCE4EQCAAQcAAIAhBAXYgCGogCEEATBsiBTYCWCAEIAVBFGwQAiIERQRAIAAoAiQiAUUNHEH9DiAAKAIsIAERAABBfwwfCyAAIAQ2AlAgACgCVCEHCyAAIAdBAWo2AlQgBCAHQRRsaiIEQeAwOwEQIARBfzYCDCAEIAY2AgQgBCAJNgIAIAQgB0EBazYCCCAEQQhrIAc2AgAgEiEEIAYiBSAMTQ0WA0AgD0EBaiEPIBQiEkEIaiEUIAUgEigCDCIMSw0ACwwWCwJAIAAoAlQiBSAAKAJYIgROBEAgAEHAACAEQQF2IARqIARBAEwbIgQ2AlggACgCUCAEQRRsEAIiB0UEQCAAKAIkIgFFDRxB/Q4gACgCLCABEQAAQX8MHwsgACAHNgJQIAAgACgCVCIFQQFqNgJUDAELIAAgBUEBajYCVCAAKAJQIgdFDRoLIAcgBUEUbGoiBEGmAjsBECAEQn83AgggBCAKQQFqIgU2AgQgBCAKNgIADBYLIAAoAlQiBUEATA0PIAAoAlAiByAFQRRsakEEay0AAEEmRw0PIAAoAlgiBCAFTARAIABBwAAgBEEBdiAEaiAEQQBMGyIENgJYIAcgBEEUbBACIgdFBEAgACgCJCIBRQ0aQf0OIAAoAiwgAREAAEF/DB0LIAAgBzYCUCAAKAJUIQULIAAgBUEBajYCVCAHIAVBFGxqIgRBuwQ7ARAgBEJ/NwIIIAQgCkEBajYCBCAEIAo2AgAMDwsgAC0ADEHAAHENCyAAIAEgD0EDdGoiDSACIA9rIhEgCiAVKAIAIgggEEGcAWoQJQ0NIApBBGoiBSANKAIEIgRPDQogCy0AAUEhRw0KIAstAAJBLUcNCiALLQADQS1HDQogBSAOai0AACIGQT5GDQoCQCAKQQVqIgkgBE8NACAGQS1HDQAgCSAOai0AAEE+Rg0LC0EAIQcCQCAFIAAoAtADIgZPBEAgBCEJDAELIAQhCSAGIAhBAmtPDQsLA0ACQCAFQQJqIgYgCSAIIAggCUsbIglNBEADQCAFIA5qLwAAQa3aAEYNAiAFQQNqIQYgBUEBaiEFIAYgCU0NAAsLAkAgBSAISQRAIAdBAWoiByARSA0BCyAAIAU2AtADIA0oAgQhBAwNCyANIAdBA3RqIgUoAgQhCSAFKAIAIQUMAQsLIAYgCE8NCiAGIA5qLQAAQT5HDQogECAGQQFqNgKcAQwNCyAKQQFqIgQgDE8NBUECIQUgBCAOai0AAEHbAEcNBQsCQCAAKAJUIgQgACgCWCIHTgRAIABBwAAgB0EBdiAHaiAHQQBMGyIENgJYIAAoAlAgBEEUbBACIghFBEAgACgCJCIBRQ0YQf0OIAAoAiwgAREAAEF/DBsLIAAgCDYCUCAAIAAoAlQiBEEBaiILNgJUIAAoAlghBwwBCyAAIARBAWoiCzYCVCAAKAJQIghFDRYLIAggBEEUbGoiBEEBOgARIAQgBjoAECAEQn83AgggBCAFIApqIgU2AgQgBCAKNgIAIAcgC0wEQCAAQcAAIAdBAXYgB2ogB0EATBsiBDYCWCAIIARBFGwQAiIIRQRAIAAoAiQiAUUNF0H9DiAAKAIsIAERAABBfwwaCyAAIAg2AlAgACgCWCEHIAAoAlQhCwsgACALQQFqIgo2AlQgCCALQRRsaiIEQcQAOwEQIARCfzcCCCAEIAU2AgQgBCAFNgIAIAcgCkwEQCAAQcAAIAdBAXYgB2ogB0EATBsiBDYCWCAIIARBFGwQAiIIRQRAIAAoAiQiAUUNF0H9DiAAKAIsIAERAABBfwwaCyAAIAg2AlAgACgCVCEKCyAAIApBAWo2AlQgCCAKQRRsaiIEQcQAOwEQIARCfzcCCCAEIAU2AgQgBCAFNgIADBILAkAgACgCVCIFIAAoAlgiBE4EQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIHRQRAIAAoAiQiAUUNF0H9DiAAKAIsIAERAABBfwwaCyAAIAc2AlAgACAAKAJUIgVBAWo2AlQMAQsgACAFQQFqNgJUIAAoAlAiB0UNFQsgByAFQRRsaiIEQd0EOwEQIARCfzcCCCAEIApBAWoiBTYCBCAEIAo2AgAMEQsgFCgCAEEBaiAKSw0KIAtBAWstAAAiBEEwa0H/AXFBCk8EQCAEQV9xQcEAa0H/AXFBGUsNCwsgFCgCBCAKQQNqTQ0KIA4gCkEBaiIJai0AACIEQTBrQf8BcUEKTwRAIARBX3FBwQBrQf8BcUEZSw0LCwJAIAAoAlQiCCAAKAJYIgVOBEAgAEHAACAFQQF2IAVqIAVBAEwbIgQ2AlggACgCUCAEQRRsEAIiB0UEQCAAKAIkIgFFDRZB/Q4gACgCLCABEQAAQX8MGQsgACAHNgJQIAAgACgCVCIIQQFqIgY2AlQgACgCWCEFDAELIAAgCEEBaiIGNgJUIAAoAlAiB0UNFAsgByAIQRRsaiIEQcACOwEQIARCfzcCCCAEIAk2AgQgBCAKNgIAIAUgBkwEQCAAQcAAIAVBAXYgBWogBUEATBsiBDYCWCAHIARBFGwQAiIHRQRAIAAoAiQiAUUNFUH9DiAAKAIsIAERAABBfwwYCyAAIAc2AlAgACgCVCEGCyAAIAZBAWo2AlQgByAGQRRsaiIEQcQAOwEQIARCfzcCCCAEIAo2AgQgBCAKNgIAIApBAWohBQwQCyAKQQNqIQ0gCkEBaiEFIBQoAgAiBkEEaiIEIApNDQIMAwsgFCgCAEEDaiIEIApLDQggDiAKQQNrIglqQZkIQQMQCg0IAkAgBCAKRg0AAkAgC0EEay0AACIEDiEKAAAAAAAAAAABAAEBAAAAAAAAAAAAAAAAAAAAAAAAAAEAC0GvCyAEwEEGEAZFDQkLIApBAWoiBSAMTw0IAkAgACgCVCILIAAoAlgiB04EQCAAQcAAIAdBAXYgB2ogB0EATBsiBDYCWCAAKAJQIARBFGwQAiIIRQRAIAAoAiQiAUUNFEH9DiAAKAIsIAERAABBfwwXCyAAIAg2AlAgACAAKAJUIgtBAWoiBDYCVCAAKAJYIQcMAQsgACALQQFqIgQ2AlQgACgCUCIIRQ0SCyAIIAtBFGxqIgZBrgI7ARAgBkJ/NwIIIAYgBTYCBCAGIAk2AgAgBCAHTgRAIABBwAAgB0EBdiAHaiAHQQBMGyIENgJYIAggBEEUbBACIghFBEAgACgCJCIBRQ0TQf0OIAAoAiwgAREAAEF/DBYLIAAgCDYCUCAAKAJUIQQLIAAgBEEBajYCVCAIIARBFGxqIgRBxAA7ARAgBEJ/NwIIIAQgCjYCBCAEIAo2AgAMDgsCQAJAAkACQAJAAkACQAJAIANFBEAgBkH8AEYEQCAAKAIMQYDAAHENAgsgCiEFIAYOJQYQEBAQEBAQEAUQBQUQEBAQEBAQEBAQEBAQEBAQEBAQBRAQEAQCCyAKIQUCQCAGDiUGEBAQEBAQEBAFEAUFEBAQEBAQEBAQEBAQEBAQEBAQEAUQEBAEAAsgBkH8AGsOAwAPAg8LAkAgACgCVCIFIAAoAlgiBE4EQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIHRQRAIAAoAiQiAUUNGkH9DiAAKAIsIAERAABBfwwdCyAAIAc2AlAgACAAKAJUIgVBAWo2AlQMAQsgACAFQQFqNgJUIAAoAlAiB0UNGAsgByAFQRRsaiIEQQA6ABEgBCAGOgAQIARCfzcCCCAEIApBAWoiBTYCBCAEIAo2AgAMFAsgBkH+AEcNDQsDQCAFQQFqIgUgDE8NBCAFIA5qIgktAABB/gBGDQALIBIhBCAFIAprQQNPDRFBACELQQchBAJAIAkgACgCBCAFa0EAEA4iCUH/AE0EQEEBIQggCUEJRg0BIAlBIEYNASAJQQtrQQJJIQgMAQsCQANAAkAgCSAEIAtqQQJtIghBAnRBoBlqKAIAIgdBH3UgCGoiDUECdEGgGWooAgBB////B3FJBEAgDUEBayEEDAELIAdBHnZBAXEgCGoiCEECdEGgGWooAgBB////B3EgCU8NAiAIQQFqIQsLIAQgC04NAAtBfyENCyANQQBOIQgLIAhBAXMhCQwECwNAIAwgBUEBaiIFSwRAIAUgDmotAABBJEYNAQsLIBIhBCAFIAprQQJLDRACQCAAKAJUIgcgACgCWCIETgRAIABBwAAgBEEBdiAEaiAEQQBMGyIENgJYIAAoAlAgBEEUbBACIghFBEAgACgCJCIBRQ0XQf0OIAAoAiwgAREAAEF/DBoLIAAgCDYCUCAAIAAoAlQiB0EBajYCVAwBCyAAIAdBAWo2AlQgACgCUCIIRQ0VCyAIIAdBFGxqIgRBAzoAESAEIAY6ABAgBEJ/NwIIIAQgBTYCBCAEIAo2AgAMEQsCQCAKQQFqIgUgDE8NAANAIAUgDmotAABBCWsiBEEXSw0BQQEgBHRBjYCABHFFDQEgBUEBaiIFIAxJDQALIAwhBQsgBkEgRgRAIBIhBCAFIAprQQJJDRALAkAgACgCVCIHIAAoAlgiBE4EQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIIRQRAIAAoAiQiAUUNFkH9DiAAKAIsIAERAABBfwwZCyAAIAg2AlAgACAAKAJUIgdBAWo2AlQMAQsgACAHQQFqNgJUIAAoAlAiCEUNFAsgCCAHQRRsaiIEQRA6ABEgBCAGOgAQIARCfzcCCCAEIAU2AgQgBCAKNgIADBALAkAgACgCVCIFIAAoAlgiBE4EQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIHRQRAIAAoAiQiAUUNFUH9DiAAKAIsIAERAABBfwwYCyAAIAc2AlAgACAAKAJUIgVBAWo2AlQMAQsgACAFQQFqNgJUIAAoAlAiB0UNEwsgByAFQRRsaiIEQRA6ABEgBCAGOgAQIARCfzcCCCAEIApBAWoiBTYCBCAEIAo2AgAMDwtBACEJIBIhBCAFIAprQQNPDQ0LAkACQCAKIBQoAgBNDQAgDiAKECYiBEH/AEsEQEEAIQhBByEHAkADQAJAIAQgByAIakECbSILQQJ0QaAZaigCACIRQR91IAtqIg1BAnRBoBlqKAIAQf///wdxSQRAIA1BAWshBwwBCyARQR52QQFxIAtqIghBAnRBoBlqKAIAQf///wdxIARPDQIgCEEBaiEICyAHIAhODQALIAlBAnIhCwwDCyANQQBODQEgCUECciELDAILIARBCUYNACAEQSBGDQAgBEELa0EBTQ0AIAlBAnIhCwwBC0EBIQsgEiEEIAlFDQ0LAkAgACgCVCIHIAAoAlgiBE4EQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIIRQRAIAAoAiQiAUUNE0H9DiAAKAIsIAERAABBfwwWCyAAIAg2AlAgACAAKAJUIgdBAWo2AlQMAQsgACAHQQFqNgJUIAAoAlAiCEUNEQsgCCAHQRRsaiIEIAs6ABEgBCAGOgAQIARCfzcCCCAEIAU2AgQgBCAKNgIADA0LIA4gCkEEayIJaigAAEHo6NGDB0cNAAJAIAQgCkYNAAJAIAtBBWstAAAiBA4hAgAAAAAAAAAAAQABAQAAAAAAAAAAAAAAAAAAAAAAAAABAAtBrwsgBMBBBhAGRQ0BCyANIBQoAgRPDQAgBSAOai8AAEGv3gBGDQELAkAgBkEFaiIEIApLDQAgDiAKQQVrIglqQdYIQQUQCg0AAkAgBCAKRg0AAkAgC0EGay0AACIEDiECAAAAAAAAAAABAAEBAAAAAAAAAAAAAAAAAAAAAAAAAAEAC0GvCyAEwEEGEAZFDQELIA0gFCgCBE8NACAFIA5qLwAAQa/eAEYNAQsgEiEEIAZBA2oiBiAKSw0KIA4gCkEDayIJakHTCUEDEAoNCgJAIAYgCkYNAAJAIAtBBGstAAAiBg4hDAAAAAAAAAAAAQABAQAAAAAAAAAAAAAAAAAAAAAAAAABAAtBrwsgBsBBBhAGRQ0LCyANIBQoAgRPDQogBSAOai8AAEGv3gBHDQoLAkAgACgCVCIIIAAoAlgiBU4EQCAAQcAAIAVBAXYgBWogBUEATBsiBDYCWCAAKAJQIARBFGwQAiIHRQRAIAAoAiQiAUUNEEH9DiAAKAIsIAERAABBfwwTCyAAIAc2AlAgACAAKAJUIghBAWoiBjYCVCAAKAJYIQUMAQsgACAIQQFqIgY2AlQgACgCUCIHRQ0OCyAHIAhBFGxqIgRBugI7ARAgBEJ/NwIIIAQgDTYCBCAEIAk2AgAgBSAGTARAIABBwAAgBUEBdiAFaiAFQQBMGyIENgJYIAcgBEEUbBACIgdFBEAgACgCJCIBRQ0PQf0OIAAoAiwgAREAAEF/DBILIAAgBzYCUCAAKAJUIQYLIAAgBkEBajYCVCAHIAZBFGxqIgRBxAA7ARAgBEJ/NwIIIAQgCjYCBCAEIAo2AgAgCkEEaiEFDAoLAkAgCkECaiIJIARPDQAgCy0AAUE/Rw0AQQAhBwJAIAkgACgC1AMiBk8EQCAJIQUMAQsgCSEFIAYgCEECa08NAQsDQAJAAkAgBUECaiIGIAQgCCAEIAhJGyIETQRAA0AgBSAOai8AAEG//ABGDQIgBUEDaiEGIAVBAWohBSAEIAZPDQALCyAFIAhJBEAgB0EBaiIHIBFIDQILIAAgBTYC1AMgDSgCBCEEDAMLIBAgBjYCnAEMBQsgDSAHQQN0aiIFKAIEIQQgBSgCACEFDAALAAsCQCAEIAlNDQAgCy0AAUEhRw0AIAkgDmotAABB3wFxQcEAa0H/AXFBGUsNAAJAIApBA2oiBSAETw0AAkADQCAFIA5qLQAAIgZB3wFxQcEAa0H/AXFBGUsNASAFQQFqIgUgBEcNAAsgBCEFDAELIAZBCWsiBkEXSw0BQQEgBnRBjYCABHFFDQELQQAhByAFIAAoAtgDIgZJIAYgCEEBa09xDQADQCAFQQFqIgkgBCAIIAQgCEkbIgZNBEAgBSAOai0AAEE+Rg0EA0ACQCAFQQFqIQQgBUECaiIJIAZLDQAgBCIFIA5qLQAAQT5HDQEMBgsLIAQhBQsCQCAFIAhJBEAgB0EBaiIHIBFIDQELIAAgBTYC2AMgDSgCBCEEDAILIA0gB0EDdGoiBSgCBCEEIAUoAgAhBQwACwALIApBCWoiBSAETw0AIAtB7DtBCRAKDQBBACEJIAUgACgC3AMiBkkgBiARQQN0IA1qQQRrKAIAIgtBAmsgCCAIIAtLGyIIQQNrT3ENAANAIAVBA2oiBiAEIAggBCAISRsiBE0EQANAIAUgDmpBmQxBAxAKRQRAIBAgBjYCnAEMBgsgBUEEaiEGIAVBAWohBSAEIAZPDQALCwJAIAUgCEkEQCAJQQFqIgkgEUgNAQsgACAFNgLcAwwCCyANIAlBA3RqIgUoAgQhBCAFKAIAIQUMAAsACyASIQQgCkEBaiIFIBUoAgAiC08NB0EBIQkCfwJAIApBAmoiBiALTw0AIAUgDmosAABBAEgNAANAIAYgCmsiCEEgSw0BIAYgDmotAAAhBAJAAkAgCEEDSQ0AIARBOkcNACAGIAtPDQMDQCAGIA5qLQAAIgRBCWsiCEEXTUEAQQEgCHRBjYCABHEbDQQgBEE+RwRAIARBIEkNBSAEQTxGDQUgBEH/AEYNBSAGQQFqIgYgC0kNAQwDCwsgBkEBaiELQTwMBAsCQCAEQTBrQf8BcUEKSQ0AIARB3wFxQcEAa0H/AXFBGkkNACAEQStrIgRBA0sNAyAEQQFGDQMLIAZBAWoiBiALRw0BCwsLIAUhBgNAAkACQCAGIA5qLAAAIghBMGtB/wFxQQpJDQAgCEFfcUHBAGtB/wFxQRpJDQAgCEUNDEGXDyAIQRUQBkUNAQsgBkEBaiIGIAtJIQkgBiALRw0BDAsLCyASIQQgCUF/cyAFIAZPckEBcQ0IQQAhCSAIQcAARw0IA0AgBiIIQQFqIgYgC08NCgJAAkACQCAGIA5qLQAAIgdBMGtB/wFxQQpPBEAgB0FfcUHBAGtB/wFxQRlLDQELIAlBAWohCQwBCwJAIAlBAEwiDQ0AIAdBLUcNACAJQQFqIQkMAQsgDQ0BIAdBLkcNAUEAIQkgCCAOai0AAEEtRg0MCyAJQT9KDQsMAQsLIBIhBCANDQggB0E+Rw0IIAggDmotAABBLUYNCCAIQQJqIQtBwAALIQ0CQCAAKAJUIgggACgCWCIGTgRAIABBwAAgBkEBdiAGaiAGQQBMGyIENgJYIAAoAlAgBEEUbBACIgRFBEAgACgCJCIBRQ0OQf0OIAAoAiwgAREAAEF/DBELIAAgBDYCUCAAIAAoAlQiCEEBaiIHNgJUIAAoAlghBgwBCyAAIAhBAWoiBzYCVCAAKAJQIgRFDQwLIAQgCEEUbGoiCUE0OgARIAkgDToAECAJQn83AgggCSAFNgIEIAkgCjYCACAGIAdMBEAgAEHAACAGQQF2IAZqIAZBAEwbIgU2AlggBCAFQRRsEAIiBEUEQCAAKAIkIgFFDQ1B/Q4gACgCLCABEQAAQX8MEAsgACAENgJQIAAoAlQhBwsgACAHQQFqNgJUIAQgB0EUbGoiBEG+8AA7ARAgBEF/NgIMIAQgCzYCBCAEIAtBAWs2AgAgBCAHQQFrNgIIIARBCGsgBzYCACASIQQgCyEFDAcLIBAgCTYCnAELAkACQCAAKAJUIgggACgCWCIFTgRAIABBwAAgBUEBdiAFaiAFQQBMGyIENgJYIAAoAlAgBEEUbBACIgZFDQIgACAGNgJQIAAgACgCVCIIQQFqIgc2AlQgACgCWCEFDAELIAAgCEEBaiIHNgJUIAAoAlAiBkUNCwsgBiAIQRRsaiIEQbwoOwEQIARCfzcCCCAEIAo2AgQgBCAKNgIAIAUgB0wEQCAAQcAAIAVBAXYgBWogBUEATBsiBDYCWCAGIARBFGwQAiIGRQ0BIAAgBjYCUCAAKAJUIQcLIAAgB0EBajYCVCAQKAKcASEFIAYgB0EUbGoiBEG+MDsBECAEQX82AgwgBCAFNgIEIAQgBTYCACAEQQhrIAc2AgAgBCAHQQFrNgIIIAUgDE0NBwNAIA9BAWohDyAUIgRBCGohFCAFIAQoAgwiDEsNAAsMBwsgACgCJCIBRQ0JQf0OIAAoAiwgAREAAEF/DAwLIApBAWohBQwFC0GuAiEEAkADQAJAIAUgBCAJakECbSINQQJ0QbAyaigCACIRQR91IA1qIgdBAnRBsDJqKAIAQf///wdxSQRAIAdBAWshBAwBCyARQR52QQFxIA1qIglBAnRBsDJqKAIAQf///wdxIAVPDQIgCUEBaiEJCyAEIAlODQALQQEhCUECDAMLIAdBH3YhCSAHQQBODQFBAgwCC0EAIAVBCUYNARpBACAFQSBGDQEaQQAgBUELa0ECSQ0BGiAFQSFrQQ9JDQAgBUE6ayIEQSdJBEBC/4CAgOAPIAStiKdBAXENASAFQf8Aa0F8SSEJQQIMAgtBAiAFQf8Aa0F8SSIJDQEaC0EBCyEWQQAhBwJAIAggDEYNAEEAIQRBByEFAkACQCAIIA5qIg4gACgCBCAIayIXQQAQDiINQf8ATQRAIA1BCUcNAQwDCwNAAkACQCANIAQgBWpBAm0iB0ECdEGgGWooAgAiE0EfdSAHaiIRQQJ0QaAZaigCAEH///8HcUkEQCARQQFrIQUMAQsgE0EedkEBcSAHaiIEQQJ0QaAZaigCAEH///8HcSANTw0BIARBAWohBAsgBCAFTA0BDAMLC0EAIRNBACEHIBFBAEgNAQwCCyANQSBGDQEgDUELa0ECSQ0BC0EAIQdBrgIhBQJAAkAgDiAXQQAQDiIEQf8ATQRAQQAhEyAEQSFrQQ9JDQIgBEE6ayIFQSdPDQFC/4CAgOAPIAWtiKdBAXENAiAEQf8Aa0F8SSETQQIhBwwDCwJAA0ACQCAEIAUgB2pBAm0iEUECdEGwMmooAgAiE0EfdSARaiINQQJ0QbAyaigCAEH///8HcUkEQCANQQFrIQUMAQsgE0EedkEBcSARaiIHQQJ0QbAyaigCAEH///8HcSAETw0CIAdBAWohBwsgBSAHTg0AC0ECIQdBASETDAMLIA1BH3YhEyANQQBODQFBAiEHDAILQQIhByAEQf8Aa0F8SSITDQELQQEhBwsgEiEEIAghBUEAIBYgCSATcSAGQd8ARnEiDRsiCUEAIAcgDRsiB3JFDQAgB0EARyAHIAlPcSAHIAlNQQF0QQAgCRtyIgRBIHIgBCAHQQJGGyAEIAlBAkYbIQQCQAJAAkACQCAIIAprQQNwDgMAAQIDCyAEQcAAciEEDAILIARBgAFyIQQMAQsgBEHAAXIhBAsCQCAAKAJUIgUgACgCWCIJTgRAIABBwAAgCUEBdiAJaiAJQQBMGyIFNgJYIAAoAlAgBUEUbBACIgdFBEAgACgCJCIBRQ0HQf0OIAAoAiwgAREAAEF/DAoLIAAgBzYCUCAAIAAoAlQiBUEBaiIJNgJUDAELIAAgBUEBaiIJNgJUIAAoAlAiB0UNBQsgByAFQRRsaiIFIAQ6ABEgBSAGOgAQIAVCfzcCCCAFIAg2AgQgBSAKNgIAIBIhBCALIgUgCE8NAANAIAAgACgCWCIFIAlKBH8gCQUgAEHAACAFQQF2IAVqIAVBAEwbIgU2AlggByAFQRRsEAIiB0UEQCAAKAIkIgFFDQdB/Q4gACgCLCABEQAAQX8MCgsgACAHNgJQIAAoAlQLIgVBAWoiCTYCVCAHIAVBFGxqIgVBxAA7ARAgBUJ/NwIIIAUgCzYCBCAFIAs2AgAgC0EBaiILIAhJDQALIAghBQwACwALAAsACyAAKAJYIgQgCkwEQCAAQcAAIARBAXYgBGogBEEATBsiBDYCWCAAKAJQIARBFGwQAiIMDQIgACgCJCIBRQ0BQf0OIAAoAiwgAREAAEF/DAQLIAAgCkEBaiIHNgJUIAAoAlAiDA0CC0F/DAILIAAgDDYCUCAAIAAoAlQiCkEBaiIHNgJUCyAAKAIEIQUgDCAKQRRsaiIEQf8gOwEQIARCfzcCCCAEIAU2AgQgBCAFNgIAIABBACAHQcwPEA0gAEEAIAAoAlRBxhEQDQJAIAAoAsgDIghBAE4EQCAAQewCaiEbIBBBBGohHUEAIRNBACEHQQAhFgNAIAAoAlAiDiAIQRRsIhdqIgkoAgwhCkEAIQxBACEEIAkoAggiFEEATgRAIA4gDiAUQRRsaiIMKAIMQRRsaiEECyAKQRRsIRUCfwJAIBMgCSgCACILSwRAIA4gFWooAgQgB0kNAQsgCyAcSQRAIA4gFWooAgQgFkkNAQsgByALSwRAIA4gF2otABBB2wBGDQELIA4gFWohEgJAAkACQAJAIAAtAA1BIHFFDQAgDEUNACAOIBdqIhgoAgQiDyALa0EBRw0AIAwtABBB2wBHDQEgDCgCACIRIAtBAWtHDQEgDCgCBCARa0EBRw0BIARFDQEgBC0AEEHdAEcNASAEKAIAIgYgEigCACIeQQFqRw0BIAQoAgQiBSAGa0EBRw0BQQAhDSAIQQFqIhohBgJAIAogGkwNAAJAA0AgDiAGQRRsaiINLQAQIhlBxABHBEAgGUH8AEYNAyANKAIAIA9rQeQASw0CCyAGQQFqIgYgCkcNAAsgCiEGC0EAIQ0LIA0gEiANGygCACIZIA9GDQAgGSAPa0HkAEsNACAPIBlJBEAgACgCACEfA0ACQCAPIB9qLQAAQQprDgQDAAADAAsgD0EBaiIPIBlHDQALCwJAIA0EQCANKAIAIQsgHiANKAIESwRAIBggCzYCBCAEKAIEIQUMAgsgEiALNgIAIAwoAgAhEQtBACENCyAJIBE2AgAgGCAYLQARQRRyOgARIA4gFWoiBCAINgIIIAQgBTYCBCAEIAQtABFBGHI6ABECQCANBEAgDSANLQARQRByOgARIAAgCCAGQQAQDCAAIBogCkGPDxANIBtB/wFB2AAQCBoMAQsgACAIIApBABAMCyAFIQcgESETIAwoAggMBQsgDA0AIA4gFWooAgQhDwwBCyAMKAIAIgUgDiAVaiIGKAIEIg9HDQACfyAEKAIAIAVBAWpLBEAgACABIAUgBCgCBCAQEBwMAQsgACABIAsgBSAQEBwLIgVBAEgNBiAFRQ0CIAYgBCgCBDYCBCAAKAJQIBRBFGxqKAIIIRQMAQsgDiAVaiEYAkAgDyAAKAIEIgtPDQAgACgCACIFIA9qLQAAQShHDQBBACEMA0AgDCIGQQFqIQwgASAGQQN0aigCBCIEIA9NDQALAkACQCAEIA9BAWoiD0sEQANAIAUgD2otAABBCWsiDUEXSw0CQQEgDXRBjYCABHFFDQIgD0EBaiIPIARHDQALIAQhDwsgECAPNgKMAQJAIAUgD2otAABBCmsOBAACAgACCyACIAxMDQIgECABIAxBA3RqKAIAIg82AowBIAwhBgwBCyAQIA82AowBCwJ/AkAgCyAPTQ0AIAUgD2otAABBKUcNAEEAIQUgEEEANgIQIBBCADcCCCAQIA82AgQgECAPNgIAIA9BAWohBEEBDAELIAUgDyABIAZBA3RqIgQoAgQiDSAQQYwBaiAQIB0QL0UNAQJAIAAgBCACIAZrIBAoAowBIBBBjAFqIBBBkAFqIBBBnAFqIBBBmAFqIBBBlAFqEC4EQCAQKAKQASIEIAZqIQsgBCAQKAKcASIMRyERIAEgBiAMaiIGQQN0aigCBCENIBAoAowBIQwMAQsgECAQKAKMASIMNgKYASAQIAw2ApQBQQAhC0EAIRELAkAgDCANSQRAA0AgBSAMai0AACIPQQlrIgRBF0sNAkEBIAR0QY2AgARxRQ0CIAxBAWoiDCANRw0ACyANIQwLAkAgBSAMai0AACIPQQprDgQAAQEAAQsgBkEBaiIEIAJODQIgBSABIARBA3RqKAIAIgxqLQAAIQ8LIA9B/wFxQSlHDQEgECAMQQFqIgQ2AowBIBAoApQBIg8gECgCmAEiDE0EQEEAIQUgEEEANgIQIBBCADcCCEEBDAELIA8gDGshBiARRQRAIBBBADYCECAQIAY2AgwgECAFIAxqIgU2AghBAQwBCwJAIAYQByIFBEAgASALQQN0aiENQQAhESAFIQYDQCAMIA0gEUEDdGooAgQiBCAPIAQgD0kbIgtJBH8gCyAMQX9zaiEZQQAhBCALIAxrQQNxIhoEQANAIAYgACgCACAMai0AADoAACAMQQFqIQwgBkEBaiEGIARBAWoiBCAaRw0ACwsgGUEDTwRAA0AgBiAAKAIAIAxqLQAAOgAAIAYgDCAAKAIAai0AAToAASAGIAwgACgCAGotAAI6AAIgBiAMIAAoAgBqLQADOgADIAZBBGohBiAMQQRqIgwgC0cNAAsLIAsFIAwLIA9PDQIgBkEKOgAAIAZBAWohBiANIBFBAWoiEUEDdGooAgAhDAwACwALIAAoAiQiAUUNCEHsDiAAKAIsIAERAAAMCAsgEEEBNgIQIBAgBTYCCCAQIAYgBWs2AgwgECgCjAEhBEEACyEPAkAgCkEBaiIMIAAoAlQiDU4NACAAKAJQIQYDQCAGIAxBFGxqIgsoAgAgBE8NAQJAIAstABFBFHFBFEcNACAGIAsoAgwiDEEUbGooAgAgBEkNACAPDQMgBRADDAMLIAxBAWoiDCANSA0ACwsgGCAENgIEDAELIAAgASAJKAIAIBgoAgQgEBAcIgRBAEgNBSAERQ0BCyAOIBdqIgwgDC0AEUEUcjoAESAOIBVqIgUgBS0AEUEYcjoAESAXIAAoAlBqIgQgECgCADYCFCAEIBAoAgQ2AhggBCAQKAIINgIoIAhBAmohBAJAIBAoAhBFBEAgACgCUCEGDAELAkAgACgC4AIiC0EATgRAIAAoAlAiBiALQRRsaiAENgIMDAELIAAgBDYC3AIgACgCUCEGCyAGIARBFGxqIg9BfzYCDCAPIAs2AgggACAENgLgAgsgBiAEQRRsaiAQKAIMNgIIIAUoAgQhBSAMLQAQIQQgCSgCACEGIAAgCEEBaiAKQY8PEA0gG0H/AUHYABAIGiAFIAcgBEHbAEYiBBshByAWIAUgBBshFiAGIBMgBBshEyAcIAYgBBshHCAJIQogAC8BDEGMCHFFDQADQAJAIAoiBUEUaiEKIAUtACQiCEHEAEcNACAKIBJJDQELCyASIQYCQCAIQcQARwRAIBJBFGshBiASIQQMAQsDQCAGIgRBFGsiBiAJSw0ACwsgBS0AJSIJQRBxRQ0AIAhFDQAgCigCACAMKAIERw0AQZMPIAjAQQQQBkUNACAFKAIgIAYgACgCUGtBFG1HDQAgBEEQaygCACASKAIARw0AIAVBxAA6ACQgBSAJQe8BcToAJSAEQRRrIgRBxAA6ABAgBCAELQARQe8BcToAEQsgFAsiCEEATg0ACwsgAEJ/NwLIAyAAQn83ArQDIAMEQCAAQQA2AsQDIABCfzcC5AIgAEEAIAAoAlRBiQgQDUEADAILIABBACAAKAJUQY8PEA0gAEHsAmpB/wFB2AAQCBpBAAwBC0F/CyEAIBBBoAFqJAAgAAu2BwEKfyMAQSBrIggkACAIIAM2AhAgCCACNgIMAkAgACAIQQxqQQFBARAoIgZBAEgNACAAKALEA0ECdEEIahAHIglFBEBBfyEGIAAoAiQiAUUEQEEAIQkMAgtB7A4gACgCLCABEQAAQQAhCQwBCyAJIAI2AgBBASEKIAAoAuQCIgdBAE4EQCAAKAJQIQYDQCAJIApBAnRqIAYgB0EUbGoiBygCBDYCACAKQQFqIQogBygCDCIHQQBODQALCyAJIApBAnRqIANBAWo2AgBBDUEAIAAoAiwgACgCEBEBACIGRQRAQQAhAwJAIAVBAEwNAEEAIQcDQAJAIAkgC0EBaiILQQJ0aigCACINQQFrIgYgAk0EQCAHIQMMAQsgB0EBaiEDIAQgB0ECdGooAgAhDiAAKAIAIQwCQAJAA0AgAiAMai0AAEEJayIHQRdLDQFBASAHdEGNgIAEcUUNASACQQFqIgIgBkcNAAsgBiECDAELIAIgBk8NAANAIAwgBkEBayIHai0AAEEJayIPQRdLDQFBASAPdEGNgIAEcUUNASAHIgYgAksNAAsgAiEGCyAIIAY2AhwgCCACNgIYIAggDjYCFAJAIAEgCEEUaiAAKAIsIAAoAhARAQAiBgRAIAAoAiQiAkUNAUGiDiAAKAIsIAIRAAAMAQsgACAIQRhqQQEQHSIGQQBIDQUgASAIQRRqIAAoAiwgACgCFBEBACIGRQ0BIAAoAiQiAkUNAEHHDiAAKAIsIAIRAAALIAZBAEgNBAsgCiALTQ0BIA0hAiADIQcgAyAFSA0ACwsgAyAFIAMgBUobIQIDQCACIANHBEAgBCADQQJ0aigCACEFIAhCADcCGCAIIAU2AhQCQCABIAhBFGogACgCLCAAKAIQEQEAIgYEQCAAKAIkIgVFDQFBog4gACgCLCAFEQAADAELIAAgCEEYakEBEB0iBkEASA0EIAEgCEEUaiAAKAIsIAAoAhQRAQAiBkUEQEEAIQYMAQsgACgCJCIFRQ0AQccOIAAoAiwgBREAAAsgA0EBaiEDIAZBAE4NAQwDCwtBDUEAIAAoAiwgACgCFBEBACIGRQRAQQAhBgwCCyAAKAIkIgFFDQFBxw4gACgCLCABEQAADAELIAAoAiQiAUUNAEGiDiAAKAIsIAERAAALIAkQAyAAKALcAiICQQBOBEAgACgCUCEHA0AgByACQRRsIgFqKAIAEAMgACgCUCIHIAFqKAIMIgJBAE4NAAsLIABCfzcC3AIgCEEgaiQAIAYL/QIBBX8gA0EATARAQQAPCwJAAkACQANAIAIgCEEMbGoiBigCCCIEQRFPBEADQCABQYAyQRAgACgCLCAAKAIgEQIAIgcEQCAAKAIkIgQNBQwGCyAEQRBrIgRBEEsNAAsLAkAgBEUNACABQYAyIAQgACgCLCAAKAIgEQIAIgdFDQAgACgCJCIEDQMMBAsCQCAGKAIEIgUgBigCACIERg0AIAUgBGshBSAAKAIAIARqIQZBACEEA0ACQCAEIAVPDQADQCAEIAZqLQAARQ0BIARBAWoiBCAFRw0ACyAFIQQLAkAgBARAIAEgBiAEIAAoAiwgACgCIBECACIHDQEgBCAGaiEGIAUgBGshBQsgBUUNAkEBIQRBAUGjE0EBIAAoAiwgACgCIBECACIHRQ0BCwsgACgCJCIEDQMMBAsgAUGiE0EBIAAoAiwgACgCIBECACIHDQEgCEEBaiIIIANHDQALQQAPCyAAKAIkIgRFDQELQbwNIAAoAiwgBBEAAAsgBwvcAwEEfyABQQFqIQQCQAJAAkAgAUEDaiIFIAJPDQAgACAEai0AAEEjRw0AIAAgAWotAAJBIHJB+ABHDQAgBSEEAkADQAJAAkAgACAEai0AACIBQTBrQf8BcUEKSQ0AIAFBwQBrQf8BcUEGSQ0AIAQgBWtBCEsNAyABQeEAa0H/AXFBBkkNAQwDCyAEIAVrQQhLDQILIARBAWoiBCACRw0ACyACIQQLIAQgBUYNAiAEIAVrQQdJDQEMAgsCQCABQQJqIgUgAk8iBw0AIAAgBGotAABBI0cNACAFIQQCQANAIAQgBWtBCEsNASAAIARqLQAAQTBrQf8BcUEJSw0BIARBAWoiBCACRw0ACyACIQQLIAQgBUYNAiAEIAVrQQhJDQEMAgsgAiAETQ0BIAAgBGotAABB3wFxQcEAa0H/AXFBGUsNAQJ/IAUgBw0AGgNAAkAgACAFai0AACIHQd8BcUHBAGtB/wFxQRpPBEAgBSAFIARrQTBLDQMaIAdBMGtB/wFxQQpJDQEgBQwDCyAFIARrQTBNDQAgBQwCCyAFQQFqIgUgAkcNAAsgAgsiBCABa0EDa0EuSw0BCyACIARNDQAgACAEai0AAEE7Rw0AQQEhBiADIARBAWo2AgALIAYLiQIBB38jAEEQayIGJAACQAJAAkAgASACTw0AIAAgAWogAiABayAGQQxqEA4hBCAGKAIMIAFqIQEgBEH/AEsEQEEHIQcDQAJAAkAgBCAFIAdqQQJtIghBAnRBoBlqKAIAIgpBH3UgCGoiCUECdEGgGWooAgBB////B3FJBEAgCUEBayEHDAELIApBHnZBAXEgCGoiBUECdEGgGWooAgBB////B3EgBE8NASAFQQFqIQULIAUgB0wNAQwECwsgCUEATg0BDAILIARBCUYNACAEQSBGDQAgBEELa0ECTw0BCyADQQE2AgwgA0EgNgIAIAAgASACEBIhAQwBCyAEIAMQLQsgBkEQaiQAIAEL4wQBBn8CQAJAAkAgAEH/AEsEQEGQAiECAkADQAJAIAAgAiADakECbSIFQQJ0QcAZaigCACIGQR91IAVqIgRBAnRBwBlqKAIAIgdB////B3FJBEAgBEEBayECDAELIAZBHnZBAXEgBWoiA0ECdEHAGWooAgBB////B3EgAE8NAiADQQFqIQMLIAIgA04NAAtBACECDAILQQAhAiAEQQBIDQEMAgsgAUEBNgIMIAEgAEEgaiAAIABBwQBrQRpJGzYCAA8LQTMhAwJAA0ACQCAAIAIgA2pBAm0iBUECdEHgKmooAgAiBkEfdSAFaiIEQQJ0QeAqaigCACIHQf///wdxTwRAIAAgBkEedkEBcSAFaiICQQJ0QeAqaigCAEH///8HcU0EQEEAIQNBASECIARBAE4NBQwECyACQQFqIQIMAQsgBEEBayEDCyACIANMDQALQQAhAwtBDyECA0ACQAJAIAAgAiADakECbSIFQQJ0QdAvaigCACIGQR91IAVqIgRBAnRB0C9qKAIAIgdB////B3FPBEAgACAGQR52QQFxIAVqIgNBAnRB0C9qKAIAQf///wdxTQRAQQIhAiAEQQBODQUMAwsgA0EBaiEDDAELIARBAWshAgsgAiADTg0BCwsgAUEBNgIMIAEgADYCAAwBCyABIAJBBHQiAUHUMWooAgAgAUHcMWooAgAiAiAEbEECdGoiAyACQQJ0EAQiASACNgIMIAAgB0YNACADKAIAIAdB////B3EiAkEBakYEQCABIAAgB3NBf3NBAXEgAGo2AgAPCyABIAEoAgAgACACa2o2AgALC88FAQV/AkACQAJAIAMgASgCBCILSQRAIAAoAgAhDCADIQkDQCAJIAxqLQAAQQlrIg1BF0sNAkEBIA10QY2AgARxRQ0CIAlBAWoiCSALRw0ACwsgAkECSA0BIAEoAgghCUEBIQoLIAMgCUYNACAFIAo2AgACQAJAIAAoAgAiBSAJaiwAACILQSJrDgcAAgICAgABAgsgByAJQQFqIgk2AgAgAiAKTA0BA0AgASAKQQN0aigCBCIHIAlLBEADQAJAAkAgBSAJai0AACIMQdwARw0AIAlBAWoiAyAAKAIETw0AIAMgBWotAAAiDUEha0H/AXFBD0kNASANQQprDnUBAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEACyAJIQMgC0H/AXEgDEYNBgsgA0EBaiIJIAdJDQALCyAKQQFqIgogAkcNAAsMAQsgByAJQQFqIgk2AgAgAiAKTA0AA0AgASAKQQN0aigCBCIHIAlLBEADQAJAIAUgCWotAAAiC0HcAEcEQCAJIQMgC0Eoaw4CBQYBCwJAIAlBAWoiAyAAKAIETw0AIAMgBWotAAAiC0Eha0H/AXFBD0kNASALQQprDnUBAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEACyAJIQMLIANBAWoiCSAHSQ0ACwsgCkEBaiIKIAJHDQALC0EADwsgCCAJNgIAIAQgCUEBajYCACAGIAo2AgBBAQvOBAEFfwJAAkAgACABai0AAEE8RgRAIAEgAk8NAiABQQFqIgcgAk8NAiAHIQYDQAJAAkAgACAGIgFqLQAAIgZB3ABHBEACQAJAIAZBCmsOBAgBAQgACyAGQTxrDgMHAAMACyABQQFqIQYMAQsgAUEBaiIGIAJPDQACQCAAIAZqLQAAIghBIWtB/wFxQQ9JDQAgCEE6aw5FAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAAAAQsgAUECaiEGCyACIAZLDQEMBAsLIAQgBzYCACAFIAE2AgAgAUEBaiEGDAELIAEgAk8NASABIQYCQAJAA0ACQAJAIAAgBmotAAAiCEHcAEcEQCAIQQlrIglBF0sNAUEBIAl0QY2AgARxDQIMAQtB3AAhCCAGQQFqIgkgAk8NAAJAIAAgCWotAAAiCUEha0H/AXFBD0kNACAJQTprDkUAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAABCyAGQQJqIgYgAkkNAgwBCyAIQSBJDQAgCEH/AEYNAAJAAkACQCAIQShrDgIAAQILIAdBH0oNByAHQQFqIQcMAQsgB0UNAyAHQQFrIQcLIAZBAWoiBiACSQ0BCwsgBw0DIAEgBkcNAQwDCyABIAZGDQILIAQgATYCACAFIAY2AgALIAMgBjYCAEEBIQoLIAoLpQMBBn8CQCAAKAIEIgYgAk0NACAAKAL8AyABTQ0AIAQCfwJAIAAoAgAiCCACai0AACIARQ0AIABBPkYEQCAEIAE2AgggBEEAOwABIARBPjoAACACQQFqIQUgAUEBagwCCyAAQT9LDQBCASAArYZCgYCAgICAC4NQDQAgBiACQQFqIgVLBEAgBSAIai0AAEEJayIHQRdLDQFBASAHdEGTgIAEcUUNAQsgBCABNgIIIARBADsAASAEIAA6AAAgAUEBagwBCyAEQQA2AgQgAkEJaiIAIAYgACAGSRsiByACTQ0BQQAhBSACIQACQANAIAAgCGotAAAiCkEwa0H/AXFBCUsNASAEIAogBUEKbGpBMGsiBTYCBCAAQQFqIgAgB0cNAAsgByEACyAAIAJNDQECQCAAIAhqLQAAIgdBKWsOBgACAgICAAILIAYgAEEBaiIFSwRAIAUgCGotAABBCWsiBkEXSw0CQQEgBnRBk4CABHFFDQILIAQgATYCCCAEQQA7AAEgBCAHOgAAIAEgAmsgAGpBAWoLNgIMIAMgBTYCAEEBIQkLIAkLkQoBBH8CQAJAAkACQAJAAkACQAJAAkACQAJAIAAoAoQEQQJrDgYBAgMEBQUACyAAKAIEIgUgAU0NCSAAKAIAIQQDQAJAIAEgBGoiAC0AACIDQTxHBEAgA0EKaw4EDAEBDAELIAAtAAEiA0EgayADIANB4QBrQf8BcUEaSRtB/wFxQS9HDQACQCAALQACIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHTAEcNACAALQADIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHDAEcNACAALQAEIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHSAEcNACAALQAFIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHJAEcNACAALQAGIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHQAEcNACAALQAHIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHUAEcNACAALQAIIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUE+Rw0AIAIgAUEJajYCAEEBDwsCQCAALQACIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHTAEcNACAALQADIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHUAEcNACAALQAEIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHZAEcNACAALQAFIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHMAEcNACAALQAGIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUHFAEcNACAALQAHIgNBIGsgAyADQeEAa0H/AXFBGkkbQf8BcUE+Rw0AIAIgAUEIajYCAEEBDwsgAC0AAiIDQSBrIAMgA0HhAGtB/wFxQRpJG0H/AXFB0ABHDQAgAC0AAyIDQSBrIAMgA0HhAGtB/wFxQRpJG0H/AXFB0gBHDQAgAC0ABCIDQSBrIAMgA0HhAGtB/wFxQRpJG0H/AXFBxQBHDQAgAC0ABSIAQSBrIAAgAEHhAGtB/wFxQRpJG0H/AXFBPkcNACACIAFBBmo2AgBBAQ8LIAFBAWoiASAFRw0ACyAFIQEMCQsgAUEDaiIDIAAoAgQiBE8NCCAEQQNrIQUgACgCACEAA0ACQCAAIAFqIgYtAABBCmsOBAoAAAoACyAGQcAMQQMQCkUNBSABQQRqIQMgAUEBaiEBIAMgBEkNAAsgBSEBDAgLIAFBAmoiAyAAKAIEIgRPDQcgBEECayEFIAAoAgAhAANAAkAgACABaiIGLQAAQQprDgQJAAAJAAsgBi8AAEG//ABGDQUgAUEDaiEDIAFBAWohASADIARJDQALIAUhAQwHCyABQQFqIgMgACgCBCIETw0GIARBAWshBSAAKAIAIQADQAJAAkAgACABai0AACIGQQprDgQJAQEJAAsgBkE+Rg0GCyABQQJqIQMgAUEBaiEBIAMgBEkNAAsgBSEBDAYLIAFBA2oiAyAAKAIEIgRPDQUgBEEDayEFIAAoAgAhAANAAkAgACABaiIGLQAAQQprDgQHAAAHAAsgBkGZDEEDEApFDQUgAUEEaiEDIAFBAWohASADIARJDQALIAUhAQwFCyACIAE2AgBBACECAkACQCAAKAIAIAFqLQAAQQprDgQAAQEAAQsgACgChAQhAgsgAg8LIAIgAzYCAEECDwsgAiADNgIAQQMPCyACIAM2AgBBBA8LIAIgAzYCAEEFDwsgAiABNgIAQQALXQEDfyAAKAIEIgIgACgCCCIBRgRAIAAgACgCACIBQYAEIAIgAWsiA0EBdCABIAJGGyICEAIiATYCACAAIAEgAmo2AgQgASADaiEBCyAAIAFBAWo2AgggAUE+OgAAC/4PAQR/IwBBEGsiBSQAAkACQAJ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEEBaw4PAAECAw8EBQ8GBwgJCgsMDwsgAigCCCIBKAIEIgIgASgCCCIAa0ENTQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EOSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyABQQhqIQIgAEGzEikAADcABiAAQa0SKQAANwAAQQ4hAAwNCyACKAIIIgEoAgQiAiABKAIIIgBrQQVNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQZJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIABBgRIvAAA7AAQgAEH9ESgAADYAACABQQhqDAsLIAIoAggiASgCBCICIAEoAggiAGtBBU0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBBkkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEGOEi8AADsABCAAQYoSKAAANgAAIAFBCGoMCgsgAigCCCIBKAIEIgIgASgCCCIAa0EFTQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EGSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyAAQZUSLwAAOwAEIABBkRIoAAA2AAAgAUEIagwJCyACKAIIIgMoAgQiAiADKAIIIgRrIAEoAgBBAnRBvD5qKAIAIgYQFyIASQRAIAIgAygCACIBayECIAQgAWshBANAIAJBAXRBgAQgAhsiAiAEayAASQ0ACyADIAEgAhACIgE2AgAgAyABIARqIgQ2AgggAyABIAJqNgIECyADQQhqIQIgBCAGIAAQBBoMCQsgAiACKAIYQQFrNgIYIAIoAgwiAARAAkAgAigCJCACKAIcIgNrIgRBAE4EQCAFQQA2AgwgASgCECABKAIUIAMgBCAFQQxqIAARCAAhASAFKAIMIQACQCABQQBMDQAgAEUNACACKAIIIAAgARAPIAUoAgwhAAsgAARAIAAQAwsgAUEATg0BCyACIAMgBBAaCyACIAIoAhwiADYCJCACIAA2AiALIAIoAggiASgCBCICIAEoAggiAGtBDU0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBDkkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAUEIaiECIABBwhIpAAA3AAYgAEG8EikAADcAAEEOIQAMCAsgAigCCCIBKAIEIgIgASgCCCIAa0EETQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EFSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyABQQhqIQIgAEH1ES0AADoABCAAQfERKAAANgAAQQUhAAwHCyACKAIIIgEoAgQiAiABKAIIIgBrQQhNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQlJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIAFBCGohAiAAQdMSLQAAOgAIIABByxIpAAA3AABBCSEADAYLIAIoAggiASgCBCICIAEoAggiAGtBCE0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBCUkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAUEIaiECIABB5BItAAA6AAggAEHcEikAADcAAEEJIQAMBQsgAigCCCIBKAIEIgIgASgCCCIAa0EITQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EJSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyABQQhqIQIgAEHWES0AADoACCAAQc4RKQAANwAAQQkhAAwECyACKAIIIgEoAgQiAiABKAIIIgBrQQVNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQZJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIABB4hEvAAA7AAQgAEHeESgAADYAACABQQhqDAILIAIoAggiASgCBCICIAEoAggiAGtBBU0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBBkkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEGcEi8AADsABCAAQZgSKAAANgAAIAFBCGoMAQsgAigCCCIBKAIEIgIgASgCCCIAa0EFTQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EGSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyAAQdkSLwAAOwAEIABB1RIoAAA2AAAgAUEIagshAkEGIQALIAIgAigCACAAajYCAAsgBUEQaiQAQQAL9REBBH8CQAJAIAIoAhBBAEoNAAJAAkACQAJAAkACQAJAAkACQAJAIAAOCgABAwQFBgcICQIKCyACKAIIIgEoAgQiAiABKAIIIgBrQQNNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQRJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIABBvMq18wM2AAAgASABKAIIQQRqNgIIDAoLIAIoAggiASgCBCICIAEoAggiAGtBB00EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBCEkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEK85tGT983bsz43AAAgASABKAIIQQhqNgIIDAkLIAIoAggiASgCBCICIAEoAggiAGtBAk0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBA0kNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEG3Cy0AADoAAiAAQbULLwAAOwAAIAEgASgCCEEDajYCCAwICyACKAIIIgQoAgQiACAEKAIIIgNrQQhNBEAgACAEKAIAIgVrIQAgAyAFayEDA0AgAEEBdEGABCAAGyIAIANrQQlJDQALIAQgBSAAEAIiBTYCACAEIAMgBWoiAzYCCCAEIAAgBWo2AgQLIANBpxEtAAA6AAggA0GfESkAADcAACAEIAQoAghBCWo2AggCQAJAIAItAABBBHENACABKAIEQQtJDQBBACEDQZ0NIQUCQCABKAIAIgYtAAAiAEUNAANAIAVBpw1GBEAgACEDQacNIQUMAgsCQCAFLQAAIgQgAEYNACAAQSByIAAgAEHBAGtBGkkbIARBIHIgBCAEQcEAa0EaSRtGDQAgACEDDAILIAVBAWohBSAGLQABIQAgBkEBaiEGIAANAAsLIANB/wFxIgBBIHIgACAAQcEAa0EaSRsgBS0AACIAQSByIAAgAEHBAGtBGkkbRg0BCyACIAEQCwsgASgCEARAIAFBEGohBSACKAIIIgMoAgQiACADKAIIIgFrQQhNBEAgACADKAIAIgRrIQAgASAEayEBA0AgAEEBdEGABCAAGyIAIAFrQQlJDQALIAMgBCAAEAIiBDYCACADIAEgBGoiATYCCCADIAAgBGo2AgQLIAFBsREtAAA6AAggAUGpESkAADcAACADIAMoAghBCWo2AgggAiAFEAsLIAIoAggiASgCBCICIAEoAggiAGtBAU0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBAkkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEGi/AA7AAAgASABKAIIQQJqNgIIDAcLIAIoAggiBCgCBCIAIAQoAggiA2tBCU0EQCAAIAQoAgAiBWshACADIAVrIQMDQCAAQQF0QYAEIAAbIgAgA2tBCkkNAAsgBCAFIAAQAiIFNgIAIAQgAyAFaiIDNgIIIAQgACAFajYCBAsgA0HDES8AADsACCADQbsRKQAANwAAIAQgBCgCCEEKajYCCCACIAEQCyACKAIIIgMoAgQiACADKAIIIgFrQQZNBEAgACADKAIAIgRrIQAgASAEayEBA0AgAEEBdEGABCAAGyIAIAFrQQdJDQALIAMgBCAAEAIiBDYCACADIAEgBGoiATYCCCADIAAgBGo2AgQLIAFBgBEoAAA2AAMgAUH9ECgAADYAACADIAMoAghBB2o2AgggAiACKAIQQQFqNgIQDAYLIAIoAggiASgCBCICIAEoAggiAGtBBU0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBBkkNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEGHDC8AADsABCAAQYMMKAAANgAAIAEgASgCCEEGajYCCAwFCyACKAIIIgEoAgQiAiABKAIIIgBrQQRNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQVJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIABB4gstAAA6AAQgAEHeCygAADYAACABIAEoAghBBWo2AggMBAsgAigCCCIBKAIEIgIgASgCCCIAa0ELTQRAIAIgASgCACIDayECIAAgA2shAANAIAJBAXRBgAQgAhsiAiAAa0EMSQ0ACyABIAMgAhACIgM2AgAgASAAIANqIgA2AgggASACIANqNgIECyAAQcULKAAANgAIIABBvQspAAA3AAAgASABKAIIQQxqNgIIDAMLIAIoAggiASgCBCICIAEoAggiAGtBGk0EQCACIAEoAgAiA2shAiAAIANrIQADQCACQQF0QYAEIAIbIgIgAGtBG0kNAAsgASADIAIQAiIDNgIAIAEgACADaiIANgIIIAEgAiADajYCBAsgAEHbDCgAADYAFyAAQdQMKQAANwAQIABBzAwpAAA3AAggAEHEDCkAADcAACABIAEoAghBG2o2AggMAgsgAigCCCIEKAIEIgAgBCgCCCIDa0EYTQRAIAAgBCgCACIFayEAIAMgBWshAwNAIABBAXRBgAQgABsiACADa0EZSQ0ACyAEIAUgABACIgU2AgAgBCADIAVqIgM2AgggBCAAIAVqNgIECyADQZ0RLQAAOgAYIANBlREpAAA3ABAgA0GNESkAADcACCADQYURKQAANwAAIAQgBCgCCEEZajYCCCACIAEQCyACKAIIIgEoAgQiAiABKAIIIgBrQQFNBEAgAiABKAIAIgNrIQIgACADayEAA0AgAkEBdEGABCACGyICIABrQQJJDQALIAEgAyACEAIiAzYCACABIAAgA2oiADYCCCABIAIgA2o2AgQLIABBovwAOwAAIAEgASgCCEECajYCCAtBAA8LQQAL3gsBBH8CQAJAAkAgAigCECIDQQBKBEAgAEEDRw0BIANBAUcNASABKAIQBEAgAUEQaiEFIAIoAggiAygCBCIAIAMoAggiAWtBCE0EQCAAIAMoAgAiBGshACABIARrIQEDQCAAQQF0QYAEIAAbIgAgAWtBCUkNAAsgAyAEIAAQAiIENgIAIAMgASAEaiIBNgIIIAMgACAEajYCBAsgAUGxES0AADoACCABQakRKQAANwAAIAMgAygCCEEJajYCCCACIAUQCwtBuwxBjQ0gAi0AAEECcSIAGyEGQQRBAiAAGyIDIAIoAggiASgCBCIAIAEoAggiBGtLBEAgACABKAIAIgVrIQAgBCAFayEEA0AgAEEBdEGABCAAGyIAIARrIANJDQALIAEgBSAAEAIiBTYCACABIAQgBWoiBDYCCCABIAAgBWo2AgQLIAQgBiADEAQaIAEgASgCCCADajYCCCACIAIoAhBBAWs2AhAMAwsCQAJAAkACQAJAAkACQAJAIAAOCgABAwgEBQYGBwIICyACKAIIIgIoAgQiACACKAIIIgFrQQRNBEAgACACKAIAIgNrIQAgASADayEBA0AgAEEBdEGABCAAGyIAIAFrQQVJDQALIAIgAyAAEAIiAzYCACACIAEgA2oiATYCCCACIAAgA2o2AgQLIAFB3AstAAA6AAQgAUHYCygAADYAACACIAIoAghBBWo2AggMCQsgAigCCCICKAIEIgAgAigCCCIBa0EITQRAIAAgAigCACIDayEAIAEgA2shAQNAIABBAXRBgAQgABsiACABa0EJSQ0ACyACIAMgABACIgM2AgAgAiABIANqIgE2AgggAiAAIANqNgIECyABQYEMLQAAOgAIIAFB+QspAAA3AAAgAiACKAIIQQlqNgIIDAgLIAIoAggiAigCBCIAIAIoAggiAWtBA00EQCAAIAIoAgAiA2shACABIANrIQEDQCAAQQF0QYAEIAAbIgAgAWtBBEkNAAsgAiADIAAQAiIDNgIAIAIgASADaiIBNgIIIAIgACADajYCBAsgAUG83tTzAzYAAAwGCyACKAIIIgIoAgQiACACKAIIIgFrQQNNBEAgACACKAIAIgNrIQAgASADayEBA0AgAEEBdEGABCAAGyIAIAFrQQRJDQALIAIgAyAAEAIiAzYCACACIAEgA2oiATYCCCACIAAgA2o2AgQLIAFBvN6E8wM2AAAMBQsgAigCCCICKAIEIgAgAigCCCIBa0EGTQRAIAAgAigCACIDayEAIAEgA2shAQNAIABBAXRBgAQgABsiACABa0EHSQ0ACyACIAMgABACIgM2AgAgAiABIANqIgE2AgggAiAAIANqNgIECyABQY0MKAAANgADIAFBigwoAAA2AAAgAiACKAIIQQdqNgIIDAULIAIoAggiAigCBCIAIAIoAggiAWtBBU0EQCAAIAIoAgAiA2shACABIANrIQEDQCAAQQF0QYAEIAAbIgAgAWtBBkkNAAsgAiADIAAQAiIDNgIAIAIgASADaiIBNgIIIAIgACADajYCBAsgAUHoCy8AADsABCABQeQLKAAANgAAIAIgAigCCEEGajYCCAwECyACKAIIIgIoAgQiACACKAIIIgFrQQxNBEAgACACKAIAIgNrIQAgASADayEBA0AgAEEBdEGABCAAGyIAIAFrQQ1JDQALIAIgAyAAEAIiAzYCACACIAEgA2oiATYCCCACIAAgA2o2AgQLIAFBzwspAAA3AAUgAUHKCykAADcAACACIAIoAghBDWo2AggMAwsgAigCCCICKAIEIgAgAigCCCIBa0EMTQRAIAAgAigCACIDayEAIAEgA2shAQNAIABBAXRBgAQgABsiACABa0ENSQ0ACyACIAMgABACIgM2AgAgAiABIANqIgE2AgggAiAAIANqNgIECyABQfALKQAANwAFIAFB6wspAAA3AAAgAiACKAIIQQ1qNgIIC0EADwsgAiACKAIIQQRqNgIIC0EAC+sOAQh/AkAgAygCGEUNACADKAIMRQ0AIAIgAygCICIAIAMoAiQiBWtLBEAgACADKAIcIgBrIQQgBSAAayEGA0AgBEEBdEGABCAEGyIEIAZrIAJJDQALIAMgACAEEAIiADYCHCADIAAgBmoiBTYCJCADIAAgBGo2AiALIAUgASACEAQaIAMgAygCJCACajYCJEEADwsCQCADKAIURQ0AIANBADYCFCAAQQRrQXxLDQAgAygCCCIGKAIEIgQgBigCCCIFa0EGTQRAIAQgBigCACIHayEEIAUgB2shBQNAIARBAXRBgAQgBBsiBCAFa0EHSQ0ACyAGIAcgBBACIgc2AgAgBiAFIAdqIgU2AgggBiAEIAdqNgIEC0EAIQQgBUG2ESgAADYAAyAFQbMRKAAANgAAIAYgBigCCEEHajYCCCADKAIIIggoAggiCSEKIAIgCCgCBCIGIAlrSwRAIAYgCCgCACIGayEFIAkgBmshBwNAIAVBAXRBgAQgBRsiBSAHayACSQ0ACyAIIAYgBRACIgY2AgAgCCAGIAdqIgo2AgggCCAFIAZqNgIECwJAAkAgAgRAQQAhBgNAAkAgASAEai0AACILwCIFQQBODQBBACEFIAtB4AFxQcABRw0AIARBAWoiByACTw0AQYACIAtBBnRBwA9xIAEgB2otAABBP3FyIgQgBEGAAk8bIQUgByEECwJAIAVB/wFxQeA+ai0AACIHQS1GBEAgBkH/AXEiBUUNASAFQS1GDQELIAggCCgCCCIGQQFqNgIIIAYgBzoAACAHIQYLIARBAWoiBCACSQ0ACyAIKAIIIQcgBkH/AXFBLUYEQCAIIAdBAWsiBzYCCAsgAygCCCIGKAIEIgQgBigCCCIFa0EqTQRAIAQgBigCACIIayEEIAUgCGshBQNAIARBAXRBgAQgBBsiBCAFa0ErSQ0ACyAGIAggBBACIgg2AgAgBiAFIAhqIgU2AgggBiAEIAhqNgIECyAFQfUPKAAANgAnIAVB7g8pAAA3ACAgBUHmDykAADcAGCAFQd4PKQAANwAQIAVB1g8pAAA3AAggBUHODykAADcAACAGIAYoAghBK2o2AgggByAKRg0BIAcgCmsiBSADKAIIIgcoAgQiBCAHKAIIIgZrSwR/IAQgBygCACIIayEEIAYgCGshBgNAIARBAXRBgAQgBBsiBCAGayAFSQ0ACyAHIAggBBACIgg2AgAgByAGIAhqNgIIIAcgBCAIajYCBCADKAIIKAIIBSAGCyAJIAUQBBogAygCCCIGIAYoAgggBWoiBTYCCAwCCyADKAIIIgYoAgQiBCAGKAIIIgVrQSpNBEAgBCAGKAIAIgdrIQQgBSAHayEFA0AgBEEBdEGABCAEGyIEIAVrQStJDQALIAYgByAEEAIiBzYCACAGIAUgB2oiBTYCCCAGIAQgB2o2AgQLIAVB9Q8oAAA2ACcgBUHuDykAADcAICAFQeYPKQAANwAYIAVB3g8pAAA3ABAgBUHWDykAADcACCAFQc4PKQAANwAAIAYgBigCCEErajYCCAsgAygCCCIGKAIIIQULIAYoAgQiBCAFa0EFTQRAIAQgBigCACIHayEEIAUgB2shBQNAIARBAXRBgAQgBBsiBCAFa0EGSQ0ACyAGIAcgBBACIgc2AgAgBiAFIAdqIgU2AgggBiAEIAdqNgIECyAFQZYMLwAAOwAEIAVBkgwoAAA2AAAgBiAGKAIIQQZqNgIICwJAAkACQAJAAkACQCAAQQFrDgYAAQIFBAUECyADKAIIIgAoAgQiASAAKAIIIgRrQQJNBEAgASAAKAIAIgFrIQIgBCABayEDA0AgAkEBdEGABCACGyICIANrQQNJDQALIAAgASACEAIiATYCACAAIAEgA2oiBDYCCCAAIAEgAmo2AgQLIARBujwtAAA6AAIgBEG4PC8AADsAACAAIAAoAghBA2o2AghBAA8LQcwRIQYgAygCEEUEQEGYE0HrESADLQAAQQJxGyEGCyADKAIIIgAoAgQiAiAAKAIIIgVrIAYQFyIBSQRAIAIgACgCACIDayECIAUgA2shBANAIAJBAXRBgAQgAhsiAiAEayABSQ0ACyAAIAMgAhACIgM2AgAgACADIARqIgU2AgggACACIANqNgIECyAFIAYgARAEGiAAIAAoAgggAWo2AghBAA8LIAMoAhAhBiADKAIIIgAoAgQiASAAKAIIIgRGBEAgACAAKAIAIgJBgAQgASACayIDQQF0IAEgAkYbIgIQAiIBNgIAIAAgASADaiIENgIIIAAgASACajYCBAsgBEEgQQogBhs6AAAgACAAKAIIQQFqNgIIQQAPCwALIAMgASACEBpBAA8LIAIgAygCCCIAKAIEIgMgACgCCCIFa0sEQCADIAAoAgAiA2shBCAFIANrIQYDQCAEQQF0QYAEIAQbIgQgBmsgAkkNAAsgACADIAQQAiIDNgIAIAAgAyAGaiIFNgIIIAAgAyAEajYCBAsgBSABIAIQBBogACAAKAIIIAJqNgIIQQAL12gBJ38jAEEwayIVJABBnMkAQZTJACgCACIINgIAQZjJACAINgIAAkACfyADQQNxBEAgAUEBdCILBEADQCAHQQF0QYAEIAcbIgcgC0kNAAtBnMkAIAggBxACIgg2AgBBlMkAIAg2AgBBmMkAIAcgCGo2AgALIBVCADcCICAVQgA3AiggFUIANwIYIBUgBTYCFCAVQZTJADYCECAVIAI2AgwgFSADNgIIIwBBsAVrIgYkACAVQQhqIhlCADcCECAZQgA3AhggGUIANwIgIBkoAgQhAyAGQTBqQQBB4AMQCBogBkIANwIkIAZBATYCICAGQQI2AhwgBkEDNgIYIAZBBDYCFCAGQQU2AhAgBiADNgIMIAZBf0EEIANBEHEbNgL8AyAGIBk2AiwgBkEANgIIIAYgATYCBCAGIAAiAjYCACAGQdwAakEAQYACEAgaIAZBgQI7ALsBIAZBAToAhgEgBkGBAjsBuAEgBkEBOgC3ASAGQQE6AJoBIAZBgQI7AJcBIAZBAToAggEgBkEBOgB9IAZBAToAXCADQYAEcQRAIAZBAToA2gELIANBgCBxBEAgBkEBOgCAAQsgA0EIcQRAIAZBAToAnAELIANBBHEEQCAGQQE6AJYBCyADQYAIcQRAIAZBAToAigELIANBgMIAcQRAIAZBAToA2AELIANBAXEEQEEAIQADQCAAQSBHIABBDEdxRQRAIAAgBmpBAToAXAsgAEEBciIDQQlGBEAgAyAGakEBOgBcCyAAQQNyIgNB/f///wdxQQlGBEAgAyAGakEBOgBcCyAAQQRqIgBBgAJHDQALCyAGAn9BACABRQ0AGkEBIAEgAmpBAWstAAAiAEENRg0AGiAAQQpGCzYCMCAGQdwCakH/AUHoABAIGiAGQn83AsgDAkBBAEEAIBkQJCIJDQAgBkGQBGoiDEEIciEeIAZBqARqIR8gBkGcBWohICAGQYgFakEBciEhIAxBBHIhIiAGQaQEaiEjIAxBDHIhJCAGQawEaiElIAZBoARqISZBpBMhAkEAIQADQCAMIRYgAiEKAkACfwJAIAYoAgQiAyAASwRAIAZCADcDmAUgBkIANwOQBSAGQgA3A4gFICYgBkGQBGoiASABIBZGIhobIBYgCiAWRiIbGyEMIAYoAogEISdBACECIAYoAgAhCQJAA0AgACAJai0AACIBQSBHIAFBCUdxDQEgAkF8cUEEaiACQQFqIAFBCUYbIQIgAEEBaiIAIANHDQALIAMhAAsgJSAkIBobIBZBDGogGxsiESACNgIAICMgIiAaGyAWQQRqIBsbIhcgADYCAEEAIQgCQCAGKAL0AyIHQQBMDQAgBigC/AMhCyAGKALwAyEOIAIhBQNAAkAgDiAIQRhsaiIBLQAAQT5GBEAgAiALTwRAIAUhAgwECyAAIANPBEAgBSECDAQLIAAgCWotAABBPkcEQCAFIQIMBAsgBUEBaiIPIQECQCADIABBAWoiAE0NAANAIAAgCWotAAAiAkEgRyACQQlHcQ0BIAFBfHFBBGogAUEBaiACQQlGGyEBIABBAWoiACADRw0ACyADIQALIBEgASAFQX9zaiABIA9HayICNgIAIBcgADYCACABIQUMAQsgASgCDCIBIAJLBEAgBSECDAMLIBEgAiABayICNgIAIAUhAQsgCEEBaiIIIAdHDQALIAchCCABIQILIAYgADYCyAQCQCAAIANPDQBBACEFQQAhEkEAIQsgCiEPIAAgCWotAABBCmsOBAAEBAAEC0EAIQUgByAITA0BIAYoAvADIQEDQCABIAhBGGxqLQAAQT5GDQIgCEEBaiIIIAdHDQALQQAhEiAHIQhBAAwCCyAGEAUaAkAgBigCQCIBRQ0AIAYgAUEFbEEEbSICNgJMIAJBAnQiAxAHIgAEQCAAQQAgAxAIGgsgBiAANgJIIABFBEBBfyEJIAYoAiQiAEUNBkHsDiAGKAIsIAARAAAMBgsgAUEASgR/QQAhAQNAIAYoAjwgAUEFdGoiACAAKAIAIAAoAgwQHyICNgIIAkAgBigCSCACIAYoAkxwQQJ0aiIDKAIAIgJFBEAgAyAANgIADAELAkAgBigCPCIDIAJLDQAgAiADIAYoAkBBBXRqTw0AIAAoAgAgACgCDCACKAIAIAIoAgwQEUUNAUEQEAciA0UEQEF/IQkgBigCJCIARQ0KQewOIAYoAiwgABEAAAwKCyADIAI2AgggA0KCgICAIDcCACADIAA2AgwgBigCSCAAKAIIIAYoAkxwQQJ0aiADNgIADAELIAIoAgAiAyACKAIEIgVOBEAgAiAFQQJtIAVqIgNBAnRBCGoQAiICRQRAQX8hCSAGKAIkIgBFDQpB/Q4gBigCLCAAEQAADAoLIAIgAzYCBCAGKAJIIAAoAgggBigCTHBBAnRqIAI2AgAgAigCACEDCyACIANBAnRqIAA2AgggAiADQQFqNgIACyABQQFqIgEgBigCQEgNAAsgBigCTAUgAgtBAEwNAEEAIQcDQAJAIAYoAkggB0ECdGooAgAiC0UNACALIAYoAjwiAE8EQCALIAAgBigCQEEFdGpJDQELIAsoAgAhACALQQhqIQgjAEHQAWsiAyQAIANCATcDCAJAIABBAnQiCkUNACADQoSAgIDAADcDEEEEIQFBBCECQQIhBQNAIANBEGogBUECdGogAiABIgBqQQRqIgE2AgAgBUEBaiEFIAAhAiABIApJDQALAn8gCCAIIApqQQRrIgBPBEBBACECQQEhBUEAIQBBASEBQQAMAQtBASEFQQEhAQNAAn8gBUEDcUEDRgRAIAggASADQRBqEBkgA0EIakECEBUgAUECagwBCwJAIANBEGogAUEBayICQQJ0aigCACAAIAhrTwRAIAggBSADKAIMIAFBACADQRBqEBQMAQsgCCABIANBEGoQGQsgAUEBRgRAIANBCGpBARATQQAMAQsgA0EIaiACEBNBAQshASADIAMoAggiAkEBciIFNgIIIAhBBGoiCCAASQ0ACyACQQFLIQAgAygCDCICQQBHCyEKIAggBSACIAFBACADQRBqEBQCQCABQQFHDQAgAA0AIApFDQELA0ACfyABQQFMBEAgA0EIaiAFIAIQIyIAEBUgAygCDCECIAMoAgghBSAAIAFqDAELIANBCGoiAEECEBMgAyADKAIIQQdzNgIIIABBARAVIAhBBGsiAiADQRBqIgogAUECayIOQQJ0aigCAGsgAygCCCADKAIMIAFBAWtBASAKEBQgAEEBEBMgAyADKAIIQQFyIgU2AgggAiAFIAMoAgwiAiAOQQEgChAUIA4LIQEgCEEEayEIIAFBAUcNACAFQQFHDQAgAg0ACwsgA0HQAWokAEEBIQAgCygCAEECSA0AA0ACQCALIABBAnRqIgEoAgQiAigCCCABKAIIIgMoAghHDQAgAigCACACKAIMIAMoAgAgAygCDBARDQAgASABKAIENgIICyAAQQFqIgAgCygCAEgNAAsLIAdBAWoiByAGKAJMSA0ACwtBACEFIAZBABAgIglBAEgNBCAGQQA2AvQDAkACQCAGKALoA0EASgRAIAZBmAVqIQxBACEHA0ACQAJAAkACQCAGKALgAyAHaiIKKAIAIgBB/wFxQQJrDgMAAQIDCyAGIABBf3NBCnZBAXE2ArwEIAYgCi8BAjoAwAQMAgsgBiAKKAIENgK8BCAGIAooAgBBf3NBCnZBAXE2AsAEIAYgCi8BAjoAxAQMAQsgBiAAQf//A0s2ArwEIAYgCi8BAjoAwAQgBiAKKAIENgLEBAsCQAJAAkACQAJAAkACQCAKKAIAIgBBgAZxBEACQCAAQYAEcUUNACAAQf8BcSAGQbwEaiAGKAIsIAYoAhQRAQAiCQRAIAYoAiQiAEUNDUHHDiAGKAIsIAARAAAMDQtBACEFIAooAgAiAEH/AXFBAWtBAksNACAGIAYoAvQDQQFrNgL0AyAKKAIAIQALIABBgAJxRQ0HIABB/wFxIAZBvARqIAYoAiwgBigCEBEBACIJBEAgBigCJCIARQ0MQaIOIAYoAiwgABEAAAwMC0EAIQUCQCAKKAIAIgBB/wFxQQFrDgMAAgIICyAGKALwAyAGKAL0A0EYbGpBAToAASAGIAYoAvQDQQFqNgL0AwwHCyAGQgA3A5AFIAxCADcDACAGQgA3A6AFQQAhCyAGQQA2AqgFIAZCADcDiAUgBigC9AMiAARAIAYoAvADIABBGGxqQRdrLQAARSELC0EBIRICQAJAAkACQCAKKAIAIgBB/wFxQQZrDgUAAQMDAgMLIAYgAEEQdjYCiAUMAgsgAEGAgARJDQEgCigCDCEBIAYoAgAiBSAKKAIIIgBqLQAAIQgCQAJAAkAgBigCBCICIABNDQADQCAAIAVqLQAAIAhHDQEgAEEBaiIAIAJHDQALDAELIAAgAk8NAQNAIAAgBWotAABBIEcNAiAAQQFqIgAgAkcNAAsLIAIhAAsgACABIAAgAUkbIQMDQAJAIAAgASICTwRAIAMhAgwBCyAFIAJBAWsiAWotAABBIEYNAQsLIAYgACAFaiACIABrQQAgBkGIBWogBkHoBGoQECIFQQBIDQYgBigCACEDIAAhAQJAIAAgAk8NAANAIAEgA2otAABBCWsiBUEXTUEAQQEgBXRBjYCABHEbDQEgAUEBaiIBIAJHDQALIAIhAQsgBiAAIANqIAEgAGtBACAMIAZByARqEBBBAEgEQEF/IQUMBwsgBiAIOgCoBUEAIRIMAQsgBkEBNgKMBSAGIABBEHY2AogFIAYgCigCBEECazYCkAULAkACQAJAAkACQCALQQAgCigCACICQf8BcSIAQQlGG0UEQCAAIAZBiAVqIAYoAiwgBigCEBEBACIFDQEgCigCACECC0EAIQUgAkH/AXFBBWsOBgcEAQIEAwQLIAYoAiQiAEUNB0GiDiAGKAIsIAARAAAMBwsgCigCBCEAAkACQCACQf//A00EQCAKQQhqIQICQCAAQQBMBEAgAiEDDAELIAIgAEEMbGohAwNAIAIoAgAgAigCBEcEQCACIQMMAgsgAkEMaiECIABBAUohASAAQQFrIQAgAQ0AC0EAIQALIABBH3UgAHEhCQNAIAAiAUEATA0CIAMgAUEBayIAQQxsaiICKAIAIAIoAgRGDQALIAEhCQwCCyAAQQFrIQkgCkEUaiEDCyAJRQ0GCyAGQQUgAyAJECoiBUEATg0FDAYLIAZBBiAKQQhqIAooAgQQKiIFQQBODQQMBQsgCigCBCEJAkACQAJAIAJBEHYiCEECdBAHIgFFBEBBfyEAIAYoAiQiAkUNAUHsDiAGKAIsIAIRAAAMAQsgAkGAgARPBEAgCigCFCEOIAYoAgAhFiAKKAIQIhEhAiAIIQAgASEPA0AgACEDA0AgAiIAQQFqIQIgACAWaiIQLQAAQS1HDQALQQAhDSAAIBFLBEAgEEEBay0AAEE6RiENCwJ/IAAgDkkEQAJAA0AgACAWai0AACICQS1HDQEgAEEBaiIAIA5JDQALIA4MAgsgDUECciANIAJBOkYbIQ0LIAALIQIgDyANQQJ0QaAyaigCADYCACADQQFrIQAgD0EEaiEPIANBAUoNAAsLQQtBACAGKAIsIAYoAhARAQAiAwRAIAYoAiQiAARAQaIOIAYoAiwgABEAAAsMBgsgBkEOIAooAgggCigCDCABIAgQKSIAQQBIDQBBC0EAIAYoAiwgBigCFBEBACIDBEAgBigCJCIABEBBxw4gBigCLCAAEQAACwwGCyAJQQNJDQICQEEMQQAgBigCLCAGKAIQEQEAIgNFBEAgCkEIaiEDQQIhAgwBCyAGKAIkIgBFDQZBog4gBigCLCAAEQAADAYLA0AgBkEPIAMgAkEDdGoiACgCACAAKAIEIAEgCBApIgBBAEgNASAJIAJBAWoiAkcNAAsMAQsgARADIAAhBQwGC0EMQQAgBigCLCAGKAIUEQEAIgNFDQAgBigCJCIARQ0DQccOIAYoAiwgABEAAAwDCyABEAMMAwsgBiAKQQhqIAooAgQQHSIFQQBIDQMMAgsgBigC8AMgBigC9ANBGGxqIABBCHZBBHE6AAEgBiAGKAL0A0EBajYC9AMMBQsgARADIAMiBUEASA0BCyALQQAgCi0AACIAQQlGGw0AIAAgBkGIBWogBigCLCAGKAIUEQEAIgVFBEBBACEFDAELIAYoAiQiAEUNAEHHDiAGKAIsIAARAAALIBINAQsgBigC+ARBAEoEQCAGKALoBBADIAYoAuwEEAMgBigC8AQQAwsgBigC2ARBAEwNACAGKALIBBADIAYoAswEEAMgBigC0AQQAwsgBUEASA0DIAooAgQhACAKLQAAQQdrQQFNBEAgAEEMbCAHaiEHDAELIABBA3QgB2ohBwsgB0EIaiIHIAYoAugDSA0ACwsgBkEANgLoAwsgBSEJCyAJQQBIDQRBACEJQQBBACAGKAIsIAYoAhQRAQAiAEUNBCAGKAIkIgEEQEHHDiAGKAIsIAERAAALIAAhCQwEC0EAIRJBAAshCyAKIQ8LA0BBASASayENQQAgEmshDiAGKALoAyIoIAYoAuADakEIayEpIAYoAvADIR0gBigCgAQhKiAGKAL8AyETIAYoAowEIRQgBigChAQhHANAAkACQAJAAkACQAJAAkACQAJAIA8vAQAiEEEGRwRAIAAhAQwBCyAXIAA2AgACQCATIBEoAgAiEE0EQCAAIQEMAQsgACEBAkAgACADTw0AIAkgDygCBGotAAAhGANAIAEgCWotAAAgGEcNASABQQFqIgEgA0cNAAsgAyEBCwJAIAEgAGsgKkkNAAJAIAEgA08NAANAIAEgCWotAAAiAEEgRwRAIABBCmsOBAIDAwIDCyABQQFqIgEgA0cNAAsgAyEBCyAGIAE2AsgEIAwgDC8BAkEQdDYCACAGQQA2AogEDAYLIAYgATYCyAQLIAcgCEYNASAPLwEAIRALAkACQAJAAkAgEEEHRw0AIBxBAEwNACAHIAhMDQFBACEcIAZBADYChAQLIAEgA08NASABIAlqIhgtAABBCmsOBAECAgECCwJAIAYgASAGQcgEahAxQQBMDQAgBkEANgKEBCAcQX5xQQZHDQAgDCAMLwECQRB0NgIAIBFBADYCAAwGCyAMQQc7AQAgByEIDAULIAwvAQJBEHQhAAJAIA8vAQBBBUcNACAIIAYoAvQDRw0AIAwgAEEFcjYCACARIBEoAgAiACAGKAL8A2siAUEAIAAgAU8bNgIAIAZBADYCiAQMBQsgDCAANgIAAkACQCAIQQBMIgANACALIA5HDQAgBiAGKALwAyAIQRhsakEYay0AACIAQT5HNgKIBAwBCyAGQQA2AogEIAANBSAGKALwAyAIQRhsakEYay0AACEACyAAQf8BcUE+Rg0EIAsgDkcNBCAGKALkAwRAIA4hCwwFCyAGKALoAyIAQQlIBEAgDiELDAULIAYoAuADIABqQQhrLQAAQQRHBEAgDiELDAULIAZBATYCjAQgDiELDAQLIAZBADYCiAQgFARAAkAgCEEATA0AIB0gCEEBayIAQRhsai0AAEE+Rg0AIAsgDkcNACAGKALkAw0AIChBCUgNACAAIAggKS0AAEEERhshCAsgBkEANgKMBAsgESgCACIUIBNPDQICQAJAIA8vAQBBCEcNAAJAIBgtAAAiEEEtaw4RAAEBAQEBAQEBAQEBAQEBAQABCyABIQAgByAIRw0AAkACQAJAA0AgAEEBaiIAIANPDQEgACAJai0AACAQRg0ACwNAIAAgCWotAAAiGEEgRwRAIBhBCmsOBAMEBAMECyAAQQFqIgAgA0cNAAsgAyEADAELIAMgAUEBaiIAIAAgA0kbIQALIAYgADYCyAQgDEGEgARBhIAIIBBBPUYbNgIAIAchCAwGCyABIAVPDQEMBAsgASAFSQ0DIBgtAAAhEAsgEEH/AXEiK0UNAkHIDyAQwEEEEAZFDQJBASEYQQEhACABQQFqIgUgA08NAgJAA0ACQCArIAUgCWotAAAiEEYiLA0AIBBBIEYNACAQQQlHDQILIAVBAWoiBSADSSEYIAAgLGohACADIAVHDQALIAMhBSAAQQNJDQMMAgsgAEEDSQ0CIBhFDQEgEEEKaw4EAQICAQILIBEgECAPKAIMayIAQQAgACAQTRs2AgAgDEEGOwEAIAchCAwCCyAGIAU2AsgEIAxBATsBAAwBCwJAIAcgCEwNACALIA5HDQACQCAGIBQgASAGQegEaiAGQYgFahAwRQ0AIAYtAIgFIgBBPkYNACAdIAhBGGxqIgstAAAgAEcNACAGKAKQBSIQIAsoAgxLDQAgBigClAUiASAQayACaiIPIQICQCADIAYoAugEIgBNDQADQCAAIAlqLQAAIhRBIEcgFEEJR3ENASACQXxxQQRqIAJBAWogFEEJRhshAiAAQQFqIgAgA0cNAAsgBiADNgLIBCARIAIgD2s2AgAgFyADNgIAIAMhAAwGCyAGIAA2AsgEIBEgAiAPayIPNgIAIBcgADYCACAAIANPDQUCQCAAIAlqLQAAQQprDgQGAAAGAAsgDyATTQRAIAYgASAPaiIBNgKUBSARQQA2AgAMBwsgBiABQQFqIgE2ApQFIBEgD0EBazYCAAwGCyAOIQsLAkACQAJAAkACQCATIBRNBEACQCAPLwEAIgAOBgACAgICAAILIBEgFCATazYCACAMQQU2AgAMBgsgBiAUIAEgBkHIBGogBkGIBWoQMCEAIA8vAQAhAQJAIAAEQCAGKALIBCEAAkAgAUEIRw0AIAcgCEcNAAJAAkAgACADTw0AIAAgCWotAAAiDUENRg0AIAYtAIgFIQEgDUEKRw0BIAFB/wFxQT5GDQEgByEIDAQLQT4hASAGLQCIBUE+Rg0AIAchCAwDCyABQf8BcSIBQS5HIAFBKUdxDQAgBigCjAVBAUYNACAHIQgMAgsgBigClAUiASAGKAKQBWsgAmoiECECAkAgACADTw0AA0AgACAJai0AACINQSBHIA1BCUdxDQEgAkF8cUEEaiACQQFqIA1BCUYbIQIgAEEBaiIAIANHDQALIAMhAAsgBiAANgLIBCARIAIgEGsiDTYCACAXIAA2AgAgDCAGLACIBTsBAgJAAkACQCAAIANPDQAgACAJai0AAEEKaw4EAAEBAAELIAYgAUEBajYClAUMAQsgDSATTQRAIAYgASANajYClAUgEUEANgIADAELIAYgAUEBajYClAUgESANQQFrNgIACyASRQRAIAYgCCALahAgIglBAEgNECAGKAL0AyEHCwJAIAYoAvgDIgEgB0oEQCAGKALwAyEBDAELIAZBECABQQF2IAFqIAFBAEwbIgE2AvgDIAYoAvADIAFBGGwQAiIBRQRAIAYoAiQiAEUNCwwKCyAGIAE2AvADIAYoAvQDIQcLQaQTIA8gCyAORhshDyASQQFqIRIgBiAHQQFqNgL0AyABIAdBGGxqIgEgBikDiAU3AgAgASAGKQOYBTcCECABIAYpA5AFNwIIIAYoAvQDIQcgBigCBCEDIAYoAgAhCQwNCyABQQlGIAcgCEZxDQIgBigCyAQhAAsgACADSQ0CDAMLIABBCUcNAyAHIAhHDQMLIAxBCTsBACAHIQgMAwsgACAJai0AAEEjRw0AIAMgAEEBaiICIAIgA0kbIQECQAJAAkAgACADQQFrIgVGDQBBASEHIAIgCWotAAAiDUEjRw0BIAIgBUYNAEECIQcgCSAAQQJqIgJqLQAAIg1BI0cNASACIAVGDQBBAyEHIAkgAEEDaiICai0AACINQSNHDQEgAiAFRg0AQQQhByAJIABBBGoiAmotAAAiDUEjRw0BIAIgBUYNAEEFIQcgCSAAQQVqIgJqLQAAIg1BI0cNASACIAVGDQBBBiEHIAkgAEEGaiICai0AACINQSNHDQEgAiAFRw0DIAEgAGsiB0EGSg0DDAILIAEgAGsiB0EGSg0CDAELAkACQCAGLQAMQQJxDQAgAiADTw0AIA1BCWtB/wFxIgFBF0sNA0GTgIAEIAF2QQFxRQ0DDAELIAIgA0kNACACIQEMAQsDQCACIAlqLQAAQSBHBEAgAiEBDAILIAJBAWoiAiADRw0ACyADIQELIBcgATYCACAGIAE2AsgEIAwgB0EQdEECcjYCAAwCCyAAIQELAkAgASADTw0AIAEgCWoiBS0AACICQTxHBEAgASEAIAJB/gBHIAJB4ABHcQ0BAkADQCAAIAlqLQAAIAJHDQEgAEEBaiIAIANHDQALIAMhAAsgACABayIHQQNPBEAgBiAHNgKABAJAAkACQCAAIANPDQADQCAAIAlqLQAAQSBHDQEgAEEBaiIAIANHDQALDAELIAAgA08NAQNAAkAgACAJai0AACICQQprDgQDAAADAAsgAkHgAEYEQCAFLQAAQeAARg0GCyAAQQFqIgAgA0cNAAsLIAMhAAsgBiAANgLIBCAMQYaABDYCAAwDCyACQTxHDQELIAYtAAxBIHENACABQQFqIQkCQAJAAkACQCAGKAIEIgMgAUEHakkNACAGKAIAIAlqIgAtAAAiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQdMARw0AIAAtAAEiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQcMARw0AIAAtAAIiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQdIARw0AIAAtAAMiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQckARw0AIAAtAAQiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQdAARw0AQQEhAiAALQAFIgBBIGsgACAAQeEAa0H/AXFBGkkbQf8BcUHUAEYNAQsCQCABQQRqIgUgA0sNACAGKAIAIAlqIgAtAAAiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQdAARw0AIAAtAAEiAkEgayACIAJB4QBrQf8BcUEaSRtB/wFxQdIARw0AQQEhAiAALQACIgBBIGsgACAAQeEAa0H/AXFBGkkbQf8BcUHFAEYNAQsCQCABQQZqIANLDQAgBigCACAJaiIALQAAIgJBIGsgAiACQeEAa0H/AXFBGkkbQf8BcUHTAEcNACAALQABIgJBIGsgAiACQeEAa0H/AXFBGkkbQf8BcUHUAEcNACAALQACIgJBIGsgAiACQeEAa0H/AXFBGkkbQf8BcUHZAEcNACAALQADIgJBIGsgAiACQeEAa0H/AXFBGkkbQf8BcUHMAEcNAEEBIQIgAC0ABCIAQSBrIAAgAEHhAGtB/wFxQRpJG0H/AXFBxQBGDQELAkAgAyAFTQ0AIAYoAgAiACAJai0AAEEhRw0AIAAgAWoiAC0AAkEtRw0AQQIhAiAALQADQS1GDQELAkAgAyAJTQ0AIAYoAgAiACAJaiIFLQAAIgJBP0YEQEEDIQIgBkEDNgKEBAwDCyACQSFHDQAgAyABQQJqIgdLBEBBBCECIAAgB2otAABBwQBrQf8BcUEaSQ0CCyABQQlqIANPDQAgBSkAAEKhto2ilIjVoNsAUg0AQQUhAiAGQQU2AoQEDAILAkAgAUECaiIAIANPDQAgBigCACIHIAlqLQAAIgJB3wFxQcEAa0H/AXFBGk8EQCACQS9HDQEgACAHai0AAEHfAXFBwQBrQf8BcUEZSw0BC0EAIRBBv39Bn38gByAAIAkgAkEvRhsiCWoiFCwAACIAQcEAa0H/AXFBGkkbIABqQQJ0QbAYaigCACICKAIAIgVFDQADQAJAAkAgCSACIBBBA3RqLQAEIhFqIg0gA0sNAEEAIQAgEUUNAQNAIAAgFGotAAAiE0EgayATIBNB4QBrQf8BcUEaSRtB/wFxIAAgBWotAAAiE0EgayATIBNB4QBrQf8BcUEaSRtB/wFxRw0BIBEgAEEBaiIARw0ACwwBCyACIBBBAWoiEEEDdGooAgAiBQ0BDAILC0EGIQIgAyANTQ0BIAcgDWotAAAiAEEJayIFQRdNQQBBASAFdEGTgIAEcRsNASAAQT5GDQEgDUEBaiIFIANPDQAgAEEvRw0AIAUgB2otAABBPkYNAQsgCUEBaiADTw0CIAZBAEEAIAEgAyAGQegEahAlRQ0CAkAgBigC6AQiACADTw0AIAYoAgAhAgNAIAAgAmotAABBCWsiBUEXSw0EQQEgBXQiBUGNgIAEcUUEQCAFQRJxDQIMBQsgAEEBaiIAIANHDQALC0EHIQIgBkEHNgKEBCAPLwEAQQhGDQIMAQsgBiACNgKEBAsgBiABIAZByARqEDEgAkYEQCAGQQA2AoQECyAMQQc7AQAMAgsgBkEANgKEBAsCQCAGKAIMIgdBgAJxRQ0AIA8vAQBBCEcNACABIAYoAgQiAk8NAAJAAkAgBigCACIDIAFqLQAAIgBBLWsODgECAgICAgICAgICAgIBAAsgAEH8AEcNAQsgCCAGKAL0A0cNACAGKALkAyIFRQ0AIAUoAgRBAUcNAEEAIQUCQCAAQfwARwRAQQAhEAwBC0EBIRAgAUEBaiIBIAJPDQADQCABIANqLQAAQQlrIgBBF0sNAUEBIAB0QY2AgARxRQ0BIAFBAWoiASACRw0ACyACIQELA0AgAiABIgBLBEAgASABIANqLQAAQTpGaiEACwJAIAAgAk8NAAJAA0AgACADai0AACIJQS1HDQEgAEEBaiIAIAJHDQALIAIhAAwBCyAAIAlBOkZqIQALIAAgAWtBA0kNAUEBIQ0gBUEBaiEFAkACQAJAAkACQCAAIAJJBEACQANAIAAgA2otAAAiAUEJayIJQRdLDQFBASAJdEGNgIAEcUUNASAAQQFqIgAgAkcNAAsgAiEBDAQLIAFB/ABGDQELIAAhAQwBC0EBIRBBACENIABBAWoiASACTw0AA0AgASADai0AAEEJayIAQRdLDQFBASAAdEGNgIAEcUUNASABQQFqIgEgAkkNAAsgAiEBDAILIAEgAk8NACABIANqLQAAQQprDgQAAgIAAgsgEEUNAwsgBiABNgLIBCAMIAVBEHRBCnI2AgAMAwsgDUUNAAsLIAxBCDsBACAGKAL0AyIAIAggCyAORhsgCCAPLwEAQQhGGyEIIAdBgBBxRQ0AIAsgEmpBAEwNACAGKALwAyAAQQFrQRhsaiIDLQAAIgBFDQAgAEE/Sw0AQgEgAK2GQoGAgICAwBuDUA0AAkAgBigCyAQiACAGKAIEIgIgAEEDaiIBIAEgAksbIgFPDQAgBigCACEFA0AgACAFai0AACIHQSBHIAdBCUdxDQEgAEEBaiIAIAFHDQALIAEhAAsgAEECaiIFIAJPDQAgBigCACIBIABqLQAAQdsARw0AIAEgAEEBaiIHaiwAACIORQ0AQcoRIA5BBBAGRQ0AIAEgBWotAABB3QBHDQAgAiAAQQNqIgBHBEAgACABai0AAEEJayIBQRdLDQFBASABdEGTgIAEcUUNAQsgA0EBaiAhIBIbQQE6AAEgA0EUaiAgIBIbIAc2AgAgBigCACEBA0ACQCAAIAFqLQAAQQlrIgJBF0sNAEEBIAJ0QY2AgARxRQ0AIABBAWohAAwBCwsgBiAANgLIBCAXIAA2AgALAkAgBigCyAQiAEEDaiICIAYoAgQiAU8NACAGKAIAIQMDQAJAIAAgA2oiBS0AAEEKaw4EAgAAAgALAkAgBS0AAUEKaw4EAgAAAgALAkAgBS0AAkEKaw4EAgAAAgALAkAgAiADai0AAEEKaw4EAgAAAgALIABBB2ohAiAAQQRqIQAgASACSw0ACwtBACEFAkAgACABTw0AQQEhBSAGKAIAIQIDQAJAIAAgAmotAABBCmsOBAIAAAIACyAAQQFqIgAgAUkhBSAAIAFHDQALIAEhAAsgBiAANgLIBCAfIB4gGhsgFkEIaiAbGyIPIAA2AgACfyAAIAwvAQAiDUECRw0AGiAAIBcoAgAiDiAAIA5JGyEHIAYoAgAhCSAAIQMDQAJAIA4gAyICTwRAIAchAgwBCyAJIAJBAWsiA2otAABBIEYNAQsLIAIgDiACIA5JGyEHA0ACQCAOIAIiA08EQCAHIQMMAQsgCSADQQFrIgJqLQAAQSNGDQELCwJAIAMgDkYNACADIAlqQQFrLQAAQSBGDQAgACAGLQAMQQJxRQ0BGgsgDyADNgIAIAMLIQICQCANQQVrQQJJDQAgAiAXKAIAIgNNDQAgBigCACEHA0AgByACQQFrIgJqLQAAQSBHDQEgDyACNgIAIAIgA0sNAAsLIAVBAXEEQCAAIAYoAgAgAGotAABBDUZqIQALAkAgACABTw0AIAYoAgAgAGotAABBCkcNACAGIABBAWoiADYCyAQLAkAgJ0UNACANRQ0AIAggC2oiAUEATA0AIAYoAvADIAFBAWtBGGxqIgEtAABBPkYNACAGKALgAyABKAIQaiIBIAEoAgBBgAhyNgIACwJAIBINACAIIAtqIgEgBigC9ANODQAgBiABECAiCUEASA0ICwJAIAtBAEoEQCAIQRhsIgUgBigC8ANqIgEoAhQhA0GEBCEIIAEvAAFBgAJPBEAgBigCACADaiwAAEEQdEGEBHIhCAtBfyEJIAYQBUEASA0JAkAgBigC6AMiB0EIaiICIAYoAuwDIgFKBEAgBkGABCABQQF2IAFqIAFBAEwbIgE2AuwDIAYoAuADIAEQAiICRQ0DIAYoAuQDIgEEQCAGIAIgASAGKALgA2tqNgLkAwsgBiACNgLgAyAGIAYoAugDIgdBCGo2AugDDAELIAYgAjYC6AMgBigC4AMiAkUNCgsgAiAHaiIBIAM2AgQgASAINgIAQYQCIQggBigCnAUhASAGLwCJBSILQYACTwRAIAYoAgAgAWosAABBEHRBhAJyIQgLIAYQBUEASA0JAkAgBigC6AMiB0EIaiIDIAYoAuwDIgJKBEAgBkGABCACQQF2IAJqIAJBAEwbIgI2AuwDIAYoAuADIAIQAiIDRQ0DIAYoAuQDIgIEQCAGIAMgAiAGKALgA2tqNgLkAwsgBiADNgLgAyAGIAYoAugDIgdBCGo2AugDDAELIAYgAzYC6AMgBigC4AMiA0UNCgsgAyAHaiICIAE2AgQgAiAINgIAIAYoAvADIAVqIAtBCHY6AAIgBigC8AMgBWogATYCFAsgEgRAIAYoAvQDIBJrIQEDQEGCAiEIAkACQEEBIAYoAvADIAFBGGxqIgIsAABBKWt0IgNBFnFFBEAgA0EhcUUNAUGDAiEICyAGEAUaIAIgBigC6AM2AhAgAigCBCEFIAIsAAAhC0F/IQkgBhAFQQBIDQwCQCAGKALoAyIHQQhqIg4gBigC7AMiA0oEQCAGQYAEIANBAXYgA2ogA0EATBsiAzYC7AMgBigC4AMgAxACIgNFDQYgBigC5AMiBwRAIAYgAyAHIAYoAuADa2o2AuQDCyAGIAM2AuADIAYgBigC6AMiB0EIajYC6AMMAQsgBiAONgLoAyAGKALgAyIDRQ0NCyADIAdqIgMgBTYCBCADIAtBEHQgCHI2AgAgAigCFCEDQQAhCCACLwABQYACTwRAIAYoAgAgA2osAAAhCAsgBhAFQQBIDQwCQCAGKALoAyIHQQhqIgUgBigC7AMiAkoEQCAGQYAEIAJBAXYgAmogAkEATBsiAjYC7AMgBigC4AMgAhACIgJFDQYgBigC5AMiBQRAIAYgAiAFIAYoAuADa2o2AuQDCyAGIAI2AuADIAYgBigC6AMiB0EIajYC6AMMAQsgBiAFNgLoAyAGKALgAyICRQ0NCyACIAdqIgIgCEEQdEGEAnI2AgAMAQtBfyEJIAYQBUEASA0LAkAgBigC6AMiA0EIaiIFIAYoAuwDIgJKBEAgBkGABCACQQF2IAJqIAJBAEwbIgI2AuwDIAYoAuADIAIQAiICRQ0FIAYoAuQDIgMEQCAGIAIgAyAGKALgA2tqNgLkAwsgBiACNgLgAyAGIAYoAugDIgNBCGo2AugDDAELIAYgBTYC6AMgBigC4AMiAkUNDAsgAiADaiICQYECNgIAQQAhAwsgAiADNgIEIAFBAWoiASAGKAL0A0gNAAsLAkACQAJAAkACQAJAAkAgDCgCAEH//wNxIgEOCwABAQQCBAQEBAQDBAtBACEBQaQTIQIgBhAFQQBODQVBfyEDDAQLQX8hAyAGEAVBAEgNAwJ/IAYoAugDIgJBCGoiBSAGKALsAyIBSgRAIAZBgAQgAUEBdiABaiABQQBMGyIBNgLsAyAGKALgAyABEAIiAUUEQCAGKAIkIgFFDQZB/Q4gBigCLCABEQAADAYLIAYoAuQDIgIEQCAGIAEgAiAGKALgA2tqNgLkAwsgBiAGKALoAyICQQhqNgLoAyAGIAE2AuADIAEgAmoMAQsgBiAFNgLoAyAGKALgAyIBRQ0EIAEgAmoLIgEgDC8BAEEBa8FBAnRB+DtqKAIAIgIgAS8BAkEQdHI2AgAgDC8BAiEFIAFBADYCBCABIAIgBUEQdHI2AgAgBiABNgLkAyAGIAwQFkEASA0DQQAhAUGkEyECIAYQBUEASA0DDAQLIAYoAuQDQQY6AAAgBigC5AMgDC8BAjsBAiAGKALkAyIBIAEoAgBBgBByNgIAQX8hAyAGIAwQFkEASA0CIAYQBUEASA0CQQAhASAGKALkA0UEQEGkEyECDAQLIAxBCDsBACAMIQIMAwsgBigC5ANBCjoAACAMLwECIQEgBigC5AMhAiAKQQk7AQAgAiABOwECQQAhASAGIAwQFkEATgRAIAohAgwDC0F/IQMMAQsCQCAKLwEAIAFzRQ0AIAYQBUEATg0AQX8hAwwBCwJAIAYoAuQDRQRAAn8gBigC6AMiAkEIaiIDIAYoAuwDIgFKBEAgBkGABCABQQF2IAFqIAFBAEwbIgE2AuwDIAYoAuADIAEQAiIBRQRAQX8hAyAGKAIkIgFFDQVB/Q4gBigCLCABEQAADAULIAYoAuQDIgIEQCAGIAEgAiAGKALgA2tqNgLkAwsgBiAGKALoAyICQQhqNgLoAyAGIAE2AuADIAEgAmoMAQsgBiADNgLoAyAGKALgAyIBRQ0CIAEgAmoLIgEgDC8BAEEBa8FBAnRB+DtqKAIAIgIgAS8BAkEQdHI2AgAgDC8BAiEDIAFBADYCBCABIAIgA0EQdHI2AgAgBiABNgLkAyAMIQoLIAYgDBAWIQMMAQtBfyEDCyAKIQIgAyEBC0F/IQkgAUEATg0HDAgLIAYoAiQiAEUNBwtB/Q4gBigCLCAAEQAAC0F/IQkMBQsgBiABQQFqIgE2ApQFCyALIBA2AgggCyABNgIMQaQTIQ9BACEUIA0hCwwACwALAAsACyAGKAJAQQBKBEBBACEAA0AgBigCPCAAQQV0aiIBLQAcIgJBAXEEfyABKAIAEAMgAS0AHAUgAgtBAnEEQCABKAIEEAMLIABBAWoiACAGKAJASA0ACwsgBigCPBADIAYoAkgiAARAIAYoAkwiAUEASgR/QQAhAANAAkAgBigCSCAAQQJ0aigCACICRQ0AIAIgBigCPCIDTwRAIAIgAyAGKAJAQQV0akkNAQsgAhADIAYoAkwhAQsgAEEBaiIAIAFIDQALIAYoAkgFIAALEAMLIAYoAjQQAyAGKAJQEAMgBigC4AMQAyAGKALwAxADIBkoAhwQAyAGQbAFaiQAIAkEQEHkwABBlQk2AgBBkMkAQQE2AgBBAAwCCyAEQZTJACgCADYCAEGcyQAoAgBBlMkAKAIAayEHDAILQeTAAEHkCDYCAEGQyQBBAjYCAEEACyEHIARBADYCAAsgFUEwaiQAIAcLCAAgACABEAILBgAgABADCwkAQeTAACgCAAsJAEGQyQAoAgALFABB5MAAQQA2AgBBkMkAQQA2AgALC9U1GwBBgAgLows/IS4sOipffgB8AHN1bW1hcnkAdGJvZHkAd3d3AGRpdgBuYXYAbWVudQB0Zm9vdABiYXNlZm9udABmcmFtZXNldABmaWVsZHNldABkdABhZGRyZXNzAGh0dHBzAGRldGFpbHMAbm8gb3V0cHV0IGZvcm1hdCBzZXQgaW4gb3V0cHV0IGZsYWdzAG5vZnJhbWVzAHRyAG1kIHBhcnNlciBlcnJvcgBkaXIAaHIAZm9vdGVyAGNlbnRlcgBoZWFkZXIAb3B0Z3JvdXAAY29sZ3JvdXAAZnRwAG9wdGlvbgBmaWdjYXB0aW9uAHNlY3Rpb24AbWFpbgBmb3JtAG1lbnVpdGVtAHBhcmFtAHVsAGNvbABodG1sAGRsAGxpbmsAdHJhY2sAPGxpADx0aABkaWFsb2cAYmxvY2txdW90ZQBiYXNlAGZpZ3VyZQBpZnJhbWUAdGl0bGUAYXJ0aWNsZQB0YWJsZQA8cHJlPjxjb2RlAGFzaWRlAHNvdXJjZQA8dGQAbGVnZW5kACBkaXNhYmxlZAAgY2hlY2tlZABkZAB0aGVhZAAiJz08PmAALi1fACpffihbADx1PgA8cD4APHgtZXF1YXRpb24+ADwveC1lcXVhdGlvbj4APC9lbT4APGRlbD4APC9kZWw+ADwveC13aWtpbGluaz4APC9zdHJvbmc+ADxjb2RlPgA8L2NvZGU+ACI+PC9hPgBdXT4APGg2PgA8aDU+ADxoND4APGgzPgA8aDI+ADxoMT4AIiAvPgAtLT4APHgtZXF1YXRpb24gdHlwZT0iZGlzcGxheSI+ACBhbGlnbj0icmlnaHQiPgAgYWxpZ249ImxlZnQiPgAgYWxpZ249ImNlbnRlciI+ACZxdW90OwAmYW1wOwBqYXZhc2NyaXB0OgBtYWlsdG86AGgxAGh0dHA6Ly8AQWJvcnRlZCBmcm9tIHRleHQoKSBjYWxsYmFjay4AQWJvcnRlZCBmcm9tIGVudGVyX3NwYW4oKSBjYWxsYmFjay4AQWJvcnRlZCBmcm9tIGxlYXZlX3NwYW4oKSBjYWxsYmFjay4AQWJvcnRlZCBmcm9tIGVudGVyX2Jsb2NrKCkgY2FsbGJhY2suAEFib3J0ZWQgZnJvbSBsZWF2ZV9ibG9jaygpIGNhbGxiYWNrLgBtYWxsb2MoKSBmYWlsZWQuAHJlYWxsb2MoKSBmYWlsZWQuACpffiRAOi4ALiEjJCUmJyorLz0/Xl9ge3x9fi0AIGNsYXNzPSJsYW5ndWFnZS0AXy46LQAuLV8rAC1fKgAmACIgY2xhc3M9ImFuY2hvciIgYXJpYS1oaWRkZW49InRydWUiIGhyZWY9IiMAIGNsYXNzPSJ0YXNrLWxpc3QtaXRlbSI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBjbGFzcz0idGFzay1saXN0LWl0ZW0tY2hlY2tib3giACBkaXNhYmxlZD0iZGlzYWJsZWQiACBjaGVja2VkPSJjaGVja2VkIgA8b2wgc3RhcnQ9IgAiIGFsdD0iADx4LXdpa2lsaW5rIGRhdGEtdGFyZ2V0PSIAPGEgaHJlZj0iACIgdGl0bGU9IgA8YSBpZD0iADxpbWcgc3JjPSIAW10hAHhYIAA8L3Rib2R5PgoAPHRyPgoAPC90cj4KADxocj4KADxicj4KADwvcD4KADx1bD4KADwvdWw+CgA8b2w+CgA8L29sPgoAPC9saT4KADwvdGg+CgA8YmxvY2txdW90ZT4KADwvYmxvY2txdW90ZT4KADwvY29kZT48L3ByZT4KADwvdGFibGU+CgA8L3RkPgoAPC90aGVhZD4KADwvaDY+CgA8L2g1PgoAPC9oND4KADwvaDM+CgA8L2gyPgoAPC9oMT4KADxociAvPgoAPGJyIC8+CgAiPgoAQcATCxVOBAAABwAAAFcFAAAHAAAAcAUAAAUAQeATCx0+BQAABAAAADAEAAAIAAAAMwUAAAoAAAAUBAAABABBkBQLHeEEAAAHAAAAswQAAAYAAAANBQAAAwAAAMoEAAAIAEHAFAs1mwUAAAIAAABcBAAABwAAACwFAAAGAAAApQQAAAMAAAAdBAAAAwAAABYFAAACAAAASwQAAAIAQYAVCzVCBAAACAAAAN4EAAAKAAAAQwUAAAYAAACsBAAABgAAAPYEAAAEAAAASwUAAAUAAAA5BAAACABBwBULJbEGAAACAAAAnwUAAAQAAAC6BAAABgAAAKkEAAACAAAAEQUAAAQAQfAVCwVKBQAABgBBgBYLFYEFAAAGAAAAJQUAAAIAAAAZBQAABABBoBYLFfEEAAAEAAAAJQQAAAQAAAD7BAAACABBwBYLDSEEAAADAAAAiQQAAAgAQeAWCxUOBQAAAgAAAMEEAAAIAAAA1wQAAAYAQYAXCw3VBAAAAQAAAAQFAAAFAEGgFwsV6QQAAAcAAAB2BQAABgAAAAsEAAAHAEHAFwtFXwUAAAUAAAATBAAABQAAAH4FAAACAAAAKgQAAAUAAAApBQAAAgAAAJ4FAAAFAAAAUQUAAAUAAACSBAAAAgAAAB4FAAAFAEGQGAsFCgUAAAIAQbAYC2bACQAA4AkAABAKAABACgAAIAwAAIAKAAAgDAAAwAoAAPAKAAAgDAAAIAwAAAALAAAgCwAAQAsAAGALAACACwAAIAwAACAMAACgCwAAwAsAABAMAAAgDAAAIAwAACAMAAAgDAAAIAwAQaAZC+QIIAAAAKAAAACAFgAAACAAQAogAIAvIAAAXyAAAAAwAABBAABAWgAAgLUAAADAAABA1gAAgNgAAEDeAACAAAEAQC4BAIAyAQBANgEAgDkBAEBHAQCASgEAQHYBAIB4AQAAeQEAQH0BAIB/AQAAgQEAAIIBAACEAQAAhgEAAIcBAACJAQAAigEAAIsBAACOAQAAjwEAAJABAACRAQAAkwEAAJQBAACWAQAAlwEAAJgBAACcAQAAnQEAAJ8BAACgAQBApAEAgKYBAACnAQAAqQEAAKwBAACuAQAArwEAALEBAACyAQAAswEAALUBAAC3AQAAuAEAALwBAADEAQAAxQEAAMcBAADIAQAAygEAAMsBAEDbAQCA3gEAQO4BAIDxAQAA8gEAAPQBAAD2AQAA9wEAAPgBAEAeAgCAIAIAACICAEAyAgCAOgIAADsCAAA9AgAAPgIAAEECAABDAgAARAIAAEUCAABGAgBATgIAgEUDAABwAwAAcgMAAHYDAAB/AwAAhgMAAIgDAECKAwCAjAMAAI4DAACPAwAAkQMAQKEDAICjAwBAqwMAgMIDAADPAwAA0AMAANEDAADVAwAA1gMAANgDAEDuAwCA8AMAAPEDAAD0AwAA9QMAAPcDAAD5AwAA+gMAAP0DAED/AwCAAAQAQA8EAIAQBABALwQAgGAEAECABACAigQAQL4EAIDABAAAwQQAQM0EAIDQBABALgUAgDEFAEBWBQCAoBAAQMUQAIDHEAAAzRAAAPgTAED9EwCAgBwAAIEcAACCHAAAgxwAAIQcAACFHAAAhhwAAIccAACIHAAAkBwAQLocAIC9HABAvxwAgAAeAECUHgCAmx4AAKAeAED+HgCACB8AQA8fAIAYHwBAHR8AgCgfAEAvHwCAOB8AQD8fAIBIHwBATR8AgFkfAABbHwAAXR8AAF8fAABoHwBAbx8AgLgfAAC5HwAAuh8AALsfAAC+HwAAyB8AQMsfAIDYHwAA2R8AANofAADbHwAA6B8AAOkfAADqHwAA6x8AAOwfAAD4HwAA+R8AAPofAAD7HwAAJiEAACohAAArIQAAMiEAAGAhAEBvIQCAgyEAALYkAEDPJACAACwAQC4sAIBgLAAAYiwAAGMsAABkLAAAZywAQGssAIBtLAAAbiwAAG8sAABwLAAAciwAAHUsAAB+LAAAfywAAIAsAEDiLACA6ywAAO0sAADyLAAAQKYAQGymAICApgBAmqYAgCKnAEAupwCAMqcAQG6nAIB5pwAAe6cAAH2nAAB+pwBAhqcAgIunAACNpwAAkKcAAJKnAACWpwBAqKcAgKqnAACrpwAArKcAAK2nAACupwAAsKcAALGnAACypwAAs6cAALSnAEC+pwCAwqcAAMSnAADFpwAAxqcAAMenAADJpwAA9acAAHCrAEC/qwCAIf8AQDr/AIAABAFAJwQBgLAEAUDTBAGAgAwBQLIMAYCgGAFAvxgBgEBuAUBfbgGAAOkBQCHpAYAAQZAiC8MIYQAAAHoAAAC8AwAA4AAAAPYAAAD4AAAA/gAAAAEBAAAvAQAAMwEAADcBAAA6AQAASAEAAEsBAAB3AQAA/wAAAHoBAAB+AQAAcwAAAFMCAACDAQAAhQEAAFQCAACIAQAAVgIAAFcCAACMAQAA3QEAAFkCAABbAgAAkgEAAGACAABjAgAAaQIAAGgCAACZAQAAbwIAAHICAAB1AgAAoQEAAKUBAACAAgAAqAEAAIMCAACtAQAAiAIAALABAACKAgAAiwIAALQBAAC2AQAAkgIAALkBAAC9AQAAxgEAAMYBAADJAQAAyQEAAMwBAADMAQAA3AEAAN8BAADvAQAA8wEAAPMBAAD1AQAAlQEAAL8BAAD5AQAAHwIAAJ4BAAAjAgAAMwIAAGUsAAA8AgAAmgEAAGYsAABCAgAAgAEAAIkCAACMAgAARwIAAE8CAAC5AwAAcQMAAHMDAAB3AwAA8wMAAKwDAACtAwAArwMAAMwDAADNAwAAzgMAALEDAADBAwAAwwMAAMsDAADDAwAA1wMAALIDAAC4AwAAxgMAAMADAADZAwAA7wMAALoDAADBAwAAuAMAALUDAAD4AwAA8gMAAPsDAAB7AwAAfQMAAFAEAABfBAAAMAQAAE8EAABhBAAAgQQAAIsEAAC/BAAAzwQAAMIEAADOBAAA0QQAAC8FAABhBQAAhgUAAAAtAAAlLQAAJy0AAC0tAADwEwAA9RMAADIEAAA0BAAAPgQAAEEEAABCBAAAQgQAAEoEAABjBAAAS6YAANAQAAD6EAAA/RAAAP8QAAABHgAAlR4AAGEeAAChHgAA/x4AAAAfAAAHHwAAEB8AABUfAAAgHwAAJx8AADAfAAA3HwAAQB8AAEUfAABRHwAAUx8AAFUfAABXHwAAYB8AAGcfAACwHwAAsR8AAHAfAABxHwAAuQMAAHIfAAB1HwAA0B8AANEfAAB2HwAAdx8AAOAfAADhHwAAeh8AAHsfAADlHwAAeB8AAHkfAAB8HwAAfR8AAMkDAABrAAAA5QAAAE4hAABwIQAAfyEAAIQhAADQJAAA6SQAADAsAABeLAAAYSwAAGsCAAB9HQAAfQIAAGgsAABsLAAAUQIAAHECAABQAgAAUgIAAHMsAAB2LAAAPwIAAEACAACBLAAA4ywAAOwsAADuLAAA8ywAAEGmAABtpgAAgaYAAJumAAAjpwAAL6cAADOnAABvpwAAeqcAAHynAAB5HQAAf6cAAIenAACMpwAAZQIAAJGnAACTpwAAl6cAAKmnAABmAgAAXAIAAGECAABsAgAAagIAAJ4CAACHAgAAnQIAAFOrAAC1pwAAv6cAAMOnAACUpwAAggIAAI4dAADIpwAAyqcAAPanAACgEwAA7xMAAEH/AABa/wAAKAQBAE8EAQDYBAEA+wQBAMAMAQDyDAEAwBgBAN8YAQBgbgEAf24BACLpAQBD6QEAQeAqC7AH3wAAADABAABJAQAA8AEAAIcFAACWHgAAlx4AAJgeAACZHgAAmh4AAJ4eAABQHwAAgB8AQIcfAICIHwBAjx8AgJAfAECXHwCAmB8AQJ8fAICgHwBApx8AgKgfAECvHwCAsh8AALMfAAC0HwAAth8AALwfAADCHwAAwx8AAMQfAADGHwAAzB8AANYfAADkHwAA5h8AAPIfAADzHwAA9B8AAPYfAAD8HwAAAPsAAAH7AAAC+wAABfsAAAb7AAAT+wAAFPsAABX7AAAW+wAAF/sAAHMAAABzAAAAaQAAAAcDAAC8AgAAbgAAAGoAAAAMAwAAZQUAAIIFAABoAAAAMQMAAHQAAAAIAwAAdwAAAAoDAAB5AAAACgMAAGEAAAC+AgAAcwAAAHMAAADFAwAAEwMAAAAfAAC5AwAABx8AALkDAAAAHwAAuQMAAAcfAAC5AwAAIB8AALkDAAAnHwAAuQMAACAfAAC5AwAAJx8AALkDAABgHwAAuQMAAGcfAAC5AwAAYB8AALkDAABnHwAAuQMAAHAfAAC5AwAAsQMAALkDAACsAwAAuQMAALEDAABCAwAAsQMAALkDAAB0HwAAuQMAALcDAAC5AwAArgMAALkDAAC3AwAAQgMAALcDAAC5AwAAuQMAAEIDAADBAwAAEwMAAMUDAABCAwAAfB8AALkDAADJAwAAuQMAAM4DAAC5AwAAyQMAAEIDAADJAwAAuQMAAGYAAABmAAAAZgAAAGkAAABmAAAAbAAAAHMAAAB0AAAAcwAAAHQAAAB0BQAAdgUAAHQFAABlBQAAdAUAAGsFAAB+BQAAdgUAAHQFAABtBQAAkAMAALADAABSHwAAVB8AAFYfAAC3HwAAxx8AANIfAADTHwAA1x8AAOIfAADjHwAA5x8AAPcfAAAD+wAABPsAALkDAAAIAwAAAQMAAMUDAAAIAwAAAQMAAMUDAAATAwAAAAMAAMUDAAATAwAAAQMAAMUDAAATAwAAQgMAALEDAABCAwAAuQMAALcDAABCAwAAuQMAALkDAAAIAwAAAAMAALkDAAAIAwAAAQMAALkDAAAIAwAAQgMAAMUDAAAIAwAAAAMAAMUDAAAIAwAAAQMAAMUDAAAIAwAAQgMAAMkDAABCAwAAuQMAAGYAAABmAAAAaQAAAGYAAABmAAAAbAAAAMAMAAAQEQAAEQEAAAEAAABgFQAAMBYAADQAAAACAAAA0BcAABAYAAAQAAAAAwAAACAgICAgICAgICAgICAgICAAQaQyC/EJAQAAAAMAAAACAAAAIQAAQCMAAIAlAABAKgAAgCwAAEAvAACAOgAAQDsAAIA/AABAQAAAgFsAAEBdAACAXwAAAHsAAAB9AAAAoQAAAKcAAACrAAAAtgAAQLcAAIC7AAAAvwAAAH4DAACHAwAAWgUAQF8FAICJBQBAigUAgL4FAADABQAAwwUAAMYFAADzBQBA9AUAgAkGAEAKBgCADAYAQA0GAIAbBgAAHgYAQB8GAIBqBgBAbQYAgNQGAAAABwBADQcAgPcHAED5BwCAMAgAQD4IAIBeCAAAZAkAQGUJAIBwCQAA/QkAAHYKAADwCgAAdwwAAIQMAAD0DQAATw4AAFoOAEBbDgCABA8AQBIPAIAUDwAAOg8AQD0PAICFDwAA0A8AQNQPAIDZDwBA2g8AgEoQAEBPEACA+xAAAGATAEBoEwCAABQAAG4WAACbFgBAnBYAgOsWAEDtFgCANRcAQDYXAIDUFwBA1hcAgNgXAEDaFwCAABgAQAoYAIBEGQBARRkAgB4aAEAfGgCAoBoAQKYaAICoGgBArRoAgFobAEBgGwCA/BsAQP8bAIA7HABAPxwAgH4cAEB/HACAwBwAQMccAIDTHAAAECAAQCcgAIAwIABAQyAAgEUgAEBRIACAUyAAQF4gAIB9IABAfiAAgI0gAECOIACACCMAQAsjAIApIwBAKiMAgGgnAEB1JwCAxScAQMYnAIDmJwBA7ycAgIMpAECYKQCA2CkAQNspAID8KQBA/SkAgPksAED8LACA/iwAQP8sAIBwLQAAAC4AQC4uAIAwLgBATy4AgFIuAAABMABAAzAAgAgwAEARMACAFDAAQB8wAIAwMAAAPTAAAKAwAAD7MAAA/qQAQP+kAIANpgBAD6YAgHOmAAB+pgAA8qYAQPemAIB0qABAd6gAgM6oAEDPqACA+KgAQPqoAID8qAAALqkAQC+pAIBfqQAAwakAQM2pAIDeqQBA36kAgFyqAEBfqgCA3qoAQN+qAIDwqgBA8aoAgOurAAA+/QBAP/0AgBD+AEAZ/gCAMP4AQFL+AIBU/gBAYf4AgGP+AABo/gAAav4AQGv+AIAB/wBAA/8AgAX/AEAK/wCADP8AQA//AIAa/wBAG/8AgB//AEAg/wCAO/8AQD3/AIA//wAAW/8AAF3/AABf/wBAZf8AgAABAUACAQGAnwMBANADAQBvBQEAVwgBAB8JAQA/CQEAUAoBQFgKAYB/CgEA8AoBQPYKAYA5CwFAPwsBgJkLAUCcCwGArQ4BAFUPAUBZDwGARxABQE0QAYC7EAFAvBABgL4QAUDBEAGAQBEBQEMRAYB0EQFAdREBgMURAUDIEQGAzREBANsRAQDdEQFA3xEBgDgSAUA9EgGAqRIBAEsUAUBPFAGAWhQBQFsUAYBdFAEAxhQBAMEVAUDXFQGAQRYBQEMWAYBgFgFAbBYBgDwXAUA+FwGAOxgBAEQZAUBGGQGA4hkBAD8aAUBGGgGAmhoBQJwaAYCeGgFAohoBgEEcAUBFHAGAcBwBQHEcAYD3HgFA+B4BgP8fAQBwJAFAdCQBgG5qAUBvagGA9WoBADdrAUA7awGARGsBAJduAUCabgGA4m8BAJ+8AQCH2gFAi9oBgF7pAUBf6QGAPCFbQ0RBVEFbAAAABQAAAAYAAAAGAAAABQAAAAcAAAAHAAAACAAAAAkAQaA8Cxs2BgAAMQYAACwGAAAnBgAAIgYAAB0GAADvv70AQeI8CwUBAAAAAQBB/DwLAwEAAQBBwD4LFokJAACCCQAAewkAAHQJAABtCQAAZgkAQeA+C4ACLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS4tMDEyMzQ1Njc4OS0tLS0tLS1hYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ei0tLS1fLWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tYWFhYWFhYWNlZWVlaWlpaWRub29vb294b3V1dXV5LXNhYWFhYWFhY2VlZWVpaWlpZG5vb29vby1vdXV1dXkteQBB4MAACwagJAEAowk=",self.location).href;function Re(Ve){try{if(Ve==Be&&D)return new Uint8Array(D);if(I)return I(Ve);throw"both async and sync fetching of the wasm failed"}catch(Ye){ce(Ye)}}function ye(Ve){return D||!h&&!r||typeof fetch!="function"?Promise.resolve().then(()=>Re(Ve)):fetch(Ve,{credentials:"same-origin"}).then(Ye=>{if(!Ye.ok)throw"failed to load wasm binary file at '"+Ve+"'";return Ye.arrayBuffer()}).catch(()=>Re(Ve))}function ht(Ve,Ye,ae){return ye(Ve).then(_e=>WebAssembly.instantiate(_e,Ye)).then(_e=>_e).then(ae,_e=>{M("failed to asynchronously prepare wasm: "+_e),ce(_e)})}function oe(Ve,Ye){var ae=Be;return D||typeof WebAssembly.instantiateStreaming!="function"||Ee(ae)||p||typeof fetch!="function"?ht(ae,Ve,Ye):fetch(ae,{credentials:"same-origin"}).then(_e=>WebAssembly.instantiateStreaming(_e,Ve).then(Ye,function(Ze){return M("wasm streaming compile failed: "+Ze),M("falling back to ArrayBuffer instantiation"),ht(ae,Ve,Ye)}))}function Tt(Ve){for(;0<Ve.length;)Ve.shift()(t)}var Fe=[];function st(Ve){var Ye=Fe[Ve];return Ye||(Ve>=Fe.length&&(Fe.length=Ve+1),Fe[Ve]=Ye=z.get(Ve)),Ye}var Et=void 0,Ke=[],Ne=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,dt={b:function(Ve,Ye,ae){F.copyWithin(Ve,Ye,Ye+ae)},a:function(Ve){var Ye=F.length;if(Ve>>>=0,2147483648<Ve)return!1;for(var ae=1;4>=ae;ae*=2){var _e=Ye*(1+.2/ae);_e=Math.min(_e,Ve+100663296);var Ze=Math,nt=Ze.min;_e=Math.max(Ve,_e),_e+=(65536-_e%65536)%65536;e:{var ut=P.buffer;try{P.grow(nt.call(Ze,2147483648,_e)-ut.byteLength+65535>>>16),N();var ze=1;break e}catch{}ze=void 0}if(ze)return!0}return!1}};(function(){function Ve(ae){if(ae=ae.exports,t.asm=ae,P=t.asm.c,N(),z=t.asm.k,q.unshift(t.asm.d),de--,t.monitorRunDependencies&&t.monitorRunDependencies(de),de==0&&te){var _e=te;te=null,_e()}return ae}var Ye={a:dt};if(de++,t.monitorRunDependencies&&t.monitorRunDependencies(de),t.instantiateWasm)try{return t.instantiateWasm(Ye,Ve)}catch(ae){M("Module.instantiateWasm callback failed with error: "+ae),o(ae)}return oe(Ye,function(ae){Ve(ae.instance)}).catch(o),{}})(),t._wrealloc=function(){return(t._wrealloc=t.asm.e).apply(null,arguments)},t._wfree=function(){return(t._wfree=t.asm.f).apply(null,arguments)},t._WErrGetCode=function(){return(t._WErrGetCode=t.asm.g).apply(null,arguments)},t._WErrGetMsg=function(){return(t._WErrGetMsg=t.asm.h).apply(null,arguments)},t._WErrClear=function(){return(t._WErrClear=t.asm.i).apply(null,arguments)},t._parseUTF8=function(){return(t._parseUTF8=t.asm.j).apply(null,arguments)},t.addOnPostRun=se,t.addFunction=function(Ve,Ye){if(!Et){Et=new WeakMap;var ae=z.length;if(Et)for(var _e=0;_e<0+ae;_e++){var Ze=st(_e);Ze&&Et.set(Ze,_e)}}if(ae=Et.get(Ve)||0)return ae;if(Ke.length)ae=Ke.pop();else{try{z.grow(1)}catch(ze){throw ze instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":ze}ae=z.length-1}try{_e=ae,z.set(_e,Ve),Fe[_e]=z.get(_e)}catch(ze){if(!(ze instanceof TypeError))throw ze;if(typeof WebAssembly.Function=="function"){_e=WebAssembly.Function,Ze={i:"i32",j:"i64",f:"f32",d:"f64",p:"i32"};for(var nt={parameters:[],results:Ye[0]=="v"?[]:[Ze[Ye[0]]]},ut=1;ut<Ye.length;++ut)nt.parameters.push(Ze[Ye[ut]]);Ye=new _e(nt,Ve)}else{for(_e=[1],Ze=Ye.slice(0,1),Ye=Ye.slice(1),nt={i:127,p:127,j:126,f:125,d:124},_e.push(96),ut=Ye.length,128>ut?_e.push(ut):_e.push(ut%128|128,ut>>7),ut=0;ut<Ye.length;++ut)_e.push(nt[Ye[ut]]);Ze=="v"?_e.push(0):_e.push(1,nt[Ze]),Ye=[0,97,115,109,1,0,0,0,1],Ze=_e.length,128>Ze?Ye.push(Ze):Ye.push(Ze%128|128,Ze>>7),Ye.push.apply(Ye,_e),Ye.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),Ye=new WebAssembly.Module(new Uint8Array(Ye)),Ye=new WebAssembly.Instance(Ye,{e:{f:Ve}}).exports.f}_e=ae,z.set(_e,Ye),Fe[_e]=z.get(_e)}return Et.set(Ve,ae),ae},t.removeFunction=function(Ve){Et.delete(st(Ve)),Ke.push(Ve)},t.UTF8ArrayToString=function(Ve,Ye,ae){var _e=Ye+ae;for(ae=Ye;Ve[ae]&&!(ae>=_e);)++ae;if(16<ae-Ye&&Ve.buffer&&Ne)return Ne.decode(Ve.subarray(Ye,ae));for(_e="";Ye<ae;){var Ze=Ve[Ye++];if(Ze&128){var nt=Ve[Ye++]&63;if((Ze&224)==192)_e+=String.fromCharCode((Ze&31)<<6|nt);else{var ut=Ve[Ye++]&63;Ze=(Ze&240)==224?(Ze&15)<<12|nt<<6|ut:(Ze&7)<<18|nt<<12|ut<<6|Ve[Ye++]&63,65536>Ze?_e+=String.fromCharCode(Ze):(Ze-=65536,_e+=String.fromCharCode(55296|Ze>>10,56320|Ze&1023))}}else _e+=String.fromCharCode(Ze)}return _e};var xt;te=function Ve(){xt||ft(),xt||(te=Ve)};function ft(){function Ve(){if(!xt&&(xt=!0,t.calledRun=!0,!O)){if(Tt(q),i(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)se(t.postRun.shift());Tt(H)}}if(!(0<de)){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)W();Tt(X),0<de||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),Ve()},1)):Ve())}}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return ft(),e.ready}})();let Lr,lb=0;const Y$=async()=>(Lr=await W$(),Lr.addOnPostRun(()=>{lb=Lr._wrealloc(0,4)}),await Lr.ready),IF={COLLAPSE_WHITESPACE:1,PERMISSIVE_ATX_HEADERS:2,PERMISSIVE_URL_AUTO_LINKS:4,PERMISSIVE_EMAIL_AUTO_LINKS:8,NO_INDENTED_CODE_BLOCKS:16,NO_HTML_BLOCKS:32,NO_HTML_SPANS:64,TABLES:256,STRIKETHROUGH:512,PERMISSIVE_WWW_AUTOLINKS:1024,TASK_LISTS:2048,LATEX_MATH_SPANS:4096,WIKI_LINKS:8192,UNDERLINE:16384,DEFAULT:2823,NO_HTML:96,COMMONMARK:0,GITHUB:2820},Hm={HTML:1<<0,XHTML:1<<1,AllowJSURI:1<<2,DisableHeadlineAnchors:1<<3};function j$(n,e={}){if(!Lr)throw new Error("[markdown-wasm] markdown-wasm does not initialized. Use `await ready();` before `parse()` function.");const t=e.parseFlags===void 0?IF.DEFAULT:e.parseFlags;let i=e.allowJSURIs?Hm.AllowJSURI:0;switch(e.format){case"xhtml":i|=Hm.HTML|Hm.XHTML;break;case"html":case void 0:case null:i|=Hm.HTML;break;default:throw new Error(`[markdown-wasm] invalid format "${e.format}"`)}e.disableHeadlineAnchors&&(i|=Hm.DisableHeadlineAnchors);const o=e.onCodeBlock?q$(e.onCodeBlock):0,u=CF(n),h=K$(r=>J$(u,(p,g)=>Lr._parseUTF8(p,g,t,i,r,o)));return e.onCodeBlock&&Lr.removeFunction(o),$$(),h?e.bytes?h:new TextDecoder("utf-8").decode(h):null}function q$(n){return Lr.addFunction((t,i,o,u,h)=>{try{const r=i>0?new TextDecoder("utf-8").decode(Lr.HEAPU8.subarray(t,t+i)):"",p=Lr.HEAPU8.subarray(o,o+u),g=n(r,new TextDecoder("utf-8").decode(p));if(g==null)return-1;const v=CF(g);if(v.length>0){const I=EF(v,v.length);Lr.HEAPU32[h>>2]=I}return v.length}catch(r){return console.error(`[markdown-wasm] error in markdown onCodeBlock callback: ${r.stack||r}`),-1}},"iiiiii")}function CF(n){return typeof n=="string"?new TextEncoder().encode(n):n instanceof Uint8Array?n:new Uint8Array(n)}function K$(n){const e=n(lb),t=Lr.HEAP32[lb>>2];if(t===0)return null;const i=Lr.HEAPU8.subarray(t,t+e);return i.heapAddr=t,i}function J$(n,e){const t=n.length,i=EF(n,t),o=e(i,t);return Lr._wfree(i),o}function EF(n,e){const t=Lr._wrealloc(0,e);return Lr.HEAPU8.set(n,t),t}class X$ extends Error{constructor(e,t,i,o){super(t,i||"wasm",o||0),this.name="WError",this.code=e}}function Z$(){const n=Lr._WErrGetCode();if(n!==0){const e=Lr._WErrGetMsg(),t=e!==""?Lr.UTF8ArrayToString(Lr.HEAPU8,e):"";return Lr._WErrClear(),new X$(n,t)}}function $$(){const n=Z$();if(n)throw n}var eee=Object.freeze({__proto__:null});/**
 * vue-markdown-wasm
 *
 * @description markdown-wasm for vue 2 & 3
 * @author Logue <logue@hotmail.co.jp>
 * @copyright 2022-2023 By Masashi Yoshikawa All rights reserved.
 * @license MIT
 * @version 0.3.12
 * @see {@link https://github.com/logue/vue-markdown-wasm}
 */const tee=n=>n?Object.entries(n).reduce((e,[t,i])=>(t=t.charAt(0).toUpperCase()+t.slice(1),t=`on${t}`,{...e,[t]:i}),{}):{};function iee(n,e={},t){const{props:i,domProps:o,on:u,...h}=e,r=u!=null?tee(u):{};return Qd(n,{...h,...i,...o,...r},t)}var wF=kn({name:"VueMarkdown",model:{prop:"modelValue"},props:{modelValue:{type:String,default:""},tag:{type:String,default:"article"},parseFlags:{type:Number,default:IF.DEFAULT},format:{type:String,default:"xhtml"},bytes:{type:Boolean,default:!1},allowJsUri:{type:Boolean,default:!1},onCodeBlock:{type:Function,default:()=>{}}},emits:{render:n=>!0},setup(n,e){const t=Gt(),i=Gt("");qi(()=>n,async u=>{i.value=o(u.modelValue,{parseFlags:u.parseFlags,format:u.format,bytes:n.bytes,allowJSURIs:u.allowJsUri,onCodeBlock:u.onCodeBlock}),await Gr()},{deep:!0}),Br(async()=>{await Y$(),i.value=o(n.modelValue,{parseFlags:n.parseFlags,format:n.format,bytes:n.bytes,allowJSURIs:n.allowJsUri,onCodeBlock:n.onCodeBlock})});const o=(u,h)=>{const r=j$(u,h);return e.emit("render",r),r};return e.expose({render:o}),{placeholder:t,html:i}},render(){return iee(this.$props.tag,{ref:"placeholder",class:"vue-markdown",domProps:{innerHTML:this.html}})}});const nee=kn({__name:"HelloTxt",setup(n){const e=Gt(`### hello.md

> What is necuro.com?

My initial idea behind necuro was creating an integrated space where I could materialize my ideas into small components.

> Why?

Short answer? For fun. I love to read about new web standards showing up on the horizon and try to implement them interestingly. I believe this playground could potentially be a great portfolio.

> Can I see the code?

Sure! Even steal it, I would be flattered.

> WhO aRe yOu??

necuro author is [Jordan Andrzejczak](https://pl.linkedin.com/in/andrzejczak)

> What's next?

I don't know, try to click around, think outside the box. Maybe start with **double-clicking** some icons?

<br/>

--- 
\`\`\`javascript
console.log('necuro playground!')
\`\`\`
`);return(t,i)=>(Qi(),ys(Bi(wF),{class:"list-disc p-2 pt-4 font-header",modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=o=>e.value=o)},null,8,["modelValue"]))}});const ree=kn({__name:"RoadMap",setup(n){const e=Gt(`### roadmap.txt

> General file for tracking progress and current issues.

<br/>

#### **TODO:**

- [x] About me page,
- [x] necuro animation,
- [x] Desktop view,
- [ ] Refactor components,
- [ ] Support mobile,
- [ ] Music player (Spotify or Apple Music API?)

<br/>

#### **Known issues:**

* Floating windows can overflow the screen,
* Floating windows are not set active, z-index issue,
* Animations in HeadView are sometimes missing,
* ...

<br/>

#### **Ideas:**

* Resize windows in all directions,
* Some kind of dock on the bottom?
* Minigamnes,
* Terminal emulator,

`);return(t,i)=>(Qi(),ys(Bi(wF),{class:"list-disc p-2 pt-4 font-header",modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=o=>e.value=o)},null,8,["modelValue"]))}});const bF=kn({name:"ListingTable",components:{},emits:[],setup(){const n=Gt(null),e=Gt(null),t=["ID","First name","Last name","Email","Street","Country","University","IBAN"],i=[{ID:"000001","First name":"Lani","Last name":"Ovendale",Email:"lovendale0@w3.org",Street:"7850 Old Shore Drive",Country:"United Kingdom",University:"University of Plymouth",IBAN:"BG34 MPVP 8782 88EX H1CJ SC"},{ID:"000002","First name":"Israel","Last name":"Tassell",Email:"itassell1@ow.ly",Street:"245 Merchant Circle",Country:"Macedonia",University:"South East European University",IBAN:"FR11 4824 2942 41H9 XBHC 46P2 O86"},{ID:"000003","First name":"Eveleen","Last name":"Mercer",Email:"emercer2@ow.ly",Street:"70700 Kipling Pass",Country:"Portugal",University:"Instituto Superior Novas Profissões - INP",IBAN:"GR96 7559 456P GUAN WTAJ 3VPB S0P"},{ID:"000004","First name":"Conn","Last name":"Whitley",Email:"cwhitley3@wsj.com",Street:"03 Service Terrace",Country:"Albania",University:"Epoka University",IBAN:"LI59 1813 2T7T VKTO 6RKE X"},{ID:"000005","First name":"Cherye","Last name":"Smitheram",Email:"csmitheram4@rambler.ru",Street:"9 Eliot Parkway",Country:"Indonesia",University:"Universitas Mahasaraswati Denpasar",IBAN:"BR27 4570 4226 4255 5239 0197 316T J"},{ID:"000006","First name":"Bunnie","Last name":"Sked",Email:"bsked5@51.la",Street:"03418 Ludington Plaza",Country:"Nigeria",University:"Federal University of Technology, Minna",IBAN:"ES45 6721 1332 3288 6455 1242"},{ID:"000007","First name":"Helaine","Last name":"Crother",Email:"hcrother6@opera.com",Street:"7932 Sloan Park",Country:"Philippines",University:"Saint Ferdinand College",IBAN:"GB50 HFAD 8121 3729 9841 31"},{ID:"000008","First name":"Tana","Last name":"Ajean",Email:"tajean7@sfgate.com",Street:"2 Schurz Junction",Country:"China",University:"Xi'an University of Electronic Science and Technology",IBAN:"KZ85 7422 XDPB P2VQ H8SR"},{ID:"000009","First name":"Sollie","Last name":"Greenrde",Email:"sgreenrde8@wikispaces.com",Street:"055 Mockingbird Way",Country:"Russia",University:"St. Petersburg State Mining Institute (Technical University)",IBAN:"CH61 6423 9T4W WP0I 8MUK C"},{ID:"000010","First name":"Vernon","Last name":"Millington",Email:"vmillington9@marketwatch.com",Street:"74 David Pass",Country:"Portugal",University:"Instituto Politécnico de Setúbal",IBAN:"ES71 2390 0665 9889 6631 1187"},{ID:"000001","First name":"Lani","Last name":"Ovendale",Email:"lovendale0@w3.org",Street:"7850 Old Shore Drive",Country:"United Kingdom",University:"University of Plymouth",IBAN:"BG34 MPVP 8782 88EX H1CJ SC"},{ID:"000002","First name":"Israel","Last name":"Tassell",Email:"itassell1@ow.ly",Street:"245 Merchant Circle",Country:"Macedonia",University:"South East European University",IBAN:"FR11 4824 2942 41H9 XBHC 46P2 O86"},{ID:"000003","First name":"Eveleen","Last name":"Mercer",Email:"emercer2@ow.ly",Street:"70700 Kipling Pass",Country:"Portugal",University:"Instituto Superior Novas Profissões - INP",IBAN:"GR96 7559 456P GUAN WTAJ 3VPB S0P"},{ID:"000004","First name":"Conn","Last name":"Whitley",Email:"cwhitley3@wsj.com",Street:"03 Service Terrace",Country:"Albania",University:"Epoka University",IBAN:"LI59 1813 2T7T VKTO 6RKE X"},{ID:"000005","First name":"Cherye","Last name":"Smitheram",Email:"csmitheram4@rambler.ru",Street:"9 Eliot Parkway",Country:"Indonesia",University:"Universitas Mahasaraswati Denpasar",IBAN:"BR27 4570 4226 4255 5239 0197 316T J"},{ID:"000006","First name":"Bunnie","Last name":"Sked",Email:"bsked5@51.la",Street:"03418 Ludington Plaza",Country:"Nigeria",University:"Federal University of Technology, Minna",IBAN:"ES45 6721 1332 3288 6455 1242"},{ID:"000007","First name":"Helaine","Last name":"Crother",Email:"hcrother6@opera.com",Street:"7932 Sloan Park",Country:"Philippines",University:"Saint Ferdinand College",IBAN:"GB50 HFAD 8121 3729 9841 31"},{ID:"000008","First name":"Tana","Last name":"Ajean",Email:"tajean7@sfgate.com",Street:"2 Schurz Junction",Country:"China",University:"Xi'an University of Electronic Science and Technology",IBAN:"KZ85 7422 XDPB P2VQ H8SR"},{ID:"000009","First name":"Sollie","Last name":"Greenrde",Email:"sgreenrde8@wikispaces.com",Street:"055 Mockingbird Way",Country:"Russia",University:"St. Petersburg State Mining Institute (Technical University)",IBAN:"CH61 6423 9T4W WP0I 8MUK C"},{ID:"000010","First name":"Vernon","Last name":"Millington",Email:"vmillington9@marketwatch.com",Street:"74 David Pass",Country:"Portugal",University:"Instituto Politécnico de Setúbal",IBAN:"ES71 2390 0665 9889 6631 1187"},{ID:"000001","First name":"Lani","Last name":"Ovendale",Email:"lovendale0@w3.org",Street:"7850 Old Shore Drive",Country:"United Kingdom",University:"University of Plymouth",IBAN:"BG34 MPVP 8782 88EX H1CJ SC"},{ID:"000002","First name":"Israel","Last name":"Tassell",Email:"itassell1@ow.ly",Street:"245 Merchant Circle",Country:"Macedonia",University:"South East European University",IBAN:"FR11 4824 2942 41H9 XBHC 46P2 O86"},{ID:"000003","First name":"Eveleen","Last name":"Mercer",Email:"emercer2@ow.ly",Street:"70700 Kipling Pass",Country:"Portugal",University:"Instituto Superior Novas Profissões - INP",IBAN:"GR96 7559 456P GUAN WTAJ 3VPB S0P"},{ID:"000004","First name":"Conn","Last name":"Whitley",Email:"cwhitley3@wsj.com",Street:"03 Service Terrace",Country:"Albania",University:"Epoka University",IBAN:"LI59 1813 2T7T VKTO 6RKE X"},{ID:"000005","First name":"Cherye","Last name":"Smitheram",Email:"csmitheram4@rambler.ru",Street:"9 Eliot Parkway",Country:"Indonesia",University:"Universitas Mahasaraswati Denpasar",IBAN:"BR27 4570 4226 4255 5239 0197 316T J"},{ID:"000006","First name":"Bunnie","Last name":"Sked",Email:"bsked5@51.la",Street:"03418 Ludington Plaza",Country:"Nigeria",University:"Federal University of Technology, Minna",IBAN:"ES45 6721 1332 3288 6455 1242"},{ID:"000007","First name":"Helaine","Last name":"Crother",Email:"hcrother6@opera.com",Street:"7932 Sloan Park",Country:"Philippines",University:"Saint Ferdinand College",IBAN:"GB50 HFAD 8121 3729 9841 31"},{ID:"000008","First name":"Tana","Last name":"Ajean",Email:"tajean7@sfgate.com",Street:"2 Schurz Junction",Country:"China",University:"Xi'an University of Electronic Science and Technology",IBAN:"KZ85 7422 XDPB P2VQ H8SR"},{ID:"000009","First name":"Sollie","Last name":"Greenrde",Email:"sgreenrde8@wikispaces.com",Street:"055 Mockingbird Way",Country:"Russia",University:"St. Petersburg State Mining Institute (Technical University)",IBAN:"CH61 6423 9T4W WP0I 8MUK C"},{ID:"000010","First name":"Vernon","Last name":"Millington",Email:"vmillington9@marketwatch.com",Street:"74 David Pass",Country:"Portugal",University:"Instituto Politécnico de Setúbal",IBAN:"ES71 2390 0665 9889 6631 1187"}],o=cn(()=>i.filter(P=>h.value.every(O=>O.filter?(P[O.name]||"").toLowerCase().includes(O.filter.toLowerCase()):!0))),u=Gt(),h=Gt([]),r=cn(()=>`grid-template-columns: ${h.value.map(P=>`minmax(${P.width}, 1fr)`).join(" ")};`),p=P=>{let O=P.parentElement??P;for(;O!=null&&O.parentElement;)O=O.parentElement;return O},g=350,v=Gt([]),I=Gt(null),C=(P,O)=>{var F,N;u.value=h.value.find(z=>z.name===O),I.value=P.target.parentNode,(F=p(I.value))==null||F.addEventListener("mousemove",E),(N=p(I.value))==null||N.addEventListener("mouseup",Q),I.value.classList.add("header--being-resized")},E=P=>requestAnimationFrame(()=>{const O=document.documentElement.scrollLeft;if(I.value){const F=O+P.clientX-I.value.offsetLeft;console.log(O,P.clientX,I.value),u.value.width=Math.max(g,F)+"px"}}),Q=()=>{var P,O,F;(P=p(I.value))==null||P.removeEventListener("mousemove",E),(O=p(I.value))==null||O.removeEventListener("mouseup",Q),(F=p(I.value))==null||F.removeEventListener("mouseleave",D),I.value.classList.remove("header--being-resized"),I.value=null,u.value=void 0},M=P=>{var N,z;let O=0,F=0;for(let X=0;X<P;X++)O+=(N=h.value[X])!=null&&N.sticky?parseInt(h.value[X].width,10):0;for(let X=h.value.length-1;X>P;X--)F+=(z=h.value[X])!=null&&z.sticky?parseInt(h.value[X].width,10):0;return`left: ${O}px; right: ${F}px`},D=P=>requestAnimationFrame(()=>{const O=document.documentElement.scrollLeft;if(I.value){const F=O+P.clientX-I.value.offsetLeft;u.value.width=Math.max(g,F)+"px"}});return Br(()=>{h.value=t.map((P,O)=>({id:O,name:P,width:`${g}px`,sticky:!1}))}),{columns:v,initResize:C,tableHeaders:t,tableData:i,listingTable:n,listingHeader:e,getColumnSizes:r,columnsData:h,filteredTableData:o,getColumnWidth:M}}}),L3=()=>{DU(n=>({"6e432f2d":n.tableHeaders.length}))},P3=bF.setup;bF.setup=P3?(n,e)=>(L3(),P3(n,e)):L3;const see={key:2,class:"flex h-full w-full cursor-pointer"},oee={class:"flex min-h-0 w-full flex-1 select-none flex-col items-center justify-center rounded-3xl border-2 border-primary bg-background p-2 text-center font-header text-xl"},aee=kn({__name:"HomeView",setup(n){const e=RP(),{layoutBounds:t}=No(e),{isSupported:i,charging:o,chargingTime:u,dischargingTime:h,level:r}=P8();A0();const p=g1("desktop-layout",[{x:2,y:4,w:1,h:1,i:"0",static:!1},{x:0,y:3,w:1,h:1,i:"1",static:!1},{x:1,y:0,w:1,h:1,i:"2",static:!1},{x:1,y:2,w:1,h:1,i:"3",static:!1}]),g=Gt(!0),v=Gt(!1),I=Gt(null);return qi(I,C=>{t.value=C==null?void 0:C.getBoundingClientRect()}),(C,E)=>{const Q=HA("v-icon");return Qi(),tn("div",{ref_key:"contentBounds",ref:I,class:"icons-container w-full flex-1 p-4"},[Di(Bi(vF),{layout:Bi(p),"onUpdate:layout":E[1]||(E[1]=M=>lr(p)?p.value=M:null),cols:{lg:8,md:6,sm:4,xs:4,xxs:2},"row-height":120,"is-draggable":g.value,"is-resizable":v.value,"is-bounded":!0,responsive:!0,"auto-size":!1,"vertical-compact":!1,"prevent-collision":!0,"use-css-transforms":!0},{default:Fs(()=>[(Qi(!0),tn(ir,null,s1(Bi(p),M=>(Qi(),ys(Bi(HB),{onTouchmove:E[0]||(E[0]=Cx(()=>{},["prevent"])),static:M.static,x:M.x,y:M.y,w:M.w,h:M.h,i:M.i},{default:Fs(()=>[M.i==="0"?(Qi(),ys(R3,{key:0,"file-name":"hello.md","icon-name":"oi-file-code",opened:!0},{default:Fs(()=>[Di(nee)]),_:1},8,["file-name"])):M.i==="1"?(Qi(),ys(O$,{key:1})):M.i==="2"&&Bi(i)?(Qi(),tn("div",see,[Yt("div",oee,[Bi(o)?(Qi(),ys(Q,{key:0,class:"color h-16 w-16",name:"bi-battery-charging"})):Bi(r)*100>50?(Qi(),ys(Q,{key:1,class:"color h-16 w-16",name:"bi-battery-full"})):Bi(r)*100<=15?(Qi(),ys(Q,{key:2,class:"color h-16 w-16",name:"bi-battery"})):(Qi(),ys(Q,{key:3,class:"color h-16 w-16",name:"bi-battery-half"}))])])):M.i==="3"?(Qi(),ys(R3,{key:3,"file-name":"roadmap.txt","icon-name":"md-route"},{default:Fs(()=>[Di(ree)]),_:1},8,["file-name"])):rh("",!0)]),_:2},1032,["static","x","y","w","h","i"]))),256))]),_:1},8,["layout","is-draggable","is-resizable"])],512)}}});const lee={class:"date"},cee={class:"title"},uee=kn({__name:"CardHeadline",props:{item:null},setup(n){return(e,t)=>(Qi(),tn("div",{style:ya(`view-transition-name: headline-${n.item.id}`),class:"headline"},[Yt("div",lee,Vd(n.item.date),1),Yt("div",cee,Vd(n.item.title),1)],4))}});const BF=ns(uee,[["__scopeId","data-v-4aa57c54"]]),hee={key:0,class:"card"},dee=["data-card"],fee={class:"card-thumb"},pee=["src"],Aee=kn({__name:"CardItem",props:{item:null,selected:{type:Boolean}},emits:["open"],setup(n,{emit:e}){const t=n,i=()=>{e("open",t.item)};return(o,u)=>(Qi(),tn(ir,null,[n.selected?(Qi(),tn("div",hee)):rh("",!0),n.selected?rh("",!0):(Qi(),tn("button",{key:1,class:"card",onClick:i,style:ya(`view-transition-name: card-${n.item.id}`),"data-card":n.item.id},[Yt("div",fee,[Yt("img",{style:ya(`view-transition-name: card-img-${n.item.id}`),src:n.item.thumb,width:"1",height:"1",alt:""},null,12,pee),Di(BF,{class:"card-headline",item:n.item},null,8,["item"])])],12,dee))],64))}});const k3=ns(Aee,[["__scopeId","data-v-9360602f"]]),Nu=[...Array(12).keys()].map(n=>({id:n,date:"2023.03.04",title:"Flower",thumb:`/images/photo_${(n+1).toString().padStart(5,"0")}.webp`,description:"Lorem ipsum dolor sit amet"})),gee={class:"page"},mee=["inert"],_ee=kn({__name:"CardPageView",setup(n){const e=Gt(!1),t=Gt(null),i=o=>{P1({async updateDOM(){t.value=o,L1.push({path:`/flower/${o.id}`}),await Gr()},cleanup(){}})};return(o,u)=>(Qi(),tn("div",gee,[Yt("div",{class:"table",inert:e.value},[(Qi(!0),tn(ir,null,s1(Bi(Nu),(h,r)=>{var p,g;return Qi(),tn(ir,null,[r%2===0?(Qi(),tn("div",{key:0,class:mn(["row",{_left:r/2%2===0,_right:r/2%2===1}])},[Di(k3,{item:Bi(Nu)[r],onOpen:i,selected:((p=t.value)==null?void 0:p.id)===Bi(Nu)[r].id},null,8,["item","selected"]),Di(k3,{item:Bi(Nu)[r+1],onOpen:i,selected:((g=t.value)==null?void 0:g.id)===Bi(Nu)[r+1].id},null,8,["item","selected"])],2)):rh("",!0)],64)}),256))],8,mee)]))}});const yee=ns(_ee,[["__scopeId","data-v-b0e9c8f2"]]);function vee(n){function e(t){n(t),requestAnimationFrame(e)}requestAnimationFrame(e)}var Bl=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Bl.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?Bl.Bounce.In(n*2)*.5:Bl.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),a_=function(){return performance.now()},xee=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){e===void 0&&(e=a_()),t===void 0&&(t=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<i.length;o++){var u=this._tweens[i[o]],h=!t;u&&u.update(e,h)===!1&&!t&&delete this._tweens[i[o]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Yp={Linear:function(n,e){var t=n.length-1,i=t*e,o=Math.floor(i),u=Yp.Utils.Linear;return e<0?u(n[0],n[1],i):e>1?u(n[t],n[t-1],t-i):u(n[o],n[o+1>t?t:o+1],i-o)},Bezier:function(n,e){for(var t=0,i=n.length-1,o=Math.pow,u=Yp.Utils.Bernstein,h=0;h<=i;h++)t+=o(1-e,i-h)*o(e,h)*n[h]*u(i,h);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,o=Math.floor(i),u=Yp.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(o=Math.floor(i=t*(1+e))),u(n[(o-1+t)%t],n[o],n[(o+1)%t],n[(o+2)%t],i-o)):e<0?n[0]-(u(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(u(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):u(n[o?o-1:0],n[o],n[t<o+1?t:o+1],n[t<o+2?t:o+2],i-o)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Yp.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,o){var u=(t-n)*.5,h=(i-e)*.5,r=o*o,p=o*r;return(2*e-2*t+u+h)*p+(-3*e+3*t-2*u-h)*r+u*o+e}}},SF=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),cb=new xee,Vm=function(){function n(e,t){t===void 0&&(t=cb),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Bl.Linear.None,this._interpolationFunction=Yp.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=SF.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=a_()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var o={};for(var u in this._valuesEnd)o[u]=this._valuesEnd[u];this._valuesEnd=o}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,o,u){for(var h in i){var r=e[h],p=Array.isArray(r),g=p?"array":typeof r,v=!p&&Array.isArray(i[h]);if(!(g==="undefined"||g==="function")){if(v){var I=i[h];if(I.length===0)continue;for(var C=[r],E=0,Q=I.length;E<Q;E+=1){var M=this._handleRelativeValue(r,I[E]);if(isNaN(M)){v=!1,console.warn("Found invalid interpolation list. Skipping.");break}C.push(M)}v&&(i[h]=C)}if((g==="object"||p)&&r&&!v){t[h]=p?[]:{};var D=r;for(var P in D)t[h][P]=D[P];o[h]=p?[]:{};var I=i[h];if(!this._isDynamic){var O={};for(var P in I)O[P]=I[P];i[h]=I=O}this._setupProperties(D,t[h],I,o[h],u)}else(typeof t[h]>"u"||u)&&(t[h]=r),p||(t[h]*=1),v?o[h]=i[h].slice().reverse():o[h]=t[h]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return e===void 0&&(e=a_()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},n.prototype.resume=function(e){return e===void 0&&(e=a_()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e===void 0&&(e=cb),this._group=e,this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=Bl.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Yp.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){if(e===void 0&&(e=a_()),t===void 0&&(t=!0),this._isPaused)return!0;var i,o,u=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>u)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),o=(e-this._startTime)/this._duration,o=this._duration===0||o>1?1:o;var h=this._easingFunction(o);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,o),o===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(i in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[i]=="string"&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var r=0,p=this._chainedTweens.length;r<p;r++)this._chainedTweens[r].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,o){for(var u in i)if(t[u]!==void 0){var h=t[u]||0,r=i[u],p=Array.isArray(e[u]),g=Array.isArray(r),v=!p&&g;v?e[u]=this._interpolationFunction(r,o):typeof r=="object"&&r?this._updateProperties(e[u],h,r,o):(r=this._handleRelativeValue(h,r),typeof r=="number"&&(e[u]=h+(r-h)*o))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n}();SF.nextId;var Pl=cb;Pl.getAll.bind(Pl);Pl.removeAll.bind(Pl);Pl.add.bind(Pl);Pl.remove.bind(Pl);var Iee=Pl.update.bind(Pl);const MF=0,Cee=1,Eee=2,F3=2,NE=1.25,N3=1,Ax=6*4+4+4,ub=65535,wee=Math.pow(2,-24);class Ov{constructor(){}}function Sl(n,e,t){return t.min.x=e[n],t.min.y=e[n+1],t.min.z=e[n+2],t.max.x=e[n+3],t.max.y=e[n+4],t.max.z=e[n+5],t}function z3(n){let e=-1,t=-1/0;for(let i=0;i<3;i++){const o=n[i+3]-n[i];o>t&&(t=o,e=i)}return e}function U3(n,e){e.set(n)}function O3(n,e,t){let i,o;for(let u=0;u<3;u++){const h=u+3;i=n[u],o=e[u],t[u]=i<o?i:o,i=n[h],o=e[h],t[h]=i>o?i:o}}function Gv(n,e,t){for(let i=0;i<3;i++){const o=e[n+2*i],u=e[n+2*i+1],h=o-u,r=o+u;h<t[i]&&(t[i]=h),r>t[i+3]&&(t[i+3]=r)}}function Wm(n){const e=n[3]-n[0],t=n[4]-n[1],i=n[5]-n[2];return 2*(e*t+t*i+i*e)}function bee(n,e){if(!n.index){const t=n.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let o;t>65535?o=new Uint32Array(new i(4*t)):o=new Uint16Array(new i(2*t)),n.setIndex(new es(o,1));for(let u=0;u<t;u++)o[u]=u}}function Bee(n){if(!n.groups||!n.groups.length)return[{offset:0,count:n.index.count/3}];const e=[],t=new Set;for(const o of n.groups)t.add(o.start),t.add(o.start+o.count);const i=Array.from(t.values()).sort((o,u)=>o-u);for(let o=0;o<i.length-1;o++){const u=i[o],h=i[o+1];e.push({offset:u/3,count:(h-u)/3})}return e}function zE(n,e,t,i,o=null){let u=1/0,h=1/0,r=1/0,p=-1/0,g=-1/0,v=-1/0,I=1/0,C=1/0,E=1/0,Q=-1/0,M=-1/0,D=-1/0;const P=o!==null;for(let O=e*6,F=(e+t)*6;O<F;O+=6){const N=n[O+0],z=n[O+1],X=N-z,q=N+z;X<u&&(u=X),q>p&&(p=q),P&&N<I&&(I=N),P&&N>Q&&(Q=N);const H=n[O+2],W=n[O+3],se=H-W,de=H+W;se<h&&(h=se),de>g&&(g=de),P&&H<C&&(C=H),P&&H>M&&(M=H);const te=n[O+4],ce=n[O+5],Ee=te-ce,Be=te+ce;Ee<r&&(r=Ee),Be>v&&(v=Be),P&&te<E&&(E=te),P&&te>D&&(D=te)}i[0]=u,i[1]=h,i[2]=r,i[3]=p,i[4]=g,i[5]=v,P&&(o[0]=I,o[1]=C,o[2]=E,o[3]=Q,o[4]=M,o[5]=D)}function See(n,e,t,i){let o=1/0,u=1/0,h=1/0,r=-1/0,p=-1/0,g=-1/0;for(let v=e*6,I=(e+t)*6;v<I;v+=6){const C=n[v+0];C<o&&(o=C),C>r&&(r=C);const E=n[v+2];E<u&&(u=E),E>p&&(p=E);const Q=n[v+4];Q<h&&(h=Q),Q>g&&(g=Q)}i[0]=o,i[1]=u,i[2]=h,i[3]=r,i[4]=p,i[5]=g}function Mee(n,e,t,i,o){let u=t,h=t+i-1;const r=o.pos,p=o.axis*2;for(;;){for(;u<=h&&e[u*6+p]<r;)u++;for(;u<=h&&e[h*6+p]>=r;)h--;if(u<h){for(let g=0;g<3;g++){let v=n[u*3+g];n[u*3+g]=n[h*3+g],n[h*3+g]=v;let I=e[u*6+g*2+0];e[u*6+g*2+0]=e[h*6+g*2+0],e[h*6+g*2+0]=I;let C=e[u*6+g*2+1];e[u*6+g*2+1]=e[h*6+g*2+1],e[h*6+g*2+1]=C}u++,h--}else return u}}const dc=32,Tee=(n,e)=>n.candidate-e.candidate,Tu=new Array(dc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Hv=new Float32Array(6);function Dee(n,e,t,i,o,u){let h=-1,r=0;if(u===MF)h=z3(e),h!==-1&&(r=(e[h]+e[h+3])/2);else if(u===Cee)h=z3(n),h!==-1&&(r=Qee(t,i,o,h));else if(u===Eee){const p=Wm(n);let g=NE*o;const v=i*6,I=(i+o)*6;for(let C=0;C<3;C++){const E=e[C],D=(e[C+3]-E)/dc;if(o<dc/4){const P=[...Tu];P.length=o;let O=0;for(let N=v;N<I;N+=6,O++){const z=P[O];z.candidate=t[N+2*C],z.count=0;const{bounds:X,leftCacheBounds:q,rightCacheBounds:H}=z;for(let W=0;W<3;W++)H[W]=1/0,H[W+3]=-1/0,q[W]=1/0,q[W+3]=-1/0,X[W]=1/0,X[W+3]=-1/0;Gv(N,t,X)}P.sort(Tee);let F=o;for(let N=0;N<F;N++){const z=P[N];for(;N+1<F&&P[N+1].candidate===z.candidate;)P.splice(N+1,1),F--}for(let N=v;N<I;N+=6){const z=t[N+2*C];for(let X=0;X<F;X++){const q=P[X];z>=q.candidate?Gv(N,t,q.rightCacheBounds):(Gv(N,t,q.leftCacheBounds),q.count++)}}for(let N=0;N<F;N++){const z=P[N],X=z.count,q=o-z.count,H=z.leftCacheBounds,W=z.rightCacheBounds;let se=0;X!==0&&(se=Wm(H)/p);let de=0;q!==0&&(de=Wm(W)/p);const te=N3+NE*(se*X+de*q);te<g&&(h=C,g=te,r=z.candidate)}}else{for(let F=0;F<dc;F++){const N=Tu[F];N.count=0,N.candidate=E+D+F*D;const z=N.bounds;for(let X=0;X<3;X++)z[X]=1/0,z[X+3]=-1/0}for(let F=v;F<I;F+=6){let X=~~((t[F+2*C]-E)/D);X>=dc&&(X=dc-1);const q=Tu[X];q.count++,Gv(F,t,q.bounds)}const P=Tu[dc-1];U3(P.bounds,P.rightCacheBounds);for(let F=dc-2;F>=0;F--){const N=Tu[F],z=Tu[F+1];O3(N.bounds,z.rightCacheBounds,N.rightCacheBounds)}let O=0;for(let F=0;F<dc-1;F++){const N=Tu[F],z=N.count,X=N.bounds,H=Tu[F+1].rightCacheBounds;z!==0&&(O===0?U3(X,Hv):O3(X,Hv,Hv)),O+=z;let W=0,se=0;O!==0&&(W=Wm(Hv)/p);const de=o-O;de!==0&&(se=Wm(H)/p);const te=N3+NE*(W*O+se*de);te<g&&(h=C,g=te,r=N.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${u} used.`);return{axis:h,pos:r}}function Qee(n,e,t,i){let o=0;for(let u=e,h=e+t;u<h;u++)o+=n[u*6+i*2];return o/t}function Ree(n,e){const t=n.attributes.position,i=n.index.array,o=i.length/3,u=new Float32Array(o*6),h=t.normalized,r=t.array,p=t.offset||0;let g=3;t.isInterleavedBufferAttribute&&(g=t.data.stride);const v=["getX","getY","getZ"];for(let I=0;I<o;I++){const C=I*3,E=I*6;let Q,M,D;h?(Q=i[C+0],M=i[C+1],D=i[C+2]):(Q=i[C+0]*g+p,M=i[C+1]*g+p,D=i[C+2]*g+p);for(let P=0;P<3;P++){let O,F,N;h?(O=t[v[P]](Q),F=t[v[P]](M),N=t[v[P]](D)):(O=r[Q+P],F=r[M+P],N=r[D+P]);let z=O;F<z&&(z=F),N<z&&(z=N);let X=O;F>X&&(X=F),N>X&&(X=N);const q=(X-z)/2,H=P*2;u[E+H+0]=z+q,u[E+H+1]=q+(Math.abs(z)+q)*wee,z<e[P]&&(e[P]=z),X>e[P+3]&&(e[P+3]=X)}}return u}function Lee(n,e){function t(P){C&&C(P/E)}function i(P,O,F,N=null,z=0){if(!Q&&z>=p&&(Q=!0,g&&(console.warn(`MeshBVH: Max depth of ${p} reached when generating BVH. Consider increasing maxDepth.`),console.warn(n))),F<=v||z>=p)return t(O+F),P.offset=O,P.count=F,P;const X=Dee(P.boundingData,N,h,O,F,I);if(X.axis===-1)return t(O+F),P.offset=O,P.count=F,P;const q=Mee(r,h,O,F,X);if(q===O||q===O+F)t(O+F),P.offset=O,P.count=F;else{P.splitAxis=X.axis;const H=new Ov,W=O,se=q-O;P.left=H,H.boundingData=new Float32Array(6),zE(h,W,se,H.boundingData,u),i(H,W,se,u,z+1);const de=new Ov,te=q,ce=F-se;P.right=de,de.boundingData=new Float32Array(6),zE(h,te,ce,de.boundingData,u),i(de,te,ce,u,z+1)}return P}bee(n,e);const o=new Float32Array(6),u=new Float32Array(6),h=Ree(n,o),r=n.index.array,p=e.maxDepth,g=e.verbose,v=e.maxLeafTris,I=e.strategy,C=e.onProgress,E=n.index.count/3;let Q=!1;const M=[],D=Bee(n);if(D.length===1){const P=D[0],O=new Ov;O.boundingData=o,See(h,P.offset,P.count,u),i(O,P.offset,P.count,u),M.push(O)}else for(let P of D){const O=new Ov;O.boundingData=new Float32Array(6),zE(h,P.offset,P.count,O.boundingData,u),i(O,P.offset,P.count,u),M.push(O)}return M}function Pee(n,e){const t=Lee(n,e);let i,o,u;const h=[],r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let v=0;v<t.length;v++){const I=t[v];let C=p(I);const E=new r(Ax*C);i=new Float32Array(E),o=new Uint32Array(E),u=new Uint16Array(E),g(0,I),h.push(E)}return h;function p(v){return v.count?1:1+p(v.left)+p(v.right)}function g(v,I){const C=v/4,E=v/2,Q=!!I.count,M=I.boundingData;for(let D=0;D<6;D++)i[C+D]=M[D];if(Q){const D=I.offset,P=I.count;return o[C+6]=D,u[E+14]=P,u[E+15]=ub,v+Ax}else{const D=I.left,P=I.right,O=I.splitAxis;let F;if(F=g(v+Ax,D),F/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return o[C+6]=F/4,F=g(F,P),o[C+7]=O,F}}}class kl{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,o=-1/0;for(let u=0,h=e.length;u<h;u++){const p=e[u][t];i=p<i?p:i,o=p>o?p:o}this.min=i,this.max=o}setFromPoints(e,t){let i=1/0,o=-1/0;for(let u=0,h=t.length;u<h;u++){const r=t[u],p=e.dot(r);i=p<i?p:i,o=p>o?p:o}this.min=i,this.max=o}isSeparated(e){return this.min>e.max||e.min>this.max}}kl.prototype.setFromBox=function(){const n=new rt;return function(t,i){const o=i.min,u=i.max;let h=1/0,r=-1/0;for(let p=0;p<=1;p++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){n.x=o.x*p+u.x*(1-p),n.y=o.y*g+u.y*(1-g),n.z=o.z*v+u.z*(1-v);const I=t.dot(n);h=Math.min(I,h),r=Math.max(I,r)}this.min=h,this.max=r}}();(function(){const n=new kl;return function(t,i){const o=t.points,u=t.satAxes,h=t.satBounds,r=i.points,p=i.satAxes,g=i.satBounds;for(let v=0;v<3;v++){const I=h[v],C=u[v];if(n.setFromPoints(C,r),I.isSeparated(n))return!1}for(let v=0;v<3;v++){const I=g[v],C=p[v];if(n.setFromPoints(C,o),I.isSeparated(n))return!1}}})();const kee=function(){const n=new rt,e=new rt,t=new rt;return function(o,u,h){const r=o.start,p=n,g=u.start,v=e;t.subVectors(r,g),n.subVectors(o.end,o.start),e.subVectors(u.end,u.start);const I=t.dot(v),C=v.dot(p),E=v.dot(v),Q=t.dot(p),D=p.dot(p)*E-C*C;let P,O;D!==0?P=(I*C-Q*E)/D:P=0,O=(I+P*C)/E,h.x=P,h.y=O}}(),jB=function(){const n=new Yi,e=new rt,t=new rt;return function(o,u,h,r){kee(o,u,n);let p=n.x,g=n.y;if(p>=0&&p<=1&&g>=0&&g<=1){o.at(p,h),u.at(g,r);return}else if(p>=0&&p<=1){g<0?u.at(0,r):u.at(1,r),o.closestPointToPoint(r,!0,h);return}else if(g>=0&&g<=1){p<0?o.at(0,h):o.at(1,h),u.closestPointToPoint(h,!0,r);return}else{let v;p<0?v=o.start:v=o.end;let I;g<0?I=u.start:I=u.end;const C=e,E=t;if(o.closestPointToPoint(I,!0,e),u.closestPointToPoint(v,!0,t),C.distanceToSquared(I)<=E.distanceToSquared(v)){h.copy(C),r.copy(I);return}else{h.copy(v),r.copy(E);return}}}}(),Fee=function(){const n=new rt,e=new rt,t=new mc,i=new Tc;return function(u,h){const{radius:r,center:p}=u,{a:g,b:v,c:I}=h;if(i.start=g,i.end=v,i.closestPointToPoint(p,!0,n).distanceTo(p)<=r||(i.start=g,i.end=I,i.closestPointToPoint(p,!0,n).distanceTo(p)<=r)||(i.start=v,i.end=I,i.closestPointToPoint(p,!0,n).distanceTo(p)<=r))return!0;const M=h.getPlane(t);if(Math.abs(M.distanceToPoint(p))<=r){const P=M.projectPoint(p,e);if(h.containsPoint(P))return!0}return!1}}(),Nee=1e-15;function Qp(n){return Math.abs(n)<Nee}class Pc extends la{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new rt),this.satBounds=new Array(4).fill().map(()=>new kl),this.points=[this.a,this.b,this.c],this.sphere=new cf,this.plane=new mc,this.needsUpdate=!0}intersectsSphere(e){return Fee(e,this)}update(){const e=this.a,t=this.b,i=this.c,o=this.points,u=this.satAxes,h=this.satBounds,r=u[0],p=h[0];this.getNormal(r),p.setFromPoints(r,o);const g=u[1],v=h[1];g.subVectors(e,t),v.setFromPoints(g,o);const I=u[2],C=h[2];I.subVectors(t,i),C.setFromPoints(I,o);const E=u[3],Q=h[3];E.subVectors(i,e),Q.setFromPoints(E,o),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(r,e),this.needsUpdate=!1}}Pc.prototype.closestPointToSegment=function(){const n=new rt,e=new rt,t=new Tc;return function(o,u=null,h=null){const{start:r,end:p}=o,g=this.points;let v,I=1/0;for(let C=0;C<3;C++){const E=(C+1)%3;t.start.copy(g[C]),t.end.copy(g[E]),jB(t,o,n,e),v=n.distanceToSquared(e),v<I&&(I=v,u&&u.copy(n),h&&h.copy(e))}return this.closestPointToPoint(r,n),v=r.distanceToSquared(n),v<I&&(I=v,u&&u.copy(n),h&&h.copy(r)),this.closestPointToPoint(p,n),v=p.distanceToSquared(n),v<I&&(I=v,u&&u.copy(n),h&&h.copy(p)),Math.sqrt(I)}}();Pc.prototype.intersectsTriangle=function(){const n=new Pc,e=new Array(3),t=new Array(3),i=new kl,o=new kl,u=new rt,h=new rt,r=new rt,p=new rt,g=new Tc,v=new Tc,I=new Tc;return function(E,Q=null,M=!1){this.needsUpdate&&this.update(),E.isExtendedTriangle?E.needsUpdate&&E.update():(n.copy(E),n.update(),E=n);const D=this.plane,P=E.plane;if(Math.abs(D.normal.dot(P.normal))>1-1e-10){const O=this.satBounds,F=this.satAxes;t[0]=E.a,t[1]=E.b,t[2]=E.c;for(let X=0;X<4;X++){const q=O[X],H=F[X];if(i.setFromPoints(H,t),q.isSeparated(i))return!1}const N=E.satBounds,z=E.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let X=0;X<4;X++){const q=N[X],H=z[X];if(i.setFromPoints(H,e),q.isSeparated(i))return!1}for(let X=0;X<4;X++){const q=F[X];for(let H=0;H<4;H++){const W=z[H];if(u.crossVectors(q,W),i.setFromPoints(u,e),o.setFromPoints(u,t),i.isSeparated(o))return!1}}return Q&&(M||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),Q.start.set(0,0,0),Q.end.set(0,0,0)),!0}else{const O=this.points;let F=!1,N=0;for(let Ee=0;Ee<3;Ee++){const Be=O[Ee],De=O[(Ee+1)%3];g.start.copy(Be),g.end.copy(De),g.delta(h);const Re=F?v.start:v.end,ye=Qp(P.distanceToPoint(Be));if(Qp(P.normal.dot(h))&&ye){v.copy(g),N=2;break}if((P.intersectLine(g,Re)||ye)&&!Qp(Re.distanceTo(De))){if(N++,F)break;F=!0}}if(N===1&&E.containsPoint(v.end))return Q&&(Q.start.copy(v.end),Q.end.copy(v.end)),!0;if(N!==2)return!1;const z=E.points;let X=!1,q=0;for(let Ee=0;Ee<3;Ee++){const Be=z[Ee],De=z[(Ee+1)%3];g.start.copy(Be),g.end.copy(De),g.delta(r);const Re=X?I.start:I.end,ye=Qp(D.distanceToPoint(Be));if(Qp(D.normal.dot(r))&&ye){I.copy(g),q=2;break}if((D.intersectLine(g,Re)||ye)&&!Qp(Re.distanceTo(De))){if(q++,X)break;X=!0}}if(q===1&&this.containsPoint(I.end))return Q&&(Q.start.copy(I.end),Q.end.copy(I.end)),!0;if(q!==2)return!1;if(v.delta(h),I.delta(r),h.dot(r)<0){let Ee=I.start;I.start=I.end,I.end=Ee}const H=v.start.dot(h),W=v.end.dot(h),se=I.start.dot(h),de=I.end.dot(h),te=W<se,ce=H<de;return H!==de&&se!==W&&te===ce?!1:(Q&&(p.subVectors(v.start,I.start),p.dot(h)>0?Q.start.copy(v.start):Q.start.copy(I.start),p.subVectors(v.end,I.end),p.dot(h)<0?Q.end.copy(v.end):Q.end.copy(I.end)),!0)}}}();Pc.prototype.distanceToPoint=function(){const n=new rt;return function(t){return this.closestPointToPoint(t,n),t.distanceTo(n)}}();Pc.prototype.distanceToTriangle=function(){const n=new rt,e=new rt,t=["a","b","c"],i=new Tc,o=new Tc;return function(h,r=null,p=null){const g=r||p?i:null;if(this.intersectsTriangle(h,g))return(r||p)&&(r&&g.getCenter(r),p&&g.getCenter(p)),0;let v=1/0;for(let I=0;I<3;I++){let C;const E=t[I],Q=h[E];this.closestPointToPoint(Q,n),C=Q.distanceToSquared(n),C<v&&(v=C,r&&r.copy(n),p&&p.copy(Q));const M=this[E];h.closestPointToPoint(M,n),C=M.distanceToSquared(n),C<v&&(v=C,r&&r.copy(M),p&&p.copy(n))}for(let I=0;I<3;I++){const C=t[I],E=t[(I+1)%3];i.set(this[C],this[E]);for(let Q=0;Q<3;Q++){const M=t[Q],D=t[(Q+1)%3];o.set(h[M],h[D]),jB(i,o,n,e);const P=n.distanceToSquared(e);P<v&&(v=P,r&&r.copy(n),p&&p.copy(e))}}return Math.sqrt(v)}}();class Fl{constructor(e,t,i){this.isOrientedBox=!0,this.min=new rt,this.max=new rt,this.matrix=new sn,this.invMatrix=new sn,this.points=new Array(8).fill().map(()=>new rt),this.satAxes=new Array(3).fill().map(()=>new rt),this.satBounds=new Array(3).fill().map(()=>new kl),this.alignedSatBounds=new Array(3).fill().map(()=>new kl),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}Fl.prototype.update=function(){return function(){const e=this.matrix,t=this.min,i=this.max,o=this.points;for(let g=0;g<=1;g++)for(let v=0;v<=1;v++)for(let I=0;I<=1;I++){const C=1*g|2*v|4*I,E=o[C];E.x=g?i.x:t.x,E.y=v?i.y:t.y,E.z=I?i.z:t.z,E.applyMatrix4(e)}const u=this.satBounds,h=this.satAxes,r=o[0];for(let g=0;g<3;g++){const v=h[g],I=u[g],C=1<<g,E=o[C];v.subVectors(r,E),I.setFromPoints(v,o)}const p=this.alignedSatBounds;p[0].setFromPointsField(o,"x"),p[1].setFromPointsField(o,"y"),p[2].setFromPointsField(o,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Fl.prototype.intersectsBox=function(){const n=new kl;return function(t){this.needsUpdate&&this.update();const i=t.min,o=t.max,u=this.satBounds,h=this.satAxes,r=this.alignedSatBounds;if(n.min=i.x,n.max=o.x,r[0].isSeparated(n)||(n.min=i.y,n.max=o.y,r[1].isSeparated(n))||(n.min=i.z,n.max=o.z,r[2].isSeparated(n)))return!1;for(let p=0;p<3;p++){const g=h[p],v=u[p];if(n.setFromBox(g,t),v.isSeparated(n))return!1}return!0}}();Fl.prototype.intersectsTriangle=function(){const n=new Pc,e=new Array(3),t=new kl,i=new kl,o=new rt;return function(h){this.needsUpdate&&this.update(),h.isExtendedTriangle?h.needsUpdate&&h.update():(n.copy(h),n.update(),h=n);const r=this.satBounds,p=this.satAxes;e[0]=h.a,e[1]=h.b,e[2]=h.c;for(let C=0;C<3;C++){const E=r[C],Q=p[C];if(t.setFromPoints(Q,e),E.isSeparated(t))return!1}const g=h.satBounds,v=h.satAxes,I=this.points;for(let C=0;C<3;C++){const E=g[C],Q=v[C];if(t.setFromPoints(Q,I),E.isSeparated(t))return!1}for(let C=0;C<3;C++){const E=p[C];for(let Q=0;Q<4;Q++){const M=v[Q];if(o.crossVectors(E,M),t.setFromPoints(o,e),i.setFromPoints(o,I),t.isSeparated(i))return!1}}return!0}}();Fl.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();Fl.prototype.distanceToPoint=function(){const n=new rt;return function(t){return this.closestPointToPoint(t,n),t.distanceTo(n)}}();Fl.prototype.distanceToBox=function(){const n=["x","y","z"],e=new Array(12).fill().map(()=>new Tc),t=new Array(12).fill().map(()=>new Tc),i=new rt,o=new rt;return function(h,r=0,p=null,g=null){if(this.needsUpdate&&this.update(),this.intersectsBox(h))return(p||g)&&(h.getCenter(o),this.closestPointToPoint(o,i),h.closestPointToPoint(i,o),p&&p.copy(i),g&&g.copy(o)),0;const v=r*r,I=h.min,C=h.max,E=this.points;let Q=1/0;for(let D=0;D<8;D++){const P=E[D];o.copy(P).clamp(I,C);const O=P.distanceToSquared(o);if(O<Q&&(Q=O,p&&p.copy(P),g&&g.copy(o),O<v))return Math.sqrt(O)}let M=0;for(let D=0;D<3;D++)for(let P=0;P<=1;P++)for(let O=0;O<=1;O++){const F=(D+1)%3,N=(D+2)%3,z=P<<F|O<<N,X=1<<D|P<<F|O<<N,q=E[z],H=E[X];e[M].set(q,H);const se=n[D],de=n[F],te=n[N],ce=t[M],Ee=ce.start,Be=ce.end;Ee[se]=I[se],Ee[de]=P?I[de]:C[de],Ee[te]=O?I[te]:C[de],Be[se]=C[se],Be[de]=P?I[de]:C[de],Be[te]=O?I[te]:C[de],M++}for(let D=0;D<=1;D++)for(let P=0;P<=1;P++)for(let O=0;O<=1;O++){o.x=D?C.x:I.x,o.y=P?C.y:I.y,o.z=O?C.z:I.z,this.closestPointToPoint(o,i);const F=o.distanceToSquared(i);if(F<Q&&(Q=F,p&&p.copy(i),g&&g.copy(o),F<v))return Math.sqrt(F)}for(let D=0;D<12;D++){const P=e[D];for(let O=0;O<12;O++){const F=t[O];jB(P,F,i,o);const N=i.distanceToSquared(o);if(N<Q&&(Q=N,p&&p.copy(i),g&&g.copy(o),N<v))return Math.sqrt(N)}}return Math.sqrt(Q)}}();const Vv=new rt,Wv=new rt,Yv=new rt,G3=new Yi,H3=new Yi,V3=new Yi,W3=new rt;function zee(n,e,t,i,o,u){let h;return u===_o?h=n.intersectTriangle(i,t,e,!0,o):h=n.intersectTriangle(e,t,i,u!==fa,o),h===null?null:{distance:n.origin.distanceTo(o),point:o.clone()}}function Uee(n,e,t,i,o,u,h){Vv.fromBufferAttribute(e,i),Wv.fromBufferAttribute(e,o),Yv.fromBufferAttribute(e,u);const r=zee(n,Vv,Wv,Yv,W3,h);if(r){t&&(G3.fromBufferAttribute(t,i),H3.fromBufferAttribute(t,o),V3.fromBufferAttribute(t,u),r.uv=la.getUV(W3,Vv,Wv,Yv,G3,H3,V3,new Yi));const p={a:i,b:o,c:u,normal:new rt,materialIndex:0};la.getNormal(Vv,Wv,Yv,p.normal),r.face=p,r.faceIndex=i}return r}function TF(n,e,t,i,o){const u=i*3,h=n.index.getX(u),r=n.index.getX(u+1),p=n.index.getX(u+2),g=Uee(t,n.attributes.position,n.attributes.uv,h,r,p,e);return g?(g.faceIndex=i,o&&o.push(g),g):null}function Oee(n,e,t,i,o,u){for(let h=i,r=i+o;h<r;h++)TF(n,e,t,h,u)}function Gee(n,e,t,i,o){let u=1/0,h=null;for(let r=i,p=i+o;r<p;r++){const g=TF(n,e,t,r);g&&g.distance<u&&(h=g,u=g.distance)}return h}function Y3(n,e,t){return n===null||(n.point.applyMatrix4(e.matrixWorld),n.distance=n.point.distanceTo(t.ray.origin),n.object=e,n.distance<t.near||n.distance>t.far)?null:n}function El(n,e,t,i){const o=n.a,u=n.b,h=n.c;let r=e,p=e+1,g=e+2;t&&(r=t.getX(e),p=t.getX(e+1),g=t.getX(e+2)),o.x=i.getX(r),o.y=i.getY(r),o.z=i.getZ(r),u.x=i.getX(p),u.y=i.getY(p),u.z=i.getZ(p),h.x=i.getX(g),h.y=i.getY(g),h.z=i.getZ(g)}function j3(n,e,t,i,o,u,h){const r=t.index,p=t.attributes.position;for(let g=n,v=e+n;g<v;g++)if(El(h,g*3,r,p),h.needsUpdate=!0,i(h,g,o,u))return!0;return!1}class DF{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}function zu(n,e){return e[n+15]===65535}function hA(n,e){return e[n+6]}function h0(n,e){return e[n+14]}function d0(n){return n+8}function f0(n,e){return e[n+6]}function Hee(n,e){return e[n+7]}const jp=new xa,Wx=new rt,Vee=["x","y","z"];function hb(n,e,t,i,o){let u=n*2,h=KA,r=eh,p=th;if(zu(u,r)){const v=hA(n,p),I=h0(u,r);Oee(e,t,i,v,I,o)}else{const v=d0(n);Yx(v,h,i,Wx)&&hb(v,e,t,i,o);const I=f0(n,p);Yx(I,h,i,Wx)&&hb(I,e,t,i,o)}}function db(n,e,t,i){let o=n*2,u=KA,h=eh,r=th;if(zu(o,h)){const g=hA(n,r),v=h0(o,h);return Gee(e,t,i,g,v)}else{const g=Hee(n,r),v=Vee[g],C=i.direction[v]>=0;let E,Q;C?(E=d0(n),Q=f0(n,r)):(E=f0(n,r),Q=d0(n));const D=Yx(E,u,i,Wx)?db(E,e,t,i):null;if(D){const F=D.point[v];if(C?F<=u[Q+g]:F>=u[Q+g+3])return D}const O=Yx(Q,u,i,Wx)?db(Q,e,t,i):null;return D&&O?D.distance<=O.distance?D:O:D||O||null}}const Wee=function(){let n,e;const t=[],i=new DF(()=>new xa);return function(...h){n=i.getPrimitive(),e=i.getPrimitive(),t.push(n,e);const r=o(...h);i.releasePrimitive(n),i.releasePrimitive(e),t.pop(),t.pop();const p=t.length;return p>0&&(e=t[p-1],n=t[p-2]),r};function o(u,h,r,p,g=null,v=0,I=0){function C(F){let N=F*2,z=eh,X=th;for(;!zu(N,z);)F=d0(F),N=F*2;return hA(F,X)}function E(F){let N=F*2,z=eh,X=th;for(;!zu(N,z);)F=f0(F,X),N=F*2;return hA(F,X)+h0(N,z)}let Q=u*2,M=KA,D=eh,P=th;if(zu(Q,D)){const F=hA(u,P),N=h0(Q,D);return Sl(u,M,n),p(F,N,!1,I,v+u,n)}else{const F=d0(u),N=f0(u,P);let z=F,X=N,q,H,W,se;if(g&&(W=n,se=e,Sl(z,M,W),Sl(X,M,se),q=g(W),H=g(se),H<q)){z=N,X=F;const Re=q;q=H,H=Re,W=se}W||(W=n,Sl(z,M,W));const de=zu(z*2,D),te=r(W,de,q,I+1,v+z);let ce;if(te===F3){const Re=C(z),ht=E(z)-Re;ce=p(Re,ht,!0,I+1,v+z,W)}else ce=te&&o(z,h,r,p,g,v,I+1);if(ce)return!0;se=e,Sl(X,M,se);const Ee=zu(X*2,D),Be=r(se,Ee,H,I+1,v+X);let De;if(Be===F3){const Re=C(X),ht=E(X)-Re;De=p(Re,ht,!0,I+1,v+X,se)}else De=Be&&o(X,h,r,p,g,v,I+1);return!!De}}}(),Yee=function(){const n=new Pc,e=new Pc,t=new sn,i=new Fl,o=new Fl;return function u(h,r,p,g,v=null){let I=h*2,C=KA,E=eh,Q=th;if(v===null&&(p.boundingBox||p.computeBoundingBox(),i.set(p.boundingBox.min,p.boundingBox.max,g),v=i),zu(I,E)){const D=r,P=D.index,O=D.attributes.position,F=p.index,N=p.attributes.position,z=hA(h,Q),X=h0(I,E);if(t.copy(g).invert(),p.boundsTree)return Sl(h,C,o),o.matrix.copy(t),o.needsUpdate=!0,p.boundsTree.shapecast({intersectsBounds:H=>o.intersectsBox(H),intersectsTriangle:H=>{H.a.applyMatrix4(g),H.b.applyMatrix4(g),H.c.applyMatrix4(g),H.needsUpdate=!0;for(let W=z*3,se=(X+z)*3;W<se;W+=3)if(El(e,W,P,O),e.needsUpdate=!0,H.intersectsTriangle(e))return!0;return!1}});for(let q=z*3,H=X+z*3;q<H;q+=3){El(n,q,P,O),n.a.applyMatrix4(t),n.b.applyMatrix4(t),n.c.applyMatrix4(t),n.needsUpdate=!0;for(let W=0,se=F.count;W<se;W+=3)if(El(e,W,F,N),e.needsUpdate=!0,n.intersectsTriangle(e))return!0}}else{const D=h+8,P=Q[h+6];return Sl(D,C,jp),!!(v.intersectsBox(jp)&&u(D,r,p,g,v)||(Sl(P,C,jp),v.intersectsBox(jp)&&u(P,r,p,g,v)))}}}();function Yx(n,e,t,i){return Sl(n,e,jp),t.intersectBox(jp,i)}const fb=[];let gx,KA,eh,th;function l_(n){gx&&fb.push(gx),gx=n,KA=new Float32Array(n),eh=new Uint16Array(n),th=new Uint32Array(n)}function jv(){gx=null,KA=null,eh=null,th=null,fb.length&&l_(fb.pop())}const UE=Symbol("skip tree generation"),OE=new xa,GE=new xa,Rp=new sn,dd=new Fl,Ym=new Fl,jm=new rt,qv=new rt,jee=new rt,qee=new rt,Kee=new rt,q3=new xa,_l=new DF(()=>new Pc);class k_{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),k_.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};const i=e.geometry,o=e._roots,u=i.getIndex();let h;return t.cloneBuffers?h={roots:o.map(r=>r.slice()),index:u.array.slice()}:h={roots:o,index:u.array},h}static deserialize(e,t,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),k_.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};const{index:o,roots:u}=e,h=new k_(t,{...i,[UE]:!0});if(h._roots=u,i.setIndex){const r=t.getIndex();if(r===null){const p=new es(e.index,1,!1);t.setIndex(p)}else r.array!==o&&(r.array.set(o),r.needsUpdate=!0)}return h}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:MF,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[UE]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[UE]||(this._roots=Pee(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new xa))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));const t=this.geometry,i=t.index.array,o=t.attributes.position;let u,h,r,p,g=0;const v=this._roots;for(let C=0,E=v.length;C<E;C++)u=v[C],h=new Uint32Array(u),r=new Uint16Array(u),p=new Float32Array(u),I(0,g),g+=u.byteLength;function I(C,E,Q=!1){const M=C*2;if(r[M+15]===ub){const P=h[C+6],O=r[M+14];let F=1/0,N=1/0,z=1/0,X=-1/0,q=-1/0,H=-1/0;for(let W=3*P,se=3*(P+O);W<se;W++){const de=i[W],te=o.getX(de),ce=o.getY(de),Ee=o.getZ(de);te<F&&(F=te),te>X&&(X=te),ce<N&&(N=ce),ce>q&&(q=ce),Ee<z&&(z=Ee),Ee>H&&(H=Ee)}return p[C+0]!==F||p[C+1]!==N||p[C+2]!==z||p[C+3]!==X||p[C+4]!==q||p[C+5]!==H?(p[C+0]=F,p[C+1]=N,p[C+2]=z,p[C+3]=X,p[C+4]=q,p[C+5]=H,!0):!1}else{const P=C+8,O=h[C+6],F=P+E,N=O+E;let z=Q,X=!1,q=!1;e?z||(X=e.has(F),q=e.has(N),z=!X&&!q):(X=!0,q=!0);const H=z||X,W=z||q;let se=!1;H&&(se=I(P,E,z));let de=!1;W&&(de=I(O,E,z));const te=se||de;if(te)for(let ce=0;ce<3;ce++){const Ee=P+ce,Be=O+ce,De=p[Ee],Re=p[Ee+3],ye=p[Be],ht=p[Be+3];p[C+ce]=De<ye?De:ye,p[C+ce+3]=Re>ht?Re:ht}return te}}}traverse(e,t=0){const i=this._roots[t],o=new Uint32Array(i),u=new Uint16Array(i);h(0);function h(r,p=0){const g=r*2,v=u[g+15]===ub;if(v){const I=o[r+6],C=u[g+14];e(p,v,new Float32Array(i,r*4,6),I,C)}else{const I=r+Ax/4,C=o[r+6],E=o[r+7];e(p,v,new Float32Array(i,r*4,6),E)||(h(I,p+1),h(C,p+1))}}}raycast(e,t=rl){const i=this._roots,o=this.geometry,u=[],h=t.isMaterial,r=Array.isArray(t),p=o.groups,g=h?t.side:t;for(let v=0,I=i.length;v<I;v++){const C=r?t[p[v].materialIndex].side:g,E=u.length;if(l_(i[v]),hb(0,o,C,e,u),jv(),r){const Q=p[v].materialIndex;for(let M=E,D=u.length;M<D;M++)u[M].face.materialIndex=Q}}return u}raycastFirst(e,t=rl){const i=this._roots,o=this.geometry,u=t.isMaterial,h=Array.isArray(t);let r=null;const p=o.groups,g=u?t.side:t;for(let v=0,I=i.length;v<I;v++){const C=h?t[p[v].materialIndex].side:g;l_(i[v]);const E=db(0,o,C,e);jv(),E!=null&&(r==null||E.distance<r.distance)&&(r=E,h&&(E.face.materialIndex=p[v].materialIndex))}return r}intersectsGeometry(e,t){const i=this.geometry;let o=!1;for(const u of this._roots)if(l_(u),o=Yee(0,i,e,t),jv(),o)break;return o}shapecast(e,t,i){const o=this.geometry;if(e instanceof Function){if(t){const C=t;t=(E,Q,M,D)=>{const P=Q*3;return C(E,P,P+1,P+2,M,D)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const u=_l.getPrimitive();let{boundsTraverseOrder:h,intersectsBounds:r,intersectsRange:p,intersectsTriangle:g}=e;if(p&&g){const C=p;p=(E,Q,M,D,P)=>C(E,Q,M,D,P)?!0:j3(E,Q,o,g,M,D,u)}else p||(g?p=(C,E,Q,M)=>j3(C,E,o,g,Q,M,u):p=(C,E,Q)=>Q);let v=!1,I=0;for(const C of this._roots){if(l_(C),v=Wee(0,o,r,p,h,I),jv(),v)break;I+=C.byteLength}return _l.releasePrimitive(u),v}bvhcast(e,t,i){let{intersectsRanges:o,intersectsTriangles:u}=i;const h=this.geometry.index,r=this.geometry.attributes.position,p=e.geometry.index,g=e.geometry.attributes.position;Rp.copy(t).invert();const v=_l.getPrimitive(),I=_l.getPrimitive();if(u){let E=function(Q,M,D,P,O,F,N,z){for(let X=D,q=D+P;X<q;X++){El(I,X*3,p,g),I.a.applyMatrix4(t),I.b.applyMatrix4(t),I.c.applyMatrix4(t),I.needsUpdate=!0;for(let H=Q,W=Q+M;H<W;H++)if(El(v,H*3,h,r),v.needsUpdate=!0,u(v,I,H,X,O,F,N,z))return!0}return!1};if(o){const Q=o;o=function(M,D,P,O,F,N,z,X){return Q(M,D,P,O,F,N,z,X)?!0:E(M,D,P,O,F,N,z,X)}}else o=E}e.getBoundingBox(GE),GE.applyMatrix4(t);const C=this.shapecast({intersectsBounds:E=>GE.intersectsBox(E),intersectsRange:(E,Q,M,D,P,O)=>(OE.copy(O),OE.applyMatrix4(Rp),e.shapecast({intersectsBounds:F=>OE.intersectsBox(F),intersectsRange:(F,N,z,X,q)=>o(E,Q,F,N,D,P,X,q)}))});return _l.releasePrimitive(v),_l.releasePrimitive(I),C}intersectsBox(e,t){return dd.set(e.min,e.max,t),dd.needsUpdate=!0,this.shapecast({intersectsBounds:i=>dd.intersectsBox(i),intersectsTriangle:i=>dd.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},o={},u=0,h=1/0){e.boundingBox||e.computeBoundingBox(),dd.set(e.boundingBox.min,e.boundingBox.max,t),dd.needsUpdate=!0;const r=this.geometry,p=r.attributes.position,g=r.index,v=e.attributes.position,I=e.index,C=_l.getPrimitive(),E=_l.getPrimitive();let Q=qv,M=jee,D=null,P=null;o&&(D=qee,P=Kee);let O=1/0,F=null,N=null;return Rp.copy(t).invert(),Ym.matrix.copy(Rp),this.shapecast({boundsTraverseOrder:z=>dd.distanceToBox(z),intersectsBounds:(z,X,q)=>q<O&&q<h?(X&&(Ym.min.copy(z.min),Ym.max.copy(z.max),Ym.needsUpdate=!0),!0):!1,intersectsRange:(z,X)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:q=>Ym.distanceToBox(q),intersectsBounds:(q,H,W)=>W<O&&W<h,intersectsRange:(q,H)=>{for(let W=q*3,se=(q+H)*3;W<se;W+=3){El(E,W,I,v),E.a.applyMatrix4(t),E.b.applyMatrix4(t),E.c.applyMatrix4(t),E.needsUpdate=!0;for(let de=z*3,te=(z+X)*3;de<te;de+=3){El(C,de,g,p),C.needsUpdate=!0;const ce=C.distanceToTriangle(E,Q,D);if(ce<O&&(M.copy(Q),P&&P.copy(D),O=ce,F=de/3,N=W/3),ce<u)return!0}}}});{const q=I?I.count:v.count;for(let H=0,W=q;H<W;H+=3){El(E,H,I,v),E.a.applyMatrix4(t),E.b.applyMatrix4(t),E.c.applyMatrix4(t),E.needsUpdate=!0;for(let se=z*3,de=(z+X)*3;se<de;se+=3){El(C,se,g,p),C.needsUpdate=!0;const te=C.distanceToTriangle(E,Q,D);if(te<O&&(M.copy(Q),P&&P.copy(D),O=te,F=se/3,N=H/3),te<u)return!0}}}}}),_l.releasePrimitive(C),_l.releasePrimitive(E),O===1/0?null:(i.point?i.point.copy(M):i.point=M.clone(),i.distance=O,i.faceIndex=F,o&&(o.point?o.point.copy(P):o.point=P.clone(),o.point.applyMatrix4(Rp),M.applyMatrix4(Rp),o.distance=M.sub(o.point).length(),o.faceIndex=N),i)}closestPointToPoint(e,t={},i=0,o=1/0){const u=i*i,h=o*o;let r=1/0,p=null;if(this.shapecast({boundsTraverseOrder:v=>(jm.copy(e).clamp(v.min,v.max),jm.distanceToSquared(e)),intersectsBounds:(v,I,C)=>C<r&&C<h,intersectsTriangle:(v,I)=>{v.closestPointToPoint(e,jm);const C=e.distanceToSquared(jm);return C<r&&(qv.copy(jm),r=C,p=I),C<u}}),r===1/0)return null;const g=Math.sqrt(r);return t.point?t.point.copy(qv):t.point=qv.clone(),t.distance=g,t.faceIndex=p,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(i=>{Sl(0,new Float32Array(i),q3),e.union(q3)}),e}}const HE=new m0,K3=new sn,Jee=nr.prototype.raycast;function Xee(n,e){if(this.geometry.boundsTree){if(this.material===void 0)return;K3.copy(this.matrixWorld).invert(),HE.copy(n.ray).applyMatrix4(K3);const t=this.geometry.boundsTree;if(n.firstHitOnly===!0){const i=Y3(t.raycastFirst(HE,this.material),this,n);i&&e.push(i)}else{const i=t.raycast(HE,this.material);for(let o=0,u=i.length;o<u;o++){const h=Y3(i[o],this,n);h&&e.push(h)}}}else Jee.call(this,n,e)}function Zee(n){return this.boundsTree=new k_(this,n),this.boundsTree}function $ee(){this.boundsTree=null}var QF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RF(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var pb={},ete={get exports(){return pb},set exports(n){pb=n}};(function(n,e){(function(t,i){n.exports=i()})(QF,function(){var t,i,o;function u(r,p){if(!t)t=p;else if(!i)i=p;else{var g="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",v={};t(v),o=p(v),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}}u(["exports"],function(r){var p=typeof self<"u"?self:{},g="2.15.0";let v;const I={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(v==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{v={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):a}catch{v=a}}return v},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!I.API_URL)return null;try{const a=new URL(I.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},C={supported:!1,testSupport:function(a){!M&&Q&&(D?P(a):E=a)}};let E,Q,M=!1,D=!1;function P(a){const s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Q),a.isContextLost())return;C.supported=!0}catch{}a.deleteTexture(s),M=!0}p.document&&(Q=p.document.createElement("img"),Q.onload=function(){E&&P(E),E=null,D=!0},Q.onerror=function(){M=!0,E=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function F(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var N=z;function z(a,s,l,d){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=l,this.p2y=d}z.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(s===void 0&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,d=0;d<8;d++){var A=this.sampleCurveX(l)-a;if(Math.abs(A)<s)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=A/_}var x=0,b=1;for(l=a,d=0;d<20&&(A=this.sampleCurveX(l),!(Math.abs(A-a)<s));d++)a>A?x=l:b=l,l=.5*(b-x)+x;return l},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var X=F(N),q=H;function H(a,s){this.x=a,this.y=s}H.prototype={clone:function(){return new H(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,l=a.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),l=Math.sin(a),d=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=d,this},_rotateAround:function(a,s){var l=Math.cos(a),d=Math.sin(a),A=s.y+d*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-d*(this.y-s.y),this.y=A,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(a){return a instanceof H?a:Array.isArray(a)?new H(a[0],a[1]):a};var W=F(q);const se=Math.PI/180,de=180/Math.PI;function te(a){return a*se}function ce(a){return a*de}const Ee=[[0,0],[1,0],[1,1],[0,1]];function Be(a){if(a<=0)return 0;if(a>=1)return 1;const s=a*a,l=s*a;return 4*(a<.5?l:3*(a-s)+l-.75)}function De(a,s,l,d){const A=new X(a,s,l,d);return function(_){return A.solve(_)}}const Re=De(.25,.1,.25,1);function ye(a,s,l){return Math.min(l,Math.max(s,a))}function ht(a,s,l){return(l=ye((l-a)/(s-a),0,1))*l*(3-2*l)}function oe(a,s,l){const d=l-s,A=((a-s)%d+d)%d+s;return A===s?l:A}function Tt(a,s,l){if(!a.length)return l(null,[]);let d=a.length;const A=new Array(a.length);let _=null;a.forEach((x,b)=>{s(x,(S,T)=>{S&&(_=S),A[b]=T,--d==0&&l(_,A)})})}function Fe(a){const s=[];for(const l in a)s.push(a[l]);return s}function st(a,...s){for(const l of s)for(const d in l)a[d]=l[d];return a}let Et=1;function Ke(){return Et++}function Ne(){return function a(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function dt(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function xt(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function ft(a,s){a.forEach(l=>{s[l]&&(s[l]=s[l].bind(s))})}function Ve(a,s){return a.indexOf(s,a.length-s.length)!==-1}function Ye(a,s,l){const d={};for(const A in a)d[A]=s.call(l||this,a[A],A,a);return d}function ae(a,s,l){const d={};for(const A in a)s.call(l||this,a[A],A,a)&&(d[A]=a[A]);return d}function _e(a){return Array.isArray(a)?a.map(_e):typeof a=="object"&&a?Ye(a,_e):a}const Ze={};function nt(a){Ze[a]||(typeof console<"u"&&console.warn(a),Ze[a]=!0)}function ut(a,s,l){return(l.y-a.y)*(s.x-a.x)>(s.y-a.y)*(l.x-a.x)}function ze(a){let s=0;for(let l,d,A=0,_=a.length,x=_-1;A<_;x=A++)l=a[A],d=a[x],s+=(d.x-l.x)*(l.y+d.y);return s}function Qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function mt(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,A,_)=>{const x=A||_;return s[d]=!x||x.toLowerCase(),""}),s["max-age"]){const l=parseInt(s["max-age"],10);isNaN(l)?delete s["max-age"]:s["max-age"]=l}return s}let Ut=null;function Dt(a){if(Ut==null){const s=a.navigator?a.navigator.userAgent:null;Ut=!!a.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ut}function Ie(a){try{const s=p[a];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function ue(a,s){return[a[4*s],a[4*s+1],a[4*s+2],a[4*s+3]]}const at="mapbox-tiles";let St=500,yt=50,Pt,Ot;function Ue(){try{return p.caches}catch{}}function ot(){Ue()&&!Pt&&(Pt=p.caches.open(at))}function ni(a){const s=a.indexOf("?");if(s<0)return a;const l=function(A){const _=A.indexOf("?");return _>0?A.slice(_+1).split("&"):[]}(a),d=l.filter(A=>{const _=A.split("=");return _[0]==="language"||_[0]==="worldview"});return d.length?`${a.slice(0,s)}?${d.join("&")}`:a.slice(0,s)}let fi=1/0;const Xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Xt);class _i extends Error{constructor(s,l,d){l===401&&Oe(d)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const si=Qt()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,wt=function(a,s){if(!(/^file:/.test(l=a.url)||/^file:/.test(si())&&!/^\w+:/.test(l))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(d,A){const _=new p.AbortController,x=new p.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:si(),referrerPolicy:d.referrerPolicy,signal:_.signal});let b=!1,S=!1;const T=(k=x.url).indexOf("sku=")>0&&Oe(k);var k;d.type==="json"&&x.headers.set("Accept","application/json");const G=(K,$,re)=>{if(S)return;if(K&&K.message!=="SecurityError"&&nt(K.toString()),$&&re)return V($);const ge=Date.now();p.fetch(x).then(Me=>{if(Me.ok){const He=T?Me.clone():null;return V(Me,He,ge)}return A(new _i(Me.statusText,Me.status,d.url))}).catch(Me=>{Me.name!=="AbortError"&&A(new Error(`${Me.message} ${d.url}`))})},V=(K,$,re)=>{(d.type==="arrayBuffer"?K.arrayBuffer():d.type==="json"?K.json():K.text()).then(ge=>{S||($&&re&&function(Me,He,Te){if(ot(),!Pt)return;const Ge={status:He.status,statusText:He.statusText,headers:new p.Headers};He.headers.forEach((It,gt)=>Ge.headers.set(gt,It));const qe=mt(He.headers.get("Cache-Control")||"");if(qe["no-store"])return;qe["max-age"]&&Ge.headers.set("Expires",new Date(Te+1e3*qe["max-age"]).toUTCString());const We=Ge.headers.get("Expires");We&&(new Date(We).getTime()-Te<42e4||function(It,gt){if(Ot===void 0)try{new Response(new ReadableStream),Ot=!0}catch{Ot=!1}Ot?gt(It.body):It.blob().then(gt)}(He,It=>{const gt=new p.Response(It,Ge);ot(),Pt&&Pt.then(Lt=>Lt.put(ni(Me.url),gt)).catch(Lt=>nt(Lt.message))}))}(x,$,re),b=!0,A(null,ge,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(ge=>{S||A(new Error(ge.message))})};return T?function(K,$){if(ot(),!Pt)return $(null);const re=ni(K.url);Pt.then(ge=>{ge.match(re).then(Me=>{const He=function(Te){if(!Te)return!1;const Ge=new Date(Te.headers.get("Expires")||0),qe=mt(Te.headers.get("Cache-Control")||"");return Ge>Date.now()&&!qe["no-cache"]}(Me);ge.delete(re),He&&ge.put(re,Me.clone()),$(null,Me,He)}).catch($)}).catch($)}(x,G):G(null,null),{cancel:()=>{S=!0,b||_.abort()}}}(a,s);if(Qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s,void 0,!0)}var l;return function(d,A){const _=new p.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const x in d.headers)_.setRequestHeader(x,d.headers[x]);return d.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=d.credentials==="include",_.onerror=()=>{A(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let x=_.response;if(d.type==="json")try{x=JSON.parse(_.response)}catch(b){return A(b)}A(null,x,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else A(new _i(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(a,s)},kt=function(a,s){return wt(st(a,{type:"arrayBuffer"}),s)};function yi(a){const s=p.document.createElement("a");return s.href=a,s.protocol===p.document.location.protocol&&s.host===p.document.location.host}const ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let J,Z;J=[],Z=0;const Ae=function(a,s){if(C.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),Z>=I.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:a,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return J.push(_),_}Z++;let l=!1;const d=()=>{if(!l)for(l=!0,Z--;J.length&&Z<I.MAX_PARALLEL_IMAGE_REQUESTS;){const _=J.shift(),{requestParameters:x,callback:b,cancelled:S}=_;S||(_.cancel=Ae(x,b).cancel)}},A=kt(a,(_,x,b,S)=>{d(),_?s(_):x&&(p.createImageBitmap?function(T,k){const G=new p.Blob([new Uint8Array(T)],{type:"image/png"});p.createImageBitmap(G).then(V=>{k(null,V)}).catch(V=>{k(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(T,k)=>s(T,k,b,S)):function(T,k){const G=new p.Image,V=p.URL;G.onload=()=>{k(null,G),V.revokeObjectURL(G.src),G.onload=null,p.requestAnimationFrame(()=>{G.src=ee})},G.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new p.Blob([new Uint8Array(T)],{type:"image/png"});G.src=T.byteLength?V.createObjectURL(K):ee}(x,(T,k)=>s(T,k,b,S)))});return{cancel:()=>{A.cancel(),d()}}},Ce="NO_ACCESS_TOKEN";function Le(a){return a.indexOf("mapbox:")===0}function Oe(a){return I.API_URL_REGEX.test(a)}function le(a){return I.API_CDN_URL_REGEX.test(a)}function me(a){return I.API_STYLE_REGEX.test(a)&&!he(a)}function he(a){return I.API_SPRITE_REGEX.test(a)}const Qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Je(a){const s=a.match(Qe);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Xe(a){const s=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${s}`}const Ft="mapbox.eventData";function Wt(a){if(!a)return null;const s=a.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(s[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class qt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const l=Wt(I.ACCESS_TOKEN);let d="";return d=l&&l.u?p.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(A,_)=>String.fromCharCode(Number("0x"+_)))):I.ACCESS_TOKEN||"",s?`${Ft}.${s}:${d}`:`${Ft}:${d}`}fetchEventData(){const s=Ie("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{const A=p.localStorage.getItem(l);A&&(this.eventData=JSON.parse(A));const _=p.localStorage.getItem(d);_&&(this.anonId=_)}catch{nt("Unable to read from LocalStorage")}}saveEventData(){const s=Ie("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{p.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{nt("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,l,d,A){if(!I.EVENTS_URL)return;const _=Je(I.EVENTS_URL);_.params.push(`access_token=${A||I.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(s).toISOString()},b=l?st(x,l):x,S={url:Xe(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};this.pendingRequest=function(T,k){return wt(st(T,{method:"POST"}),k)}(S,T=>{this.pendingRequest=null,d(T),this.saveEventData(),this.processRequests(A)})}queueRequest(s,l){this.queue.push(s),this.processRequests(l)}}const pe=new class extends qt{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,s){I.EVENTS_URL&&I.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>Le(l)||Oe(l))&&this.queueRequest(Date.now(),s)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Wt(I.ACCESS_TOKEN),l=s?s.u:I.ACCESS_TOKEN;let d=l!==this.eventData.tokenU;xt(this.anonId)||(this.anonId=Ne(),d=!0);const A=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),x=new Date(A),b=(A-this.eventData.lastSuccess)/864e5;d=d||b>=1||b<-1||_.getDate()!==x.getDate()}else d=!0;d?this.postEvent(A,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:O,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=A,this.eventData.tokenU=l)},a):this.processRequests()}},je=pe.postTurnstileEvent.bind(pe),pt=new class extends qt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,s,l,d){this.skuToken=s,this.errorCb=d,I.EVENTS_URL&&(l||I.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ce)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:l}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),xt(this.anonId)||(this.anonId=Ne()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:O,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},a))}},it=pt.postMapLoadEvent.bind(pt),Ct=new class extends qt{constructor(){super("gljs.performance")}postPerformanceEvent(a,s){I.EVENTS_URL&&(a||I.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},a)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:l}=this.queue.shift(),d=function(A){const _=p.performance.getEntriesByType("resource"),x=p.performance.getEntriesByType("mark"),b=function(V){const K={};if(V){for(const $ in V)if($!=="other")for(const re of V[$]){const ge=`${$}ResolveRangeMin`,Me=`${$}ResolveRangeMax`,He=`${$}RequestCount`,Te=`${$}RequestCachedCount`;K[ge]=Math.min(K[ge]||1/0,re.startTime),K[Me]=Math.max(K[Me]||-1/0,re.responseEnd);const Ge=qe=>{K[qe]===void 0&&(K[qe]=0),++K[qe]};re.transferSize!==void 0&&re.transferSize===0&&Ge(Te),Ge(He)}}return K}(function(V,K){const $={};if(V)for(const re of V){const ge=K(re);$[ge]===void 0&&($[ge]=[]),$[ge].push(re)}return $}(_,Li)),S=p.devicePixelRatio,T=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},G=(V,K,$)=>{$!=null&&V.push({name:K,value:$.toString()})};for(const V in b)G(k.counters,V,b[V]);if(A.interactionRange[0]!==1/0&&A.interactionRange[1]!==-1/0&&(G(k.counters,"interactionRangeMin",A.interactionRange[0]),G(k.counters,"interactionRangeMax",A.interactionRange[1])),x)for(const V of Object.keys(zi)){const K=zi[V],$=x.find(re=>re.name===K);$&&G(k.counters,K,$.startTime)}return G(k.counters,"visibilityHidden",A.visibilityHidden),G(k.attributes,"style",function(V){if(V)for(const K of V){const $=K.name.split("?")[0];if(me($)){const re=$.split("/").slice(-2);if(re.length===2)return`mapbox://styles/${re[0]}/${re[1]}`}}}(_)),G(k.attributes,"terrainEnabled",A.terrainEnabled?"true":"false"),G(k.attributes,"fogEnabled",A.fogEnabled?"true":"false"),G(k.attributes,"projection",A.projection),G(k.attributes,"zoom",A.zoom),G(k.metadata,"devicePixelRatio",S),G(k.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),G(k.metadata,"navigatorUserAgent",p.navigator.userAgent),G(k.metadata,"screenWidth",p.screen.width),G(k.metadata,"screenHeight",p.screen.height),G(k.metadata,"windowWidth",p.innerWidth),G(k.metadata,"windowHeight",p.innerHeight),G(k.metadata,"mapWidth",A.width/S),G(k.metadata,"mapHeight",A.height/S),G(k.metadata,"webglRenderer",A.renderer),G(k.metadata,"webglVendor",A.vendor),G(k.metadata,"sdkVersion",g),G(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(l);for(const A of d.metadata);for(const A of d.counters);for(const A of d.attributes);this.postEvent(s,d,()=>{},a)}},li=Ct.postPerformanceEvent.bind(Ct),Ai=new class extends qt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,s,l,d){if(!I.API_URL||!I.SESSION_PATH)return;const A=Je(I.API_URL+I.SESSION_PATH);A.params.push(`sku=${s||""}`),A.params.push(`access_token=${d||I.ACCESS_TOKEN||""}`);const _={url:Xe(A),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(x,b){return wt(st(x,{method:"GET"}),b)}(_,x=>{this.pendingRequest=null,l(x),this.saveEventData(),this.processRequests(d)})}getSessionAPI(a,s,l,d){this.skuToken=s,this.errorCb=d,I.SESSION_PATH&&I.API_URL&&(l||I.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ce)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:l}=this.queue.shift();s&&this.success[s]||this.getSession(l,this.skuToken,d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},a)}},oi=Ai.getSessionAPI.bind(Ai),ci=new Set,zi={create:"create",load:"load",fullLoad:"fullLoad"},Pi={mark(a){p.performance.mark(a)},measure(a,s,l){p.performance.measure(a,s,l)}};function Li(a){const s=a.name.split("?")[0];return le(s)&&s.includes("mapbox-gl.js")?"javascript":le(s)&&s.includes("mapbox-gl.css")?"css":function(l){return I.API_FONTS_REGEX.test(l)}(s)?"fontRange":he(s)?"sprite":me(s)?"style":function(l){return I.API_TILEJSON_REGEX.test(l)}(s)?"tilejson":"other"}const xi=p.performance;function Gn(a){const s=a?a.url.toString():void 0;return xi.getEntriesByName(s)}let Sr,Es,wn,ki;const Mr={now:()=>wn!==void 0?wn:p.performance.now(),setNow(a){wn=a},restoreNow(){wn=void 0},frame(a){const s=p.requestAnimationFrame(a);return{cancel:()=>p.cancelAnimationFrame(s)}},getImageData(a,s=0){const{width:l,height:d}=a;ki||(ki=p.document.createElement("canvas"));const A=ki.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return(l>ki.width||d>ki.height)&&(ki.width=l,ki.height=d),A.clearRect(-s,-s,l+2*s,d+2*s),A.drawImage(a,0,0,l,d),A.getImageData(-s,-s,l+2*s,d+2*s)},resolveURL:a=>(Sr||(Sr=p.document.createElement("a")),Sr.href=a,Sr.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Es==null&&(Es=p.matchMedia("(prefers-reduced-motion: reduce)")),Es.matches)}};function ur(a,s,l){l[a]&&l[a].indexOf(s)!==-1||(l[a]=l[a]||[],l[a].push(s))}function vo(a,s,l){if(l&&l[a]){const d=l[a].indexOf(s);d!==-1&&l[a].splice(d,1)}}class Go{constructor(s,l={}){st(this,l),this.type=s}}class As extends Go{constructor(s,l={}){super("error",st({error:s},l))}}class Ia{on(s,l){return this._listeners=this._listeners||{},ur(s,l,this._listeners),this}off(s,l){return vo(s,l,this._listeners),vo(s,l,this._oneTimeListeners),this}once(s,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},ur(s,l,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,l){typeof s=="string"&&(s=new Go(s,l||{}));const d=s.type;if(this.listens(d)){s.target=this;const A=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const b of A)b.call(this,s);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const b of _)vo(d,b,this._oneTimeListeners),b.call(this,s);const x=this._eventedParent;x&&(st(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(s))}else s instanceof As&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,l){return this._eventedParent=s,this._eventedParentData=l,this}}var Mt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Wr(a,...s){for(const l of s)for(const d in l)a[d]=l[d];return a}function qn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function In(a){if(Array.isArray(a))return a.map(In);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const l in a)s[l]=In(a[l]);return s}return qn(a)}class Uc extends Error{constructor(s,l){super(l),this.message=l,this.key=s}}var Zs=Uc;class Oc{constructor(s,l=[]){this.parent=s,this.bindings={};for(const[d,A]of l)this.bindings[d]=A}concat(s){return new Oc(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var x0=Oc;const Gc={kind:"null"},gi={kind:"number"},nn={kind:"string"},Zi={kind:"boolean"},Us={kind:"color"},xo={kind:"object"},$i={kind:"value"},Os={kind:"collator"},mh={kind:"formatted"},zl={kind:"resolvedImage"};function $s(a,s){return{kind:"array",itemType:a,N:s}}function Yn(a){if(a.kind==="array"){const s=Yn(a.itemType);return typeof a.N=="number"?`array<${s}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${s}>`}return a.kind}const I0=[Gc,gi,nn,Zi,Us,mh,xo,$s($i),zl];function Ca(a,s){if(s.kind==="error")return null;if(a.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Ca(a.itemType,s.itemType))&&(typeof a.N!="number"||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if(a.kind==="value"){for(const l of I0)if(!Ca(l,s))return null}}return`Expected ${Yn(a)} but found ${Yn(s)} instead.`}function _h(a,s){return s.some(l=>l.kind===a.kind)}function yh(a,s){return s.some(l=>l==="null"?a===null:l==="array"?Array.isArray(a):l==="object"?a&&!Array.isArray(a)&&typeof a=="object":l===typeof a)}var JA,C0={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function vh(a){return(a=Math.round(a))<0?0:a>255?255:a}function xh(a){return vh(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function df(a){return(s=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:s>1?1:s;var s}function Hc(a,s,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(s-a)*l*6:2*l<1?s:3*l<2?a+(s-a)*(2/3-l)*6:a}try{JA={}.parseCSSColor=function(a){var s,l=a.replace(/ /g,"").toLowerCase();if(l in C0)return C0[l].slice();if(l[0]==="#")return l.length===4?(s=parseInt(l.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:l.length===7&&(s=parseInt(l.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var d=l.indexOf("("),A=l.indexOf(")");if(d!==-1&&A+1===l.length){var _=l.substr(0,d),x=l.substr(d+1,A-(d+1)).split(","),b=1;switch(_){case"rgba":if(x.length!==4)return null;b=df(x.pop());case"rgb":return x.length!==3?null:[xh(x[0]),xh(x[1]),xh(x[2]),b];case"hsla":if(x.length!==4)return null;b=df(x.pop());case"hsl":if(x.length!==3)return null;var S=(parseFloat(x[0])%360+360)%360/360,T=df(x[1]),k=df(x[2]),G=k<=.5?k*(T+1):k+T-k*T,V=2*k-G;return[vh(255*Hc(V,G,S+1/3)),vh(255*Hc(V,G,S)),vh(255*Hc(V,G,S-1/3)),b];default:return null}}return null}}catch{}class ws{constructor(s,l,d,A=1){this.r=s,this.g=l,this.b=d,this.a=A}static parse(s){if(!s)return;if(s instanceof ws)return s;if(typeof s!="string")return;const l=JA(s);return l?new ws(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[s,l,d,A]=this.toArray();return`rgba(${Math.round(s)},${Math.round(l)},${Math.round(d)},${A})`}toArray(){const{r:s,g:l,b:d,a:A}=this;return A===0?[0,0,0,0]:[255*s/A,255*l/A,255*d/A,A]}toArray01(){const{r:s,g:l,b:d,a:A}=this;return A===0?[0,0,0,0]:[s/A,l/A,d/A,A]}toArray01PremultipliedAlpha(){const{r:s,g:l,b:d,a:A}=this;return[s,l,d,A]}}ws.black=new ws(0,0,0,1),ws.white=new ws(1,1,1,1),ws.transparent=new ws(0,0,0,0),ws.red=new ws(1,0,0,1),ws.blue=new ws(0,0,1,1);var hr=ws;class XA{constructor(s,l,d){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,l){return this.collator.compare(s,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ZA{constructor(s,l,d,A,_){this.text=s.normalize?s.normalize():s,this.image=l,this.scale=d,this.fontStack=A,this.textColor=_}}class bs{constructor(s){this.sections=s}static fromString(s){return new bs([new ZA(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof bs?s:bs.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const l of this.sections){if(l.image){s.push(["image",l.image.name]);continue}s.push(l.text);const d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toArray())),s.push(d)}return s}}class eo{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new eo({name:s,available:!1}):null}serialize(){return["image",this.name]}}function E0(a,s,l,d){return typeof a=="number"&&a>=0&&a<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof l=="number"&&l>=0&&l<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[a,s,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[a,s,l,d]:[a,s,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ih(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof hr||a instanceof XA||a instanceof bs||a instanceof eo)return!0;if(Array.isArray(a)){for(const s of a)if(!Ih(s))return!1;return!0}if(typeof a=="object"){for(const s in a)if(!Ih(a[s]))return!1;return!0}return!1}function sr(a){if(a===null)return Gc;if(typeof a=="string")return nn;if(typeof a=="boolean")return Zi;if(typeof a=="number")return gi;if(a instanceof hr)return Us;if(a instanceof XA)return Os;if(a instanceof bs)return mh;if(a instanceof eo)return zl;if(Array.isArray(a)){const s=a.length;let l;for(const d of a){const A=sr(d);if(l){if(l===A)continue;l=$i;break}l=A}return $s(l||$i,s)}return xo}function Ch(a){const s=typeof a;return a===null?"":s==="string"||s==="number"||s==="boolean"?String(a):a instanceof hr||a instanceof bs||a instanceof eo?a.toString():JSON.stringify(a)}class $A{constructor(s,l){this.type=s,this.value=l}static parse(s,l){if(s.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Ih(s[1]))return l.error("invalid value");const d=s[1];let A=sr(d);const _=l.expectedType;return A.kind!=="array"||A.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(A=_),new $A(A,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof hr?["rgba"].concat(this.value.toArray()):this.value instanceof bs?this.value.serialize():this.value}}var Ul=$A,Yr=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const eg={string:nn,number:gi,boolean:Zi,object:xo};class tg{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let d,A=1;const _=s[0];if(_==="array"){let b,S;if(s.length>2){const T=s[1];if(typeof T!="string"||!(T in eg)||T==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=eg[T],A++}else b=$i;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);S=s[2],A++}d=$s(b,S)}else d=eg[_];const x=[];for(;A<s.length;A++){const b=l.parse(s[A],A,$i);if(!b)return null;x.push(b)}return new tg(d,x)}evaluate(s){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(s);if(!Ca(this.type,sr(d)))return d;if(l===this.args.length-1)throw new Yr(`Expected value to be of type ${Yn(this.type)}, but found ${Yn(sr(d))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,l=[s.kind];if(s.kind==="array"){const d=s.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){l.push(d.kind);const A=s.N;(typeof A=="number"||this.args.length>1)&&l.push(A)}}return l.concat(this.args.map(d=>d.serialize()))}}var Ea=tg;class ol{constructor(s){this.type=mh,this.sections=s}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&typeof d=="object")return l.error("First argument must be an image or text section.");const A=[];let _=!1;for(let x=1;x<=s.length-1;++x){const b=s[x];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let S=null;if(b["font-scale"]&&(S=l.parse(b["font-scale"],1,gi),!S))return null;let T=null;if(b["text-font"]&&(T=l.parse(b["text-font"],1,$s(nn)),!T))return null;let k=null;if(b["text-color"]&&(k=l.parse(b["text-color"],1,Us),!k))return null;const G=A[A.length-1];G.scale=S,G.font=T,G.textColor=k}else{const S=l.parse(s[x],1,$i);if(!S)return null;const T=S.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,A.push({content:S,scale:null,font:null,textColor:null})}}return new ol(A)}evaluate(s){return new bs(this.sections.map(l=>{const d=l.content.evaluate(s);return sr(d)===zl?new ZA("",d,null,null,null):new ZA(Ch(d),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))}eachChild(s){for(const l of this.sections)s(l.content),l.scale&&s(l.scale),l.font&&s(l.font),l.textColor&&s(l.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const l of this.sections){s.push(l.content.serialize());const d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),s.push(d)}return s}}class ff{constructor(s){this.type=zl,this.input=s}static parse(s,l){if(s.length!==2)return l.error("Expected two arguments.");const d=l.parse(s[1],1,nn);return d?new ff(d):l.error("No image name provided.")}evaluate(s){const l=this.input.evaluate(s),d=eo.fromString(l);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(l)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const F1={"to-boolean":Zi,"to-color":Us,"to-number":gi,"to-string":nn};class ig{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const d=s[0];if((d==="to-boolean"||d==="to-string")&&s.length!==2)return l.error("Expected one argument.");const A=F1[d],_=[];for(let x=1;x<s.length;x++){const b=l.parse(s[x],x,$i);if(!b)return null;_.push(b)}return new ig(A,_)}evaluate(s){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(s));if(this.type.kind==="color"){let l,d;for(const A of this.args){if(l=A.evaluate(s),d=null,l instanceof hr)return l;if(typeof l=="string"){const _=s.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:E0(l[0],l[1],l[2],l[3]),!d))return new hr(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Yr(d||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const d of this.args){if(l=d.evaluate(s),l===null)return 0;const A=Number(l);if(!isNaN(A))return A}throw new Yr(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?bs.fromString(Ch(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?eo.fromString(Ch(this.args[0].evaluate(s))):Ch(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ol([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ff(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(l=>{s.push(l.serialize())}),s}}var Vc=ig;const Ho=["Unknown","Point","LineString","Polygon"];var ng=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ho[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:l,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*s-a[0])+this.featureDistanceData.bearing[1]*(d*s-a[1])}return 0}parseColor(a){let s=this._parseColorCache[a];return s||(s=this._parseColorCache[a]=hr.parse(a)),s}};class Ol{constructor(s,l,d,A){this.name=s,this.type=l,this._evaluate=d,this.args=A}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,l){const d=s[0],A=Ol.definitions[d];if(!A)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(A)?A[0]:A.type,x=Array.isArray(A)?[[A[1],A[2]]]:A.overloads,b=x.filter(([T])=>!Array.isArray(T)||T.length===s.length-1);let S=null;for(const[T,k]of b){S=new cg(l.registry,l.path,null,l.scope);const G=[];let V=!1;for(let K=1;K<s.length;K++){const $=s[K],re=Array.isArray(T)?T[K-1]:T.type,ge=S.parse($,1+G.length,re);if(!ge){V=!0;break}G.push(ge)}if(!V)if(Array.isArray(T)&&T.length!==G.length)S.error(`Expected ${T.length} arguments, but found ${G.length} instead.`);else{for(let K=0;K<G.length;K++){const $=Array.isArray(T)?T[K]:T.type,re=G[K];S.concat(K+1).checkSubtype($,re.type)}if(S.errors.length===0)return new Ol(d,_,k,G)}}if(b.length===1)l.errors.push(...S.errors);else{const T=(b.length?b:x).map(([G])=>{return V=G,Array.isArray(V)?`(${V.map(Yn).join(", ")})`:`(${Yn(V.type)}...)`;var V}).join(" | "),k=[];for(let G=1;G<s.length;G++){const V=l.parse(s[G],1+k.length);if(!V)return null;k.push(Yn(V.type))}l.error(`Expected arguments of type ${T}, but found (${k.join(", ")}) instead.`)}return null}static register(s,l){Ol.definitions=l;for(const d in l)s[d]=Ol}}var wa=Ol;class Eh{constructor(s,l,d){this.type=Os,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=l}static parse(s,l){if(s.length!==2)return l.error("Expected one argument.");const d=s[1];if(typeof d!="object"||Array.isArray(d))return l.error("Collator options argument must be an object.");const A=l.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Zi);if(!A)return null;const _=l.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Zi);if(!_)return null;let x=null;return d.locale&&(x=l.parse(d.locale,1,nn),!x)?null:new Eh(A,_,x)}evaluate(s){return new XA(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const ba=8192;function pf(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function Wc(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function wh(a,s){const l=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,A=Math.pow(2,s.z);return[Math.round(l*A*ba),Math.round(d*A*ba)]}function w0(a,s,l){const d=a[0]-s[0],A=a[1]-s[1],_=a[0]-l[0],x=a[1]-l[1];return d*x-_*A==0&&d*_<=0&&A*x<=0}function Af(a,s){let l=!1;for(let x=0,b=s.length;x<b;x++){const S=s[x];for(let T=0,k=S.length;T<k-1;T++){if(w0(a,S[T],S[T+1]))return!1;(A=S[T])[1]>(d=a)[1]!=(_=S[T+1])[1]>d[1]&&d[0]<(_[0]-A[0])*(d[1]-A[1])/(_[1]-A[1])+A[0]&&(l=!l)}}var d,A,_;return l}function rg(a,s){for(let l=0;l<s.length;l++)if(Af(a,s[l]))return!0;return!1}function sg(a,s,l,d){const A=d[0]-l[0],_=d[1]-l[1],x=(a[0]-l[0])*_-A*(a[1]-l[1]),b=(s[0]-l[0])*_-A*(s[1]-l[1]);return x>0&&b<0||x<0&&b>0}function Yc(a,s,l){for(const T of l)for(let k=0;k<T.length-1;++k)if((b=[(x=T[k+1])[0]-(_=T[k])[0],x[1]-_[1]])[0]*(S=[(A=s)[0]-(d=a)[0],A[1]-d[1]])[1]-b[1]*S[0]!=0&&sg(d,A,_,x)&&sg(_,x,d,A))return!0;var d,A,_,x,b,S;return!1}function gn(a,s){for(let l=0;l<a.length;++l)if(!Af(a[l],s))return!1;for(let l=0;l<a.length-1;++l)if(Yc(a[l],a[l+1],s))return!1;return!0}function N1(a,s){for(let l=0;l<s.length;l++)if(gn(a,s[l]))return!0;return!1}function og(a,s,l){const d=[];for(let A=0;A<a.length;A++){const _=[];for(let x=0;x<a[A].length;x++){const b=wh(a[A][x],l);pf(s,b),_.push(b)}d.push(_)}return d}function b0(a,s,l){const d=[];for(let A=0;A<a.length;A++){const _=og(a[A],s,l);d.push(_)}return d}function ag(a,s,l,d){if(a[0]<l[0]||a[0]>l[2]){const A=.5*d;let _=a[0]-l[0]>A?-d:l[0]-a[0]>A?d:0;_===0&&(_=a[0]-l[2]>A?-d:l[2]-a[0]>A?d:0),a[0]+=_}pf(s,a)}function B0(a,s,l,d){const A=Math.pow(2,d.z)*ba,_=[d.x*ba,d.y*ba],x=[];if(!a)return x;for(const b of a)for(const S of b){const T=[S.x+_[0],S.y+_[1]];ag(T,s,l,A),x.push(T)}return x}function lg(a,s,l,d){const A=Math.pow(2,d.z)*ba,_=[d.x*ba,d.y*ba],x=[];if(!a)return x;for(const S of a){const T=[];for(const k of S){const G=[k.x+_[0],k.y+_[1]];pf(s,G),T.push(G)}x.push(T)}if(s[2]-s[0]<=A/2){(b=s)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of x)for(const T of S)ag(T,s,l,A)}var b;return x}class jc{constructor(s,l){this.type=Zi,this.geojson=s,this.geometries=l}static parse(s,l){if(s.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Ih(s[1])){const d=s[1];if(d.type==="FeatureCollection")for(let A=0;A<d.features.length;++A){const _=d.features[A].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new jc(d,d.features[A].geometry)}else if(d.type==="Feature"){const A=d.geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new jc(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new jc(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(l,d){const A=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(d.type==="Polygon"){const b=og(d.coordinates,_,x),S=B0(l.geometry(),A,_,x);if(!Wc(A,_))return!1;for(const T of S)if(!Af(T,b))return!1}if(d.type==="MultiPolygon"){const b=b0(d.coordinates,_,x),S=B0(l.geometry(),A,_,x);if(!Wc(A,_))return!1;for(const T of S)if(!rg(T,b))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(l,d){const A=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(d.type==="Polygon"){const b=og(d.coordinates,_,x),S=lg(l.geometry(),A,_,x);if(!Wc(A,_))return!1;for(const T of S)if(!gn(T,b))return!1}if(d.type==="MultiPolygon"){const b=b0(d.coordinates,_,x),S=lg(l.geometry(),A,_,x);if(!Wc(A,_))return!1;for(const T of S)if(!N1(T,b))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var gf=jc;function qc(a){if(a instanceof wa&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof gf)return!1;let s=!0;return a.eachChild(l=>{s&&!qc(l)&&(s=!1)}),s}function Ba(a){if(a instanceof wa&&a.name==="feature-state")return!1;let s=!0;return a.eachChild(l=>{s&&!Ba(l)&&(s=!1)}),s}function Gl(a,s){if(a instanceof wa&&s.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(d=>{l&&!Gl(d,s)&&(l=!1)}),l}class mf{constructor(s,l){this.type=l.type,this.name=s,this.boundExpression=l}static parse(s,l){if(s.length!==2||typeof s[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const d=s[1];return l.scope.has(d)?new mf(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var S0=mf;class bh{constructor(s,l=[],d,A=new x0,_=[]){this.registry=s,this.path=l,this.key=l.map(x=>`[${x}]`).join(""),this.scope=A,this.errors=_,this.expectedType=d}parse(s,l,d,A,_={}){return l?this.concat(l,d,A)._parse(s,_):this._parse(s,_)}_parse(s,l){function d(A,_,x){return x==="assert"?new Ea(_,[A]):x==="coerce"?new Vc(_,[A]):A}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const A=s[0];if(typeof A!="string")return this.error(`Expression name must be a string, but found ${typeof A} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[A];if(_){let x=_.parse(s,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,S=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(b,S))return null}else x=d(x,b,l.typeAnnotation||"coerce");else x=d(x,b,l.typeAnnotation||"assert")}if(!(x instanceof Ul)&&x.type.kind!=="resolvedImage"&&ug(x)){const b=new ng;try{x=new Ul(x.type,x.evaluate(b))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${A}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,l,d){const A=typeof s=="number"?this.path.concat(s):this.path,_=d?this.scope.concat(d):this.scope;return new bh(this.registry,A,l||null,_,this.errors)}error(s,...l){const d=`${this.key}${l.map(A=>`[${A}]`).join("")}`;this.errors.push(new Zs(d,s))}checkSubtype(s,l){const d=Ca(s,l);return d&&this.error(d),d}}var cg=bh;function ug(a){if(a instanceof S0)return ug(a.boundExpression);if(a instanceof wa&&a.name==="error"||a instanceof Eh||a instanceof gf)return!1;const s=a instanceof Vc||a instanceof Ea;let l=!0;return a.eachChild(d=>{l=s?l&&ug(d):l&&d instanceof Ul}),!!l&&qc(a)&&Gl(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function _f(a,s){const l=a.length-1;let d,A,_=0,x=l,b=0;for(;_<=x;)if(b=Math.floor((_+x)/2),d=a[b],A=a[b+1],d<=s){if(b===l||s<A)return b;_=b+1}else{if(!(d>s))throw new Yr("Input is not a number.");x=b-1}return 0}class yf{constructor(s,l,d){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(const[A,_]of d)this.labels.push(A),this.outputs.push(_)}static parse(s,l){if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(s[1],1,gi);if(!d)return null;const A=[];let _=null;l.expectedType&&l.expectedType.kind!=="value"&&(_=l.expectedType);for(let x=1;x<s.length;x+=2){const b=x===1?-1/0:s[x],S=s[x+1],T=x,k=x+1;if(typeof b!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(A.length&&A[A.length-1][0]>=b)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const G=l.parse(S,k,_);if(!G)return null;_=_||G.type,A.push([b,G])}return new yf(_,d,A)}evaluate(s){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(s);const A=this.input.evaluate(s);if(A<=l[0])return d[0].evaluate(s);const _=l.length;return A>=l[_-1]?d[_-1].evaluate(s):d[_f(l,A)].evaluate(s)}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&s.push(this.labels[l]),s.push(this.outputs[l].serialize());return s}}var hg=yf;function an(a,s,l){return a*(1-l)+s*l}var Bh=Object.freeze({__proto__:null,array:function(a,s,l){return a.map((d,A)=>an(d,s[A],l))},color:function(a,s,l){return new hr(an(a.r,s.r,l),an(a.g,s.g,l),an(a.b,s.b,l),an(a.a,s.a,l))},number:an});const M0=.95047,dg=1.08883,T0=4/29,Hl=6/29,fg=3*Hl*Hl,z1=Hl*Hl*Hl,U1=Math.PI/180,O1=180/Math.PI;function pg(a){return a>z1?Math.pow(a,1/3):a/fg+T0}function Ag(a){return a>Hl?a*a*a:fg*(a-T0)}function gg(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function vf(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function D0(a){const s=vf(a.r),l=vf(a.g),d=vf(a.b),A=pg((.4124564*s+.3575761*l+.1804375*d)/M0),_=pg((.2126729*s+.7151522*l+.072175*d)/1);return{l:116*_-16,a:500*(A-_),b:200*(_-pg((.0193339*s+.119192*l+.9503041*d)/dg)),alpha:a.a}}function Q0(a){let s=(a.l+16)/116,l=isNaN(a.a)?s:s+a.a/500,d=isNaN(a.b)?s:s-a.b/200;return s=1*Ag(s),l=M0*Ag(l),d=dg*Ag(d),new hr(gg(3.2404542*l-1.5371385*s-.4985314*d),gg(-.969266*l+1.8760108*s+.041556*d),gg(.0556434*l-.2040259*s+1.0572252*d),a.alpha)}function G1(a,s,l){const d=s-a;return a+l*(d>180||d<-180?d-360*Math.round(d/360):d)}const Sh={forward:D0,reverse:Q0,interpolate:function(a,s,l){return{l:an(a.l,s.l,l),a:an(a.a,s.a,l),b:an(a.b,s.b,l),alpha:an(a.alpha,s.alpha,l)}}},Kc={forward:function(a){const{l:s,a:l,b:d}=D0(a),A=Math.atan2(d,l)*O1;return{h:A<0?A+360:A,c:Math.sqrt(l*l+d*d),l:s,alpha:a.a}},reverse:function(a){const s=a.h*U1,l=a.c;return Q0({l:a.l,a:Math.cos(s)*l,b:Math.sin(s)*l,alpha:a.alpha})},interpolate:function(a,s,l){return{h:G1(a.h,s.h,l),c:an(a.c,s.c,l),l:an(a.l,s.l,l),alpha:an(a.alpha,s.alpha,l)}}};var mg=Object.freeze({__proto__:null,hcl:Kc,lab:Sh});class Mh{constructor(s,l,d,A,_){this.type=s,this.operator=l,this.interpolation=d,this.input=A,this.labels=[],this.outputs=[];for(const[x,b]of _)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(s,l,d,A){let _=0;if(s.name==="exponential")_=_g(l,s.base,d,A);else if(s.name==="linear")_=_g(l,1,d,A);else if(s.name==="cubic-bezier"){const x=s.controlPoints;_=new X(x[0],x[1],x[2],x[3]).solve(_g(l,1,d,A))}return _}static parse(s,l){let[d,A,_,...x]=s;if(!Array.isArray(A)||A.length===0)return l.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){const T=A[1];if(typeof T!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:T}}else{if(A[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(A[0])}`,1,0);{const T=A.slice(1);if(T.length!==4||T.some(k=>typeof k!="number"||k<0||k>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:T}}}if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,gi),!_)return null;const b=[];let S=null;d==="interpolate-hcl"||d==="interpolate-lab"?S=Us:l.expectedType&&l.expectedType.kind!=="value"&&(S=l.expectedType);for(let T=0;T<x.length;T+=2){const k=x[T],G=x[T+1],V=T+3,K=T+4;if(typeof k!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(b.length&&b[b.length-1][0]>=k)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const $=l.parse(G,K,S);if(!$)return null;S=S||$.type,b.push([k,$])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Mh(S,d,A,_,b):l.error(`Type ${Yn(S)} is not interpolatable.`)}evaluate(s){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(s);const A=this.input.evaluate(s);if(A<=l[0])return d[0].evaluate(s);const _=l.length;if(A>=l[_-1])return d[_-1].evaluate(s);const x=_f(l,A),b=Mh.interpolationFactor(this.interpolation,A,l[x],l[x+1]),S=d[x].evaluate(s),T=d[x+1].evaluate(s);return this.operator==="interpolate"?Bh[this.type.kind.toLowerCase()](S,T,b):this.operator==="interpolate-hcl"?Kc.reverse(Kc.interpolate(Kc.forward(S),Kc.forward(T),b)):Sh.reverse(Sh.interpolate(Sh.forward(S),Sh.forward(T),b))}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,s,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function _g(a,s,l,d){const A=d-l,_=a-l;return A===0?0:s===1?_/A:(Math.pow(s,_)-1)/(Math.pow(s,A)-1)}var Vo=Mh;class xf{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expectected at least one argument.");let d=null;const A=l.expectedType;A&&A.kind!=="value"&&(d=A);const _=[];for(const b of s.slice(1)){const S=l.parse(b,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!S)return null;d=d||S.type,_.push(S)}const x=A&&_.some(b=>Ca(A,b.type));return new xf(x?$i:d,_)}evaluate(s){let l,d=null,A=0;for(const _ of this.args){if(A++,d=_.evaluate(s),d&&d instanceof eo&&!d.available&&(l||(l=d),d=null,A===this.args.length))return l;if(d!==null)break}return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(l=>{s.push(l.serialize())}),s}}var yg=xf;class If{constructor(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const l of this.bindings)s(l[1]);s(this.result)}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let _=1;_<s.length-1;_+=2){const x=s[_];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const b=l.parse(s[_+1],_+1);if(!b)return null;d.push([x,b])}const A=l.parse(s[s.length-1],s.length-1,l.expectedType,d);return A?new If(d,A):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[l,d]of this.bindings)s.push(l,d.serialize());return s.push(this.result.serialize()),s}}var R0=If;class vg{constructor(s,l,d){this.type=s,this.index=l,this.input=d}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,gi),A=l.parse(s[2],2,$s(l.expectedType||$i));return d&&A?new vg(A.type.itemType,d,A):null}evaluate(s){const l=this.index.evaluate(s),d=this.input.evaluate(s);if(l<0)throw new Yr(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new Yr(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new Yr(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var H1=vg;class xg{constructor(s,l){this.type=Zi,this.needle=s,this.haystack=l}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,$i),A=l.parse(s[2],2,$i);return d&&A?_h(d.type,[Zi,nn,gi,Gc,$i])?new xg(d,A):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(d.type)} instead`):null}evaluate(s){const l=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(d==null)return!1;if(!yh(l,["boolean","string","number","null"]))throw new Yr(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(sr(l))} instead.`);if(!yh(d,["string","array"]))throw new Yr(`Expected second argument to be of type array or string, but found ${Yn(sr(d))} instead.`);return d.indexOf(l)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Cf=xg;class Th{constructor(s,l,d){this.type=gi,this.needle=s,this.haystack=l,this.fromIndex=d}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,$i),A=l.parse(s[2],2,$i);if(!d||!A)return null;if(!_h(d.type,[Zi,nn,gi,Gc,$i]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(d.type)} instead`);if(s.length===4){const _=l.parse(s[3],3,gi);return _?new Th(d,A,_):null}return new Th(d,A)}evaluate(s){const l=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!yh(l,["boolean","string","number","null"]))throw new Yr(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(sr(l))} instead.`);if(!yh(d,["string","array"]))throw new Yr(`Expected second argument to be of type array or string, but found ${Yn(sr(d))} instead.`);if(this.fromIndex){const A=this.fromIndex.evaluate(s);return d.indexOf(l,A)}return d.indexOf(l)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var L0=Th;class Ig{constructor(s,l,d,A,_,x){this.inputType=s,this.type=l,this.input=d,this.cases=A,this.outputs=_,this.otherwise=x}static parse(s,l){if(s.length<5)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return l.error("Expected an even number of arguments.");let d,A;l.expectedType&&l.expectedType.kind!=="value"&&(A=l.expectedType);const _={},x=[];for(let T=2;T<s.length-1;T+=2){let k=s[T];const G=s[T+1];Array.isArray(k)||(k=[k]);const V=l.concat(T);if(k.length===0)return V.error("Expected at least one branch label.");for(const $ of k){if(typeof $!="number"&&typeof $!="string")return V.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return V.error("Numeric branch labels must be integer values.");if(d){if(V.checkSubtype(d,sr($)))return null}else d=sr($);if(_[String($)]!==void 0)return V.error("Branch labels must be unique.");_[String($)]=x.length}const K=l.parse(G,T,A);if(!K)return null;A=A||K.type,x.push(K)}const b=l.parse(s[1],1,$i);if(!b)return null;const S=l.parse(s[s.length-1],s.length-1,A);return S?b.type.kind!=="value"&&l.concat(1).checkSubtype(d,b.type)?null:new Ig(d,A,b,_,x,S):null}evaluate(s){const l=this.input.evaluate(s);return(sr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],A={};for(const x of l){const b=A[this.cases[x]];b===void 0?(A[this.cases[x]]=d.length,d.push([this.cases[x],[x]])):d[b][1].push(x)}const _=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,b]of d)s.push(b.length===1?_(b[0]):b.map(_)),s.push(this.outputs[x].serialize());return s.push(this.otherwise.serialize()),s}}var V1=Ig;class Cg{constructor(s,l,d){this.type=s,this.branches=l,this.otherwise=d}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);const A=[];for(let x=1;x<s.length-1;x+=2){const b=l.parse(s[x],x,Zi);if(!b)return null;const S=l.parse(s[x+1],x+1,d);if(!S)return null;A.push([b,S]),d=d||S.type}const _=l.parse(s[s.length-1],s.length-1,d);return _?new Cg(d,A,_):null}evaluate(s){for(const[l,d]of this.branches)if(l.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[l,d]of this.branches)s(l),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(l=>{s.push(l.serialize())}),s}}var P0=Cg;class Dh{constructor(s,l,d,A){this.type=s,this.input=l,this.beginIndex=d,this.endIndex=A}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,$i),A=l.parse(s[2],2,gi);if(!d||!A)return null;if(!_h(d.type,[$s($i),nn,$i]))return l.error(`Expected first argument to be of type array or string, but found ${Yn(d.type)} instead`);if(s.length===4){const _=l.parse(s[3],3,gi);return _?new Dh(d.type,d,A,_):null}return new Dh(d.type,d,A)}evaluate(s){const l=this.input.evaluate(s),d=this.beginIndex.evaluate(s);if(!yh(l,["string","array"]))throw new Yr(`Expected first argument to be of type array or string, but found ${Yn(sr(l))} instead.`);if(this.endIndex){const A=this.endIndex.evaluate(s);return l.slice(d,A)}return l.slice(d)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var k0=Dh;function Ef(a,s){return a==="=="||a==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function F0(a,s,l,d){return d.compare(s,l)===0}function Jc(a,s,l){const d=a!=="=="&&a!=="!=";return class LF{constructor(_,x,b){this.type=Zi,this.lhs=_,this.rhs=x,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const b=_[0];let S=x.parse(_[1],1,$i);if(!S)return null;if(!Ef(b,S.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${Yn(S.type)}'.`);let T=x.parse(_[2],2,$i);if(!T)return null;if(!Ef(b,T.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${Yn(T.type)}'.`);if(S.type.kind!==T.type.kind&&S.type.kind!=="value"&&T.type.kind!=="value")return x.error(`Cannot compare types '${Yn(S.type)}' and '${Yn(T.type)}'.`);d&&(S.type.kind==="value"&&T.type.kind!=="value"?S=new Ea(T.type,[S]):S.type.kind!=="value"&&T.type.kind==="value"&&(T=new Ea(S.type,[T])));let k=null;if(_.length===4){if(S.type.kind!=="string"&&T.type.kind!=="string"&&S.type.kind!=="value"&&T.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(k=x.parse(_[3],3,Os),!k)return null}return new LF(S,T,k)}evaluate(_){const x=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const S=sr(x),T=sr(b);if(S.kind!==T.kind||S.kind!=="string"&&S.kind!=="number")throw new Yr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${S.kind}, ${T.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const S=sr(x),T=sr(b);if(S.kind!=="string"||T.kind!=="string")return s(_,x,b)}return this.collator?l(_,x,b,this.collator.evaluate(_)):s(_,x,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[a];return this.eachChild(x=>{_.push(x.serialize())}),_}}}const W1=Jc("==",function(a,s,l){return s===l},F0),Y1=Jc("!=",function(a,s,l){return s!==l},function(a,s,l,d){return!F0(0,s,l,d)}),j1=Jc("<",function(a,s,l){return s<l},function(a,s,l,d){return d.compare(s,l)<0}),q1=Jc(">",function(a,s,l){return s>l},function(a,s,l,d){return d.compare(s,l)>0}),K1=Jc("<=",function(a,s,l){return s<=l},function(a,s,l,d){return d.compare(s,l)<=0}),N0=Jc(">=",function(a,s,l){return s>=l},function(a,s,l,d){return d.compare(s,l)>=0});class wf{constructor(s,l,d,A,_,x){this.type=nn,this.number=s,this.locale=l,this.currency=d,this.unit=A,this.minFractionDigits=_,this.maxFractionDigits=x}static parse(s,l){if(s.length!==3)return l.error("Expected two arguments.");const d=l.parse(s[1],1,gi);if(!d)return null;const A=s[2];if(typeof A!="object"||Array.isArray(A))return l.error("NumberFormat options argument must be an object.");let _=null;if(A.locale&&(_=l.parse(A.locale,1,nn),!_))return null;let x=null;if(A.currency&&(x=l.parse(A.currency,1,nn),!x))return null;let b=null;if(A.unit&&(b=l.parse(A.unit,1,nn),!b))return null;let S=null;if(A["min-fraction-digits"]&&(S=l.parse(A["min-fraction-digits"],1,gi),!S))return null;let T=null;return A["max-fraction-digits"]&&(T=l.parse(A["max-fraction-digits"],1,gi),!T)?null:new wf(d,_,x,b,S,T)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class Xc{constructor(s){this.type=gi,this.input=s}static parse(s,l){if(s.length!==2)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=l.parse(s[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Yn(d.type)} instead.`):new Xc(d):null}evaluate(s){const l=this.input.evaluate(s);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Yr(`Expected value to be of type string or array, but found ${Yn(sr(l))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(l=>{s.push(l.serialize())}),s}}const z0={"==":W1,"!=":Y1,">":q1,"<":j1,">=":N0,"<=":K1,array:Ea,at:H1,boolean:Ea,case:P0,coalesce:yg,collator:Eh,format:ol,image:ff,in:Cf,"index-of":L0,interpolate:Vo,"interpolate-hcl":Vo,"interpolate-lab":Vo,length:Xc,let:R0,literal:Ul,match:V1,number:Ea,"number-format":wf,object:Ea,slice:k0,step:hg,string:Ea,"to-boolean":Vc,"to-color":Vc,"to-number":Vc,"to-string":Vc,var:S0,within:gf};function U0(a,[s,l,d,A]){s=s.evaluate(a),l=l.evaluate(a),d=d.evaluate(a);const _=A?A.evaluate(a):1,x=E0(s,l,d,_);if(x)throw new Yr(x);return new hr(s/255*_,l/255*_,d/255*_,_)}function Sa(a,s){return a in s}function bf(a,s){const l=s[a];return l===void 0?null:l}function to(a){return{type:a}}wa.register(z0,{error:[{kind:"error"},[nn],(a,[s])=>{throw new Yr(s.evaluate(a))}],typeof:[nn,[$i],(a,[s])=>Yn(sr(s.evaluate(a)))],"to-rgba":[$s(gi,4),[Us],(a,[s])=>s.evaluate(a).toArray()],rgb:[Us,[gi,gi,gi],U0],rgba:[Us,[gi,gi,gi,gi],U0],has:{type:Zi,overloads:[[[nn],(a,[s])=>Sa(s.evaluate(a),a.properties())],[[nn,xo],(a,[s,l])=>Sa(s.evaluate(a),l.evaluate(a))]]},get:{type:$i,overloads:[[[nn],(a,[s])=>bf(s.evaluate(a),a.properties())],[[nn,xo],(a,[s,l])=>bf(s.evaluate(a),l.evaluate(a))]]},"feature-state":[$i,[nn],(a,[s])=>bf(s.evaluate(a),a.featureState||{})],properties:[xo,[],a=>a.properties()],"geometry-type":[nn,[],a=>a.geometryType()],id:[$i,[],a=>a.id()],zoom:[gi,[],a=>a.globals.zoom],pitch:[gi,[],a=>a.globals.pitch||0],"distance-from-center":[gi,[],a=>a.distanceFromCenter()],"heatmap-density":[gi,[],a=>a.globals.heatmapDensity||0],"line-progress":[gi,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[gi,[],a=>a.globals.skyRadialProgress||0],accumulated:[$i,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[gi,to(gi),(a,s)=>{let l=0;for(const d of s)l+=d.evaluate(a);return l}],"*":[gi,to(gi),(a,s)=>{let l=1;for(const d of s)l*=d.evaluate(a);return l}],"-":{type:gi,overloads:[[[gi,gi],(a,[s,l])=>s.evaluate(a)-l.evaluate(a)],[[gi],(a,[s])=>-s.evaluate(a)]]},"/":[gi,[gi,gi],(a,[s,l])=>s.evaluate(a)/l.evaluate(a)],"%":[gi,[gi,gi],(a,[s,l])=>s.evaluate(a)%l.evaluate(a)],ln2:[gi,[],()=>Math.LN2],pi:[gi,[],()=>Math.PI],e:[gi,[],()=>Math.E],"^":[gi,[gi,gi],(a,[s,l])=>Math.pow(s.evaluate(a),l.evaluate(a))],sqrt:[gi,[gi],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[gi,[gi],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[gi,[gi],(a,[s])=>Math.log(s.evaluate(a))],log2:[gi,[gi],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[gi,[gi],(a,[s])=>Math.sin(s.evaluate(a))],cos:[gi,[gi],(a,[s])=>Math.cos(s.evaluate(a))],tan:[gi,[gi],(a,[s])=>Math.tan(s.evaluate(a))],asin:[gi,[gi],(a,[s])=>Math.asin(s.evaluate(a))],acos:[gi,[gi],(a,[s])=>Math.acos(s.evaluate(a))],atan:[gi,[gi],(a,[s])=>Math.atan(s.evaluate(a))],min:[gi,to(gi),(a,s)=>Math.min(...s.map(l=>l.evaluate(a)))],max:[gi,to(gi),(a,s)=>Math.max(...s.map(l=>l.evaluate(a)))],abs:[gi,[gi],(a,[s])=>Math.abs(s.evaluate(a))],round:[gi,[gi],(a,[s])=>{const l=s.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[gi,[gi],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[gi,[gi],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[Zi,[nn,$i],(a,[s,l])=>a.properties()[s.value]===l.value],"filter-id-==":[Zi,[$i],(a,[s])=>a.id()===s.value],"filter-type-==":[Zi,[nn],(a,[s])=>a.geometryType()===s.value],"filter-<":[Zi,[nn,$i],(a,[s,l])=>{const d=a.properties()[s.value],A=l.value;return typeof d==typeof A&&d<A}],"filter-id-<":[Zi,[$i],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l<d}],"filter->":[Zi,[nn,$i],(a,[s,l])=>{const d=a.properties()[s.value],A=l.value;return typeof d==typeof A&&d>A}],"filter-id->":[Zi,[$i],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l>d}],"filter-<=":[Zi,[nn,$i],(a,[s,l])=>{const d=a.properties()[s.value],A=l.value;return typeof d==typeof A&&d<=A}],"filter-id-<=":[Zi,[$i],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l<=d}],"filter->=":[Zi,[nn,$i],(a,[s,l])=>{const d=a.properties()[s.value],A=l.value;return typeof d==typeof A&&d>=A}],"filter-id->=":[Zi,[$i],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l>=d}],"filter-has":[Zi,[$i],(a,[s])=>s.value in a.properties()],"filter-has-id":[Zi,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Zi,[$s(nn)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[Zi,[$s($i)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[Zi,[nn,$s($i)],(a,[s,l])=>l.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[Zi,[nn,$s($i)],(a,[s,l])=>function(d,A,_,x){for(;_<=x;){const b=_+x>>1;if(A[b]===d)return!0;A[b]>d?x=b-1:_=b+1}return!1}(a.properties()[s.value],l.value,0,l.value.length-1)],all:{type:Zi,overloads:[[[Zi,Zi],(a,[s,l])=>s.evaluate(a)&&l.evaluate(a)],[to(Zi),(a,s)=>{for(const l of s)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Zi,overloads:[[[Zi,Zi],(a,[s,l])=>s.evaluate(a)||l.evaluate(a)],[to(Zi),(a,s)=>{for(const l of s)if(l.evaluate(a))return!0;return!1}]]},"!":[Zi,[Zi],(a,[s])=>!s.evaluate(a)],"is-supported-script":[Zi,[nn],(a,[s])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(s.evaluate(a))}],upcase:[nn,[nn],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[nn,[nn],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[nn,to($i),(a,s)=>s.map(l=>Ch(l.evaluate(a))).join("")],"resolved-locale":[nn,[Os],(a,[s])=>s.evaluate(a).resolvedLocale()]});var Qh=z0;function O0(a){return{result:"success",value:a}}function Vl(a){return{result:"error",value:a}}function Zc(a){return a["property-type"]==="data-driven"}function Bf(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Sf(a){return!!a.expression&&a.expression.interpolated}function un(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Rh(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function G0(a){return a}function Mf(a,s){const l=s.type==="color",d=a.stops&&typeof a.stops[0][0]=="object",A=d||!(d||a.property!==void 0),_=a.type||(Sf(s)?"exponential":"interval");if(l&&((a=Wr({},a)).stops&&(a.stops=a.stops.map(T=>[T[0],hr.parse(T[1])])),a.default=hr.parse(a.default?a.default:s.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!mg[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let x,b,S;if(_==="exponential")x=Ma;else if(_==="interval")x=Tf;else if(_==="categorical"){x=H0,b=Object.create(null);for(const T of a.stops)b[T[0]]=T[1];S=typeof a.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);x=V0}if(d){const T={},k=[];for(let K=0;K<a.stops.length;K++){const $=a.stops[K],re=$[0].zoom;T[re]===void 0&&(T[re]={zoom:re,type:a.type,property:a.property,default:a.default,stops:[]},k.push(re)),T[re].stops.push([$[0].value,$[1]])}const G=[];for(const K of k)G.push([T[K].zoom,Mf(T[K],s)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Vo.interpolationFactor.bind(void 0,V),zoomStops:G.map(K=>K[0]),evaluate:({zoom:K},$)=>Ma({stops:G,base:a.base},s,K).evaluate(K,$)}}if(A){const T=_==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Vo.interpolationFactor.bind(void 0,T),zoomStops:a.stops.map(k=>k[0]),evaluate:({zoom:k})=>x(a,s,k,b,S)}}return{kind:"source",evaluate(T,k){const G=k&&k.properties?k.properties[a.property]:void 0;return G===void 0?$c(a.default,s.default):x(a,s,G,b,S)}}}function $c(a,s,l){return a!==void 0?a:s!==void 0?s:l!==void 0?l:void 0}function H0(a,s,l,d,A){return $c(typeof l===A?d[l]:void 0,a.default,s.default)}function Tf(a,s,l){if(un(l)!=="number")return $c(a.default,s.default);const d=a.stops.length;if(d===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[d-1][0])return a.stops[d-1][1];const A=_f(a.stops.map(_=>_[0]),l);return a.stops[A][1]}function Ma(a,s,l){const d=a.base!==void 0?a.base:1;if(un(l)!=="number")return $c(a.default,s.default);const A=a.stops.length;if(A===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[A-1][0])return a.stops[A-1][1];const _=_f(a.stops.map(k=>k[0]),l),x=function(k,G,V,K){const $=K-V,re=k-V;return $===0?0:G===1?re/$:(Math.pow(G,re)-1)/(Math.pow(G,$)-1)}(l,d,a.stops[_][0],a.stops[_+1][0]),b=a.stops[_][1],S=a.stops[_+1][1];let T=Bh[s.type]||G0;if(a.colorSpace&&a.colorSpace!=="rgb"){const k=mg[a.colorSpace];T=(G,V)=>k.reverse(k.interpolate(k.forward(G),k.forward(V),x))}return typeof b.evaluate=="function"?{evaluate(...k){const G=b.evaluate.apply(void 0,k),V=S.evaluate.apply(void 0,k);if(G!==void 0&&V!==void 0)return T(G,V,x)}}:T(b,S,x)}function V0(a,s,l){return s.type==="color"?l=hr.parse(l):s.type==="formatted"?l=bs.fromString(l.toString()):s.type==="resolvedImage"?l=eo.fromString(l.toString()):un(l)===s.type||s.type==="enum"&&s.values[l]||(l=void 0),$c(l,a.default,s.default)}class Df{constructor(s,l){this.expression=s,this._warningHistory={},this._evaluator=new ng,this._defaultValue=l?function(d){return d.type==="color"&&(Rh(d.default)||Array.isArray(d.default))?new hr(0,0,0,0):d.type==="color"?hr.parse(d.default)||null:d.default===void 0?null:d.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(s,l,d,A,_,x,b,S){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=A||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(s,l,d,A,_,x,b,S){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=A||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Yr(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function eu(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Qh}function tu(a,s){const l=new cg(Qh,[],s?function(A){const _={color:Us,string:nn,number:gi,enum:nn,boolean:Zi,formatted:mh,resolvedImage:zl};return A.type==="array"?$s(_[A.value]||$i,A.length):_[A.type]}(s):void 0),d=l.parse(a,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?O0(new Df(d,s)):Vl(l.errors)}class Eg{constructor(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent=s!=="constant"&&!Ba(l.expression)}evaluateWithoutErrorHandling(s,l,d,A,_,x){return this._styleExpression.evaluateWithoutErrorHandling(s,l,d,A,_,x)}evaluate(s,l,d,A,_,x){return this._styleExpression.evaluate(s,l,d,A,_,x)}}class Lh{constructor(s,l,d,A){this.kind=s,this.zoomStops=d,this._styleExpression=l,this.isStateDependent=s!=="camera"&&!Ba(l.expression),this.interpolationType=A}evaluateWithoutErrorHandling(s,l,d,A,_,x){return this._styleExpression.evaluateWithoutErrorHandling(s,l,d,A,_,x)}evaluate(s,l,d,A,_,x){return this._styleExpression.evaluate(s,l,d,A,_,x)}interpolationFactor(s,l,d){return this.interpolationType?Vo.interpolationFactor(this.interpolationType,s,l,d):0}}function Ph(a,s){if((a=tu(a,s)).result==="error")return a;const l=a.value.expression,d=qc(l);if(!d&&!Zc(s))return Vl([new Zs("","data expressions not supported")]);const A=Gl(l,["zoom","pitch","distance-from-center"]);if(!A&&!Bf(s))return Vl([new Zs("","zoom expressions not supported")]);const _=Rf(l);return _||A?_ instanceof Zs?Vl([_]):_ instanceof Vo&&!Sf(s)?Vl([new Zs("",'"interpolate" expressions cannot be used with this property')]):O0(_?new Lh(d?"camera":"composite",a.value,_.labels,_ instanceof Vo?_.interpolation:void 0):new Eg(d?"constant":"source",a.value)):Vl([new Zs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qf{constructor(s,l){this._parameters=s,this._specification=l,Wr(this,Mf(this._parameters,this._specification))}static deserialize(s){return new Qf(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Rf(a){let s=null;if(a instanceof R0)s=Rf(a.result);else if(a instanceof yg){for(const l of a.args)if(s=Rf(l),s)break}else(a instanceof hg||a instanceof Vo)&&a.input instanceof wa&&a.input.name==="zoom"&&(s=a);return s instanceof Zs||a.eachChild(l=>{const d=Rf(l);d instanceof Zs?s=d:!s&&d?s=new Zs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new Zs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class mi{constructor(s,l,d,A){this.message=(s?`${s}: `:"")+d,A&&(this.identifier=A),l!=null&&l.__line__&&(this.line=l.__line__)}}function Io(a){const s=a.key,l=a.value,d=a.valueSpec||{},A=a.objectElementValidators||{},_=a.style,x=a.styleSpec;let b=[];const S=un(l);if(S!=="object")return[new mi(s,l,`object expected, ${S} found`)];for(const T in l){const k=T.split(".")[0];let G;A[k]?G=A[k]:d[k]?G=rs:A["*"]?G=A["*"]:d["*"]&&(G=rs),G?b=b.concat(G({key:(s&&`${s}.`)+T,value:l[T],valueSpec:d[k]||d["*"],style:_,styleSpec:x,object:l,objectKey:T},l)):b.push(new mi(s,l[T],`unknown property "${T}"`))}for(const T in d)A[T]||d[T].required&&d[T].default===void 0&&l[T]===void 0&&b.push(new mi(s,l,`missing required property "${T}"`));return b}function W0(a){const s=a.value,l=a.valueSpec,d=a.style,A=a.styleSpec,_=a.key,x=a.arrayElementValidator||rs;if(un(s)!=="array")return[new mi(_,s,`array expected, ${un(s)} found`)];if(l.length&&s.length!==l.length)return[new mi(_,s,`array length ${l.length} expected, length ${s.length} found`)];if(l["min-length"]&&s.length<l["min-length"])return[new mi(_,s,`array length at least ${l["min-length"]} expected, length ${s.length} found`)];let b={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};A.$version<7&&(b.function=l.function),un(l.value)==="object"&&(b=l.value);let S=[];for(let T=0;T<s.length;T++)S=S.concat(x({array:s,arrayIndex:T,value:s[T],valueSpec:b,style:d,styleSpec:A,key:`${_}[${T}]`}));return S}function kh(a){const s=a.key,l=a.value,d=a.valueSpec;let A=un(l);if(A==="number"&&l!=l&&(A="NaN"),A!=="number")return[new mi(s,l,`number expected, ${A} found`)];if("minimum"in d){let _=d.minimum;if(un(d.minimum)==="array"&&(_=d.minimum[a.arrayIndex]),l<_)return[new mi(s,l,`${l} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if(un(d.maximum)==="array"&&(_=d.maximum[a.arrayIndex]),l>_)return[new mi(s,l,`${l} is greater than the maximum value ${_}`)]}return[]}function Fh(a){const s=a.valueSpec,l=qn(a.value.type);let d,A,_,x={};const b=l!=="categorical"&&a.value.property===void 0,S=!b,T=un(a.value.stops)==="array"&&un(a.value.stops[0])==="array"&&un(a.value.stops[0][0])==="object",k=Io({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(K){if(l==="identity")return[new mi(K.key,K.value,'identity function may not have a "stops" property')];let $=[];const re=K.value;return $=$.concat(W0({key:K.key,value:re,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:G})),un(re)==="array"&&re.length===0&&$.push(new mi(K.key,re,"array must have at least one stop")),$},default:function(K){return rs({key:K.key,value:K.value,valueSpec:s,style:K.style,styleSpec:K.styleSpec})}}});return l==="identity"&&b&&k.push(new mi(a.key,a.value,'missing required property "property"')),l==="identity"||a.value.stops||k.push(new mi(a.key,a.value,'missing required property "stops"')),l==="exponential"&&a.valueSpec.expression&&!Sf(a.valueSpec)&&k.push(new mi(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(S&&!Zc(a.valueSpec)?k.push(new mi(a.key,a.value,"property functions not supported")):b&&!Bf(a.valueSpec)&&k.push(new mi(a.key,a.value,"zoom functions not supported"))),l!=="categorical"&&!T||a.value.property!==void 0||k.push(new mi(a.key,a.value,'"property" property is required')),k;function G(K){let $=[];const re=K.value,ge=K.key;if(un(re)!=="array")return[new mi(ge,re,`array expected, ${un(re)} found`)];if(re.length!==2)return[new mi(ge,re,`array length 2 expected, length ${re.length} found`)];if(T){if(un(re[0])!=="object")return[new mi(ge,re,`object expected, ${un(re[0])} found`)];if(re[0].zoom===void 0)return[new mi(ge,re,"object stop key must have zoom")];if(re[0].value===void 0)return[new mi(ge,re,"object stop key must have value")];const Me=qn(re[0].zoom);if(typeof Me!="number")return[new mi(ge,re[0].zoom,"stop zoom values must be numbers")];if(_&&_>Me)return[new mi(ge,re[0].zoom,"stop zoom values must appear in ascending order")];Me!==_&&(_=Me,A=void 0,x={}),$=$.concat(Io({key:`${ge}[0]`,value:re[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:kh,value:V}}))}else $=$.concat(V({key:`${ge}[0]`,value:re[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},re));return eu(In(re[1]))?$.concat([new mi(`${ge}[1]`,re[1],"expressions are not allowed in function stops.")]):$.concat(rs({key:`${ge}[1]`,value:re[1],valueSpec:s,style:K.style,styleSpec:K.styleSpec}))}function V(K,$){const re=un(K.value),ge=qn(K.value),Me=K.value!==null?K.value:$;if(d){if(re!==d)return[new mi(K.key,Me,`${re} stop domain type must match previous stop domain type ${d}`)]}else d=re;if(re!=="number"&&re!=="string"&&re!=="boolean"&&typeof ge!="number"&&typeof ge!="string"&&typeof ge!="boolean")return[new mi(K.key,Me,"stop domain value must be a number, string, or boolean")];if(re!=="number"&&l!=="categorical"){let He=`number expected, ${re} found`;return Zc(s)&&l===void 0&&(He+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mi(K.key,Me,He)]}return l!=="categorical"||re!=="number"||typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge?l!=="categorical"&&re==="number"&&typeof ge=="number"&&typeof A=="number"&&A!==void 0&&ge<A?[new mi(K.key,Me,"stop domain values must appear in ascending order")]:(A=ge,l==="categorical"&&ge in x?[new mi(K.key,Me,"stop domain values must be unique")]:(x[ge]=!0,[])):[new mi(K.key,Me,`integer expected, found ${String(ge)}`)]}}function kr(a){const s=(a.expressionContext==="property"?Ph:tu)(In(a.value),a.valueSpec);if(s.result==="error")return s.value.map(d=>new mi(`${a.key}${d.key}`,a.value,d.message));const l=s.value.expression||s.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!l.outputDefined())return[new mi(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ba(l))return[new mi(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return Nh(l,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Gl(l,["zoom","feature-state"]))return[new mi(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!qc(l))return[new mi(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nh(a,s){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const A of s.valueSpec.expression.parameters)l.delete(A);if(l.size===0)return[];const d=[];return a instanceof wa&&l.has(a.name)?[new mi(s.key,s.value,`["${a.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(a.eachChild(A=>{d.push(...Nh(A,s))}),d)}function Lf(a){const s=a.key,l=a.value,d=a.valueSpec,A=[];return Array.isArray(d.values)?d.values.indexOf(qn(l))===-1&&A.push(new mi(s,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(d.values).indexOf(qn(l))===-1&&A.push(new mi(s,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),A}function wg(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!wg(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function Pf(a,s="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};wg(a)||(a=nu(a));const l=a;let d=!0;try{d=function(T){if(!iu(T))return T;let k=In(T);return kf(k),k=Y0(k),k}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(l,null,2)}
        `)}const A=Mt[`filter_${s}`],_=tu(d,A);let x=null;if(_.result==="error")throw new Error(_.value.map(T=>`${T.key}: ${T.message}`).join(", "));x=(T,k,G)=>_.value.evaluate(T,k,{},G);let b=null,S=null;if(d!==l){const T=tu(l,A);if(T.result==="error")throw new Error(T.value.map(k=>`${k.key}: ${k.message}`).join(", "));b=(k,G,V,K,$)=>T.value.evaluate(k,G,{},V,void 0,void 0,K,$),S=!qc(T.value.expression)}return{filter:x,dynamicFilter:b||void 0,needGeometry:j0(d),needFeature:!!S}}function Y0(a){if(!Array.isArray(a))return a;const s=function(l){if(bg.has(l[0])){for(let d=1;d<l.length;d++)if(iu(l[d]))return!0}return l}(a);return s===!0?s:s.map(l=>Y0(l))}function kf(a){let s=!1;const l=[];if(a[0]==="case"){for(let d=1;d<a.length-1;d+=2)s=s||iu(a[d]),l.push(a[d+1]);l.push(a[a.length-1])}else if(a[0]==="match"){s=s||iu(a[1]);for(let d=2;d<a.length-1;d+=2)l.push(a[d+1]);l.push(a[a.length-1])}else if(a[0]==="step"){s=s||iu(a[1]);for(let d=1;d<a.length-1;d+=2)l.push(a[d+1])}s&&(a.length=0,a.push("any",...l));for(let d=1;d<a.length;d++)kf(a[d])}function iu(a){if(!Array.isArray(a))return!1;if((s=a[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let l=1;l<a.length;l++)if(iu(a[l]))return!0;return!1}const bg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function J1(a,s){return a<s?-1:a>s?1:0}function j0(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let s=1;s<a.length;s++)if(j0(a[s]))return!0;return!1}function nu(a){if(!a)return!0;const s=a[0];return a.length<=1?s!=="any":s==="=="?Bg(a[1],a[2],"=="):s==="!="?Ff(Bg(a[1],a[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Bg(a[1],a[2],s):s==="any"?(l=a.slice(1),["any"].concat(l.map(nu))):s==="all"?["all"].concat(a.slice(1).map(nu)):s==="none"?["all"].concat(a.slice(1).map(nu).map(Ff)):s==="in"?Sg(a[1],a.slice(2)):s==="!in"?Ff(Sg(a[1],a.slice(2))):s==="has"?Mg(a[1]):s==="!has"?Ff(Mg(a[1])):s!=="within"||a;var l}function Bg(a,s,l){switch(a){case"$type":return[`filter-type-${l}`,s];case"$id":return[`filter-id-${l}`,s];default:return[`filter-${l}`,a,s]}}function Sg(a,s){if(s.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(l=>typeof l!=typeof s[0])?["filter-in-large",a,["literal",s.sort(J1)]]:["filter-in-small",a,["literal",s]]}}function Mg(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ff(a){return["!",a]}function zh(a){return wg(In(a.value))?kr(Wr({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):Uh(a)}function Uh(a){const s=a.value,l=a.key;if(un(s)!=="array")return[new mi(l,s,`array expected, ${un(s)} found`)];const d=a.styleSpec;let A,_=[];if(s.length<1)return[new mi(l,s,"filter array must have at least 1 element")];switch(_=_.concat(Lf({key:`${l}[0]`,value:s[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),qn(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&qn(s[1])==="$type"&&_.push(new mi(l,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&_.push(new mi(l,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(A=un(s[1]),A!=="string"&&_.push(new mi(`${l}[1]`,s[1],`string expected, ${A} found`)));for(let x=2;x<s.length;x++)A=un(s[x]),qn(s[1])==="$type"?_=_.concat(Lf({key:`${l}[${x}]`,value:s[x],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):A!=="string"&&A!=="number"&&A!=="boolean"&&_.push(new mi(`${l}[${x}]`,s[x],`string, number, or boolean expected, ${A} found`));break;case"any":case"all":case"none":for(let x=1;x<s.length;x++)_=_.concat(Uh({key:`${l}[${x}]`,value:s[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":A=un(s[1]),s.length!==2?_.push(new mi(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):A!=="string"&&_.push(new mi(`${l}[1]`,s[1],`string expected, ${A} found`));break;case"within":A=un(s[1]),s.length!==2?_.push(new mi(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):A!=="object"&&_.push(new mi(`${l}[1]`,s[1],`object expected, ${A} found`))}return _}function Tg(a,s){const l=a.key,d=a.style,A=a.styleSpec,_=a.value,x=a.objectKey,b=A[`${s}_${a.layerType}`];if(!b)return[];const S=x.match(/^(.*)-transition$/);if(s==="paint"&&S&&b[S[1]]&&b[S[1]].transition)return rs({key:l,value:_,valueSpec:A.transition,style:d,styleSpec:A});const T=a.valueSpec||b[x];if(!T)return[new mi(l,_,`unknown property "${x}"`)];let k;if(un(_)==="string"&&Zc(T)&&!T.tokens&&(k=/^{([^}]+)}$/.exec(_))){const V=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new mi(l,_,`"${x}" does not support interpolation syntax
Use an identity property function instead: ${V}.`)]}const G=[];return a.layerType==="symbol"&&(x==="text-field"&&d&&!d.glyphs&&G.push(new mi(l,_,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Rh(In(_))&&qn(_.type)==="identity"&&G.push(new mi(l,_,'"text-font" does not support identity functions'))),G.concat(rs({key:a.key,value:_,valueSpec:T,style:d,styleSpec:A,expressionContext:"property",propertyType:s,propertyKey:x}))}function q0(a){return Tg(a,"paint")}function Dg(a){return Tg(a,"layout")}function K0(a){let s=[];const l=a.value,d=a.key,A=a.style,_=a.styleSpec;l.type||l.ref||s.push(new mi(d,l,'either "type" or "ref" is required'));let x=qn(l.type);const b=qn(l.ref);if(l.id){const S=qn(l.id);for(let T=0;T<a.arrayIndex;T++){const k=A.layers[T];qn(k.id)===S&&s.push(new mi(d,l.id,`duplicate layer id "${l.id}", previously used at line ${k.id.__line__}`))}}if("ref"in l){let S;["type","source","source-layer","filter","layout"].forEach(T=>{T in l&&s.push(new mi(d,l[T],`"${T}" is prohibited for ref layers`))}),A.layers.forEach(T=>{qn(T.id)===b&&(S=T)}),S?S.ref?s.push(new mi(d,l.ref,"ref cannot reference another ref layer")):x=qn(S.type):typeof b=="string"&&s.push(new mi(d,l.ref,`ref layer "${b}" not found`))}else if(x!=="background"&&x!=="sky")if(l.source){const S=A.sources&&A.sources[l.source],T=S&&qn(S.type);S?T==="vector"&&x==="raster"?s.push(new mi(d,l.source,`layer "${l.id}" requires a raster source`)):T==="raster"&&x!=="raster"?s.push(new mi(d,l.source,`layer "${l.id}" requires a vector source`)):T!=="vector"||l["source-layer"]?T==="raster-dem"&&x!=="hillshade"?s.push(new mi(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||T==="geojson"&&S.lineMetrics||s.push(new mi(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new mi(d,l,`layer "${l.id}" must specify a "source-layer"`)):s.push(new mi(d,l.source,`source "${l.source}" not found`))}else s.push(new mi(d,l,'missing required property "source"'));return s=s.concat(Io({key:d,value:l,valueSpec:_.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>rs({key:`${d}.type`,value:l.type,valueSpec:_.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:S=>zh(Wr({layerType:x},S)),layout:S=>Io({layer:l,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>Dg(Wr({layerType:x},T))}}),paint:S=>Io({layer:l,key:S.key,value:S.value,valueSpec:{},style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":T=>q0(Wr({layerType:x},T))}})}})),s}function al(a){const s=a.value,l=a.key,d=un(s);return d!=="string"?[new mi(l,s,`string expected, ${d} found`)]:[]}const J0={promoteId:function({key:a,value:s}){if(un(s)==="string")return al({key:a,value:s});{const l=[];for(const d in s)l.push(...al({key:`${a}.${d}`,value:s[d]}));return l}}};function X0(a){const s=a.value,l=a.key,d=a.styleSpec,A=a.style;if(!s.type)return[new mi(l,s,'"type" is required')];const _=qn(s.type);let x;switch(_){case"vector":case"raster":case"raster-dem":return x=Io({key:l,value:s,valueSpec:d[`source_${_.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:J0}),x;case"geojson":if(x=Io({key:l,value:s,valueSpec:d.source_geojson,style:A,styleSpec:d,objectElementValidators:J0}),s.cluster)for(const b in s.clusterProperties){const[S,T]=s.clusterProperties[b],k=typeof S=="string"?[S,["accumulated"],["get",b]]:S;x.push(...kr({key:`${l}.${b}.map`,value:T,expressionContext:"cluster-map"})),x.push(...kr({key:`${l}.${b}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return x;case"video":return Io({key:l,value:s,valueSpec:d.source_video,style:A,styleSpec:d});case"image":return Io({key:l,value:s,valueSpec:d.source_image,style:A,styleSpec:d});case"canvas":return[new mi(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lf({key:`${l}.type`,value:s.type,valueSpec:{values:X1(d)},style:A,styleSpec:d})}}function X1(a){return a.source.reduce((s,l)=>{const d=a[l];return d.type.type==="enum"&&(s=s.concat(Object.keys(d.type.values))),s},[])}function Z0(a){const s=a.value,l=a.styleSpec,d=l.light,A=a.style;let _=[];const x=un(s);if(s===void 0)return _;if(x!=="object")return _=_.concat([new mi("light",s,`object expected, ${x} found`)]),_;for(const b in s){const S=b.match(/^(.*)-transition$/);_=_.concat(S&&d[S[1]]&&d[S[1]].transition?rs({key:b,value:s[b],valueSpec:l.transition,style:A,styleSpec:l}):d[b]?rs({key:b,value:s[b],valueSpec:d[b],style:A,styleSpec:l}):[new mi(b,s[b],`unknown property "${b}"`)])}return _}function Qg(a){const s=a.value,l=a.key,d=a.style,A=a.styleSpec,_=A.terrain;let x=[];const b=un(s);if(s===void 0)return x;if(b!=="object")return x=x.concat([new mi("terrain",s,`object expected, ${b} found`)]),x;for(const S in s){const T=S.match(/^(.*)-transition$/);x=x.concat(T&&_[T[1]]&&_[T[1]].transition?rs({key:S,value:s[S],valueSpec:A.transition,style:d,styleSpec:A}):_[S]?rs({key:S,value:s[S],valueSpec:_[S],style:d,styleSpec:A}):[new mi(S,s[S],`unknown property "${S}"`)])}if(s.source){const S=d.sources&&d.sources[s.source],T=S&&qn(S.type);S?T!=="raster-dem"&&x.push(new mi(l,s.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):x.push(new mi(l,s.source,`source "${s.source}" not found`))}else x.push(new mi(l,s,'terrain is missing required property "source"'));return x}function $0(a){const s=a.value,l=a.style,d=a.styleSpec,A=d.fog;let _=[];const x=un(s);if(s===void 0)return _;if(x!=="object")return _=_.concat([new mi("fog",s,`object expected, ${x} found`)]),_;for(const b in s){const S=b.match(/^(.*)-transition$/);_=_.concat(S&&A[S[1]]&&A[S[1]].transition?rs({key:b,value:s[b],valueSpec:d.transition,style:l,styleSpec:d}):A[b]?rs({key:b,value:s[b],valueSpec:A[b],style:l,styleSpec:d}):[new mi(b,s[b],`unknown property "${b}"`)])}return _}const ey={"*":()=>[],array:W0,boolean:function(a){const s=a.value,l=a.key,d=un(s);return d!=="boolean"?[new mi(l,s,`boolean expected, ${d} found`)]:[]},number:kh,color:function(a){const s=a.key,l=a.value,d=un(l);return d!=="string"?[new mi(s,l,`color expected, ${d} found`)]:JA(l)===null?[new mi(s,l,`color expected, "${l}" found`)]:[]},enum:Lf,filter:zh,function:Fh,layer:K0,object:Io,source:X0,light:Z0,terrain:Qg,fog:$0,string:al,formatted:function(a){return al(a).length===0?[]:kr(a)},resolvedImage:function(a){return al(a).length===0?[]:kr(a)},projection:function(a){const s=a.value,l=a.styleSpec,d=l.projection,A=a.style;let _=[];const x=un(s);if(x==="object")for(const b in s)_=_.concat(rs({key:b,value:s[b],valueSpec:d[b],style:A,styleSpec:l}));else x!=="string"&&(_=_.concat([new mi("projection",s,`object or string expected, ${x} found`)]));return _}};function rs(a){const s=a.value,l=a.valueSpec,d=a.styleSpec;return l.expression&&Rh(qn(s))?Fh(a):l.expression&&eu(In(s))?kr(a):l.type&&ey[l.type]?ey[l.type](a):Io(Wr({},a,{valueSpec:l.type?d[l.type]:l}))}function Z1(a){const s=a.value,l=a.key,d=al(a);return d.length||(s.indexOf("{fontstack}")===-1&&d.push(new mi(l,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&d.push(new mi(l,s,'"glyphs" url must include a "{range}" token'))),d}function ty(a,s=Mt){return io(rs({key:"",value:a,valueSpec:s.$root,styleSpec:s,style:a,objectElementValidators:{glyphs:Z1,"*":()=>[]}}))}const $1=a=>io(q0(a)),eI=a=>io(Dg(a));function io(a){return a.slice().sort((s,l)=>s.line&&l.line?s.line-l.line:0)}function iy(a,s){let l=!1;if(s&&s.length)for(const d of s)a.fire(new As(new Error(d.message))),l=!0;return l}var tI=Wo,Co=3;function Wo(a,s,l){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var A=new Int32Array(this.arrayBuffer);a=A[0],this.d=(s=A[1])+2*(l=A[2]);for(var _=0;_<this.d*this.d;_++){var x=A[Co+_],b=A[Co+_+1];d.push(x===b?null:A.subarray(x,b))}var S=A[Co+d.length+1];this.keys=A.subarray(A[Co+d.length],S),this.bboxes=A.subarray(S),this.insert=this._insertReadonly}else{this.d=s+2*l;for(var T=0;T<this.d*this.d;T++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=a,this.padding=l,this.scale=s/a,this.uid=0;var k=l/s*a;this.min=-k,this.max=a+k}Wo.prototype.insert=function(a,s,l,d,A){this._forEachCell(s,l,d,A,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(A)},Wo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Wo.prototype._insertCell=function(a,s,l,d,A,_){this.cells[A].push(_)},Wo.prototype.query=function(a,s,l,d,A){var _=this.min,x=this.max;if(a<=_&&s<=_&&x<=l&&x<=d&&!A)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(a,s,l,d,this._queryCell,b,{},A),b},Wo.prototype._queryCell=function(a,s,l,d,A,_,x,b){var S=this.cells[A];if(S!==null)for(var T=this.keys,k=this.bboxes,G=0;G<S.length;G++){var V=S[G];if(x[V]===void 0){var K=4*V;(b?b(k[K+0],k[K+1],k[K+2],k[K+3]):a<=k[K+2]&&s<=k[K+3]&&l>=k[K+0]&&d>=k[K+1])?(x[V]=!0,_.push(T[V])):x[V]=!1}}},Wo.prototype._forEachCell=function(a,s,l,d,A,_,x,b){for(var S=this._convertToCellCoord(a),T=this._convertToCellCoord(s),k=this._convertToCellCoord(l),G=this._convertToCellCoord(d),V=S;V<=k;V++)for(var K=T;K<=G;K++){var $=this.d*K+V;if((!b||b(this._convertFromCellCoord(V),this._convertFromCellCoord(K),this._convertFromCellCoord(V+1),this._convertFromCellCoord(K+1)))&&A.call(this,a,s,l,d,$,_,x,b))return}},Wo.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Wo.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Wo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,s=Co+this.cells.length+1+1,l=0,d=0;d<this.cells.length;d++)l+=this.cells[d].length;var A=new Int32Array(s+l+this.keys.length+this.bboxes.length);A[0]=this.extent,A[1]=this.n,A[2]=this.padding;for(var _=s,x=0;x<a.length;x++){var b=a[x];A[Co+x]=_,A.set(b,_),_+=b.length}return A[Co+a.length]=_,A.set(this.keys,_),A[Co+a.length+1]=_+=this.keys.length,A.set(this.bboxes,_),_+=this.bboxes.length,A.buffer};var Wl=F(tI);const Nf={};function vi(a,s,l={}){Object.defineProperty(a,"_classRegistryKey",{value:s,writeable:!1}),Nf[s]={klass:a,omit:l.omit||[]}}vi(Object,"Object"),Wl.serialize=function(a,s){const l=a.toArrayBuffer();return s&&s.push(l),{buffer:l}},Wl.deserialize=function(a){return new Wl(a.buffer)},Object.defineProperty(Wl,"name",{value:"Grid"}),vi(Wl,"Grid"),vi(hr,"Color"),vi(Error,"Error"),vi(_i,"AJAXError"),vi(eo,"ResolvedImage"),vi(Qf,"StylePropertyFunction"),vi(Df,"StyleExpression",{omit:["_evaluator"]}),vi(Lh,"ZoomDependentExpression"),vi(Eg,"ZoomConstantExpression"),vi(wa,"CompoundExpression",{omit:["_evaluate"]});for(const a in Qh)Nf[Qh[a]._classRegistryKey]||vi(Qh[a],`Expression${a}`);function Rg(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Lg(a){return p.ImageBitmap&&a instanceof p.ImageBitmap}function ru(a,s){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Rg(a)||Lg(a))return s&&s.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return s&&s.push(l.buffer),l}if(a instanceof p.ImageData)return s&&s.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const d of a)l.push(ru(d,s));return l}if(typeof a=="object"){const l=a.constructor,d=l._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const A=l.serialize?l.serialize(a,s):{};if(!l.serialize){for(const _ in a)a.hasOwnProperty(_)&&(Nf[d].omit.indexOf(_)>=0||(A[_]=ru(a[_],s)));a instanceof Error&&(A.message=a.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(A.$name=d),A}throw new Error("can't serialize object of type "+typeof a)}function Yl(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Rg(a)||Lg(a)||ArrayBuffer.isView(a)||a instanceof p.ImageData)return a;if(Array.isArray(a))return a.map(Yl);if(typeof a=="object"){const s=a.$name||"Object",{klass:l}=Nf[s];if(!l)throw new Error(`can't deserialize unregistered class ${s}`);if(l.deserialize)return l.deserialize(a);const d=Object.create(l.prototype);for(const A of Object.keys(a))A!=="$name"&&(d[A]=Yl(a[A]));return d}throw new Error("can't deserialize object of type "+typeof a)}const pi={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Pg(a){for(const s of a)if(kg(s.charCodeAt(0)))return!0;return!1}function iI(a){for(const s of a)if(!ny(s.charCodeAt(0)))return!1;return!0}function ny(a){return!(pi.Arabic(a)||pi["Arabic Supplement"](a)||pi["Arabic Extended-A"](a)||pi["Arabic Presentation Forms-A"](a)||pi["Arabic Presentation Forms-B"](a))}function kg(a){return!(a!==746&&a!==747&&(a<4352||!(pi["Bopomofo Extended"](a)||pi.Bopomofo(a)||pi["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||pi["CJK Compatibility Ideographs"](a)||pi["CJK Compatibility"](a)||pi["CJK Radicals Supplement"](a)||pi["CJK Strokes"](a)||!(!pi["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||pi["CJK Unified Ideographs Extension A"](a)||pi["CJK Unified Ideographs"](a)||pi["Enclosed CJK Letters and Months"](a)||pi["Hangul Compatibility Jamo"](a)||pi["Hangul Jamo Extended-A"](a)||pi["Hangul Jamo Extended-B"](a)||pi["Hangul Jamo"](a)||pi["Hangul Syllables"](a)||pi.Hiragana(a)||pi["Ideographic Description Characters"](a)||pi.Kanbun(a)||pi["Kangxi Radicals"](a)||pi["Katakana Phonetic Extensions"](a)||pi.Katakana(a)&&a!==12540||!(!pi["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!pi["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||pi["Unified Canadian Aboriginal Syllabics"](a)||pi["Unified Canadian Aboriginal Syllabics Extended"](a)||pi["Vertical Forms"](a)||pi["Yijing Hexagram Symbols"](a)||pi["Yi Syllables"](a)||pi["Yi Radicals"](a))))}function ry(a){return!(kg(a)||function(s){return!!(pi["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||pi["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||pi["Letterlike Symbols"](s)||pi["Number Forms"](s)||pi["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||pi["Control Pictures"](s)&&s!==9251||pi["Optical Character Recognition"](s)||pi["Enclosed Alphanumerics"](s)||pi["Geometric Shapes"](s)||pi["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||pi["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||pi["CJK Symbols and Punctuation"](s)||pi.Katakana(s)||pi["Private Use Area"](s)||pi["CJK Compatibility Forms"](s)||pi["Small Form Variants"](s)||pi["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(a))}function sy(a){return a>=1424&&a<=2303||pi["Arabic Presentation Forms-A"](a)||pi["Arabic Presentation Forms-B"](a)}function nI(a,s){return!(!s&&sy(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||pi.Khmer(a))}function rI(a){for(const s of a)if(sy(s.charCodeAt(0)))return!0;return!1}const Fg="deferred",Ng="loading",zg="loaded";let su=null,m="unavailable",c=null;const f=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(m="error"),su&&su(a)};function y(){w.fire(new Go("pluginStateChange",{pluginStatus:m,pluginURL:c}))}const w=new Ia,B=function(){return m},R=function(){if(m!==Fg||!c)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");m=Ng,y(),c&&kt({url:c},a=>{a?f(a):(m=zg,y())})},L={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>m===zg||L.applyArabicShaping!=null,isLoading:()=>m===Ng,setState(a){m=a.pluginStatus,c=a.pluginURL},isParsed:()=>L.applyArabicShaping!=null&&L.processBidirectionalText!=null&&L.processStyledBidirectionalText!=null,getPluginURL:()=>c};class U{constructor(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(l,d){for(const A of l)if(!nI(A.charCodeAt(0),d))return!1;return!0}(s,L.isLoaded())}}class j{constructor(s,l){this.property=s,this.value=l,this.expression=function(d,A){if(Rh(d))return new Qf(d,A);if(eu(d)){const _=Ph(d,A);if(_.result==="error")throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=d;return typeof d=="string"&&A.type==="color"&&(_=hr.parse(d)),{kind:"constant",evaluate:()=>_}}}(l===void 0?s.specification.default:l,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,l,d){return this.property.possiblyEvaluate(this,s,l,d)}}class Y{constructor(s){this.property=s,this.value=new j(s,void 0)}transitioned(s,l){return new fe(this.property,this.value,l,st({},s.transition,this.transition),s.now)}untransitioned(){return new fe(this.property,this.value,null,{},0)}}class ie{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return _e(this._values[s].value.value)}setValue(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Y(this._values[s].property)),this._values[s].value=new j(this._values[s].property,l===null?void 0:_e(l))}getTransition(s){return _e(this._values[s].transition)}setTransition(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Y(this._values[s].property)),this._values[s].transition=_e(l)||void 0}serialize(){const s={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(s[l]=d);const A=this.getTransition(l);A!==void 0&&(s[`${l}-transition`]=A)}return s}transitioned(s,l){const d=new xe(this._properties);for(const A of Object.keys(this._values))d._values[A]=this._values[A].transitioned(s,l._values[A]);return d}untransitioned(){const s=new xe(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].untransitioned();return s}}class fe{constructor(s,l,d,A,_){const x=A.delay||0,b=A.duration||0;_=_||0,this.property=s,this.value=l,this.begin=_+x,this.end=this.begin+b,s.specification.transition&&(A.delay||A.duration)&&(this.prior=d)}possiblyEvaluate(s,l,d){const A=s.now||0,_=this.value.possiblyEvaluate(s,l,d),x=this.prior;if(x){if(A>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(A<this.begin)return x.possiblyEvaluate(s,l,d);{const b=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(s,l,d),_,Be(b))}}return _}}class xe{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,l,d){const A=new Se(this._properties);for(const _ of Object.keys(this._values))A._values[_]=this._values[_].possiblyEvaluate(s,l,d);return A}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class be{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return _e(this._values[s].value)}setValue(s,l){this._values[s]=new j(this._values[s].property,l===null?void 0:_e(l))}serialize(){const s={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(s[l]=d)}return s}possiblyEvaluate(s,l,d){const A=new Se(this._properties);for(const _ of Object.keys(this._values))A._values[_]=this._values[_].possiblyEvaluate(s,l,d);return A}}class we{constructor(s,l,d){this.property=s,this.value=l,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,l,d,A){return this.property.evaluate(this.value,this.parameters,s,l,d,A)}}class Se{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class ne{constructor(s){this.specification=s}possiblyEvaluate(s,l){return s.expression.evaluate(l)}interpolate(s,l,d){const A=Bh[this.specification.type];return A?A(s,l,d):s}}class ve{constructor(s,l){this.specification=s,this.overrides=l}possiblyEvaluate(s,l,d,A){return new we(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(l,null,{},d,A)}:s.expression,l)}interpolate(s,l,d){if(s.value.kind!=="constant"||l.value.kind!=="constant")return s;if(s.value.value===void 0||l.value.value===void 0)return new we(this,{kind:"constant",value:void 0},s.parameters);const A=Bh[this.specification.type];return A?new we(this,{kind:"constant",value:A(s.value.value,l.value.value,d)},s.parameters):s}evaluate(s,l,d,A,_,x){return s.kind==="constant"?s.value:s.evaluate(l,d,A,_,x)}}class Pe{constructor(s){this.specification=s}possiblyEvaluate(s,l,d,A){return!!s.expression.evaluate(l,null,{},d,A)}interpolate(){return!1}}class ke{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new U(0,{});for(const d in s){const A=s[d];A.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new j(A,void 0),x=this.defaultTransitionablePropertyValues[d]=new Y(A);this.defaultTransitioningPropertyValues[d]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(l)}}}function $e(a,s){return 256*(a=ye(Math.floor(a),0,255))+ye(Math.floor(s),0,255)}vi(ve,"DataDrivenProperty"),vi(ne,"DataConstantProperty"),vi(Pe,"ColorRampProperty");const tt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class et{constructor(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ct{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function lt(a,s=1){let l=0,d=0;return{members:a.map(A=>{const _=tt[A.type].BYTES_PER_ELEMENT,x=l=vt(l,Math.max(s,_)),b=A.components||1;return d=Math.max(d,_),l+=_*b,{name:A.name,type:A.type,components:b,offset:x}}),size:vt(l,Math.max(d,s)),alignment:s}}function vt(a,s){return Math.ceil(a/s)*s}class Zt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const A=2*s;return this.int16[A+0]=l,this.int16[A+1]=d,s}}Zt.prototype.bytesPerElement=4,vi(Zt,"StructArrayLayout2i4");class At extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,d)}emplace(s,l,d,A){const _=3*s;return this.int16[_+0]=l,this.int16[_+1]=d,this.int16[_+2]=A,s}}At.prototype.bytesPerElement=6,vi(At,"StructArrayLayout3i6");class zt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,A){const _=this.length;return this.resize(_+1),this.emplace(_,s,l,d,A)}emplace(s,l,d,A,_){const x=4*s;return this.int16[x+0]=l,this.int16[x+1]=d,this.int16[x+2]=A,this.int16[x+3]=_,s}}zt.prototype.bytesPerElement=8,vi(zt,"StructArrayLayout4i8");class bt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,s,l,d,A,_,x,b)}emplace(s,l,d,A,_,x,b,S){const T=6*s,k=12*s,G=3*s;return this.int16[T+0]=l,this.int16[T+1]=d,this.uint8[k+4]=A,this.uint8[k+5]=_,this.uint8[k+6]=x,this.uint8[k+7]=b,this.float32[G+2]=S,s}}bt.prototype.bytesPerElement=12,vi(bt,"StructArrayLayout2i4ub1f12");class Jt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A){const _=this.length;return this.resize(_+1),this.emplace(_,s,l,d,A)}emplace(s,l,d,A,_){const x=4*s;return this.float32[x+0]=l,this.float32[x+1]=d,this.float32[x+2]=A,this.float32[x+3]=_,s}}Jt.prototype.bytesPerElement=16,vi(Jt,"StructArrayLayout4f16");class _t extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,d,A,_)}emplace(s,l,d,A,_,x){const b=6*s,S=3*s;return this.uint16[b+0]=l,this.uint16[b+1]=d,this.uint16[b+2]=A,this.uint16[b+3]=_,this.float32[S+2]=x,s}}_t.prototype.bytesPerElement=12,vi(_t,"StructArrayLayout4ui1f12");class Nt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,A){const _=this.length;return this.resize(_+1),this.emplace(_,s,l,d,A)}emplace(s,l,d,A,_){const x=4*s;return this.uint16[x+0]=l,this.uint16[x+1]=d,this.uint16[x+2]=A,this.uint16[x+3]=_,s}}Nt.prototype.bytesPerElement=8,vi(Nt,"StructArrayLayout4ui8");class ei extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,s,l,d,A,_,x)}emplace(s,l,d,A,_,x,b){const S=6*s;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=A,this.int16[S+3]=_,this.int16[S+4]=x,this.int16[S+5]=b,s}}ei.prototype.bytesPerElement=12,vi(ei,"StructArrayLayout6i12");class jt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b,S,T,k,G,V){const K=this.length;return this.resize(K+1),this.emplace(K,s,l,d,A,_,x,b,S,T,k,G,V)}emplace(s,l,d,A,_,x,b,S,T,k,G,V,K){const $=12*s;return this.int16[$+0]=l,this.int16[$+1]=d,this.int16[$+2]=A,this.int16[$+3]=_,this.uint16[$+4]=x,this.uint16[$+5]=b,this.uint16[$+6]=S,this.uint16[$+7]=T,this.int16[$+8]=k,this.int16[$+9]=G,this.int16[$+10]=V,this.int16[$+11]=K,s}}jt.prototype.bytesPerElement=24,vi(jt,"StructArrayLayout4i4ui4i24");class ti extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x){const b=this.length;return this.resize(b+1),this.emplace(b,s,l,d,A,_,x)}emplace(s,l,d,A,_,x,b){const S=10*s,T=5*s;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=A,this.float32[T+2]=_,this.float32[T+3]=x,this.float32[T+4]=b,s}}ti.prototype.bytesPerElement=20,vi(ti,"StructArrayLayout3i3f20");class bi extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint32[1*s+0]=l,s}}bi.prototype.bytesPerElement=4,vi(bi,"StructArrayLayout1ul4");class Ni extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b,S,T,k,G,V,K){const $=this.length;return this.resize($+1),this.emplace($,s,l,d,A,_,x,b,S,T,k,G,V,K)}emplace(s,l,d,A,_,x,b,S,T,k,G,V,K,$){const re=20*s,ge=10*s;return this.int16[re+0]=l,this.int16[re+1]=d,this.int16[re+2]=A,this.int16[re+3]=_,this.int16[re+4]=x,this.float32[ge+3]=b,this.float32[ge+4]=S,this.float32[ge+5]=T,this.float32[ge+6]=k,this.int16[re+14]=G,this.uint32[ge+8]=V,this.uint16[re+18]=K,this.uint16[re+19]=$,s}}Ni.prototype.bytesPerElement=40,vi(Ni,"StructArrayLayout5i4f1i1ul2ui40");class Ii extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,s,l,d,A,_,x,b)}emplace(s,l,d,A,_,x,b,S){const T=8*s;return this.int16[T+0]=l,this.int16[T+1]=d,this.int16[T+2]=A,this.int16[T+4]=_,this.int16[T+5]=x,this.int16[T+6]=b,this.int16[T+7]=S,s}}Ii.prototype.bytesPerElement=16,vi(Ii,"StructArrayLayout3i2i2i16");class Ti extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,d,A,_)}emplace(s,l,d,A,_,x){const b=4*s,S=8*s;return this.float32[b+0]=l,this.float32[b+1]=d,this.float32[b+2]=A,this.int16[S+6]=_,this.int16[S+7]=x,s}}Ti.prototype.bytesPerElement=16,vi(Ti,"StructArrayLayout2f1f2i16");class en extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A){const _=this.length;return this.resize(_+1),this.emplace(_,s,l,d,A)}emplace(s,l,d,A,_){const x=12*s,b=3*s;return this.uint8[x+0]=l,this.uint8[x+1]=d,this.float32[b+1]=A,this.float32[b+2]=_,s}}en.prototype.bytesPerElement=12,vi(en,"StructArrayLayout2ub2f12");class Ji extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,d)}emplace(s,l,d,A){const _=3*s;return this.float32[_+0]=l,this.float32[_+1]=d,this.float32[_+2]=A,s}}Ji.prototype.bytesPerElement=12,vi(Ji,"StructArrayLayout3f12");class wi extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,d)}emplace(s,l,d,A){const _=3*s;return this.uint16[_+0]=l,this.uint16[_+1]=d,this.uint16[_+2]=A,s}}wi.prototype.bytesPerElement=6,vi(wi,"StructArrayLayout3ui6");class yn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe){const We=this.length;return this.resize(We+1),this.emplace(We,s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe)}emplace(s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe,We){const It=30*s,gt=15*s,Lt=60*s;return this.int16[It+0]=l,this.int16[It+1]=d,this.int16[It+2]=A,this.float32[gt+2]=_,this.float32[gt+3]=x,this.uint16[It+8]=b,this.uint16[It+9]=S,this.uint32[gt+5]=T,this.uint32[gt+6]=k,this.uint32[gt+7]=G,this.uint16[It+16]=V,this.uint16[It+17]=K,this.uint16[It+18]=$,this.float32[gt+10]=re,this.float32[gt+11]=ge,this.uint8[Lt+48]=Me,this.uint8[Lt+49]=He,this.uint8[Lt+50]=Te,this.uint32[gt+13]=Ge,this.int16[It+28]=qe,this.uint8[Lt+58]=We,s}}yn.prototype.bytesPerElement=60,vi(yn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Sn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe,We,It,gt,Lt,$t,Bt,Ht,Vt,Kt){const ii=this.length;return this.resize(ii+1),this.emplace(ii,s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe,We,It,gt,Lt,$t,Bt,Ht,Vt,Kt)}emplace(s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge,Me,He,Te,Ge,qe,We,It,gt,Lt,$t,Bt,Ht,Vt,Kt,ii){const Rt=38*s,hi=19*s;return this.int16[Rt+0]=l,this.int16[Rt+1]=d,this.int16[Rt+2]=A,this.float32[hi+2]=_,this.float32[hi+3]=x,this.int16[Rt+8]=b,this.int16[Rt+9]=S,this.int16[Rt+10]=T,this.int16[Rt+11]=k,this.int16[Rt+12]=G,this.int16[Rt+13]=V,this.uint16[Rt+14]=K,this.uint16[Rt+15]=$,this.uint16[Rt+16]=re,this.uint16[Rt+17]=ge,this.uint16[Rt+18]=Me,this.uint16[Rt+19]=He,this.uint16[Rt+20]=Te,this.uint16[Rt+21]=Ge,this.uint16[Rt+22]=qe,this.uint16[Rt+23]=We,this.uint16[Rt+24]=It,this.uint16[Rt+25]=gt,this.uint16[Rt+26]=Lt,this.uint16[Rt+27]=$t,this.uint16[Rt+28]=Bt,this.uint32[hi+15]=Ht,this.float32[hi+16]=Vt,this.float32[hi+17]=Kt,this.float32[hi+18]=ii,s}}Sn.prototype.bytesPerElement=76,vi(Sn,"StructArrayLayout3i2f6i15ui1ul3f76");class Mn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.float32[1*s+0]=l,s}}Mn.prototype.bytesPerElement=4,vi(Mn,"StructArrayLayout1f4");class Tn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,A,_){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,d,A,_)}emplace(s,l,d,A,_,x){const b=5*s;return this.float32[b+0]=l,this.float32[b+1]=d,this.float32[b+2]=A,this.float32[b+3]=_,this.float32[b+4]=x,s}}Tn.prototype.bytesPerElement=20,vi(Tn,"StructArrayLayout5f20");class ss extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,A){const _=this.length;return this.resize(_+1),this.emplace(_,s,l,d,A)}emplace(s,l,d,A,_){const x=6*s;return this.uint32[3*s+0]=l,this.uint16[x+2]=d,this.uint16[x+3]=A,this.uint16[x+4]=_,s}}ss.prototype.bytesPerElement=12,vi(ss,"StructArrayLayout1ul3ui12");class Fr extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const A=2*s;return this.uint16[A+0]=l,this.uint16[A+1]=d,s}}Fr.prototype.bytesPerElement=4,vi(Fr,"StructArrayLayout2ui4");class no extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint16[1*s+0]=l,s}}no.prototype.bytesPerElement=2,vi(no,"StructArrayLayout1ui2");class Yo extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const A=2*s;return this.float32[A+0]=l,this.float32[A+1]=d,s}}Yo.prototype.bytesPerElement=8,vi(Yo,"StructArrayLayout2f8");class jn extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}jn.prototype.size=40;class Dn extends Ni{get(s){return new jn(this,s)}}vi(Dn,"CollisionBoxArray");class fn extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}fn.prototype.size=60;class Ar extends yn{get(s){return new fn(this,s)}}vi(Ar,"PlacedSymbolArray");class gs extends et{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}gs.prototype.size=76;class Hn extends Sn{get(s){return new gs(this,s)}}vi(Hn,"SymbolInstanceArray");class Bs extends Mn{getoffsetX(s){return this.float32[1*s+0]}}vi(Bs,"GlyphOffsetArray");class zf extends Zt{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}vi(zf,"SymbolLineVertexArray");class jl extends et{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}jl.prototype.size=12;class Oh extends ss{get(s){return new jl(this,s)}}vi(Oh,"FeatureIndexArray");class Ta extends Fr{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}vi(Ta,"FillExtrusionCentroidArray");const ll=lt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ql=lt([{name:"a_dash",components:4,type:"Uint16"}]);var Uf={exports:{}},Gh={exports:{}};Gh.exports=function(a,s){var l,d,A,_,x,b,S,T;for(d=a.length-(l=3&a.length),A=s,x=3432918353,b=461845907,T=0;T<d;)S=255&a.charCodeAt(T)|(255&a.charCodeAt(++T))<<8|(255&a.charCodeAt(++T))<<16|(255&a.charCodeAt(++T))<<24,++T,A=27492+(65535&(_=5*(65535&(A=(A^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,l){case 3:S^=(255&a.charCodeAt(T+2))<<16;case 2:S^=(255&a.charCodeAt(T+1))<<8;case 1:A^=S=(65535&(S=(S=(65535&(S^=255&a.charCodeAt(T)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return A^=a.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0};var Ug=Gh.exports,qB={exports:{}};qB.exports=function(a,s){for(var l,d=a.length,A=s^d,_=0;d>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(_)|(255&a.charCodeAt(++_))<<8|(255&a.charCodeAt(++_))<<16|(255&a.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:A^=(255&a.charCodeAt(_+2))<<16;case 2:A^=(255&a.charCodeAt(_+1))<<8;case 1:A=1540483477*(65535&(A^=255&a.charCodeAt(_)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0};var KB=Ug,kF=qB.exports;Uf.exports=KB,Uf.exports.murmur3=KB,Uf.exports.murmur2=kF;var sI=F(Uf.exports);class oy{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,l,d,A){this.ids.push(JB(s)),this.positions.push(l,d,A)}getPositions(s){const l=JB(s);let d=0,A=this.ids.length-1;for(;d<A;){const x=d+A>>1;this.ids[x]>=l?A=x:d=x+1}const _=[];for(;this.ids[d]===l;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(s,l){const d=new Float64Array(s.ids),A=new Uint32Array(s.positions);return oI(d,A,0,d.length-1),l&&l.push(d.buffer,A.buffer),{ids:d,positions:A}}static deserialize(s){const l=new oy;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l}}function JB(a){const s=+a;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:sI(String(a))}function oI(a,s,l,d){for(;l<d;){const A=a[l+d>>1];let _=l-1,x=d+1;for(;;){do _++;while(a[_]<A);do x--;while(a[x]>A);if(_>=x)break;ay(a,_,x),ay(s,3*_,3*x),ay(s,3*_+1,3*x+1),ay(s,3*_+2,3*x+2)}x-l<d-x?(oI(a,s,l,x),l=x+1):(oI(a,s,x+1,d),d=x)}}function ay(a,s,l){const d=a[s];a[s]=a[l],a[l]=d}vi(oy,"FeaturePositionMap");class Kl{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,l),this.initialized=!0),!!this.location}}class ly extends Kl{constructor(s){super(s),this.current=0}set(s,l,d){this.fetchUniformLocation(s,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class XB extends Kl{constructor(s){super(s),this.current=[0,0,0,0]}set(s,l,d){this.fetchUniformLocation(s,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class ZB extends Kl{constructor(s){super(s),this.current=hr.transparent}set(s,l,d){this.fetchUniformLocation(s,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const FF=new Float32Array(16),NF=new Float32Array(9),zF=new Float32Array(4);function aI(a){return[$e(255*a.r,255*a.g),$e(255*a.b,255*a.a)]}class Og{constructor(s,l,d){this.value=s,this.uniformNames=l.map(A=>`u_${A}`),this.type=d}setUniform(s,l,d,A,_){l.set(s,_,A.constantOr(this.value))}getBinding(s,l){return this.type==="color"?new ZB(s):new ly(s)}}class Of{constructor(s,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,l,d,A,_){const x=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;x&&l.set(s,_,x)}getBinding(s,l){return l==="u_pattern"||l==="u_dash"?new XB(s):new ly(s)}}class Jl{constructor(s,l,d,A){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new A}populatePaintArray(s,l,d,A,_,x){const b=this.paintVertexArray.length,S=this.expression.evaluate(new U(0),l,{},_,A,x);this.paintVertexArray.resize(s),this._setPaintValue(b,s,S)}updatePaintArray(s,l,d,A,_){const x=this.expression.evaluate({zoom:0},d,A,void 0,_);this._setPaintValue(s,l,x)}_setPaintValue(s,l,d){if(this.type==="color"){const A=aI(d);for(let _=s;_<l;_++)this.paintVertexArray.emplace(_,A[0],A[1])}else{for(let A=s;A<l;A++)this.paintVertexArray.emplace(A,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Da{constructor(s,l,d,A,_,x){this.expression=s,this.uniformNames=l.map(b=>`u_${b}_t`),this.type=d,this.useIntegerZoom=A,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=l.map(b=>({name:`a_${b}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,l,d,A,_,x){const b=this.expression.evaluate(new U(this.zoom),l,{},_,A,x),S=this.expression.evaluate(new U(this.zoom+1),l,{},_,A,x),T=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(T,s,b,S)}updatePaintArray(s,l,d,A,_){const x=this.expression.evaluate({zoom:this.zoom},d,A,void 0,_),b=this.expression.evaluate({zoom:this.zoom+1},d,A,void 0,_);this._setPaintValue(s,l,x,b)}_setPaintValue(s,l,d,A){if(this.type==="color"){const _=aI(d),x=aI(A);for(let b=s;b<l;b++)this.paintVertexArray.emplace(b,_[0],_[1],x[0],x[1])}else{for(let _=s;_<l;_++)this.paintVertexArray.emplace(_,d,A);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(A))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,l,d,A,_){const x=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,b=ye(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);l.set(s,_,b)}getBinding(s,l){return new ly(s)}}class ou{constructor(s,l,d,A,_){this.expression=s,this.layerId=_,this.paintVertexAttributes=(d==="array"?ql:ll).members;for(let x=0;x<l.length;++x);this.paintVertexArray=new A}populatePaintArray(s,l,d){const A=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(A,s,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(s,l,d,A,_,x){this._setPaintValues(s,l,d.patterns&&d.patterns[this.layerId],x)}_setPaintValues(s,l,d,A){if(!A||!d)return;const _=A[d];if(!_)return;const{tl:x,br:b,pixelRatio:S}=_;for(let T=s;T<l;T++)this.paintVertexArray.emplace(T,x[0],x[1],b[0],b[1],S)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class au{constructor(s,l,d=()=>!0){this.binders={},this._buffers=[];const A=[];for(const _ in s.paint._values){if(!d(_))continue;const x=s.paint.get(_);if(!(x instanceof we&&Zc(x.property.specification)))continue;const b=OF(_,s.type),S=x.value,T=x.property.specification.type,k=!!x.property.useIntegerZoom,G=_==="line-dasharray"||_.endsWith("pattern"),V=_==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||V)if(S.kind==="source"||V||G){const K=$B(_,T,"source");this.binders[_]=G?new ou(S,b,T,K,s.id):new Jl(S,b,T,K),A.push(`/a_${_}`)}else{const K=$B(_,T,"composite");this.binders[_]=new Da(S,b,T,k,l,K),A.push(`/z_${_}`)}else this.binders[_]=G?new Of(S.value,b):new Og(S.value,b,T),A.push(`/u_${_}`)}this.cacheKey=A.sort().join("")}getMaxValue(s){const l=this.binders[s];return l instanceof Jl||l instanceof Da?l.maxValue:0}populatePaintArrays(s,l,d,A,_,x){for(const b in this.binders){const S=this.binders[b];(S instanceof Jl||S instanceof Da||S instanceof ou)&&S.populatePaintArray(s,l,d,A,_,x)}}setConstantPatternPositions(s){for(const l in this.binders){const d=this.binders[l];d instanceof Of&&d.setConstantPatternPositions(s)}}updatePaintArrays(s,l,d,A,_,x){let b=!1;for(const S in s){const T=l.getPositions(S);for(const k of T){const G=d.feature(k.index);for(const V in this.binders){const K=this.binders[V];if((K instanceof Jl||K instanceof Da||K instanceof ou)&&K.expression.isStateDependent===!0){const $=A.paint.get(V);K.expression=$.value,K.updatePaintArray(k.start,k.end,G,s[S],_,x),b=!0}}}}return b}defines(){const s=[];for(const l in this.binders){const d=this.binders[l];(d instanceof Og||d instanceof Of)&&s.push(...d.uniformNames.map(A=>`#define HAS_UNIFORM_${A}`))}return s}getBinderAttributes(){const s=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Jl||d instanceof Da||d instanceof ou)for(let A=0;A<d.paintVertexAttributes.length;A++)s.push(d.paintVertexAttributes[A].name)}return s}getBinderUniforms(){const s=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Og||d instanceof Of||d instanceof Da)for(const A of d.uniformNames)s.push(A)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const l=[];for(const d in this.binders){const A=this.binders[d];if(A instanceof Og||A instanceof Of||A instanceof Da)for(const _ of A.uniformNames)l.push({name:_,property:d,binding:A.getBinding(s,_)})}return l}setUniforms(s,l,d,A,_){for(const{name:x,property:b,binding:S}of d)this.binders[b].setUniform(s,S,_,A.get(b),x)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const l=this.binders[s];(l instanceof Jl||l instanceof Da||l instanceof ou)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(s){for(const l in this.binders){const d=this.binders[l];(d instanceof Jl||d instanceof Da||d instanceof ou)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const l=this.binders[s];(l instanceof Jl||l instanceof Da||l instanceof ou)&&l.destroy()}}}class Hh{constructor(s,l,d=()=>!0){this.programConfigurations={};for(const A of s)this.programConfigurations[A.id]=new au(A,l,d);this.needsUpload=!1,this._featureMap=new oy,this._bufferOffset=0}populatePaintArrays(s,l,d,A,_,x,b){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(s,l,A,_,x,b);l.id!==void 0&&this._featureMap.add(l.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,l,d,A,_){for(const x of d)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,l,x,A,_)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const UF={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function OF(a,s){return UF[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}const GF={"line-pattern":{source:_t,composite:_t},"fill-pattern":{source:_t,composite:_t},"fill-extrusion-pattern":{source:_t,composite:_t},"line-dasharray":{source:Nt,composite:Nt}},HF={color:{source:Yo,composite:Jt},number:{source:Mn,composite:Yo}};function $B(a,s,l){const d=GF[a];return d&&d[l]||HF[s][l]}vi(Og,"ConstantBinder"),vi(Of,"PatternConstantBinder"),vi(Jl,"SourceExpressionBinder"),vi(ou,"PatternCompositeBinder"),vi(Da,"CompositeExpressionBinder"),vi(au,"ProgramConfiguration",{omit:["_buffers"]}),vi(Hh,"ProgramConfigurationSet");const e2="-transition";class Qa extends Ia{constructor(s,l){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&s.type!=="sky"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),l.layout&&(this._unevaluatedLayout=new be(l.layout)),l.paint)){this._transitionablePaint=new ie(l.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Se(l.paint)}}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,l,d={}){l!=null&&this._validate(eI,`layers.${this.id}.layout.${s}`,s,l,d)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,l):this.visibility=l)}getPaintProperty(s){return Ve(s,e2)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,l,d={}){if(l!=null&&this._validate($1,`layers.${this.id}.paint.${s}`,s,l,d))return!1;if(Ve(s,e2))return this._transitionablePaint.setTransition(s.slice(0,-11),l||void 0),!1;{const A=this._transitionablePaint._values[s],_=A.value.isDataDriven(),x=A.value;this._transitionablePaint.setValue(s,l),this._handleSpecialPaintPropertyUpdate(s);const b=this._transitionablePaint._values[s].value,S=b.isDataDriven(),T=Ve(s,"pattern")||s==="line-dasharray";return S||_||T||this._handleOverridablePaintPropertyUpdate(s,x,b)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,l,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,l)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),ae(s,(l,d)=>!(l===void 0||d==="layout"&&!Object.keys(l).length||d==="paint"&&!Object.keys(l).length))}_validate(s,l,d,A,_={}){return(!_||_.validate!==!1)&&iy(this,s.call(ty,{key:l,layerType:this.type,objectKey:d,value:A,styleSpec:Mt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const l=this.paint.get(s);if(l instanceof we&&Zc(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Pf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const VF=lt([{name:"a_pos",components:2,type:"Int16"}],4),WF=lt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class gr{constructor(s=[]){this.segments=s}prepareSegment(s,l,d,A){let _=this.segments[this.segments.length-1];return s>gr.MAX_VERTEX_ARRAY_LENGTH&&nt(`Max vertices per segment is ${gr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!_||_.vertexLength+s>gr.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==A)&&(_={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},A!==void 0&&(_.sortKey=A),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const s of this.segments)for(const l in s.vaos)s.vaos[l].destroy()}static simpleSegment(s,l,d,A){return new gr([{vertexOffset:s,primitiveOffset:l,vertexLength:d,primitiveLength:A,vaos:{},sortKey:0}])}}gr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vi(gr,"SegmentVector");var Mi=8192;class lu{constructor(s,l){s&&(l?this.setSouthWest(s).setNorthEast(l):s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof Qn?new Qn(s.lng,s.lat):Qn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Qn?new Qn(s.lng,s.lat):Qn.convert(s),this}extend(s){const l=this._sw,d=this._ne;let A,_;if(s instanceof Qn)A=s,_=s;else{if(!(s instanceof lu))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(lu.convert(s)):this.extend(Qn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Qn.convert(s)):this;if(A=s._sw,_=s._ne,!A||!_)return this}return l||d?(l.lng=Math.min(A.lng,l.lng),l.lat=Math.min(A.lat,l.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new Qn(A.lng,A.lat),this._ne=new Qn(_.lng,_.lat)),this}getCenter(){return new Qn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Qn(this.getWest(),this.getNorth())}getSouthEast(){return new Qn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:l,lat:d}=Qn.convert(s);let A=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&A}static convert(s){return!s||s instanceof lu?s:new lu(s)}}var cy=1e-6,ro=typeof Float32Array<"u"?Float32Array:Array;function t2(){var a=new ro(9);return ro!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function i2(a,s,l){var d=s[0],A=s[1],_=s[2],x=s[3],b=s[4],S=s[5],T=s[6],k=s[7],G=s[8],V=l[0],K=l[1],$=l[2],re=l[3],ge=l[4],Me=l[5],He=l[6],Te=l[7],Ge=l[8];return a[0]=V*d+K*x+$*T,a[1]=V*A+K*b+$*k,a[2]=V*_+K*S+$*G,a[3]=re*d+ge*x+Me*T,a[4]=re*A+ge*b+Me*k,a[5]=re*_+ge*S+Me*G,a[6]=He*d+Te*x+Ge*T,a[7]=He*A+Te*b+Ge*k,a[8]=He*_+Te*S+Ge*G,a}function Ra(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lI(a,s){var l=s[0],d=s[1],A=s[2],_=s[3],x=s[4],b=s[5],S=s[6],T=s[7],k=s[8],G=s[9],V=s[10],K=s[11],$=s[12],re=s[13],ge=s[14],Me=s[15],He=l*b-d*x,Te=l*S-A*x,Ge=l*T-_*x,qe=d*S-A*b,We=d*T-_*b,It=A*T-_*S,gt=k*re-G*$,Lt=k*ge-V*$,$t=k*Me-K*$,Bt=G*ge-V*re,Ht=G*Me-K*re,Vt=V*Me-K*ge,Kt=He*Vt-Te*Ht+Ge*Bt+qe*$t-We*Lt+It*gt;return Kt?(a[0]=(b*Vt-S*Ht+T*Bt)*(Kt=1/Kt),a[1]=(A*Ht-d*Vt-_*Bt)*Kt,a[2]=(re*It-ge*We+Me*qe)*Kt,a[3]=(V*We-G*It-K*qe)*Kt,a[4]=(S*$t-x*Vt-T*Lt)*Kt,a[5]=(l*Vt-A*$t+_*Lt)*Kt,a[6]=(ge*Ge-$*It-Me*Te)*Kt,a[7]=(k*It-V*Ge+K*Te)*Kt,a[8]=(x*Ht-b*$t+T*gt)*Kt,a[9]=(d*$t-l*Ht-_*gt)*Kt,a[10]=($*We-re*Ge+Me*He)*Kt,a[11]=(G*Ge-k*We-K*He)*Kt,a[12]=(b*Lt-x*Bt-S*gt)*Kt,a[13]=(l*Bt-d*Lt+A*gt)*Kt,a[14]=(re*Te-$*qe-ge*He)*Kt,a[15]=(k*qe-G*Te+V*He)*Kt,a):null}function Vh(a,s,l){var d=s[0],A=s[1],_=s[2],x=s[3],b=s[4],S=s[5],T=s[6],k=s[7],G=s[8],V=s[9],K=s[10],$=s[11],re=s[12],ge=s[13],Me=s[14],He=s[15],Te=l[0],Ge=l[1],qe=l[2],We=l[3];return a[0]=Te*d+Ge*b+qe*G+We*re,a[1]=Te*A+Ge*S+qe*V+We*ge,a[2]=Te*_+Ge*T+qe*K+We*Me,a[3]=Te*x+Ge*k+qe*$+We*He,a[4]=(Te=l[4])*d+(Ge=l[5])*b+(qe=l[6])*G+(We=l[7])*re,a[5]=Te*A+Ge*S+qe*V+We*ge,a[6]=Te*_+Ge*T+qe*K+We*Me,a[7]=Te*x+Ge*k+qe*$+We*He,a[8]=(Te=l[8])*d+(Ge=l[9])*b+(qe=l[10])*G+(We=l[11])*re,a[9]=Te*A+Ge*S+qe*V+We*ge,a[10]=Te*_+Ge*T+qe*K+We*Me,a[11]=Te*x+Ge*k+qe*$+We*He,a[12]=(Te=l[12])*d+(Ge=l[13])*b+(qe=l[14])*G+(We=l[15])*re,a[13]=Te*A+Ge*S+qe*V+We*ge,a[14]=Te*_+Ge*T+qe*K+We*Me,a[15]=Te*x+Ge*k+qe*$+We*He,a}function Gg(a,s,l){var d,A,_,x,b,S,T,k,G,V,K,$,re=l[0],ge=l[1],Me=l[2];return s===a?(a[12]=s[0]*re+s[4]*ge+s[8]*Me+s[12],a[13]=s[1]*re+s[5]*ge+s[9]*Me+s[13],a[14]=s[2]*re+s[6]*ge+s[10]*Me+s[14],a[15]=s[3]*re+s[7]*ge+s[11]*Me+s[15]):(A=s[1],_=s[2],x=s[3],b=s[4],S=s[5],T=s[6],k=s[7],G=s[8],V=s[9],K=s[10],$=s[11],a[0]=d=s[0],a[1]=A,a[2]=_,a[3]=x,a[4]=b,a[5]=S,a[6]=T,a[7]=k,a[8]=G,a[9]=V,a[10]=K,a[11]=$,a[12]=d*re+b*ge+G*Me+s[12],a[13]=A*re+S*ge+V*Me+s[13],a[14]=_*re+T*ge+K*Me+s[14],a[15]=x*re+k*ge+$*Me+s[15]),a}function Wh(a,s,l){var d=l[0],A=l[1],_=l[2];return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*A,a[5]=s[5]*A,a[6]=s[6]*A,a[7]=s[7]*A,a[8]=s[8]*_,a[9]=s[9]*_,a[10]=s[10]*_,a[11]=s[11]*_,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a}function cI(a,s,l){var d=Math.sin(l),A=Math.cos(l),_=s[4],x=s[5],b=s[6],S=s[7],T=s[8],k=s[9],G=s[10],V=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=_*A+T*d,a[5]=x*A+k*d,a[6]=b*A+G*d,a[7]=S*A+V*d,a[8]=T*A-_*d,a[9]=k*A-x*d,a[10]=G*A-b*d,a[11]=V*A-S*d,a}function uy(a,s,l){var d=Math.sin(l),A=Math.cos(l),_=s[0],x=s[1],b=s[2],S=s[3],T=s[8],k=s[9],G=s[10],V=s[11];return s!==a&&(a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=_*A-T*d,a[1]=x*A-k*d,a[2]=b*A-G*d,a[3]=S*A-V*d,a[8]=_*d+T*A,a[9]=x*d+k*A,a[10]=b*d+G*A,a[11]=S*d+V*A,a}function n2(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function r2(a,s,l){var d,A,_,x=l[0],b=l[1],S=l[2],T=Math.hypot(x,b,S);return T<cy?null:(x*=T=1/T,b*=T,S*=T,d=Math.sin(s),A=Math.cos(s),a[0]=x*x*(_=1-A)+A,a[1]=b*x*_+S*d,a[2]=S*x*_-b*d,a[3]=0,a[4]=x*b*_-S*d,a[5]=b*b*_+A,a[6]=S*b*_+x*d,a[7]=0,a[8]=x*S*_+b*d,a[9]=b*S*_-x*d,a[10]=S*S*_+A,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var YF=Vh;function uI(){var a=new ro(3);return ro!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function s2(a){var s=new ro(3);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s}function Hg(a){return Math.hypot(a[0],a[1],a[2])}function Gf(a,s,l){var d=new ro(3);return d[0]=a,d[1]=s,d[2]=l,d}function Xl(a,s,l){return a[0]=s[0]+l[0],a[1]=s[1]+l[1],a[2]=s[2]+l[2],a}function hI(a,s,l){return a[0]=s[0]-l[0],a[1]=s[1]-l[1],a[2]=s[2]-l[2],a}function o2(a,s,l){return a[0]=s[0]*l[0],a[1]=s[1]*l[1],a[2]=s[2]*l[2],a}function Vg(a,s,l){return a[0]=Math.min(s[0],l[0]),a[1]=Math.min(s[1],l[1]),a[2]=Math.min(s[2],l[2]),a}function Wg(a,s,l){return a[0]=Math.max(s[0],l[0]),a[1]=Math.max(s[1],l[1]),a[2]=Math.max(s[2],l[2]),a}function Eo(a,s,l){return a[0]=s[0]*l,a[1]=s[1]*l,a[2]=s[2]*l,a}function Yg(a,s,l,d){return a[0]=s[0]+l[0]*d,a[1]=s[1]+l[1]*d,a[2]=s[2]+l[2]*d,a}function Ss(a,s){var l=s[0],d=s[1],A=s[2],_=l*l+d*d+A*A;return _>0&&(_=1/Math.sqrt(_)),a[0]=s[0]*_,a[1]=s[1]*_,a[2]=s[2]*_,a}function jo(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]}function dI(a,s,l){var d=s[0],A=s[1],_=s[2],x=l[0],b=l[1],S=l[2];return a[0]=A*S-_*b,a[1]=_*x-d*S,a[2]=d*b-A*x,a}function dr(a,s,l){var d=s[0],A=s[1],_=s[2],x=l[3]*d+l[7]*A+l[11]*_+l[15];return a[0]=(l[0]*d+l[4]*A+l[8]*_+l[12])/(x=x||1),a[1]=(l[1]*d+l[5]*A+l[9]*_+l[13])/x,a[2]=(l[2]*d+l[6]*A+l[10]*_+l[14])/x,a}function a2(a,s,l){var d=l[0],A=l[1],_=l[2],x=s[0],b=s[1],S=s[2],T=A*S-_*b,k=_*x-d*S,G=d*b-A*x,V=A*G-_*k,K=_*T-d*G,$=d*k-A*T,re=2*l[3];return k*=re,G*=re,K*=2,$*=2,a[0]=x+(T*=re)+(V*=2),a[1]=b+k+K,a[2]=S+G+$,a}var jg,La=hI,jF=o2,qF=Hg;function l2(a,s,l){return a[0]=s[0]*l,a[1]=s[1]*l,a[2]=s[2]*l,a[3]=s[3]*l,a}function c2(a,s){var l=s[0],d=s[1],A=s[2],_=s[3],x=l*l+d*d+A*A+_*_;return x>0&&(x=1/Math.sqrt(x)),a[0]=l*x,a[1]=d*x,a[2]=A*x,a[3]=_*x,a}function Yh(a,s,l){var d=s[0],A=s[1],_=s[2],x=s[3];return a[0]=l[0]*d+l[4]*A+l[8]*_+l[12]*x,a[1]=l[1]*d+l[5]*A+l[9]*_+l[13]*x,a[2]=l[2]*d+l[6]*A+l[10]*_+l[14]*x,a[3]=l[3]*d+l[7]*A+l[11]*_+l[15]*x,a}function u2(){var a=new ro(4);return ro!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function h2(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function d2(a,s,l){l*=.5;var d=s[0],A=s[1],_=s[2],x=s[3],b=Math.sin(l),S=Math.cos(l);return a[0]=d*S+x*b,a[1]=A*S+_*b,a[2]=_*S-A*b,a[3]=x*S-d*b,a}function f2(a,s,l){l*=.5;var d=s[0],A=s[1],_=s[2],x=s[3],b=Math.sin(l),S=Math.cos(l);return a[0]=d*S-_*b,a[1]=A*S+x*b,a[2]=_*S+d*b,a[3]=x*S-A*b,a}uI(),jg=new ro(4),ro!=Float32Array&&(jg[0]=0,jg[1]=0,jg[2]=0,jg[3]=0);var KF=c2;uI(),Gf(1,0,0),Gf(0,1,0),u2(),u2(),t2();const JF=lt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:p2}=JF,A2=lt([{name:"a_pos_3",components:3,type:"Int16"}]);var qg=lt([{name:"a_pos",type:"Int16",components:2}]);class fI{constructor(s,l){this.pos=s,this.dir=l}intersectsPlane(s,l,d){const A=jo(l,this.dir);if(Math.abs(A)<1e-6)return!1;const _=((s[0]-this.pos[0])*l[0]+(s[1]-this.pos[1])*l[1]+(s[2]-this.pos[2])*l[2])/A;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(s,l,d){if(function(K,$){var re=K[0],ge=K[1],Me=K[2],He=$[0],Te=$[1],Ge=$[2];return Math.abs(re-He)<=cy*Math.max(1,Math.abs(re),Math.abs(He))&&Math.abs(ge-Te)<=cy*Math.max(1,Math.abs(ge),Math.abs(Te))&&Math.abs(Me-Ge)<=cy*Math.max(1,Math.abs(Me),Math.abs(Ge))}(this.pos,s)||l===0)return d[0]=d[1]=d[2]=0,!1;const[A,_,x]=this.dir,b=this.pos[0]-s[0],S=this.pos[1]-s[1],T=this.pos[2]-s[2],k=A*A+_*_+x*x,G=2*(b*A+S*_+T*x),V=G*G-4*k*(b*b+S*S+T*T-l*l);if(V<0){const K=Math.max(-G/2,0),$=b+A*K,re=S+_*K,ge=T+x*K,Me=Math.hypot($,re,ge);return d[0]=$*l/Me,d[1]=re*l/Me,d[2]=ge*l/Me,!1}{const K=(-G-Math.sqrt(V))/(2*k);if(K<0){const $=Math.hypot(b,S,T);return d[0]=b*l/$,d[1]=S*l/$,d[2]=T*l/$,!1}return d[0]=b+A*K,d[1]=S+_*K,d[2]=T+x*K,!0}}}class pI{constructor(s,l,d,A,_){this.TL=s,this.TR=l,this.BR=d,this.BL=A,this.horizon=_}static fromInvProjectionMatrix(s,l,d){const A=[-1,1,1],_=[1,1,1],x=[1,-1,1],b=[-1,-1,1],S=dr(A,A,s),T=dr(_,_,s),k=dr(x,x,s),G=dr(b,b,s);return new pI(S,T,k,G,l/d)}}class AI{constructor(s,l){this.points=s,this.planes=l}static fromInvProjectionMatrix(s,l,d,A){const _=Math.pow(2,d),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const T=Yh([],S,s),k=1/T[3]/l*_;return function(G,V,K){return G[0]=V[0]*K[0],G[1]=V[1]*K[1],G[2]=V[2]*K[2],G[3]=V[3]*K[3],G}(T,T,[k,k,A?1/T[3]:k,k])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const T=Ss([],dI([],La([],x[S[0]],x[S[1]]),La([],x[S[2]],x[S[1]]))),k=-jo(T,x[S[1]]);return T.concat(k)});return new AI(x,b)}}class Ms{static fromPoints(s){const l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const A of s)Vg(l,l,A),Wg(d,d,A);return new Ms(l,d)}static applyTransform(s,l){const d=s.getCorners();for(let A=0;A<d.length;++A)dr(d[A],d[A],l);return Ms.fromPoints(d)}constructor(s,l){this.min=s,this.max=l,this.center=Eo([],Xl([],this.min,this.max),.5)}quadrant(s){const l=[s%2==0,s<2],d=s2(this.min),A=s2(this.max);for(let _=0;_<l.length;_++)d[_]=l[_]?this.min[_]:this.center[_],A[_]=l[_]?this.center[_]:this.max[_];return A[2]=this.max[2],new Ms(d,A)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,l=this.max;return[[s[0],s[1],s[2]],[l[0],s[1],s[2]],[l[0],l[1],s[2]],[s[0],l[1],s[2]],[s[0],s[1],l[2]],[l[0],s[1],l[2]],[l[0],l[1],l[2]],[s[0],l[1],l[2]]]}intersects(s){const l=this.getCorners();let d=!0;for(let A=0;A<s.planes.length;A++){const _=s.planes[A];let x=0;for(let b=0;b<l.length;b++)x+=jo(_,l[b])+_[3]>=0;if(x===0)return 0;x!==l.length&&(d=!1)}if(d)return 2;for(let A=0;A<3;A++){let _=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<s.points.length;b++){const S=s.points[b][A]-this.min[A];_=Math.min(_,S),x=Math.max(x,S)}if(x<0||_>this.max[A]-this.min[A])return 0}return 1}}const gI=5,g2=6,cl=Mi/Math.PI/2,XF=16383,jh=64,Kg=[jh,32,16],qo=-cl,Ko=cl,ZF=[new Ms([qo,qo,qo],[Ko,Ko,Ko]),new Ms([qo,qo,qo],[0,0,Ko]),new Ms([0,qo,qo],[Ko,0,Ko]),new Ms([qo,0,qo],[0,Ko,Ko]),new Ms([0,0,qo],[Ko,Ko,Ko])];function hy(a){return a*cl/Zg}function m2(a,s,l,d=!0){const A=Eo([],a._camera.position,a.worldSize),_=[s,l,1,1];Yh(_,_,a.pixelMatrixInverse),l2(_,_,1/_[3]);const x=Ss([],La([],_,A)),b=a.globeMatrix,S=[b[12],b[13],b[14]],T=La([],S,A),k=Hg(T),G=Ss([],T),V=a.worldSize/(2*Math.PI),K=jo(G,x),$=Math.asin(V/k);if($<Math.acos(K)){if(!d)return null;const $t=[],Bt=[];Eo($t,x,k/K),Ss(Bt,La(Bt,$t,T)),Ss(x,Xl(x,T,Eo(x,Bt,Math.tan($)*k)))}const re=[];new fI(A,x).closestPointOnSphere(S,V,re);const ge=Ss([],ue(b,0)),Me=Ss([],ue(b,1)),He=Ss([],ue(b,2)),Te=jo(ge,re),Ge=jo(Me,re),qe=jo(He,re),We=ce(Math.asin(-Ge/V));let It=ce(Math.atan2(Te,qe));It=a.center.lng+function($t,Bt){const Ht=(Bt-$t+180)%360-180;return Ht<-180?Ht+360:Ht}(a.center.lng,It);const gt=hl(It),Lt=ye(dl(We),0,1);return new Yf(gt,Lt)}class $F{constructor(s,l,d){this.a=La([],s,d),this.b=La([],l,d),this.center=d;const A=Ss([],this.a),_=Ss([],this.b);this.angle=Math.acos(jo(A,_))}}function mI(a,s){if(a.angle===0)return null;let l;return l=a.a[s]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[s]/a.a[s]/Math.sin(a.angle)-1/Math.tan(a.angle)),l<0||l>1?null:function(d,A,_,x){const b=Math.sin(_);return d*(Math.sin((1-x)*_)/b)+A*(Math.sin(x*_)/b)}(a.a[s],a.b[s],a.angle,ye(l,0,1))+a.center[s]}function ul(a){if(a.z<=1)return ZF[a.z+2*a.y+a.x];const s=_I(dy(a));return Ms.fromPoints(s)}function qh(a,s,l){return Eo(a,a,1-l),Yg(a,a,s,l)}function _2(a,s){const l=Wf(s.zoom);if(l===0)return ul(a);const d=dy(a),A=_I(d),_=hl(d.getWest())*s.worldSize,x=hl(d.getEast())*s.worldSize,b=dl(d.getNorth())*s.worldSize,S=dl(d.getSouth())*s.worldSize,T=[_,b,0],k=[x,b,0],G=[_,S,0],V=[x,S,0],K=lI([],s.globeMatrix);return dr(T,T,K),dr(k,k,K),dr(G,G,K),dr(V,V,K),A[0]=qh(A[0],G,l),A[1]=qh(A[1],V,l),A[2]=qh(A[2],k,l),A[3]=qh(A[3],T,l),Ms.fromPoints(A)}function y2(a,s,l){for(const d of a)dr(d,d,s),Eo(d,d,l)}function e5(a,s,l){const d=s/a.worldSize,A=a.globeMatrix;if(l.z<=1){const gt=ul(l).getCorners();return y2(gt,A,d),Ms.fromPoints(gt)}const _=dy(l),x=_I(_);y2(x,A,d);const b=Number.MAX_VALUE,S=[-b,-b,-b],T=[b,b,b];if(_.contains(a.center)){for(const $t of x)Vg(T,T,$t),Wg(S,S,$t);S[2]=0;const gt=a.point,Lt=[gt.x*d,gt.y*d,0];return Vg(T,T,Lt),Wg(S,S,Lt),new Ms(T,S)}const k=[A[12]*d,A[13]*d,A[14]*d],G=_.getCenter(),V=ye(a.center.lat,-as,as),K=ye(G.lat,-as,as),$=hl(a.center.lng),re=dl(V);let ge=$-hl(G.lng);const Me=re-dl(K);ge>.5?ge-=1:ge<-.5&&(ge+=1);let He=0;Math.abs(ge)>Math.abs(Me)?He=ge>=0?1:3:(He=Me>=0?0:2,Yg(k,k,[A[4]*d,A[5]*d,A[6]*d],-Math.sin(te(Me>=0?_.getSouth():_.getNorth()))*cl));const Te=x[He],Ge=x[(He+1)%4],qe=new $F(Te,Ge,k),We=[mI(qe,0)||Te[0],mI(qe,1)||Te[1],mI(qe,2)||Te[2]],It=Wf(a.zoom);if(It>0){const gt=function({x:$t,y:Bt,z:Ht},Vt,Kt,ii,Rt){const hi=1/(1<<Ht);let Ci=$t*hi,di=Ci+hi,Oi=Bt*hi,ri=Oi+hi,Si=0;const Gi=(Ci+di)/2-ii;return Gi>.5?Si=-1:Gi<-.5&&(Si=1),Ci=((Ci+Si)*Vt-(ii*=Vt))*Kt+ii,di=((di+Si)*Vt-ii)*Kt+ii,Oi=(Oi*Vt-(Rt*=Vt))*Kt+Rt,ri=(ri*Vt-Rt)*Kt+Rt,[[Ci,ri,0],[di,ri,0],[di,Oi,0],[Ci,Oi,0]]}(l,s,a._pixelsPerMercatorPixel,$,re);for(let $t=0;$t<x.length;$t++)qh(x[$t],gt[$t],It);const Lt=Xl([],gt[He],gt[(He+1)%4]);Eo(Lt,Lt,.5),qh(We,Lt,It)}for(const gt of x)Vg(T,T,gt),Wg(S,S,gt);return T[2]=Math.min(Te[2],Ge[2]),Vg(T,T,We),Wg(S,S,We),new Ms(T,S)}function dy({x:a,y:s,z:l}){const d=1/(1<<l),A=new Qn(wo(a*d),os((s+1)*d)),_=new Qn(wo((a+1)*d),os(s*d));return new lu(A,_)}function _I(a){const s=te(a.getNorth()),l=te(a.getSouth()),d=Math.cos(s),A=Math.cos(l),_=Math.sin(s),x=Math.sin(l),b=a.getWest(),S=a.getEast();return[Hf(A,x,b),Hf(A,x,S),Hf(d,_,S),Hf(d,_,b)]}function Hf(a,s,l,d=cl){return l=te(l),[a*Math.sin(l)*d,-s*d,a*Math.cos(l)*d]}function Vf(a,s,l){return Hf(Math.cos(te(a)),Math.sin(te(a)),s,l)}function Jg(a,s,l,d){const A=1<<l.z,_=(a/Mi+l.x)/A;return Vf(os((s/Mi+l.y)/A),wo(_),d)}function fy({min:a,max:s}){return XF/Math.max(s[0]-a[0],s[1]-a[1],s[2]-a[2])}const v2=new Float64Array(16);function Xg(a){const s=fy(a),l=n2(v2,[s,s,s]);return Gg(l,l,((d=[])[0]=-(A=a.min)[0],d[1]=-A[1],d[2]=-A[2],d));var d,A}function yI(a){const s=(d=a.min,(l=v2)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=d[0],l[13]=d[1],l[14]=d[2],l[15]=1,l);var l,d;const A=1/fy(a);return Wh(s,s,[A,A,A])}function x2(a,s,l,d,A){const _=function(S){const T=Mi/(2*Math.PI);return S/(2*Math.PI)/T}(l),x=[a,s,-l/(2*Math.PI)],b=Ra(new Float64Array(16));return Gg(b,b,x),Wh(b,b,[_,_,_]),cI(b,b,te(-A)),uy(b,b,te(-d)),b}function Wf(a){return ht(gI,g2,a)}function I2(a,s){const l=Vf(s.lat,s.lng),d=function($){const re=Vf($._center.lat,$._center.lng);let ge=dI([],Gf(0,1,0),re);const Me=r2([],-$.angle,re);ge=dr(ge,ge,Me),r2(Me,-$._pitch,ge);const He=Ss([],re);return Eo(He,He,hy($.cameraToCenterDistance/$.pixelsPerMeter)),dr(He,He,Me),Xl([],re,He)}(a);return x=(A=hI([],d,l))[0],b=A[1],S=A[2],T=(_=l)[0],k=_[1],G=_[2],K=(V=Math.sqrt(x*x+b*b+S*S)*Math.sqrt(T*T+k*k+G*G))&&jo(A,_)/V,Math.acos(Math.min(Math.max(K,-1),1));var A,_,x,b,S,T,k,G,V,K}function vI(a,s){return I2(a,s)>Math.PI/2*1.01}const C2=te(85),t5=Math.cos(C2),i5=Math.sin(C2),Zg=63710088e-1,E2=2*Math.PI*Zg;class cu{constructor(s,l){if(isNaN(s)||isNaN(l))throw new Error(`Invalid LngLat object: (${s}, ${l})`);if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new cu(oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const l=Math.PI/180,d=this.lat*l,A=s.lat*l,_=Math.sin(d)*Math.sin(A)+Math.cos(d)*Math.cos(A)*Math.cos((s.lng-this.lng)*l);return Zg*Math.acos(Math.min(_,1))}toBounds(s=0){const l=360*s/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new lu(new cu(this.lng-d,this.lat-l),new cu(this.lng+d,this.lat+l))}toEcef(s){const l=hy(s);return Vf(this.lat,this.lng,cl+l)}static convert(s){if(s instanceof cu)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new cu(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new cu(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Qn=cu;function xI(a){return E2*Math.cos(a*Math.PI/180)}function hl(a){return(180+a)/360}function dl(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Pa(a,s){return a/xI(s)}function wo(a){return 360*a-180}function os(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function w2(a,s){return a*xI(os(s))}const as=85.051129;function b2(a){return 1/Math.cos(a*Math.PI/180)}class Yf{constructor(s,l,d=0){this.x=+s,this.y=+l,this.z=+d}static fromLngLat(s,l=0){const d=Qn.convert(s);return new Yf(hl(d.lng),dl(d.lat),Pa(l,d.lat))}toLngLat(){return new Qn(wo(this.x),os(this.y))}toAltitude(){return w2(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/E2*b2(os(this.y))}}function II(a,s,l,d,A,_,x,b,S){const T=(s+d)/2,k=(l+A)/2,G=new W(T,k);b(G),function(V,K,$,re,ge,Me){const He=$-ge,Te=re-Me;return Math.abs((re-K)*He-($-V)*Te)/Math.hypot(He,Te)}(G.x,G.y,_.x,_.y,x.x,x.y)>=S?(II(a,s,l,T,k,_,G,b,S),II(a,T,k,d,A,G,x,b,S)):a.push(x)}function B2(a,s,l){let d=a[0],A=d.x,_=d.y;s(d);const x=[d];for(let b=1;b<a.length;b++){const S=a[b],{x:T,y:k}=S;s(S),II(x,A,_,T,k,d,S,s,l),A=T,_=k,d=S}return x}function CI(a,s,l,d){if(d(s,l)){const A=s.add(l)._mult(.5);CI(a,s,A,d),CI(a,A,l,d)}else a.push(l)}function n5(a,s){let l=a[0];const d=[l];for(let A=1;A<a.length;A++){const _=a[A];CI(d,l,_,s),l=_}return d}const EI=Math.pow(2,14)-1,S2=-EI-1;function r5(a,s){const l=Math.round(a.x*s),d=Math.round(a.y*s);return a.x=ye(l,S2,EI),a.y=ye(d,S2,EI),(l<a.x||l>a.x+1||d<a.y||d>a.y+1)&&nt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Zl(a,s,l){const d=a.loadGeometry(),A=a.extent,_=Mi/A;if(s&&l&&l.projection.isReprojectedInTileSpace){const x=1<<s.z,{scale:b,x:S,y:T,projection:k}=l,G=V=>{const K=wo((s.x+V.x/A)/x),$=os((s.y+V.y/A)/x),re=k.project(K,$);V.x=(re.x*b-S)*A,V.y=(re.y*b-T)*A};for(let V=0;V<d.length;V++)if(a.type!==1)d[V]=B2(d[V],G,1);else{const K=[];for(const $ of d[V])$.x<0||$.x>=A||$.y<0||$.y>=A||(G($),K.push($));d[V]=K}}for(const x of d)for(const b of x)r5(b,_);return d}function Kh(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?Zl(a):[]}}function py(a,s,l,d,A){a.emplaceBack(2*s+(d+1)/2,2*l+(A+1)/2)}function Ay(a,s,l){a.emplaceBack(s.x,s.y,s.z,l[0]*16384,l[1]*16384,l[2]*16384)}class wI{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Zt,this.indexArray=new wi,this.segments=new gr,this.programConfigurations=new Hh(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d,A){const _=this.layers[0],x=[];let b=null;_.type==="circle"&&(b=_.layout.get("circle-sort-key"));for(const{feature:T,id:k,index:G,sourceLayerIndex:V}of s){const K=this.layers[0]._featureFilter.needGeometry,$=Kh(T,K);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),$,d))continue;const re=b?b.evaluate($,{},d):void 0,ge={id:k,properties:T.properties,type:T.type,sourceLayerIndex:V,index:G,geometry:K?$.geometry:Zl(T,d,A),patterns:{},sortKey:re};x.push(ge)}b&&x.sort((T,k)=>T.sortKey-k.sortKey);let S=null;A.projection.name==="globe"&&(this.globeExtVertexArray=new ei,S=A.projection);for(const T of x){const{geometry:k,index:G,sourceLayerIndex:V}=T,K=s[G].feature;this.addFeature(T,k,G,l.availableImages,d,S),l.featureIndex.insert(K,k,G,V,this.index)}}update(s,l,d,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,VF.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,WF.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,l,d,A,_,x){for(const b of l)for(const S of b){const T=S.x,k=S.y;if(T<0||T>=Mi||k<0||k>=Mi)continue;if(x){const K=x.projectTilePoint(T,k,_),$=x.upVector(_,T,k),re=this.globeExtVertexArray;Ay(re,K,$),Ay(re,K,$),Ay(re,K,$),Ay(re,K,$)}const G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),V=G.vertexLength;py(this.layoutVertexArray,T,k,-1,-1),py(this.layoutVertexArray,T,k,1,-1),py(this.layoutVertexArray,T,k,1,1),py(this.layoutVertexArray,T,k,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+2,V+3),G.vertexLength+=4,G.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},A,_)}}function M2(a,s){for(let l=0;l<a.length;l++)if(Jh(s,a[l]))return!0;for(let l=0;l<s.length;l++)if(Jh(a,s[l]))return!0;return!!bI(a,s)}function s5(a,s,l){return!!Jh(a,s)||!!BI(s,a,l)}function T2(a,s){if(a.length===1)return Q2(s,a[0]);for(let l=0;l<s.length;l++){const d=s[l];for(let A=0;A<d.length;A++)if(Jh(a,d[A]))return!0}for(let l=0;l<a.length;l++)if(Q2(s,a[l]))return!0;for(let l=0;l<s.length;l++)if(bI(a,s[l]))return!0;return!1}function o5(a,s,l){if(a.length>1){if(bI(a,s))return!0;for(let d=0;d<s.length;d++)if(BI(s[d],a,l))return!0}for(let d=0;d<a.length;d++)if(BI(a[d],s,l))return!0;return!1}function bI(a,s){if(a.length===0||s.length===0)return!1;for(let l=0;l<a.length-1;l++){const d=a[l],A=a[l+1];for(let _=0;_<s.length-1;_++)if(a5(d,A,s[_],s[_+1]))return!0}return!1}function a5(a,s,l,d){return ut(a,l,d)!==ut(s,l,d)&&ut(a,s,l)!==ut(a,s,d)}function BI(a,s,l){const d=l*l;if(s.length===1)return a.distSqr(s[0])<d;for(let A=1;A<s.length;A++)if(D2(a,s[A-1],s[A])<d)return!0;return!1}function D2(a,s,l){const d=s.distSqr(l);if(d===0)return a.distSqr(s);const A=((a.x-s.x)*(l.x-s.x)+(a.y-s.y)*(l.y-s.y))/d;return a.distSqr(A<0?s:A>1?l:l.sub(s)._mult(A)._add(s))}function Q2(a,s){let l,d,A,_=!1;for(let x=0;x<a.length;x++){l=a[x];for(let b=0,S=l.length-1;b<l.length;S=b++)d=l[b],A=l[S],d.y>s.y!=A.y>s.y&&s.x<(A.x-d.x)*(s.y-d.y)/(A.y-d.y)+d.x&&(_=!_)}return _}function Jh(a,s){let l=!1;for(let d=0,A=a.length-1;d<a.length;A=d++){const _=a[d],x=a[A];_.y>s.y!=x.y>s.y&&s.x<(x.x-_.x)*(s.y-_.y)/(x.y-_.y)+_.x&&(l=!l)}return l}function R2(a,s,l,d,A){for(const x of a)if(s<=x.x&&l<=x.y&&d>=x.x&&A>=x.y)return!0;const _=[new W(s,l),new W(s,A),new W(d,A),new W(d,l)];if(a.length>2){for(const x of _)if(Jh(a,x))return!0}for(let x=0;x<a.length-1;x++)if(l5(a[x],a[x+1],_))return!0;return!1}function l5(a,s,l){const d=l[0],A=l[2];if(a.x<d.x&&s.x<d.x||a.x>A.x&&s.x>A.x||a.y<d.y&&s.y<d.y||a.y>A.y&&s.y>A.y)return!1;const _=ut(a,s,l[0]);return _!==ut(a,s,l[1])||_!==ut(a,s,l[2])||_!==ut(a,s,l[3])}function jf(a,s,l){const d=s.paint.get(a).value;return d.kind==="constant"?d.value:l.programConfigurations.get(s.id).getMaxValue(a)}function gy(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function L2(a,s,l,d,A){if(!s[0]&&!s[1])return a;const _=W.convert(s)._mult(A);l==="viewport"&&_._rotate(-d);const x=[];for(let b=0;b<a.length;b++)x.push(a[b].sub(_));return x}function P2(a,s,l,d){const A=W.convert(a)._mult(d);return s==="viewport"&&A._rotate(-l),A}vi(wI,"CircleBucket",{omit:["layers"]});const c5=new ke({"circle-sort-key":new ve(Mt.layout_circle["circle-sort-key"])});var u5={paint:new ke({"circle-radius":new ve(Mt.paint_circle["circle-radius"]),"circle-color":new ve(Mt.paint_circle["circle-color"]),"circle-blur":new ve(Mt.paint_circle["circle-blur"]),"circle-opacity":new ve(Mt.paint_circle["circle-opacity"]),"circle-translate":new ne(Mt.paint_circle["circle-translate"]),"circle-translate-anchor":new ne(Mt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ne(Mt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ne(Mt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ve(Mt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ve(Mt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ve(Mt.paint_circle["circle-stroke-opacity"])}),layout:c5};function k2(a,s,l,d,A,_,x,b,S){if(_&&a.queryGeometry.isAboveHorizon)return!1;_&&(S*=a.pixelToTileUnitsFactor);const T=a.tileID.canonical,k=l.projection.upVectorScale(T,l.center.lat,l.worldSize).metersToTile;for(const G of s)for(const V of G){const K=V.add(b),$=A&&l.elevation?l.elevation.exaggeration()*A.getElevationAt(K.x,K.y,!0):0,re=l.projection.projectTilePoint(K.x,K.y,T);if($>0){const Te=l.projection.upVector(T,K.x,K.y);re.x+=Te[0]*k*$,re.y+=Te[1]*k*$,re.z+=Te[2]*k*$}const ge=_?K:h5(re.x,re.y,re.z,d),Me=_?a.tilespaceRays.map(Te=>f5(Te,$)):a.queryGeometry.screenGeometry,He=Yh([],[re.x,re.y,re.z,1],d);if(!x&&_?S*=He[3]/l.cameraToCenterDistance:x&&!_&&(S*=l.cameraToCenterDistance/He[3]),_){const Te=os((V.y/Mi+T.y)/(1<<T.z));S/=l.projection.pixelsPerMeter(Te,1)/Pa(1,Te)}if(s5(Me,ge,S))return!0}return!1}function h5(a,s,l,d){const A=Yh([],[a,s,l,1],d);return new W(A[0]/A[3],A[1]/A[3])}const F2=Gf(0,0,0),d5=Gf(0,0,1);function f5(a,s){const l=uI();return F2[2]=s,a.intersectsPlane(F2,d5,l),new W(l[0],l[1])}class N2 extends wI{}function z2(a,{width:s,height:l},d,A){if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==s*l*d)throw new RangeError("mismatched image size")}else A=new Uint8Array(s*l*d);return a.width=s,a.height=l,a.data=A,a}function U2(a,s,l){const{width:d,height:A}=s;d===a.width&&A===a.height||(SI(a,s,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,A)},l),a.width=d,a.height=A,a.data=s.data)}function SI(a,s,l,d,A,_){if(A.width===0||A.height===0)return s;if(A.width>a.width||A.height>a.height||l.x>a.width-A.width||l.y>a.height-A.height)throw new RangeError("out of range source coordinates for image copy");if(A.width>s.width||A.height>s.height||d.x>s.width-A.width||d.y>s.height-A.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,b=s.data;for(let S=0;S<A.height;S++){const T=((l.y+S)*a.width+l.x)*_,k=((d.y+S)*s.width+d.x)*_;for(let G=0;G<A.width*_;G++)b[k+G]=x[T+G]}return s}vi(N2,"HeatmapBucket",{omit:["layers"]});class $l{constructor(s,l){z2(this,s,1,l)}resize(s){U2(this,new $l(s),1)}clone(){return new $l({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,d,A,_){SI(s,l,d,A,_,1)}}class so{constructor(s,l){z2(this,s,4,l)}resize(s){U2(this,new so(s),4)}replace(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new so({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,d,A,_){SI(s,l,d,A,_,4)}}vi($l,"AlphaImage"),vi(so,"RGBAImage");var p5={paint:new ke({"heatmap-radius":new ve(Mt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ve(Mt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ne(Mt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pe(Mt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ne(Mt.paint_heatmap["heatmap-opacity"])})};function MI(a){const s={},l=a.resolution||256,d=a.clips?a.clips.length:1,A=a.image||new so({width:l,height:d}),_=(x,b,S)=>{s[a.evaluationKey]=S;const T=a.expression.evaluate(s);A.data[x+b+0]=Math.floor(255*T.r/T.a),A.data[x+b+1]=Math.floor(255*T.g/T.a),A.data[x+b+2]=Math.floor(255*T.b/T.a),A.data[x+b+3]=Math.floor(255*T.a)};if(a.clips)for(let x=0,b=0;x<d;++x,b+=4*l)for(let S=0,T=0;S<l;S++,T+=4){const k=S/(l-1),{start:G,end:V}=a.clips[x];_(b,T,G*(1-k)+V*k)}else for(let x=0,b=0;x<l;x++,b+=4)_(0,b,x/(l-1));return A}var A5={paint:new ke({"hillshade-illumination-direction":new ne(Mt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ne(Mt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ne(Mt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ne(Mt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ne(Mt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ne(Mt.paint_hillshade["hillshade-accent-color"])})};const g5=lt([{name:"a_pos",components:2,type:"Int16"}],4),{members:m5}=g5;var TI={exports:{}};function my(a,s,l){l=l||2;var d,A,_,x,b,S,T,k=s&&s.length,G=k?s[0]*l:a.length,V=O2(a,0,G,l,!0),K=[];if(!V||V.next===V.prev)return K;if(k&&(V=function(re,ge,Me,He){var Te,Ge,qe,We=[];for(Te=0,Ge=ge.length;Te<Ge;Te++)(qe=O2(re,ge[Te]*He,Te<Ge-1?ge[Te+1]*He:re.length,He,!1))===qe.next&&(qe.steiner=!0),We.push(w5(qe));for(We.sort(I5),Te=0;Te<We.length;Te++)Me=C5(We[Te],Me);return Me}(a,s,V,l)),a.length>80*l){d=_=a[0],A=x=a[1];for(var $=l;$<G;$+=l)(b=a[$])<d&&(d=b),(S=a[$+1])<A&&(A=S),b>_&&(_=b),S>x&&(x=S);T=(T=Math.max(_-d,x-A))!==0?32767/T:0}return $g(V,K,l,d,A,T,0),K}function O2(a,s,l,d,A){var _,x;if(A===RI(a,s,l,d)>0)for(_=s;_<l;_+=d)x=V2(_,a[_],a[_+1],x);else for(_=l-d;_>=s;_-=d)x=V2(_,a[_],a[_+1],x);return x&&_y(x,x.next)&&(tm(x),x=x.next),x}function Xh(a,s){if(!a)return a;s||(s=a);var l,d=a;do if(l=!1,d.steiner||!_y(d,d.next)&&mr(d.prev,d,d.next)!==0)d=d.next;else{if(tm(d),(d=s=d.prev)===d.next)break;l=!0}while(l||d!==s);return s}function $g(a,s,l,d,A,_,x){if(a){!x&&_&&function(k,G,V,K){var $=k;do $.z===0&&($.z=DI($.x,$.y,G,V,K)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==k);$.prevZ.nextZ=null,$.prevZ=null,function(re){var ge,Me,He,Te,Ge,qe,We,It,gt=1;do{for(Me=re,re=null,Ge=null,qe=0;Me;){for(qe++,He=Me,We=0,ge=0;ge<gt&&(We++,He=He.nextZ);ge++);for(It=gt;We>0||It>0&&He;)We!==0&&(It===0||!He||Me.z<=He.z)?(Te=Me,Me=Me.nextZ,We--):(Te=He,He=He.nextZ,It--),Ge?Ge.nextZ=Te:re=Te,Te.prevZ=Ge,Ge=Te;Me=He}Ge.nextZ=null,gt*=2}while(qe>1)}($)}(a,d,A,_);for(var b,S,T=a;a.prev!==a.next;)if(b=a.prev,S=a.next,_?y5(a,d,A,_):_5(a))s.push(b.i/l|0),s.push(a.i/l|0),s.push(S.i/l|0),tm(a),a=S.next,T=S.next;else if((a=S)===T){x?x===1?$g(a=v5(Xh(a),s,l),s,l,d,A,_,2):x===2&&x5(a,s,l,d,A,_):$g(Xh(a),s,l,d,A,_,1);break}}}function _5(a){var s=a.prev,l=a,d=a.next;if(mr(s,l,d)>=0)return!1;for(var A=s.x,_=l.x,x=d.x,b=s.y,S=l.y,T=d.y,k=A<_?A<x?A:x:_<x?_:x,G=b<S?b<T?b:T:S<T?S:T,V=A>_?A>x?A:x:_>x?_:x,K=b>S?b>T?b:T:S>T?S:T,$=d.next;$!==s;){if($.x>=k&&$.x<=V&&$.y>=G&&$.y<=K&&qf(A,b,_,S,x,T,$.x,$.y)&&mr($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function y5(a,s,l,d){var A=a.prev,_=a,x=a.next;if(mr(A,_,x)>=0)return!1;for(var b=A.x,S=_.x,T=x.x,k=A.y,G=_.y,V=x.y,K=b<S?b<T?b:T:S<T?S:T,$=k<G?k<V?k:V:G<V?G:V,re=b>S?b>T?b:T:S>T?S:T,ge=k>G?k>V?k:V:G>V?G:V,Me=DI(K,$,s,l,d),He=DI(re,ge,s,l,d),Te=a.prevZ,Ge=a.nextZ;Te&&Te.z>=Me&&Ge&&Ge.z<=He;){if(Te.x>=K&&Te.x<=re&&Te.y>=$&&Te.y<=ge&&Te!==A&&Te!==x&&qf(b,k,S,G,T,V,Te.x,Te.y)&&mr(Te.prev,Te,Te.next)>=0||(Te=Te.prevZ,Ge.x>=K&&Ge.x<=re&&Ge.y>=$&&Ge.y<=ge&&Ge!==A&&Ge!==x&&qf(b,k,S,G,T,V,Ge.x,Ge.y)&&mr(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;Te&&Te.z>=Me;){if(Te.x>=K&&Te.x<=re&&Te.y>=$&&Te.y<=ge&&Te!==A&&Te!==x&&qf(b,k,S,G,T,V,Te.x,Te.y)&&mr(Te.prev,Te,Te.next)>=0)return!1;Te=Te.prevZ}for(;Ge&&Ge.z<=He;){if(Ge.x>=K&&Ge.x<=re&&Ge.y>=$&&Ge.y<=ge&&Ge!==A&&Ge!==x&&qf(b,k,S,G,T,V,Ge.x,Ge.y)&&mr(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function v5(a,s,l){var d=a;do{var A=d.prev,_=d.next.next;!_y(A,_)&&G2(A,d,d.next,_)&&em(A,_)&&em(_,A)&&(s.push(A.i/l|0),s.push(d.i/l|0),s.push(_.i/l|0),tm(d),tm(d.next),d=a=_),d=d.next}while(d!==a);return Xh(d)}function x5(a,s,l,d,A,_){var x=a;do{for(var b=x.next.next;b!==x.prev;){if(x.i!==b.i&&b5(x,b)){var S=H2(x,b);return x=Xh(x,x.next),S=Xh(S,S.next),$g(x,s,l,d,A,_,0),void $g(S,s,l,d,A,_,0)}b=b.next}x=x.next}while(x!==a)}function I5(a,s){return a.x-s.x}function C5(a,s){var l=function(A,_){var x,b=_,S=A.x,T=A.y,k=-1/0;do{if(T<=b.y&&T>=b.next.y&&b.next.y!==b.y){var G=b.x+(T-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(G<=S&&G>k&&(k=G,x=b.x<b.next.x?b:b.next,G===S))return x}b=b.next}while(b!==_);if(!x)return null;var V,K=x,$=x.x,re=x.y,ge=1/0;b=x;do S>=b.x&&b.x>=$&&S!==b.x&&qf(T<re?S:k,T,$,re,T<re?k:S,T,b.x,b.y)&&(V=Math.abs(T-b.y)/(S-b.x),em(b,A)&&(V<ge||V===ge&&(b.x>x.x||b.x===x.x&&E5(x,b)))&&(x=b,ge=V)),b=b.next;while(b!==K);return x}(a,s);if(!l)return s;var d=H2(l,a);return Xh(d,d.next),Xh(l,l.next)}function E5(a,s){return mr(a.prev,a,s.prev)<0&&mr(s.next,a,a.next)<0}function DI(a,s,l,d,A){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*A|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*A|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function w5(a){var s=a,l=a;do(s.x<l.x||s.x===l.x&&s.y<l.y)&&(l=s),s=s.next;while(s!==a);return l}function qf(a,s,l,d,A,_,x,b){return(A-x)*(s-b)>=(a-x)*(_-b)&&(a-x)*(d-b)>=(l-x)*(s-b)&&(l-x)*(_-b)>=(A-x)*(d-b)}function b5(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(l,d){var A=l;do{if(A.i!==l.i&&A.next.i!==l.i&&A.i!==d.i&&A.next.i!==d.i&&G2(A,A.next,l,d))return!0;A=A.next}while(A!==l);return!1}(a,s)&&(em(a,s)&&em(s,a)&&function(l,d){var A=l,_=!1,x=(l.x+d.x)/2,b=(l.y+d.y)/2;do A.y>b!=A.next.y>b&&A.next.y!==A.y&&x<(A.next.x-A.x)*(b-A.y)/(A.next.y-A.y)+A.x&&(_=!_),A=A.next;while(A!==l);return _}(a,s)&&(mr(a.prev,a,s.prev)||mr(a,s.prev,s))||_y(a,s)&&mr(a.prev,a,a.next)>0&&mr(s.prev,s,s.next)>0)}function mr(a,s,l){return(s.y-a.y)*(l.x-s.x)-(s.x-a.x)*(l.y-s.y)}function _y(a,s){return a.x===s.x&&a.y===s.y}function G2(a,s,l,d){var A=vy(mr(a,s,l)),_=vy(mr(a,s,d)),x=vy(mr(l,d,a)),b=vy(mr(l,d,s));return A!==_&&x!==b||!(A!==0||!yy(a,l,s))||!(_!==0||!yy(a,d,s))||!(x!==0||!yy(l,a,d))||!(b!==0||!yy(l,s,d))}function yy(a,s,l){return s.x<=Math.max(a.x,l.x)&&s.x>=Math.min(a.x,l.x)&&s.y<=Math.max(a.y,l.y)&&s.y>=Math.min(a.y,l.y)}function vy(a){return a>0?1:a<0?-1:0}function em(a,s){return mr(a.prev,a,a.next)<0?mr(a,s,a.next)>=0&&mr(a,a.prev,s)>=0:mr(a,s,a.prev)<0||mr(a,a.next,s)<0}function H2(a,s){var l=new QI(a.i,a.x,a.y),d=new QI(s.i,s.x,s.y),A=a.next,_=s.prev;return a.next=s,s.prev=a,l.next=A,A.prev=l,d.next=l,l.prev=d,_.next=d,d.prev=_,d}function V2(a,s,l,d){var A=new QI(a,s,l);return d?(A.next=d.next,A.prev=d,d.next.prev=A,d.next=A):(A.prev=A,A.next=A),A}function tm(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function QI(a,s,l){this.i=a,this.x=s,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RI(a,s,l,d){for(var A=0,_=s,x=l-d;_<l;_+=d)A+=(a[x]-a[_])*(a[_+1]+a[x+1]),x=_;return A}TI.exports=my,TI.exports.default=my,my.deviation=function(a,s,l,d){var A=s&&s.length,_=Math.abs(RI(a,0,A?s[0]*l:a.length,l));if(A)for(var x=0,b=s.length;x<b;x++)_-=Math.abs(RI(a,s[x]*l,x<b-1?s[x+1]*l:a.length,l));var S=0;for(x=0;x<d.length;x+=3){var T=d[x]*l,k=d[x+1]*l,G=d[x+2]*l;S+=Math.abs((a[T]-a[G])*(a[k+1]-a[T+1])-(a[T]-a[k])*(a[G+1]-a[T+1]))}return _===0&&S===0?0:Math.abs((S-_)/_)},my.flatten=function(a){for(var s=a[0][0].length,l={vertices:[],holes:[],dimensions:s},d=0,A=0;A<a.length;A++){for(var _=0;_<a[A].length;_++)for(var x=0;x<s;x++)l.vertices.push(a[A][_][x]);A>0&&l.holes.push(d+=a[A-1].length)}return l};var LI=F(TI.exports);function B5(a,s,l,d,A){W2(a,s,l||0,d||a.length-1,A||S5)}function W2(a,s,l,d,A){for(;d>l;){if(d-l>600){var _=d-l+1,x=s-l+1,b=Math.log(_),S=.5*Math.exp(2*b/3),T=.5*Math.sqrt(b*S*(_-S)/_)*(x-_/2<0?-1:1);W2(a,s,Math.max(l,Math.floor(s-x*S/_+T)),Math.min(d,Math.floor(s+(_-x)*S/_+T)),A)}var k=a[s],G=l,V=d;for(im(a,l,s),A(a[d],k)>0&&im(a,l,d);G<V;){for(im(a,G,V),G++,V--;A(a[G],k)<0;)G++;for(;A(a[V],k)>0;)V--}A(a[l],k)===0?im(a,l,V):im(a,++V,d),V<=s&&(l=V+1),s<=V&&(d=V-1)}}function im(a,s,l){var d=a[s];a[s]=a[l],a[l]=d}function S5(a,s){return a<s?-1:a>s?1:0}function PI(a,s){const l=a.length;if(l<=1)return[a];const d=[];let A,_;for(let x=0;x<l;x++){const b=ze(a[x]);b!==0&&(a[x].area=Math.abs(b),_===void 0&&(_=b<0),_===b<0?(A&&d.push(A),A=[a[x]]):A.push(a[x]))}if(A&&d.push(A),s>1)for(let x=0;x<d.length;x++)d[x].length<=s||(B5(d[x],s,1,d[x].length-1,M5),d[x]=d[x].slice(0,s));return d}function M5(a,s){return s.area-a.area}function kI(a,s,l){const d=l.patternDependencies;let A=!1;for(const _ of s){const x=_.paint.get(`${a}-pattern`);x.isConstant()||(A=!0);const b=x.constantOr(null);b&&(A=!0,d[b]=!0)}return A}function FI(a,s,l,d,A){const _=A.patternDependencies;for(const x of s){const b=x.paint.get(`${a}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:d},l,{},A.availableImages);S=S&&S.name?S.name:S,_[S]=!0,l.patterns[x.id]=S}}return l}class xy{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Zt,this.indexArray=new wi,this.indexArray2=new Fr,this.programConfigurations=new Hh(s.layers,s.zoom),this.segments=new gr,this.segments2=new gr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=s.projection}populate(s,l,d,A){this.hasPattern=kI("fill",this.layers,l);const _=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:b,id:S,index:T,sourceLayerIndex:k}of s){const G=this.layers[0]._featureFilter.needGeometry,V=Kh(b,G);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),V,d))continue;const K=_?_.evaluate(V,{},d,l.availableImages):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:k,index:T,geometry:G?V.geometry:Zl(b,d,A),patterns:{},sortKey:K};x.push($)}_&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:T,sourceLayerIndex:k}=b;if(this.hasPattern){const G=FI("fill",this.layers,b,this.zoom,l);this.patternFeatures.push(G)}else this.addFeature(b,S,T,d,{},l.availableImages);l.featureIndex.insert(s[T].feature,S,T,k,this.index)}}update(s,l,d,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d,A)}addFeatures(s,l,d,A,_){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,d,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,m5),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,l,d,A,_,x=[]){for(const b of PI(l,500)){let S=0;for(const $ of b)S+=$.length;const T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),k=T.vertexLength,G=[],V=[];for(const $ of b){if($.length===0)continue;$!==b[0]&&V.push(G.length/2);const re=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),ge=re.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(ge+$.length-1,ge),G.push($[0].x),G.push($[0].y);for(let Me=1;Me<$.length;Me++)this.layoutVertexArray.emplaceBack($[Me].x,$[Me].y),this.indexArray2.emplaceBack(ge+Me-1,ge+Me),G.push($[Me].x),G.push($[Me].y);re.vertexLength+=$.length,re.primitiveLength+=$.length}const K=LI(G,V);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(k+K[$],k+K[$+1],k+K[$+2]);T.vertexLength+=S,T.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,x,A)}}vi(xy,"FillBucket",{omit:["layers","patternFeatures"]});const T5=new ke({"fill-sort-key":new ve(Mt.layout_fill["fill-sort-key"])});var D5={paint:new ke({"fill-antialias":new ne(Mt.paint_fill["fill-antialias"]),"fill-opacity":new ve(Mt.paint_fill["fill-opacity"]),"fill-color":new ve(Mt.paint_fill["fill-color"]),"fill-outline-color":new ve(Mt.paint_fill["fill-outline-color"]),"fill-translate":new ne(Mt.paint_fill["fill-translate"]),"fill-translate-anchor":new ne(Mt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ve(Mt.paint_fill["fill-pattern"])}),layout:T5};const Q5=lt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),R5=lt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),L5=lt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:P5}=Q5;var Iy={},k5=q,Y2=Kf;function Kf(a,s,l,d,A){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=A,a.readFields(F5,this,s)}function F5(a,s,l){a==1?s.id=l.readVarint():a==2?function(d,A){for(var _=d.readVarint()+d.pos;d.pos<_;){var x=A._keys[d.readVarint()],b=A._values[d.readVarint()];A.properties[x]=b}}(l,s):a==3?s.type=l.readVarint():a==4&&(s._geometry=l.pos)}function N5(a){for(var s,l,d=0,A=0,_=a.length,x=_-1;A<_;x=A++)d+=((l=a[x]).x-(s=a[A]).x)*(s.y+l.y);return d}Kf.types=["Unknown","Point","LineString","Polygon"],Kf.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,l=a.readVarint()+a.pos,d=1,A=0,_=0,x=0,b=[];a.pos<l;){if(A<=0){var S=a.readVarint();d=7&S,A=S>>3}if(A--,d===1||d===2)_+=a.readSVarint(),x+=a.readSVarint(),d===1&&(s&&b.push(s),s=[]),s.push(new k5(_,x));else{if(d!==7)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&b.push(s),b},Kf.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,l=1,d=0,A=0,_=0,x=1/0,b=-1/0,S=1/0,T=-1/0;a.pos<s;){if(d<=0){var k=a.readVarint();l=7&k,d=k>>3}if(d--,l===1||l===2)(A+=a.readSVarint())<x&&(x=A),A>b&&(b=A),(_+=a.readSVarint())<S&&(S=_),_>T&&(T=_);else if(l!==7)throw new Error("unknown command "+l)}return[x,S,b,T]},Kf.prototype.toGeoJSON=function(a,s,l){var d,A,_=this.extent*Math.pow(2,l),x=this.extent*a,b=this.extent*s,S=this.loadGeometry(),T=Kf.types[this.type];function k(K){for(var $=0;$<K.length;$++){var re=K[$];K[$]=[360*(re.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(re.y+b)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(d=0;d<S.length;d++)G[d]=S[d][0];k(S=G);break;case 2:for(d=0;d<S.length;d++)k(S[d]);break;case 3:for(S=function(K){var $=K.length;if($<=1)return[K];for(var re,ge,Me=[],He=0;He<$;He++){var Te=N5(K[He]);Te!==0&&(ge===void 0&&(ge=Te<0),ge===Te<0?(re&&Me.push(re),re=[K[He]]):re.push(K[He]))}return re&&Me.push(re),Me}(S),d=0;d<S.length;d++)for(A=0;A<S[d].length;A++)k(S[d][A])}S.length===1?S=S[0]:T="Multi"+T;var V={type:"Feature",geometry:{type:T,coordinates:S},properties:this.properties};return"id"in this&&(V.id=this.id),V};var z5=Y2,j2=q2;function q2(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(U5,this,s),this.length=this._features.length}function U5(a,s,l){a===15?s.version=l.readVarint():a===1?s.name=l.readString():a===5?s.extent=l.readVarint():a===2?s._features.push(l.pos):a===3?s._keys.push(l.readString()):a===4&&s._values.push(function(d){for(var A=null,_=d.readVarint()+d.pos;d.pos<_;){var x=d.readVarint()>>3;A=x===1?d.readString():x===2?d.readFloat():x===3?d.readDouble():x===4?d.readVarint64():x===5?d.readVarint():x===6?d.readSVarint():x===7?d.readBoolean():null}return A}(l))}q2.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new z5(this._pbf,s,this.extent,this._keys,this._values)};var O5=j2;function G5(a,s,l){if(a===3){var d=new O5(l,l.readVarint()+l.pos);d.length&&(s[d.name]=d)}}var NI=Iy.VectorTile=function(a,s){this.layers=a.readFields(G5,{},s)},Cy=Iy.VectorTileFeature=Y2;function Ey(a,s,l,d){const A=[],_=d===0?(x,b,S,T,k,G)=>{x.push(new W(G,S+(G-b)/(T-b)*(k-S)))}:(x,b,S,T,k,G)=>{x.push(new W(b+(G-S)/(k-S)*(T-b),G))};for(const x of a){const b=[];for(const S of x){if(S.length<=2)continue;const T=[];for(let V=0;V<S.length-1;V++){const K=S[V].x,$=S[V].y,re=S[V+1].x,ge=S[V+1].y,Me=d===0?K:$,He=d===0?re:ge;Me<s?He>s&&_(T,K,$,re,ge,s):Me>l?He<l&&_(T,K,$,re,ge,l):T.push(S[V]),He<s&&Me>=s&&_(T,K,$,re,ge,s),He>l&&Me<=l&&_(T,K,$,re,ge,l)}let k=S[S.length-1];const G=d===0?k.x:k.y;G>=s&&G<=l&&T.push(k),T.length&&(k=T[T.length-1],T[0].x===k.x&&T[0].y===k.y||T.push(T[0]),b.push(T))}b.length&&A.push(b)}return A}Iy.VectorTileLayer=j2;const H5=Cy.types,V5=Math.pow(2,13);function nm(a,s,l,d,A,_,x,b){a.emplaceBack((s<<1)+x,(l<<1)+_,(Math.floor(d*V5)<<1)+A,Math.round(b))}function rm(a,s,l){a.emplaceBack(s.x,s.y,s.z,l[0]*16384,l[1]*16384,l[2]*16384)}class K2{constructor(){this.acc=new W(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new W(s.x,s.y),this.max=new W(s.x,s.y))}append(s,l){this.currentPolyCount.edges++,this.acc._add(s);const d=this.min,A=this.max;s.x<d.x?d.x=s.x:s.x>A.x&&(A.x=s.x),s.y<d.y?d.y=s.y:s.y>A.y&&(A.y=s.y),((s.x===0||s.x===Mi)&&s.x===l.x)!=((s.y===0||s.y===Mi)&&s.y===l.y)&&this.processBorderOverlap(s,l),l.x<0!=s.x<0&&this.addBorderIntersection(0,an(l.y,s.y,(0-l.x)/(s.x-l.x))),l.x>Mi!=s.x>Mi&&this.addBorderIntersection(1,an(l.y,s.y,(Mi-l.x)/(s.x-l.x))),l.y<0!=s.y<0&&this.addBorderIntersection(2,an(l.x,s.x,(0-l.y)/(s.y-l.y))),l.y>Mi!=s.y>Mi&&this.addBorderIntersection(3,an(l.x,s.x,(Mi-l.y)/(s.y-l.y)))}addBorderIntersection(s,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[s];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(s,l){if(s.x===l.x){if(s.y===l.y)return;const d=s.x===0?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,s.y)}else{const d=s.y===0?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,s.x)}}centroid(){const s=this.polyCount.reduce((l,d)=>l+d.edges,0);return s!==0?this.acc.div(s)._round():new W(0,0)}span(){return new W(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,l)=>s+ +(l[0]!==Number.MAX_VALUE),0)}}class sm{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new zt,this.centroidVertexArray=new Ta,this.indexArray=new wi,this.programConfigurations=new Hh(s.layers,s.zoom),this.segments=new gr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=s.enableTerrain}populate(s,l,d,A){this.features=[],this.hasPattern=kI("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const x=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*x/(x*x+1)/Mi/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:x,index:b,sourceLayerIndex:S}of s){const T=this.layers[0]._featureFilter.needGeometry,k=Kh(_,T);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),k,d))continue;const G={id:x,sourceLayerIndex:S,index:b,geometry:T?k.geometry:Zl(_,d,A),properties:_.properties,type:_.type,patterns:{}},V=this.layoutVertexArray.length;this.hasPattern?this.features.push(FI("fill-extrusion",this.layers,G,this.zoom,l)):this.addFeature(G,G.geometry,b,d,{},l.availableImages,A),l.featureIndex.insert(_,G.geometry,b,S,this.index,V)}this.sortBorders()}addFeatures(s,l,d,A,_){for(const x of this.features){const{geometry:b}=x;this.addFeature(x,b,x.index,l,d,A,_)}this.sortBorders()}update(s,l,d,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,P5),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,L5.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,R5.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,l,d,A,_,x,b){const S=[new W(0,0),new W(Mi,Mi)],T=b.projection,k=T.name==="globe",G=this.enableTerrain&&!k?new K2:null,V=H5[s.type]==="Polygon";k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ei);const K=PI(l,500);for(let Me=K.length-1;Me>=0;Me--){const He=K[Me];(He.length===0||($=He[0]).every(Te=>Te.x<=0)||$.every(Te=>Te.x>=Mi)||$.every(Te=>Te.y<=0)||$.every(Te=>Te.y>=Mi))&&K.splice(Me,1)}var $;let re;if(k)re=iS(K,S,A);else{re=[];for(const Me of K)re.push({polygon:Me,bounds:S})}const ge=V?this.edgeRadius:0;for(const{polygon:Me,bounds:He}of re){let Te=0,Ge=0;for(const We of Me)V&&!We[0].equals(We[We.length-1])&&We.push(We[0]),Ge+=V?We.length-1:We.length;const qe=this.segments.prepareSegment((V?5:4)*Ge,this.layoutVertexArray,this.indexArray);if(V){const We=[],It=[];Te=qe.vertexLength;for(const Lt of Me){let $t,Bt;Lt.length&&Lt!==Me[0]&&It.push(We.length/2),$t=Lt[1].sub(Lt[0])._perp()._unit();for(let Ht=1;Ht<Lt.length;Ht++){const Vt=Lt[Ht],Kt=Lt[Ht===Lt.length-1?1:Ht+1];let{x:ii,y:Rt}=Vt;if(ge){Bt=Kt.sub(Vt)._perp()._unit();const hi=$t.add(Bt)._unit(),Ci=ge*Math.min(4,1/($t.x*hi.x+$t.y*hi.y));ii+=Ci*hi.x,Rt+=Ci*hi.y,$t=Bt}nm(this.layoutVertexArray,ii,Rt,0,0,1,1,0),qe.vertexLength++,We.push(Vt.x,Vt.y),k&&rm(this.layoutVertexExtArray,T.projectTilePoint(ii,Rt,A),T.upVector(A,ii,Rt))}}const gt=LI(We,It);for(let Lt=0;Lt<gt.length;Lt+=3)this.indexArray.emplaceBack(Te+gt[Lt],Te+gt[Lt+2],Te+gt[Lt+1]),qe.primitiveLength++}for(const We of Me){G&&We.length&&G.startRing(We[0]);let It,gt,Lt,$t=We.length>4&&$2(We[We.length-2],We[0],We[1]),Bt=ge?W5(We[We.length-2],We[0],We[1],ge):0;gt=We[1].sub(We[0])._perp()._unit();let Ht=!0;for(let Vt=1,Kt=0;Vt<We.length;Vt++){let ii=We[Vt-1],Rt=We[Vt];const hi=We[Vt===We.length-1?1:Vt+1];if(G&&V&&G.currentPolyCount.top++,Z2(Rt,ii,He)){ge&&(gt=hi.sub(Rt)._perp()._unit(),Ht=!Ht);continue}G&&G.append(Rt,ii);const Ci=Rt.sub(ii)._perp(),di=Ci.x/(Math.abs(Ci.x)+Math.abs(Ci.y)),Oi=Ci.y>0?1:0,ri=ii.dist(Rt);if(Kt+ri>32768&&(Kt=0),ge){Lt=hi.sub(Rt)._perp()._unit();let Hi=X2(ii,Rt,hi,J2(gt,Lt),ge);isNaN(Hi)&&(Hi=0);const Ri=Rt.sub(ii)._unit();ii=ii.add(Ri.mult(Bt))._round(),Rt=Rt.add(Ri.mult(-Hi))._round(),Bt=Hi,gt=Lt}const Si=qe.vertexLength,Gi=We.length>4&&$2(ii,Rt,hi);let hn=eS(Kt,$t,Ht);if(nm(this.layoutVertexArray,ii.x,ii.y,di,Oi,0,0,hn),nm(this.layoutVertexArray,ii.x,ii.y,di,Oi,0,1,hn),Kt+=ri,hn=eS(Kt,Gi,!Ht),$t=Gi,nm(this.layoutVertexArray,Rt.x,Rt.y,di,Oi,0,0,hn),nm(this.layoutVertexArray,Rt.x,Rt.y,di,Oi,0,1,hn),qe.vertexLength+=4,this.indexArray.emplaceBack(Si+0,Si+1,Si+2),this.indexArray.emplaceBack(Si+1,Si+3,Si+2),qe.primitiveLength+=2,ge){const Hi=Te+(Vt===1?We.length-2:Vt-2),Ri=Vt===1?Te:Hi+1;if(this.indexArray.emplaceBack(Si+1,Hi,Si+3),this.indexArray.emplaceBack(Hi,Ri,Si+3),qe.primitiveLength+=2,It===void 0&&(It=Si),!Z2(hi,We[Vt],He)){const On=Vt===We.length-1?It:qe.vertexLength;this.indexArray.emplaceBack(Si+2,Si+3,On),this.indexArray.emplaceBack(Si+3,On+1,On),this.indexArray.emplaceBack(Si+3,Ri,On+1),qe.primitiveLength+=3}Ht=!Ht}if(k){const Hi=this.layoutVertexExtArray,Ri=T.projectTilePoint(ii.x,ii.y,A),On=T.projectTilePoint(Rt.x,Rt.y,A),Vi=T.upVector(A,ii.x,ii.y),Wi=T.upVector(A,Rt.x,Rt.y);rm(Hi,Ri,Vi),rm(Hi,Ri,Vi),rm(Hi,On,Wi),rm(Hi,On,Wi)}}V&&(Te+=We.length-1)}}if(G&&G.polyCount.length>0){if(G.borders){G.vertexArrayOffset=this.centroidVertexArray.length;const Me=G.borders,He=this.featuresOnBorder.push(G)-1;for(let Te=0;Te<4;Te++)Me[Te][0]!==Number.MAX_VALUE&&this.borders[Te].push(He)}this.encodeCentroid(G.borders?void 0:G.centroid(),G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,x,A)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((l,d)=>this.featuresOnBorder[l].borders[s][0]-this.featuresOnBorder[d].borders[s][0])}encodeCentroid(s,l,d=!0){let A,_;if(s)if(s.y!==0){const b=l.span()._mult(this.tileToMeter);A=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(b.x/10)),_=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else A=Math.ceil(7*(s.x+450)),_=0;else A=0,_=+d;let x=d?this.centroidVertexArray.length:l.vertexArrayOffset;for(const b of l.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let S=0;S<b.top;S++)this.centroidVertexArray.emplace(x++,A,_);for(let S=0;S<2*b.edges;S++)this.centroidVertexArray.emplace(x++,0,_),this.centroidVertexArray.emplace(x++,A,_)}}}function J2(a,s){const l=a.add(s)._unit();return a.x*l.x+a.y*l.y}function W5(a,s,l,d){const A=s.sub(a)._perp()._unit(),_=l.sub(s)._perp()._unit();return X2(a,s,l,J2(A,_),d)}function X2(a,s,l,d,A){const _=Math.sqrt(1-d*d);return Math.min(a.dist(s)/3,s.dist(l)/3,A*_/d)}function Z2(a,s,l){return a.x<l[0].x&&s.x<l[0].x||a.x>l[1].x&&s.x>l[1].x||a.y<l[0].y&&s.y<l[0].y||a.y>l[1].y&&s.y>l[1].y}function $2(a,s,l){if(a.x<0||a.x>=Mi||s.x<0||s.x>=Mi||l.x<0||l.x>=Mi)return!1;const d=l.sub(s),A=d.perp(),_=a.sub(s);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&A.x*_.x+A.y*_.y<0}function eS(a,s,l){const d=s?2|a:-3&a;return l?1|d:-2&d}function tS(){const a=Math.PI/32,s=Math.tan(a),l=Zg;return l*Math.sqrt(1+2*s*s)-l}function iS(a,s,l){const d=1<<l.z,A=wo(l.x/d),_=wo((l.x+1)/d),x=os(l.y/d),b=os((l.y+1)/d);return function(S,T,k,G,V=0,K){const $=[];if(!S.length||!k||!G)return $;const re=(We,It)=>{for(const gt of We)$.push({polygon:gt,bounds:It})},ge=Math.ceil(Math.log2(k)),Me=Math.ceil(Math.log2(G)),He=ge-Me,Te=[];for(let We=0;We<Math.abs(He);We++)Te.push(He>0?0:1);for(let We=0;We<Math.min(ge,Me);We++)Te.push(0),Te.push(1);let Ge=S;if(Ge=Ey(Ge,T[0].y-V,T[1].y+V,1),Ge=Ey(Ge,T[0].x-V,T[1].x+V,0),!Ge.length)return $;const qe=[];for(Te.length?qe.push({polygons:Ge,bounds:T,depth:0}):re(Ge,T);qe.length;){const We=qe.pop(),It=We.depth,gt=Te[It],Lt=We.bounds[0],$t=We.bounds[1],Bt=gt===0?Lt.x:Lt.y,Ht=gt===0?$t.x:$t.y,Vt=K?K(gt,Bt,Ht):.5*(Bt+Ht),Kt=Ey(We.polygons,Bt-V,Vt+V,gt),ii=Ey(We.polygons,Vt-V,Ht+V,gt);if(Kt.length){const Rt=[Lt,new W(gt===0?Vt:$t.x,gt===1?Vt:$t.y)];Te.length>It+1?qe.push({polygons:Kt,bounds:Rt,depth:It+1}):re(Kt,Rt)}if(ii.length){const Rt=[new W(gt===0?Vt:Lt.x,gt===1?Vt:Lt.y),$t];Te.length>It+1?qe.push({polygons:ii,bounds:Rt,depth:It+1}):re(ii,Rt)}}return $}(a,s,Math.ceil((_-A)/11.25),Math.ceil((x-b)/11.25),1,(S,T,k)=>{if(S===0)return .5*(T+k);{const G=os((l.y+T/Mi)/d);return(dl(.5*(os((l.y+k/Mi)/d)+G))*d-l.y)*Mi}})}vi(sm,"FillExtrusionBucket",{omit:["layers","features"]}),vi(K2,"PartMetadata");const Y5=new ke({"fill-extrusion-edge-radius":new ne(Mt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var j5={paint:new ke({"fill-extrusion-opacity":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ve(Mt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ve(Mt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ve(Mt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ve(Mt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ne(Mt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Y5};function nS(a,s,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[a*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class wy{constructor(s,l,d){this.z=s,this.x=l,this.y=d,this.key=om(0,s,s,l,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,l){const d=function(_,x,b){var S=nS(256*_,256*(x=Math.pow(2,b)-x-1),b),T=nS(256*(_+1),256*(x+1),b);return S[0]+","+S[1]+","+T[0]+","+T[1]}(this.x,this.y,this.z),A=function(_,x,b){let S,T="";for(let k=_;k>0;k--)S=1<<k-1,T+=(x&S?1:0)+(b&S?2:0);return T}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rS{constructor(s,l){this.wrap=s,this.canonical=l,this.key=om(s,l.z,l.z,l.x,l.y)}}class Ts{constructor(s,l,d,A,_){this.overscaledZ=s,this.wrap=l,this.canonical=new wy(d,+A,+_),this.key=l===0&&s===d?this.canonical.key:om(l,s,d,A,_)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const l=this.canonical.z-s;return s>this.canonical.z?new Ts(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ts(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(s,l=!0){if(this.overscaledZ===s&&l)return this.key;if(s>this.canonical.z)return om(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-s;return om(this.wrap*+l,s,s,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const l=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l}children(s){if(this.overscaledZ>=s)return[new Ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,A=2*this.canonical.y;return[new Ts(l,this.wrap,l,d,A),new Ts(l,this.wrap,l,d+1,A),new Ts(l,this.wrap,l,d,A+1),new Ts(l,this.wrap,l,d+1,A+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Ts(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function om(a,s,l,d,A){const _=1<<Math.min(l,22);let x=_*(A%_)+d%_;return a&&l<22&&(x+=_*_*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*x+l)+(s-l)}vi(wy,"CanonicalTileID"),vi(Ts,"OverscaledTileID",{omit:["projMatrix"]});class Jf extends W{constructor(s,l,d){super(s,l),this.z=d}}function am(a,s){return a.x*s.x+a.y*s.y}function sS(a,s){if(a.length===1){let l=0;const d=s[l++];let A;for(;!A||d.equals(A);)if(A=s[l++],!A)return 1/0;for(;l<s.length;l++){const _=s[l],x=a[0],b=A.sub(d),S=_.sub(d),T=x.sub(d),k=am(b,b),G=am(b,S),V=am(S,S),K=am(T,b),$=am(T,S),re=k*V-G*G,ge=(V*K-G*$)/re,Me=(k*$-G*K)/re,He=d.z*(1-ge-Me)+A.z*ge+_.z*Me;if(isFinite(He))return He}return 1/0}{let l=1/0;for(const d of s)l=Math.min(l,d.z);return l}}function oS(a,s,l,d,A,_,x,b){const S=x*A.getElevationAt(a,s,!0,!0),T=_[0]!==0,k=T?_[1]===0?x*(_[0]/7-450):x*function(G,V,K){const $=Math.floor(V[0]/8),re=Math.floor(V[1]/8),ge=10*(V[0]-8*$),Me=10*(V[1]-8*re),He=G.getElevationAt($,re,!0,!0),Te=G.getMeterToDEM(K),Ge=Math.floor(.5*(ge*Te-1)),qe=Math.floor(.5*(Me*Te-1)),We=G.tileCoordToPixel($,re),It=2*Ge+1,gt=2*qe+1,Lt=function(ii,Rt,hi,Ci,di){return[ii.getElevationAtPixel(Rt,hi,!0),ii.getElevationAtPixel(Rt+di,hi,!0),ii.getElevationAtPixel(Rt,hi+di,!0),ii.getElevationAtPixel(Rt+Ci,hi+di,!0)]}(G,We.x-Ge,We.y-qe,It,gt),$t=Math.abs(Lt[0]-Lt[1]),Bt=Math.abs(Lt[2]-Lt[3]),Ht=Math.abs(Lt[0]-Lt[2])+Math.abs(Lt[1]-Lt[3]),Vt=Math.min(.25,.5*Te*($t+Bt)/It),Kt=Math.min(.25,.5*Te*Ht/gt);return He+Math.max(Vt*ge,Kt*Me)}(A,_,b):S;return{base:S+(l===0)?-1:l,top:T?Math.max(k+d,S+l+2):S+d}}const q5=lt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:K5}=q5,J5=lt([{name:"a_packed",components:4,type:"Float32"}]),{members:X5}=J5,Z5=Cy.types,$5=Math.cos(Math.PI/180*37.5);class by{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new bt,this.layoutVertexArray2=new Jt,this.indexArray=new wi,this.programConfigurations=new Hh(s.layers,s.zoom),this.segments=new gr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d,A){this.hasPattern=kI("line",this.layers,l);const _=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:k,id:G,index:V,sourceLayerIndex:K}of s){const $=this.layers[0]._featureFilter.needGeometry,re=Kh(k,$);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),re,d))continue;const ge=_?_.evaluate(re,{},d):void 0,Me={id:G,properties:k.properties,type:k.type,sourceLayerIndex:K,index:V,geometry:$?re.geometry:Zl(k,d,A),patterns:{},sortKey:ge};x.push(Me)}_&&x.sort((k,G)=>k.sortKey-G.sortKey);const{lineAtlas:b,featureIndex:S}=l,T=this.addConstantDashes(b);for(const k of x){const{geometry:G,index:V,sourceLayerIndex:K}=k;if(T&&this.addFeatureDashes(k,b),this.hasPattern){const $=FI("line",this.layers,k,this.zoom,l);this.patternFeatures.push($)}else this.addFeature(k,G,V,d,b.positions,l.availableImages);S.insert(s[V].feature,G,V,K,this.index)}}addConstantDashes(s){let l=!1;for(const d of this.layers){const A=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if(A.kind!=="constant"||_.kind!=="constant")l=!0;else{const x=_.value,b=A.value;if(!b)continue;s.addDash(b,x)}}return l}addFeatureDashes(s,l){const d=this.zoom;for(const A of this.layers){const _=A.paint.get("line-dasharray").value,x=A.layout.get("line-cap").value;if(_.kind==="constant"&&x.kind==="constant")continue;let b,S;if(_.kind==="constant"){if(b=_.value,!b)continue}else b=_.evaluate({zoom:d},s);S=x.kind==="constant"?x.value:x.evaluate({zoom:d},s),l.addDash(b,S),s.patterns[A.id]=l.getKey(b,S)}}update(s,l,d,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d,A)}addFeatures(s,l,d,A,_){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,l,d,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,X5)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,K5),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,l,d,A,_,x){const b=this.layers[0].layout,S=b.get("line-join").evaluate(s,{}),T=b.get("line-cap").evaluate(s,{}),k=b.get("line-miter-limit"),G=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const V of l)this.addLine(V,s,S,T,k,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,x,A)}addLine(s,l,d,A,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Me=0;Me<s.length-1;Me++)this.totalDistance+=s[Me].dist(s[Me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=Z5[l.type]==="Polygon";let S=s.length;for(;S>=2&&s[S-1].equals(s[S-2]);)S--;let T=0;for(;T<S-1&&s[T].equals(s[T+1]);)T++;if(S<(b?3:2))return;d==="bevel"&&(_=1.05);const k=this.overscaling<=16?15*Mi/(512*this.overscaling):0,G=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let V,K,$,re,ge;this.e1=this.e2=-1,b&&(V=s[S-2],ge=s[T].sub(V)._unit()._perp());for(let Me=T;Me<S;Me++){if($=Me===S-1?b?s[T+1]:void 0:s[Me+1],$&&s[Me].equals($))continue;ge&&(re=ge),V&&(K=V),V=s[Me],ge=$?$.sub(V)._unit()._perp():re,re=re||ge;let He=re.add(ge);He.x===0&&He.y===0||He._unit();const Te=re.x*ge.x+re.y*ge.y,Ge=He.x*ge.x+He.y*ge.y,qe=Ge!==0?1/Ge:1/0,We=2*Math.sqrt(2-2*Ge),It=Ge<$5&&K&&$,gt=re.x*ge.y-re.y*ge.x>0;if(It&&Me>T){const Bt=V.dist(K);if(Bt>2*k){const Ht=V.sub(V.sub(K)._mult(k/Bt)._round());this.updateDistance(K,Ht),this.addCurrentVertex(Ht,re,0,0,G),K=Ht}}const Lt=K&&$;let $t=Lt?d:b?"butt":A;if(Lt&&$t==="round"&&(qe<x?$t="miter":qe<=2&&($t="fakeround")),$t==="miter"&&qe>_&&($t="bevel"),$t==="bevel"&&(qe>2&&($t="flipbevel"),qe<_&&($t="miter")),K&&this.updateDistance(K,V),$t==="miter")He._mult(qe),this.addCurrentVertex(V,He,0,0,G);else if($t==="flipbevel"){if(qe>100)He=ge.mult(-1);else{const Bt=qe*re.add(ge).mag()/re.sub(ge).mag();He._perp()._mult(Bt*(gt?-1:1))}this.addCurrentVertex(V,He,0,0,G),this.addCurrentVertex(V,He.mult(-1),0,0,G)}else if($t==="bevel"||$t==="fakeround"){const Bt=-Math.sqrt(qe*qe-1),Ht=gt?Bt:0,Vt=gt?0:Bt;if(K&&this.addCurrentVertex(V,re,Ht,Vt,G),$t==="fakeround"){const Kt=Math.round(180*We/Math.PI/20);for(let ii=1;ii<Kt;ii++){let Rt=ii/Kt;if(Rt!==.5){const Ci=Rt-.5;Rt+=Rt*Ci*(Rt-1)*((1.0904+Te*(Te*(3.55645-1.43519*Te)-3.2452))*Ci*Ci+(.848013+Te*(.215638*Te-1.06021)))}const hi=ge.sub(re)._mult(Rt)._add(re)._unit()._mult(gt?-1:1);this.addHalfVertex(V,hi.x,hi.y,!1,gt,0,G)}}$&&this.addCurrentVertex(V,ge,-Ht,-Vt,G)}else if($t==="butt")this.addCurrentVertex(V,He,0,0,G);else if($t==="square"){const Bt=K?1:-1;K||this.addCurrentVertex(V,He,Bt,Bt,G),this.addCurrentVertex(V,He,0,0,G),K&&this.addCurrentVertex(V,He,Bt,Bt,G)}else $t==="round"&&(K&&(this.addCurrentVertex(V,re,0,0,G),this.addCurrentVertex(V,re,1,1,G,!0)),$&&(this.addCurrentVertex(V,ge,-1,-1,G,!0),this.addCurrentVertex(V,ge,0,0,G)));if(It&&Me<S-1){const Bt=V.dist($);if(Bt>2*k){const Ht=V.add($.sub(V)._mult(k/Bt)._round());this.updateDistance(V,Ht),this.addCurrentVertex(Ht,ge,0,0,G),V=Ht}}}}addCurrentVertex(s,l,d,A,_,x=!1){const b=l.y*A-l.x,S=-l.y-l.x*A;this.addHalfVertex(s,l.x+l.y*d,l.y-l.x*d,x,!1,d,_),this.addHalfVertex(s,b,S,x,!0,-A,_)}addHalfVertex({x:s,y:l},d,A,_,x,b,S){this.layoutVertexArray.emplaceBack((s<<1)+(_?1:0),(l<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*A)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),S.primitiveLength++),x?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,l){this.distance+=s.dist(l),this.updateScaledDistance()}}vi(by,"LineBucket",{omit:["layers","patternFeatures"]});const e4=new ke({"line-cap":new ve(Mt.layout_line["line-cap"]),"line-join":new ve(Mt.layout_line["line-join"]),"line-miter-limit":new ne(Mt.layout_line["line-miter-limit"]),"line-round-limit":new ne(Mt.layout_line["line-round-limit"]),"line-sort-key":new ve(Mt.layout_line["line-sort-key"])});var aS={paint:new ke({"line-opacity":new ve(Mt.paint_line["line-opacity"]),"line-color":new ve(Mt.paint_line["line-color"]),"line-translate":new ne(Mt.paint_line["line-translate"]),"line-translate-anchor":new ne(Mt.paint_line["line-translate-anchor"]),"line-width":new ve(Mt.paint_line["line-width"]),"line-gap-width":new ve(Mt.paint_line["line-gap-width"]),"line-offset":new ve(Mt.paint_line["line-offset"]),"line-blur":new ve(Mt.paint_line["line-blur"]),"line-dasharray":new ve(Mt.paint_line["line-dasharray"]),"line-pattern":new ve(Mt.paint_line["line-pattern"]),"line-gradient":new Pe(Mt.paint_line["line-gradient"]),"line-trim-offset":new ne(Mt.paint_line["line-trim-offset"])}),layout:e4};const lS=new class extends ve{possiblyEvaluate(a,s){return s=new U(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(a,s)}evaluate(a,s,l,d){return s=st({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(a,s,l,d)}}(aS.paint.properties["line-width"].specification);function cS(a,s){return s>0?s+2*a:a}lS.useIntegerZoom=!0;const t4=lt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),i4=lt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),n4=lt([{name:"a_projected_pos",components:4,type:"Float32"}],4);lt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const r4=lt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),s4=lt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);lt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const uS=lt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),o4=lt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);lt([{name:"triangle",components:3,type:"Uint16"}]),lt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),lt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),lt([{type:"Float32",name:"offsetX"}]),lt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var jr=24;const ka=128;function zI(a,s){const{expression:l}=s;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new U(a+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:A}=l;let _=0;for(;_<d.length&&d[_]<=a;)_++;_=Math.max(0,_-1);let x=_;for(;x<d.length&&d[x]<a+1;)x++;x=Math.min(d.length-1,x);const b=d[_],S=d[x];return l.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:A}:{kind:"camera",minZoom:b,maxZoom:S,minSize:l.evaluate(new U(b)),maxSize:l.evaluate(new U(S)),interpolationType:A}}}function By(a,{uSize:s,uSizeT:l},{lowerSize:d,upperSize:A}){return a.kind==="source"?d/ka:a.kind==="composite"?an(d/ka,A/ka,l):s}function Xf(a,s){let l=0,d=0;if(a.kind==="constant")d=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:A,minZoom:_,maxZoom:x}=a,b=A?ye(Vo.interpolationFactor(A,s,_,x),0,1):0;a.kind==="camera"?d=an(a.minSize,a.maxSize,b):l=b}return{uSizeT:l,uSize:d}}var a4=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ka,evaluateSizeForFeature:By,evaluateSizeForZoom:Xf,getSizeData:zI});function l4(a,s,l){return a.sections.forEach(d=>{d.text=function(A,_,x){const b=_.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?A=A.toLocaleUpperCase():b==="lowercase"&&(A=A.toLocaleLowerCase()),L.applyArabicShaping&&(A=L.applyArabicShaping(A)),A}(d.text,s,l)}),a}const lm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function c4(a){return a==="︶"||a==="﹈"||a==="︸"||a==="﹄"||a==="﹂"||a==="︾"||a==="︼"||a==="︺"||a==="︘"||a==="﹀"||a==="︐"||a==="︓"||a==="︔"||a==="｀"||a==="￣"||a==="︑"||a==="︒"}function u4(a){return a==="︵"||a==="﹇"||a==="︷"||a==="﹃"||a==="﹁"||a==="︽"||a==="︻"||a==="︹"||a==="︗"||a==="︿"}var hS=Fn,dS=function(a,s,l,d,A){var _,x,b=8*A-d-1,S=(1<<b)-1,T=S>>1,k=-7,G=l?A-1:0,V=l?-1:1,K=a[s+G];for(G+=V,_=K&(1<<-k)-1,K>>=-k,k+=b;k>0;_=256*_+a[s+G],G+=V,k-=8);for(x=_&(1<<-k)-1,_>>=-k,k+=d;k>0;x=256*x+a[s+G],G+=V,k-=8);if(_===0)_=1-T;else{if(_===S)return x?NaN:1/0*(K?-1:1);x+=Math.pow(2,d),_-=T}return(K?-1:1)*x*Math.pow(2,_-d)},fS=function(a,s,l,d,A,_){var x,b,S,T=8*_-A-1,k=(1<<T)-1,G=k>>1,V=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=d?0:_-1,$=d?1:-1,re=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(b=isNaN(s)?1:0,x=k):(x=Math.floor(Math.log(s)/Math.LN2),s*(S=Math.pow(2,-x))<1&&(x--,S*=2),(s+=x+G>=1?V/S:V*Math.pow(2,1-G))*S>=2&&(x++,S/=2),x+G>=k?(b=0,x=k):x+G>=1?(b=(s*S-1)*Math.pow(2,A),x+=G):(b=s*Math.pow(2,G-1)*Math.pow(2,A),x=0));A>=8;a[l+K]=255&b,K+=$,b/=256,A-=8);for(x=x<<A|b,T+=A;T>0;a[l+K]=255&x,K+=$,x/=256,T-=8);a[l+K-$]|=128*re};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Fn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Fn.Varint=0,Fn.Fixed64=1,Fn.Bytes=2,Fn.Fixed32=5;var UI=4294967296,pS=1/UI,AS=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ec(a){return a.type===Fn.Bytes?a.readVarint()+a.pos:a.pos+1}function Zf(a,s,l){return l?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}function gS(a,s,l){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));l.realloc(d);for(var A=l.pos-1;A>=a;A--)l.buf[A+d]=l.buf[A]}function h4(a,s){for(var l=0;l<a.length;l++)s.writeVarint(a[l])}function d4(a,s){for(var l=0;l<a.length;l++)s.writeSVarint(a[l])}function f4(a,s){for(var l=0;l<a.length;l++)s.writeFloat(a[l])}function p4(a,s){for(var l=0;l<a.length;l++)s.writeDouble(a[l])}function A4(a,s){for(var l=0;l<a.length;l++)s.writeBoolean(a[l])}function g4(a,s){for(var l=0;l<a.length;l++)s.writeFixed32(a[l])}function m4(a,s){for(var l=0;l<a.length;l++)s.writeSFixed32(a[l])}function _4(a,s){for(var l=0;l<a.length;l++)s.writeFixed64(a[l])}function y4(a,s){for(var l=0;l<a.length;l++)s.writeSFixed64(a[l])}function Sy(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function $f(a,s,l){a[l]=s,a[l+1]=s>>>8,a[l+2]=s>>>16,a[l+3]=s>>>24}function mS(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}Fn.prototype={destroy:function(){this.buf=null},readFields:function(a,s,l){for(l=l||this.length;this.pos<l;){var d=this.readVarint(),A=d>>3,_=this.pos;this.type=7&d,a(A,s,this),this.pos===_&&this.skip(d)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=Sy(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=mS(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Sy(this.buf,this.pos)+Sy(this.buf,this.pos+4)*UI;return this.pos+=8,a},readSFixed64:function(){var a=Sy(this.buf,this.pos)+mS(this.buf,this.pos+4)*UI;return this.pos+=8,a},readFloat:function(){var a=dS(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=dS(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,l,d=this.buf;return s=127&(l=d[this.pos++]),l<128?s:(s|=(127&(l=d[this.pos++]))<<7,l<128?s:(s|=(127&(l=d[this.pos++]))<<14,l<128?s:(s|=(127&(l=d[this.pos++]))<<21,l<128?s:function(A,_,x){var b,S,T=x.buf;if(b=(112&(S=T[x.pos++]))>>4,S<128||(b|=(127&(S=T[x.pos++]))<<3,S<128)||(b|=(127&(S=T[x.pos++]))<<10,S<128)||(b|=(127&(S=T[x.pos++]))<<17,S<128)||(b|=(127&(S=T[x.pos++]))<<24,S<128)||(b|=(1&(S=T[x.pos++]))<<31,S<128))return Zf(A,b,_);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(l=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&AS?function(l,d,A){return AS.decode(l.subarray(d,A))}(this.buf,s,a):function(l,d,A){for(var _="",x=d;x<A;){var b,S,T,k=l[x],G=null,V=k>239?4:k>223?3:k>191?2:1;if(x+V>A)break;V===1?k<128&&(G=k):V===2?(192&(b=l[x+1]))==128&&(G=(31&k)<<6|63&b)<=127&&(G=null):V===3?(S=l[x+2],(192&(b=l[x+1]))==128&&(192&S)==128&&((G=(15&k)<<12|(63&b)<<6|63&S)<=2047||G>=55296&&G<=57343)&&(G=null)):V===4&&(S=l[x+2],T=l[x+3],(192&(b=l[x+1]))==128&&(192&S)==128&&(192&T)==128&&((G=(15&k)<<18|(63&b)<<12|(63&S)<<6|63&T)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,V=1):G>65535&&(G-=65536,_+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),_+=String.fromCharCode(G),x+=V}return _}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==Fn.Bytes)return a.push(this.readVarint(s));var l=ec(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSVarint());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Fn.Bytes)return a.push(this.readBoolean());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFloat());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Fn.Bytes)return a.push(this.readDouble());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFixed32());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSFixed32());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFixed64());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSFixed64());var s=ec(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===Fn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Fn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Fn.Fixed32)this.pos+=4;else{if(s!==Fn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var l=new Uint8Array(s);l.set(this.buf),this.buf=l,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),$f(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),$f(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),$f(this.buf,-1&a,this.pos),$f(this.buf,Math.floor(a*pS),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),$f(this.buf,-1&a,this.pos),$f(this.buf,Math.floor(a*pS),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,l){var d,A;if(s>=0?(d=s%4294967296|0,A=s/4294967296|0):(A=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,A=A+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(_,x,b){b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,b.buf[b.pos]=127&(_>>>=7)}(d,0,l),function(_,x){var b=(7&_)<<4;x.buf[x.pos++]|=b|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(A,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(d,A,_){for(var x,b,S=0;S<A.length;S++){if((x=A.charCodeAt(S))>55295&&x<57344){if(!b){x>56319||S+1===A.length?(d[_++]=239,d[_++]=191,d[_++]=189):b=x;continue}if(x<56320){d[_++]=239,d[_++]=191,d[_++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(d[_++]=239,d[_++]=191,d[_++]=189,b=null);x<128?d[_++]=x:(x<2048?d[_++]=x>>6|192:(x<65536?d[_++]=x>>12|224:(d[_++]=x>>18|240,d[_++]=x>>12&63|128),d[_++]=x>>6&63|128),d[_++]=63&x|128)}return _}(this.buf,a,this.pos);var l=this.pos-s;l>=128&&gS(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),fS(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),fS(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var l=0;l<s;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,s){this.pos++;var l=this.pos;a(s,this);var d=this.pos-l;d>=128&&gS(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,s,l){this.writeTag(a,Fn.Bytes),this.writeRawMessage(s,l)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,h4,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,d4,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,A4,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,f4,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,p4,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,g4,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,m4,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,_4,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,y4,s)},writeBytesField:function(a,s){this.writeTag(a,Fn.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,Fn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,Fn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,Fn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,Fn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,Fn.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,Fn.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,Fn.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,Fn.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,Fn.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,Boolean(s))}};var My=F(hS);const OI=3;function v4(a,s,l){s.glyphs=[],a===1&&l.readMessage(x4,s)}function x4(a,s,l){if(a===3){const{id:d,bitmap:A,width:_,height:x,left:b,top:S,advance:T}=l.readMessage(I4,{});s.glyphs.push({id:d,bitmap:new $l({width:_+2*OI,height:x+2*OI},A),metrics:{width:_,height:x,left:b,top:S,advance:T}})}else a===4?s.ascender=l.readSVarint():a===5&&(s.descender=l.readSVarint())}function I4(a,s,l){a===1?s.id=l.readVarint():a===2?s.bitmap=l.readBytes():a===3?s.width=l.readVarint():a===4?s.height=l.readVarint():a===5?s.left=l.readSVarint():a===6?s.top=l.readSVarint():a===7&&(s.advance=l.readVarint())}const _S=OI;function GI(a){let s=0,l=0;for(const x of a)s+=x.w*x.h,l=Math.max(l,x.w);a.sort((x,b)=>b.h-x.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),l),h:1/0}];let A=0,_=0;for(const x of a)for(let b=d.length-1;b>=0;b--){const S=d[b];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,_=Math.max(_,x.y+x.h),A=Math.max(A,x.x+x.w),x.w===S.w&&x.h===S.h){const T=d.pop();b<d.length&&(d[b]=T)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(d.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:A,h:_,fill:s/(A*_)||0}}const Gs=1;class HI{constructor(s,{pixelRatio:l,version:d,stretchX:A,stretchY:_,content:x}){this.paddedRect=s,this.pixelRatio=l,this.stretchX=A,this.stretchY=_,this.content=x,this.version=d}get tl(){return[this.paddedRect.x+Gs,this.paddedRect.y+Gs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Gs,this.paddedRect.y+this.paddedRect.h-Gs]}get displaySize(){return[(this.paddedRect.w-2*Gs)/this.pixelRatio,(this.paddedRect.h-2*Gs)/this.pixelRatio]}}class yS{constructor(s,l){const d={},A={};this.haveRenderCallbacks=[];const _=[];this.addImages(s,d,_),this.addImages(l,A,_);const{w:x,h:b}=GI(_),S=new so({width:x||1,height:b||1});for(const T in s){const k=s[T],G=d[T].paddedRect;so.copy(k.data,S,{x:0,y:0},{x:G.x+Gs,y:G.y+Gs},k.data)}for(const T in l){const k=l[T],G=A[T].paddedRect,V=G.x+Gs,K=G.y+Gs,$=k.data.width,re=k.data.height;so.copy(k.data,S,{x:0,y:0},{x:V,y:K},k.data),so.copy(k.data,S,{x:0,y:re-1},{x:V,y:K-1},{width:$,height:1}),so.copy(k.data,S,{x:0,y:0},{x:V,y:K+re},{width:$,height:1}),so.copy(k.data,S,{x:$-1,y:0},{x:V-1,y:K},{width:1,height:re}),so.copy(k.data,S,{x:0,y:0},{x:V+$,y:K},{width:1,height:re})}this.image=S,this.iconPositions=d,this.patternPositions=A}addImages(s,l,d){for(const A in s){const _=s[A],x={x:0,y:0,w:_.data.width+2*Gs,h:_.data.height+2*Gs};d.push(x),l[A]=new HI(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(A)}}patchUpdatedImages(s,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>s.hasImage(d)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),l)}patchUpdatedImage(s,l,d){if(!s||!l||s.version===l.version)return;s.version=l.version;const[A,_]=s.tl;d.update(l.data,void 0,{x:A,y:_})}}vi(HI,"ImagePosition"),vi(yS,"ImageAtlas");const bo={horizontal:1,vertical:2,horizontalOnly:3},vS=-17;class cm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,l){const d=new cm;return d.scale=s||1,d.fontStack=l,d}static forImage(s){const l=new cm;return l.imageName=s,l}}class ep{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,l){const d=new ep;for(let A=0;A<s.sections.length;A++){const _=s.sections[A];_.image?d.addImageSection(_):d.addTextSection(_,l)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(l,d){let A="";for(let _=0;_<l.length;_++){const x=l.charCodeAt(_+1)||null,b=l.charCodeAt(_-1)||null;A+=!d&&(x&&ry(x)&&!lm[l[_+1]]||b&&ry(b)&&!lm[l[_-1]])||!lm[l[_]]?l[_]:lm[l[_]]}return A}(this.text,s)}trim(){let s=0;for(let d=0;d<this.text.length&&Ty[this.text.charCodeAt(d)];d++)s++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&Ty[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(s,l),this.sectionIndex=this.sectionIndex.slice(s,l)}substring(s,l){const d=new ep;return d.text=this.text.substring(s,l),d.sectionIndex=this.sectionIndex.slice(s,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,l)=>Math.max(s,this.sections[l].scale),0)}addTextSection(s,l){this.text+=s.text,this.sections.push(cm.forText(s.scale,s.fontStack||l));const d=this.sections.length-1;for(let A=0;A<s.text.length;++A)this.sectionIndex.push(d)}addImageSection(s){const l=s.image?s.image.name:"";if(l.length===0)return void nt("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(cm.forImage(l)),this.sectionIndex.push(this.sections.length-1)):nt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function VI(a,s,l,d,A,_,x,b,S,T,k,G,V,K,$){const re=ep.fromFeature(a,A);G===bo.vertical&&re.verticalizePunctuation(V);let ge=[];const Me=function(We,It,gt,Lt,$t,Bt){if(!We)return[];const Ht=[],Vt=function(hi,Ci,di,Oi,ri,Si){let Gi=0;for(let hn=0;hn<hi.length();hn++){const Hi=hi.getSection(hn);Gi+=xS(hi.getCharCode(hn),Hi,Oi,ri,Ci,Si)}return Gi/Math.max(1,Math.ceil(Gi/di))}(We,It,gt,Lt,$t,Bt),Kt=We.text.indexOf("​")>=0;let ii=0;for(let hi=0;hi<We.length();hi++){const Ci=We.getSection(hi),di=We.getCharCode(hi);if(Ty[di]||(ii+=xS(di,Ci,Lt,$t,It,Bt)),hi<We.length()-1){const Oi=!((Rt=di)<11904||!(pi["Bopomofo Extended"](Rt)||pi.Bopomofo(Rt)||pi["CJK Compatibility Forms"](Rt)||pi["CJK Compatibility Ideographs"](Rt)||pi["CJK Compatibility"](Rt)||pi["CJK Radicals Supplement"](Rt)||pi["CJK Strokes"](Rt)||pi["CJK Symbols and Punctuation"](Rt)||pi["CJK Unified Ideographs Extension A"](Rt)||pi["CJK Unified Ideographs"](Rt)||pi["Enclosed CJK Letters and Months"](Rt)||pi["Halfwidth and Fullwidth Forms"](Rt)||pi.Hiragana(Rt)||pi["Ideographic Description Characters"](Rt)||pi["Kangxi Radicals"](Rt)||pi["Katakana Phonetic Extensions"](Rt)||pi.Katakana(Rt)||pi["Vertical Forms"](Rt)||pi["Yi Radicals"](Rt)||pi["Yi Syllables"](Rt)));(C4[di]||Oi||Ci.imageName)&&Ht.push(CS(hi+1,ii,Vt,Ht,E4(di,We.getCharCode(hi+1),Oi&&Kt),!1))}}var Rt;return ES(CS(We.length(),ii,Vt,Ht,0,!0))}(re,T,_,s,d,K),{processBidirectionalText:He,processStyledBidirectionalText:Te}=L;if(He&&re.sections.length===1){const We=He(re.toString(),Me);for(const It of We){const gt=new ep;gt.text=It,gt.sections=re.sections;for(let Lt=0;Lt<It.length;Lt++)gt.sectionIndex.push(0);ge.push(gt)}}else if(Te){const We=Te(re.text,re.sectionIndex,Me);for(const It of We){const gt=new ep;gt.text=It[0],gt.sectionIndex=It[1],gt.sections=re.sections,ge.push(gt)}}else ge=function(We,It){const gt=[],Lt=We.text;let $t=0;for(const Bt of It)gt.push(We.substring($t,Bt)),$t=Bt;return $t<Lt.length&&gt.push(We.substring($t,Lt.length)),gt}(re,Me);const Ge=[],qe={positionedLines:Ge,text:re.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:G,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(We,It,gt,Lt,$t,Bt,Ht,Vt,Kt,ii,Rt,hi){let Ci=0,di=0,Oi=0;const ri=Vt==="right"?1:Vt==="left"?0:.5;let Si=!1;for(const Vi of $t){const Wi=Vi.getSections();for(const Rn of Wi){if(Rn.imageName)continue;const Nn=It[Rn.fontStack];if(Nn&&(Si=Nn.ascender!==void 0&&Nn.descender!==void 0,!Si))break}if(!Si)break}let Gi=0;for(const Vi of $t){Vi.trim();const Wi=Vi.getMaxScale(),Rn=(Wi-1)*jr,Nn={positionedGlyphs:[],lineOffset:0};We.positionedLines[Gi]=Nn;const zn=Nn.positionedGlyphs;let Ln=0;if(!Vi.length()){di+=Bt,++Gi;continue}let Kn=0,or=0;for(let Pn=0;Pn<Vi.length();Pn++){const Er=Vi.getSection(Pn),yr=Vi.getSectionIndex(Pn),tr=Vi.getCharCode(Pn);let pn=Er.scale,vr=null,Un=null,Ds=null,xr=jr,qr=0;const Nr=!(Kt===bo.horizontal||!Rt&&!kg(tr)||Rt&&(Ty[tr]||(hn=tr,pi.Arabic(hn)||pi["Arabic Supplement"](hn)||pi["Arabic Extended-A"](hn)||pi["Arabic Presentation Forms-A"](hn)||pi["Arabic Presentation Forms-B"](hn))));if(Er.imageName){const Qs=Lt[Er.imageName];if(!Qs)continue;Ds=Er.imageName,We.iconsInText=We.iconsInText||!0,Un=Qs.paddedRect;const zr=Qs.displaySize;pn=pn*jr/hi,vr={width:zr[0],height:zr[1],left:Gs,top:-_S,advance:Nr?zr[1]:zr[0],localGlyph:!1},qr=Si?-vr.height*pn:vS+Wi*jr-zr[1]*pn,xr=vr.advance;const za=(Nr?zr[0]:zr[1])*pn-jr*Wi;za>0&&za>Ln&&(Ln=za)}else{const Qs=gt[Er.fontStack];if(!Qs)continue;Qs[tr]&&(Un=Qs[tr]);const zr=It[Er.fontStack];if(!zr)continue;const za=zr.glyphs[tr];if(!za)continue;if(vr=za.metrics,xr=tr!==8203?jr:0,Si){const ap=zr.ascender!==void 0?Math.abs(zr.ascender):0,ym=zr.descender!==void 0?Math.abs(zr.descender):0,vm=(ap+ym)*pn;Kn<vm&&(Kn=vm,or=(ap-ym)/2*pn),qr=-ap*pn}else qr=vS+(Wi-pn)*jr}Nr?(We.verticalizable=!0,zn.push({glyph:tr,imageName:Ds,x:Ci,y:di+qr,vertical:Nr,scale:pn,localGlyph:vr.localGlyph,fontStack:Er.fontStack,sectionIndex:yr,metrics:vr,rect:Un}),Ci+=xr*pn+ii):(zn.push({glyph:tr,imageName:Ds,x:Ci,y:di+qr,vertical:Nr,scale:pn,localGlyph:vr.localGlyph,fontStack:Er.fontStack,sectionIndex:yr,metrics:vr,rect:Un}),Ci+=vr.advance*pn+ii)}zn.length!==0&&(Oi=Math.max(Ci-ii,Oi),Si?wS(zn,ri,Ln,or,Bt*Wi/2):wS(zn,ri,Ln,0,Bt/2)),Ci=0;const _r=Bt*Wi+Ln;Nn.lineOffset=Math.max(Ln,Rn),di+=_r,++Gi}var hn;const Hi=di,{horizontalAlign:Ri,verticalAlign:On}=WI(Ht);(function(Vi,Wi,Rn,Nn,zn,Ln){const Kn=(Wi-Rn)*zn,or=-Ln*Nn;for(const _r of Vi)for(const Pn of _r.positionedGlyphs)Pn.x+=Kn,Pn.y+=or})(We.positionedLines,ri,Ri,On,Oi,Hi),We.top+=-On*Hi,We.bottom=We.top+Hi,We.left+=-Ri*Oi,We.right=We.left+Oi,We.hasBaseline=Si}(qe,s,l,d,ge,x,b,S,G,T,V,$),!function(We){for(const It of We)if(It.positionedGlyphs.length!==0)return!1;return!0}(Ge)&&qe}const Ty={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},C4={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xS(a,s,l,d,A,_){if(s.imageName){const x=d[s.imageName];return x?x.displaySize[0]*s.scale*jr/_+A:0}{const x=l[s.fontStack],b=x&&x.glyphs[a];return b?b.metrics.advance*s.scale+A:0}}function IS(a,s,l,d){const A=Math.pow(a-s,2);return d?a<s?A/2:2*A:A+Math.abs(l)*l}function E4(a,s,l){let d=0;return a===10&&(d-=1e4),l&&(d+=150),a!==40&&a!==65288||(d+=50),s!==41&&s!==65289||(d+=50),d}function CS(a,s,l,d,A,_){let x=null,b=IS(s,l,A,_);for(const S of d){const T=IS(s-S.x,l,A,_)+S.badness;T<=b&&(x=S,b=T)}return{index:a,x:s,priorBreak:x,badness:b}}function ES(a){return a?ES(a.priorBreak).concat(a.index):[]}function WI(a){let s=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:s,verticalAlign:l}}function wS(a,s,l,d,A){if(!(s||l||d||A))return;const _=a.length-1,x=a[_],b=(x.x+x.metrics.advance*x.scale)*s;for(let S=0;S<=_;S++)a[S].x-=b,a[S].y+=l+d+A}function w4(a,s,l){const{horizontalAlign:d,verticalAlign:A}=WI(l),_=s[0]-a.displaySize[0]*d,x=s[1]-a.displaySize[1]*A;return{image:a,top:x,bottom:x+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function bS(a,s,l,d,A,_){const x=a.image;let b;if(x.content){const ge=x.content,Me=x.pixelRatio||1;b=[ge[0]/Me,ge[1]/Me,x.displaySize[0]-ge[2]/Me,x.displaySize[1]-ge[3]/Me]}const S=s.left*_,T=s.right*_;let k,G,V,K;l==="width"||l==="both"?(K=A[0]+S-d[3],G=A[0]+T+d[1]):(K=A[0]+(S+T-x.displaySize[0])/2,G=K+x.displaySize[0]);const $=s.top*_,re=s.bottom*_;return l==="height"||l==="both"?(k=A[1]+$-d[0],V=A[1]+re+d[2]):(k=A[1]+($+re-x.displaySize[1])/2,V=k+x.displaySize[1]),{image:x,top:k,right:G,bottom:V,left:K,collisionPadding:b}}class tc extends W{constructor(s,l,d,A,_){super(s,l),this.angle=A,this.z=d,_!==void 0&&(this.segment=_)}clone(){return new tc(this.x,this.y,this.z,this.angle,this.segment)}}function BS(a,s,l,d,A){if(s.segment===void 0)return!0;let _=s,x=s.segment+1,b=0;for(;b>-l/2;){if(x--,x<0)return!1;b-=a[x].dist(_),_=a[x]}b+=a[x].dist(a[x+1]),x++;const S=[];let T=0;for(;b<l/2;){const k=a[x],G=a[x+1];if(!G)return!1;let V=a[x-1].angleTo(k)-k.angleTo(G);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:V}),T+=V;b-S[0].distance>d;)T-=S.shift().angleDelta;if(T>A)return!1;x++,b+=k.dist(G)}return!0}function SS(a){let s=0;for(let l=0;l<a.length-1;l++)s+=a[l].dist(a[l+1]);return s}function MS(a,s,l){return a?.6*s*l:0}function TS(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function b4(a,s,l,d,A,_){const x=MS(l,A,_),b=TS(l,d)*_;let S=0;const T=SS(a)/2;for(let k=0;k<a.length-1;k++){const G=a[k],V=a[k+1],K=G.dist(V);if(S+K>T){const $=(T-S)/K,re=an(G.x,V.x,$),ge=an(G.y,V.y,$),Me=new tc(re,ge,0,V.angleTo(G),k);return!x||BS(a,Me,b,x,s)?Me:void 0}S+=K}}function B4(a,s,l,d,A,_,x,b,S){const T=MS(d,_,x),k=TS(d,A),G=k*x,V=a[0].x===0||a[0].x===S||a[0].y===0||a[0].y===S;return s-G<s/4&&(s=G+s/4),DS(a,V?s/2*b%s:(k/2+2*_)*x*b%s,s,T,l,G,V,!1,S)}function DS(a,s,l,d,A,_,x,b,S){const T=_/2,k=SS(a);let G=0,V=s-l,K=[];for(let $=0;$<a.length-1;$++){const re=a[$],ge=a[$+1],Me=re.dist(ge),He=ge.angleTo(re);for(;V+l<G+Me;){V+=l;const Te=(V-G)/Me,Ge=an(re.x,ge.x,Te),qe=an(re.y,ge.y,Te);if(Ge>=0&&Ge<S&&qe>=0&&qe<S&&V-T>=0&&V+T<=k){const We=new tc(Ge,qe,0,He,$);We._round(),d&&!BS(a,We,_,d,A)||K.push(We)}}G+=Me}return b||K.length||x||(K=DS(a,G/2,l,d,A,_,x,!0,S)),K}function QS(a,s,l,d,A){const _=[];for(let x=0;x<a.length;x++){const b=a[x];let S;for(let T=0;T<b.length-1;T++){let k=b[T],G=b[T+1];k.x<s&&G.x<s||(k.x<s?k=new W(s,k.y+(s-k.x)/(G.x-k.x)*(G.y-k.y))._round():G.x<s&&(G=new W(s,k.y+(s-k.x)/(G.x-k.x)*(G.y-k.y))._round()),k.y<l&&G.y<l||(k.y<l?k=new W(k.x+(l-k.y)/(G.y-k.y)*(G.x-k.x),l)._round():G.y<l&&(G=new W(k.x+(l-k.y)/(G.y-k.y)*(G.x-k.x),l)._round()),k.x>=d&&G.x>=d||(k.x>=d?k=new W(d,k.y+(d-k.x)/(G.x-k.x)*(G.y-k.y))._round():G.x>=d&&(G=new W(d,k.y+(d-k.x)/(G.x-k.x)*(G.y-k.y))._round()),k.y>=A&&G.y>=A||(k.y>=A?k=new W(k.x+(A-k.y)/(G.y-k.y)*(G.x-k.x),A)._round():G.y>=A&&(G=new W(k.x+(A-k.y)/(G.y-k.y)*(G.x-k.x),A)._round()),S&&k.equals(S[S.length-1])||(S=[k],_.push(S)),S.push(G)))))}}return _}vi(tc,"Anchor");const um=1e20;function RS(a,s,l,d,A,_,x,b,S){for(let T=s;T<s+d;T++)LS(a,l*_+T,_,A,x,b,S);for(let T=l;T<l+A;T++)LS(a,T*_+s,1,d,x,b,S)}function LS(a,s,l,d,A,_,x){_[0]=0,x[0]=-um,x[1]=um,A[0]=a[s];for(let b=1,S=0,T=0;b<d;b++){A[b]=a[s+b*l];const k=b*b;do{const G=_[S];T=(A[b]-A[G]+k-G*G)/(b-G)/2}while(T<=x[S]&&--S>-1);S++,_[S]=b,x[S]=T,x[S+1]=um}for(let b=0,S=0;b<d;b++){for(;x[S+1]<b;)S++;const T=_[S],k=b-T;a[s+b*l]=A[T]+k*k}}const Fa=2,YI={none:0,ideographs:1,all:2};class tp{constructor(s,l,d){this.requestManager=s,this.localGlyphMode=l,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,l){const d=[];for(const A in s)for(const _ of s[A])d.push({stack:A,id:_});Tt(d,({stack:A,id:_},x)=>{let b=this.entries[A];b||(b=this.entries[A]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=b.glyphs[_];if(S!==void 0)return void x(null,{stack:A,id:_,glyph:S});if(S=this._tinySDF(b,A,_),S)return b.glyphs[_]=S,void x(null,{stack:A,id:_,glyph:S});const T=Math.floor(_/256);if(256*T>65535)return void x(new Error("glyphs > 65535 not supported"));if(b.ranges[T])return void x(null,{stack:A,id:_,glyph:S});let k=b.requests[T];k||(k=b.requests[T]=[],tp.loadGlyphRange(A,T,this.url,this.requestManager,(G,V)=>{if(V){b.ascender=V.ascender,b.descender=V.descender;for(const K in V.glyphs)this._doesCharSupportLocalGlyph(+K)||(b.glyphs[+K]=V.glyphs[+K]);b.ranges[T]=!0}for(const K of k)K(G,V);delete b.requests[T]})),k.push((G,V)=>{G?x(G):V&&x(null,{stack:A,id:_,glyph:V.glyphs[_]||null})})},(A,_)=>{if(A)l(A);else if(_){const x={};for(const{stack:b,id:S,glyph:T}of _)x[b]===void 0&&(x[b]={}),x[b].glyphs===void 0&&(x[b].glyphs={}),x[b].glyphs[S]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},x[b].ascender=this.entries[b].ascender,x[b].descender=this.entries[b].descender;l(null,x)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==YI.none&&(this.localGlyphMode===YI.all?!!this.localFontFamily:!!this.localFontFamily&&(pi["CJK Unified Ideographs"](s)||pi["Hangul Syllables"](s)||pi.Hiragana(s)||pi.Katakana(s)||pi["CJK Symbols and Punctuation"](s)))}_tinySDF(s,l,d){const A=this.localFontFamily;if(!A||!this._doesCharSupportLocalGlyph(d))return;let _=s.tinySDF;if(!_){let re="400";/bold/i.test(l)?re="900":/medium/i.test(l)?re="500":/light/i.test(l)&&(re="200"),_=s.tinySDF=new tp.TinySDF({fontFamily:A,fontWeight:re,fontSize:24*Fa,buffer:3*Fa,radius:8*Fa}),_.fontWeight=re}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const x=String.fromCharCode(d),{data:b,width:S,height:T,glyphWidth:k,glyphHeight:G,glyphLeft:V,glyphTop:K,glyphAdvance:$}=_.draw(x);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new $l({width:S,height:T},b),metrics:{width:k/Fa,height:G/Fa,left:V/Fa,top:K/Fa-27,advance:$/Fa,localGlyph:!0}}}}tp.loadGlyphRange=function(a,s,l,d,A){const _=256*s,x=_+255,b=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${_}-${x}`),Xt.Glyphs);kt(b,(S,T)=>{if(S)A(S);else if(T){const k={},G=function(V){return new My(V).readFields(v4,{})}(T);for(const V of G.glyphs)k[V.id]=V;A(null,{glyphs:k,ascender:G.ascender,descender:G.descender})}})},tp.TinySDF=class{constructor({fontSize:a=24,buffer:s=3,radius:l=8,cutoff:d=.25,fontFamily:A="sans-serif",fontWeight:_="normal",fontStyle:x="normal"}={}){this.buffer=s,this.cutoff=d,this.radius=l;const b=this.size=a+4*s,S=this._createCanvas(b),T=this.ctx=S.getContext("2d",{willReadFrequently:!0});T.font=`${x} ${_} ${a}px ${A}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(a){const s=document.createElement("canvas");return s.width=s.height=a,s}draw(a){const{width:s,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:A,actualBoundingBoxRight:_}=this.ctx.measureText(a),x=Math.ceil(l),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-A))),S=Math.min(this.size-this.buffer,x+Math.ceil(d)),T=b+2*this.buffer,k=S+2*this.buffer,G=Math.max(T*k,0),V=new Uint8ClampedArray(G),K={data:V,width:T,height:k,glyphWidth:b,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:s};if(b===0||S===0)return K;const{ctx:$,buffer:re,gridInner:ge,gridOuter:Me}=this;$.clearRect(re,re,b,S),$.fillText(a,re,re+x);const He=$.getImageData(re,re,b,S);Me.fill(um,0,G),ge.fill(0,0,G);for(let Te=0;Te<S;Te++)for(let Ge=0;Ge<b;Ge++){const qe=He.data[4*(Te*b+Ge)+3]/255;if(qe===0)continue;const We=(Te+re)*T+Ge+re;if(qe===1)Me[We]=0,ge[We]=um;else{const It=.5-qe;Me[We]=It>0?It*It:0,ge[We]=It<0?It*It:0}}RS(Me,0,0,T,k,T,this.f,this.v,this.z),RS(ge,re,re,b,S,T,this.f,this.v,this.z);for(let Te=0;Te<G;Te++){const Ge=Math.sqrt(Me[Te])-Math.sqrt(ge[Te]);V[Te]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return K}};const ip=Gs;function PS(a,s,l,d){const A=[],_=a.image,x=_.pixelRatio,b=_.paddedRect.w-2*ip,S=_.paddedRect.h-2*ip,T=a.right-a.left,k=a.bottom-a.top,G=_.stretchX||[[0,b]],V=_.stretchY||[[0,S]],K=(Bt,Ht)=>Bt+Ht[1]-Ht[0],$=G.reduce(K,0),re=V.reduce(K,0),ge=b-$,Me=S-re;let He=0,Te=$,Ge=0,qe=re,We=0,It=ge,gt=0,Lt=Me;if(_.content&&d){const Bt=_.content;He=Dy(G,0,Bt[0]),Ge=Dy(V,0,Bt[1]),Te=Dy(G,Bt[0],Bt[2]),qe=Dy(V,Bt[1],Bt[3]),We=Bt[0]-He,gt=Bt[1]-Ge,It=Bt[2]-Bt[0]-Te,Lt=Bt[3]-Bt[1]-qe}const $t=(Bt,Ht,Vt,Kt)=>{const ii=Qy(Bt.stretch-He,Te,T,a.left),Rt=Ry(Bt.fixed-We,It,Bt.stretch,$),hi=Qy(Ht.stretch-Ge,qe,k,a.top),Ci=Ry(Ht.fixed-gt,Lt,Ht.stretch,re),di=Qy(Vt.stretch-He,Te,T,a.left),Oi=Ry(Vt.fixed-We,It,Vt.stretch,$),ri=Qy(Kt.stretch-Ge,qe,k,a.top),Si=Ry(Kt.fixed-gt,Lt,Kt.stretch,re),Gi=new W(ii,hi),hn=new W(di,hi),Hi=new W(di,ri),Ri=new W(ii,ri),On=new W(Rt/x,Ci/x),Vi=new W(Oi/x,Si/x),Wi=s*Math.PI/180;if(Wi){const zn=Math.sin(Wi),Ln=Math.cos(Wi),Kn=[Ln,-zn,zn,Ln];Gi._matMult(Kn),hn._matMult(Kn),Ri._matMult(Kn),Hi._matMult(Kn)}const Rn=Bt.stretch+Bt.fixed,Nn=Ht.stretch+Ht.fixed;return{tl:Gi,tr:hn,bl:Ri,br:Hi,tex:{x:_.paddedRect.x+ip+Rn,y:_.paddedRect.y+ip+Nn,w:Vt.stretch+Vt.fixed-Rn,h:Kt.stretch+Kt.fixed-Nn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:On,pixelOffsetBR:Vi,minFontScaleX:It/x/T,minFontScaleY:Lt/x/k,isSDF:l}};if(d&&(_.stretchX||_.stretchY)){const Bt=kS(G,ge,$),Ht=kS(V,Me,re);for(let Vt=0;Vt<Bt.length-1;Vt++){const Kt=Bt[Vt],ii=Bt[Vt+1];for(let Rt=0;Rt<Ht.length-1;Rt++)A.push($t(Kt,Ht[Rt],ii,Ht[Rt+1]))}}else A.push($t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return A}function Dy(a,s,l){let d=0;for(const A of a)d+=Math.max(s,Math.min(l,A[1]))-Math.max(s,Math.min(l,A[0]));return d}function kS(a,s,l){const d=[{fixed:-ip,stretch:0}];for(const[A,_]of a){const x=d[d.length-1];d.push({fixed:A-x.stretch,stretch:x.stretch}),d.push({fixed:A-x.stretch,stretch:x.stretch+(_-A)})}return d.push({fixed:s+ip,stretch:l}),d}function Qy(a,s,l,d){return a/s*l+d}function Ry(a,s,l,d){return a-s*l/d}function S4(a,s,l,d){const A=s+a.positionedLines[d].lineOffset;return d===0?l+A/2:l+(A+(s+a.positionedLines[d-1].lineOffset))/2}class M4{constructor(s=[],l=T4){if(this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:l,compare:d}=this,A=l[s];for(;s>0;){const _=s-1>>1,x=l[_];if(d(A,x)>=0)break;l[s]=x,s=_}l[s]=A}_down(s){const{data:l,compare:d}=this,A=this.length>>1,_=l[s];for(;s<A;){let x=1+(s<<1),b=l[x];const S=x+1;if(S<this.length&&d(l[S],b)<0&&(x=S,b=l[S]),d(b,_)>=0)break;l[s]=b,s=x}l[s]=_}}function T4(a,s){return a<s?-1:a>s?1:0}function D4(a,s=1,l=!1){let d=1/0,A=1/0,_=-1/0,x=-1/0;const b=a[0];for(let K=0;K<b.length;K++){const $=b[K];(!K||$.x<d)&&(d=$.x),(!K||$.y<A)&&(A=$.y),(!K||$.x>_)&&(_=$.x),(!K||$.y>x)&&(x=$.y)}const S=Math.min(_-d,x-A);let T=S/2;const k=new M4([],Q4);if(S===0)return new W(d,A);for(let K=d;K<_;K+=S)for(let $=A;$<x;$+=S)k.push(new np(K+T,$+T,T,a));let G=function(K){let $=0,re=0,ge=0;const Me=K[0];for(let He=0,Te=Me.length,Ge=Te-1;He<Te;Ge=He++){const qe=Me[He],We=Me[Ge],It=qe.x*We.y-We.x*qe.y;re+=(qe.x+We.x)*It,ge+=(qe.y+We.y)*It,$+=3*It}return new np(re/$,ge/$,0,K)}(a),V=k.length;for(;k.length;){const K=k.pop();(K.d>G.d||!G.d)&&(G=K,l&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,V)),K.max-G.d<=s||(T=K.h/2,k.push(new np(K.p.x-T,K.p.y-T,T,a)),k.push(new np(K.p.x+T,K.p.y-T,T,a)),k.push(new np(K.p.x-T,K.p.y+T,T,a)),k.push(new np(K.p.x+T,K.p.y+T,T,a)),V+=4)}return l&&(console.log(`num probes: ${V}`),console.log(`best distance: ${G.d}`)),G.p}function Q4(a,s){return s.max-a.max}class np{constructor(s,l,d,A){this.p=new W(s,l),this.h=d,this.d=function(_,x){let b=!1,S=1/0;for(let T=0;T<x.length;T++){const k=x[T];for(let G=0,V=k.length,K=V-1;G<V;K=G++){const $=k[G],re=k[K];$.y>_.y!=re.y>_.y&&_.x<(re.x-$.x)*(_.y-$.y)/(re.y-$.y)+$.x&&(b=!b),S=Math.min(S,D2(_,$,re))}}return(b?1:-1)*Math.sqrt(S)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}}const rp=7,jI=Number.POSITIVE_INFINITY,R4=Math.sqrt(2);function FS(a,[s,l]){let d=0,A=0;if(l===jI){s<0&&(s=0);const _=s/R4;switch(a){case"top-right":case"top-left":A=_-rp;break;case"bottom-right":case"bottom-left":A=-_+rp;break;case"bottom":A=-s+rp;break;case"top":A=s-rp}switch(a){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=s;break;case"right":d=-s}}else{switch(s=Math.abs(s),l=Math.abs(l),a){case"top-right":case"top-left":case"top":A=l-rp;break;case"bottom-right":case"bottom-left":case"bottom":A=-l+rp}switch(a){case"top-right":case"bottom-right":case"right":d=-s;break;case"top-left":case"bottom-left":case"left":d=s}}return[d,A]}function L4(a,s,l,d,A,_,x,b,S,T){a.createArrays(),a.tilePixelRatio=Mi/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const k=a.layers[0].layout,G=a.layers[0]._unevaluatedLayout._values,V={};if(a.textSizeData.kind==="composite"){const{minZoom:re,maxZoom:ge}=a.textSizeData;V.compositeTextSizes=[G["text-size"].possiblyEvaluate(new U(re),b),G["text-size"].possiblyEvaluate(new U(ge),b)]}if(a.iconSizeData.kind==="composite"){const{minZoom:re,maxZoom:ge}=a.iconSizeData;V.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new U(re),b),G["icon-size"].possiblyEvaluate(new U(ge),b)]}V.layoutTextSize=G["text-size"].possiblyEvaluate(new U(S+1),b),V.layoutIconSize=G["icon-size"].possiblyEvaluate(new U(S+1),b),V.textMaxSize=G["text-size"].possiblyEvaluate(new U(18),b);const K=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",$=k.get("text-size");for(const re of a.features){const ge=k.get("text-font").evaluate(re,{},b).join(","),Me=$.evaluate(re,{},b),He=V.layoutTextSize.evaluate(re,{},b),Te=(V.layoutIconSize.evaluate(re,{},b),{horizontal:{},vertical:void 0}),Ge=re.text;let qe,We=[0,0];if(Ge){const Lt=Ge.toString(),$t=k.get("text-letter-spacing").evaluate(re,{},b)*jr,Bt=k.get("text-line-height").evaluate(re,{},b)*jr,Ht=iI(Lt)?$t:0,Vt=k.get("text-anchor").evaluate(re,{},b),Kt=k.get("text-variable-anchor");if(!Kt){const di=k.get("text-radial-offset").evaluate(re,{},b);We=di?FS(Vt,[di*jr,jI]):k.get("text-offset").evaluate(re,{},b).map(Oi=>Oi*jr)}let ii=K?"center":k.get("text-justify").evaluate(re,{},b);const Rt=k.get("symbol-placement")==="point",hi=Rt?k.get("text-max-width").evaluate(re,{},b)*jr:1/0,Ci=di=>{a.allowVerticalPlacement&&Pg(Lt)&&(Te.vertical=VI(Ge,s,l,A,ge,hi,Bt,Vt,di,Ht,We,bo.vertical,!0,He,Me))};if(!K&&Kt){const di=ii==="auto"?Kt.map(ri=>qI(ri)):[ii];let Oi=!1;for(let ri=0;ri<di.length;ri++){const Si=di[ri];if(!Te.horizontal[Si])if(Oi)Te.horizontal[Si]=Te.horizontal[0];else{const Gi=VI(Ge,s,l,A,ge,hi,Bt,"center",Si,Ht,We,bo.horizontal,!1,He,Me);Gi&&(Te.horizontal[Si]=Gi,Oi=Gi.positionedLines.length===1)}}Ci("left")}else{if(ii==="auto"&&(ii=qI(Vt)),Rt||k.get("text-writing-mode").indexOf("horizontal")>=0||!Pg(Lt)){const di=VI(Ge,s,l,A,ge,hi,Bt,Vt,ii,Ht,We,bo.horizontal,!1,He,Me);di&&(Te.horizontal[ii]=di)}Ci(Rt?"left":ii)}}let It=!1;if(re.icon&&re.icon.name){const Lt=d[re.icon.name];Lt&&(qe=w4(A[re.icon.name],k.get("icon-offset").evaluate(re,{},b),k.get("icon-anchor").evaluate(re,{},b)),It=Lt.sdf,a.sdfIcons===void 0?a.sdfIcons=Lt.sdf:a.sdfIcons!==Lt.sdf&&nt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Lt.pixelRatio!==a.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const gt=zS(Te.horizontal)||Te.vertical;a.iconsInText||(a.iconsInText=!!gt&&gt.iconsInText),(gt||qe)&&P4(a,re,Te,qe,d,V,He,0,We,It,x,b,T)}_&&a.generateCollisionDebugBuffers(S,a.collisionBoxArray)}function qI(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function P4(a,s,l,d,A,_,x,b,S,T,k,G,V){let K=_.textMaxSize.evaluate(s,{},G);K===void 0&&(K=x);const $=a.layers[0].layout,re=$.get("icon-offset").evaluate(s,{},G),ge=zS(l.horizontal)||l.vertical,Me=V.name==="globe",He=jr,Te=x/He,Ge=a.tilePixelRatio*K/He,qe=(Vt=a.overscaling,a.zoom>18&&Vt>2&&(Vt>>=1),Math.max(Mi/(512*Vt),1)*$.get("symbol-spacing")),We=$.get("text-padding")*a.tilePixelRatio,It=$.get("icon-padding")*a.tilePixelRatio,gt=te($.get("text-max-angle")),Lt=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",$t=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Bt=$.get("symbol-placement"),Ht=qe/2;var Vt;const Kt=$.get("icon-text-fit");let ii;d&&Kt!=="none"&&(a.allowVerticalPlacement&&l.vertical&&(ii=bS(d,l.vertical,Kt,$.get("icon-text-fit-padding"),re,Te)),ge&&(d=bS(d,ge,Kt,$.get("icon-text-fit-padding"),re,Te)));const Rt=(hi,Ci,di)=>{if(Ci.x<0||Ci.x>=Mi||Ci.y<0||Ci.y>=Mi)return;let Oi=null;if(Me){const{x:ri,y:Si,z:Gi}=V.projectTilePoint(Ci.x,Ci.y,di);Oi={anchor:new tc(ri,Si,Gi,0,void 0),up:V.upVector(di,Ci.x,Ci.y)}}(function(ri,Si,Gi,hn,Hi,Ri,On,Vi,Wi,Rn,Nn,zn,Ln,Kn,or,_r,Pn,Er,yr,tr,pn,vr,Un,Ds,xr){const qr=ri.addToLineVertexArray(Si,hn);let Nr,Qs,zr,za,ap,ym,vm,_M=0,yM=0,vM=0,xM=0,cC=-1,uC=-1;const gl={};let IM=sI("");const ed=Gi?Gi.anchor:Si;let hC=0,dC=0;if(Wi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[hC,dC]=Wi.layout.get("text-offset").evaluate(pn,{},xr).map(oo=>oo*jr):(hC=Wi.layout.get("text-radial-offset").evaluate(pn,{},xr)*jr,dC=jI),ri.allowVerticalPlacement&&Hi.vertical){const oo=Hi.vertical;if(or)ym=KI(oo),Vi&&(vm=KI(Vi));else{const ao=Wi.layout.get("text-rotate").evaluate(pn,{},xr)+90;zr=Ly(Rn,ed,Si,Nn,zn,Ln,oo,Kn,ao,_r),Vi&&(za=Ly(Rn,ed,Si,Nn,zn,Ln,Vi,Er,ao))}}if(Ri){const oo=Wi.layout.get("icon-rotate").evaluate(pn,{},xr),ao=Wi.layout.get("icon-text-fit")!=="none",xm=PS(Ri,oo,Un,ao),pC=Vi?PS(Vi,oo,Un,ao):void 0;Qs=Ly(Rn,ed,Si,Nn,zn,Ln,Ri,Er,oo),_M=4*xm.length;const CM=ri.iconSizeData;let td=null;CM.kind==="source"?(td=[ka*Wi.layout.get("icon-size").evaluate(pn,{},xr)],td[0]>uu&&nt(`${ri.layerIds[0]}: Value for "icon-size" is >= ${hm}. Reduce your "icon-size".`)):CM.kind==="composite"&&(td=[ka*vr.compositeIconSizes[0].evaluate(pn,{},xr),ka*vr.compositeIconSizes[1].evaluate(pn,{},xr)],(td[0]>uu||td[1]>uu)&&nt(`${ri.layerIds[0]}: Value for "icon-size" is >= ${hm}. Reduce your "icon-size".`)),ri.addSymbols(ri.icon,xm,td,tr,yr,pn,!1,Gi,Si,qr.lineStartIndex,qr.lineLength,-1,Ds,xr),cC=ri.icon.placedSymbolArray.length-1,pC&&(yM=4*pC.length,ri.addSymbols(ri.icon,pC,td,tr,yr,pn,bo.vertical,Gi,Si,qr.lineStartIndex,qr.lineLength,-1,Ds,xr),uC=ri.icon.placedSymbolArray.length-1)}for(const oo in Hi.horizontal){const ao=Hi.horizontal[oo];Nr||(IM=sI(ao.text),or?ap=KI(ao):Nr=Ly(Rn,ed,Si,Nn,zn,Ln,ao,Kn,Wi.layout.get("text-rotate").evaluate(pn,{},xr),_r));const xm=ao.positionedLines.length===1;if(vM+=NS(ri,Gi,Si,ao,On,Wi,or,pn,_r,qr,Hi.vertical?bo.horizontal:bo.horizontalOnly,xm?Object.keys(Hi.horizontal):[oo],gl,cC,vr,Ds,xr),xm)break}Hi.vertical&&(xM+=NS(ri,Gi,Si,Hi.vertical,On,Wi,or,pn,_r,qr,bo.vertical,["vertical"],gl,uC,vr,Ds,xr));let gu=-1;const fC=(oo,ao)=>oo?Math.max(oo,ao):ao;gu=fC(ap,gu),gu=fC(ym,gu),gu=fC(vm,gu);const cN=gu>-1?1:0;ri.glyphOffsetArray.length>=du.MAX_GLYPHS&&nt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pn.sortKey!==void 0&&ri.addToSortKeyRanges(ri.symbolInstances.length,pn.sortKey),ri.symbolInstances.emplaceBack(ed.x,ed.y,ed.z,Si.x,Si.y,gl.right>=0?gl.right:-1,gl.center>=0?gl.center:-1,gl.left>=0?gl.left:-1,gl.vertical>=0?gl.vertical:-1,cC,uC,IM,Nr!==void 0?Nr:ri.collisionBoxArray.length,Nr!==void 0?Nr+1:ri.collisionBoxArray.length,zr!==void 0?zr:ri.collisionBoxArray.length,zr!==void 0?zr+1:ri.collisionBoxArray.length,Qs!==void 0?Qs:ri.collisionBoxArray.length,Qs!==void 0?Qs+1:ri.collisionBoxArray.length,za||ri.collisionBoxArray.length,za?za+1:ri.collisionBoxArray.length,Nn,vM,xM,_M,yM,cN,0,hC,dC,gu)})(a,Ci,Oi,hi,l,d,A,ii,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,We,Lt,S,0,It,$t,re,s,_,T,k,G)};if(Bt==="line")for(const hi of QS(s.geometry,0,0,Mi,Mi)){const Ci=B4(hi,qe,gt,l.vertical||ge,d,He,Ge,a.overscaling,Mi);for(const di of Ci)ge&&k4(a,ge.text,Ht,di)||Rt(hi,di,G)}else if(Bt==="line-center"){for(const hi of s.geometry)if(hi.length>1){const Ci=b4(hi,gt,l.vertical||ge,d,He,Ge);Ci&&Rt(hi,Ci,G)}}else if(s.type==="Polygon")for(const hi of PI(s.geometry,0)){const Ci=D4(hi,16);Rt(hi[0],new tc(Ci.x,Ci.y,0,0,void 0),G)}else if(s.type==="LineString")for(const hi of s.geometry)Rt(hi,new tc(hi[0].x,hi[0].y,0,0,void 0),G);else if(s.type==="Point")for(const hi of s.geometry)for(const Ci of hi)Rt([Ci],new tc(Ci.x,Ci.y,0,0,void 0),G)}const hm=255,uu=hm*ka;function NS(a,s,l,d,A,_,x,b,S,T,k,G,V,K,$,re,ge){const Me=function(Ge,qe,We,It,gt,Lt,$t,Bt){const Ht=[];if(qe.positionedLines.length===0)return Ht;const Vt=It.layout.get("text-rotate").evaluate(Lt,{})*Math.PI/180,Kt=function(di){const Oi=di[0],ri=di[1],Si=Oi*ri;return Si>0?[Oi,-ri]:Si<0?[-Oi,ri]:Oi===0?[ri,Oi]:[ri,-Oi]}(We);let ii=Math.abs(qe.top-qe.bottom);for(const di of qe.positionedLines)ii-=di.lineOffset;const Rt=qe.positionedLines.length,hi=ii/Rt;let Ci=qe.top-We[1];for(let di=0;di<Rt;++di){const Oi=qe.positionedLines[di];Ci=S4(qe,hi,Ci,di);for(const ri of Oi.positionedGlyphs){if(!ri.rect)continue;const Si=ri.rect||{};let Gi=_S+1,hn=!0,Hi=1,Ri=0;if(ri.imageName){const Un=$t[ri.imageName];if(!Un)continue;if(Un.sdf){nt("SDF images are not supported in formatted text and will be ignored.");continue}hn=!1,Hi=Un.pixelRatio,Gi=Gs/Hi}const On=(gt||Bt)&&ri.vertical,Vi=ri.metrics.advance*ri.scale/2,Wi=ri.metrics,Rn=ri.rect;if(Rn===null)continue;Bt&&qe.verticalizable&&(Ri=ri.imageName?Vi-ri.metrics.width*ri.scale/2:0);const Nn=gt?[ri.x+Vi,ri.y]:[0,0];let zn=[0,0],Ln=[0,0],Kn=!1;gt||(On?(Ln=[ri.x+Vi+Kt[0],ri.y+Kt[1]-Ri],Kn=!0):zn=[ri.x+Vi+We[0],ri.y+We[1]-Ri]);const or=Rn.w*ri.scale/(Hi*(ri.localGlyph?Fa:1)),_r=Rn.h*ri.scale/(Hi*(ri.localGlyph?Fa:1));let Pn,Er,yr,tr;if(On){const Un=ri.y-Ci,Ds=new W(-Vi,Vi-Un),xr=-Math.PI/2,qr=new W(...Ln);Pn=new W(-Vi+zn[0],zn[1]),Pn._rotateAround(xr,Ds)._add(qr),Pn.x+=-Un+Vi,Pn.y-=(Wi.left-Gi)*ri.scale;const Nr=ri.imageName?Wi.advance*ri.scale:jr*ri.scale,Qs=String.fromCharCode(ri.glyph);c4(Qs)?Pn.x+=(1-Gi)*ri.scale:u4(Qs)?Pn.x+=Nr-Wi.height*ri.scale+(-Gi-1)*ri.scale:Pn.x+=ri.imageName||Wi.width+2*Gi===Rn.w&&Wi.height+2*Gi===Rn.h?(Nr-_r)/2:(Nr-(Wi.height+2*Gi)*ri.scale)/2,Er=new W(Pn.x,Pn.y-or),yr=new W(Pn.x+_r,Pn.y),tr=new W(Pn.x+_r,Pn.y-or)}else{const Un=(Wi.left-Gi)*ri.scale-Vi+zn[0],Ds=(-Wi.top-Gi)*ri.scale+zn[1],xr=Un+or,qr=Ds+_r;Pn=new W(Un,Ds),Er=new W(xr,Ds),yr=new W(Un,qr),tr=new W(xr,qr)}if(Vt){let Un;Un=gt?new W(0,0):Kn?new W(Kt[0],Kt[1]):new W(We[0],We[1]),Pn._rotateAround(Vt,Un),Er._rotateAround(Vt,Un),yr._rotateAround(Vt,Un),tr._rotateAround(Vt,Un)}const pn=new W(0,0),vr=new W(0,0);Ht.push({tl:Pn,tr:Er,bl:yr,br:tr,tex:Si,writingMode:qe.writingMode,glyphOffset:Nn,sectionIndex:ri.sectionIndex,isSDF:hn,pixelOffsetTL:pn,pixelOffsetBR:vr,minFontScaleX:0,minFontScaleY:0})}}return Ht}(0,d,S,_,x,b,A,a.allowVerticalPlacement),He=a.textSizeData;let Te=null;He.kind==="source"?(Te=[ka*_.layout.get("text-size").evaluate(b,{},ge)],Te[0]>uu&&nt(`${a.layerIds[0]}: Value for "text-size" is >= ${hm}. Reduce your "text-size".`)):He.kind==="composite"&&(Te=[ka*$.compositeTextSizes[0].evaluate(b,{},ge),ka*$.compositeTextSizes[1].evaluate(b,{},ge)],(Te[0]>uu||Te[1]>uu)&&nt(`${a.layerIds[0]}: Value for "text-size" is >= ${hm}. Reduce your "text-size".`)),a.addSymbols(a.text,Me,Te,S,x,b,k,s,l,T.lineStartIndex,T.lineLength,K,re,ge);for(const Ge of G)V[Ge]=a.text.placedSymbolArray.length-1;return 4*Me.length}function zS(a){for(const s in a)return a[s];return null}function Ly(a,s,l,d,A,_,x,b,S,T){let k=x.top,G=x.bottom,V=x.left,K=x.right;const $=x.collisionPadding;if($&&(V-=$[0],k-=$[1],K+=$[2],G+=$[3]),S){const re=new W(V,k),ge=new W(K,k),Me=new W(V,G),He=new W(K,G),Te=te(S);let Ge=new W(0,0);T&&(Ge=new W(T[0],T[1])),re._rotateAround(Te,Ge),ge._rotateAround(Te,Ge),Me._rotateAround(Te,Ge),He._rotateAround(Te,Ge),V=Math.min(re.x,ge.x,Me.x,He.x),K=Math.max(re.x,ge.x,Me.x,He.x),k=Math.min(re.y,ge.y,Me.y,He.y),G=Math.max(re.y,ge.y,Me.y,He.y)}return a.emplaceBack(s.x,s.y,s.z,l.x,l.y,V,k,K,G,b,d,A,_),a.length-1}function KI(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const s=a.bottom-a.top;return s>0?Math.max(10,s):null}function k4(a,s,l,d){const A=a.compareText;if(s in A){const _=A[s];for(let x=_.length-1;x>=0;x--)if(d.dist(_[x])<l)return!0}else A[s]=[];return A[s].push(d),!1}function US(a,s){const l=a.fovAboveCenter,d=a.elevation?a.elevation.getMinElevationBelowMSL()*s:0,A=(a._camera.position[2]*a.worldSize-d)/Math.cos(a._pitch),_=Math.sin(l)*A/Math.sin(Math.max(Math.PI/2-a._pitch-l,.01)),x=Math.sin(a._pitch)*_+A;return Math.min(1.01*x,A*(1/a._horizonShift))}function Zh(a,s){if(!s.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:s};const l=Math.pow(2,-a.z),d=a.x*l,A=(a.x+1)*l,_=a.y*l,x=(a.y+1)*l,b=wo(d),S=wo(A),T=os(_),k=os(x),G=s.project(b,T),V=s.project(S,T),K=s.project(S,k),$=s.project(b,k);let re=Math.min(G.x,V.x,K.x,$.x),ge=Math.min(G.y,V.y,K.y,$.y),Me=Math.max(G.x,V.x,K.x,$.x),He=Math.max(G.y,V.y,K.y,$.y);const Te=l/16;function Ge(We,It,gt,Lt,$t,Bt){const Ht=(gt+$t)/2,Vt=(Lt+Bt)/2,Kt=s.project(wo(Ht),os(Vt)),ii=Math.max(0,re-Kt.x,ge-Kt.y,Kt.x-Me,Kt.y-He);re=Math.min(re,Kt.x),Me=Math.max(Me,Kt.x),ge=Math.min(ge,Kt.y),He=Math.max(He,Kt.y),ii>Te&&(Ge(We,Kt,gt,Lt,Ht,Vt),Ge(Kt,It,Ht,Vt,$t,Bt))}Ge(G,V,d,_,A,_),Ge(V,K,A,_,A,x),Ge(K,$,A,x,d,x),Ge($,G,d,x,d,_),re-=Te,ge-=Te,Me+=Te,He+=Te;const qe=1/Math.max(Me-re,He-ge);return{scale:qe,x:re*qe,y:ge*qe,x2:Me*qe,y2:He*qe,projection:s}}const F4=Ra(new Float32Array(16));class hu{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,l){return{x:0,y:0,z:0}}unproject(s,l){return new Qn(0,0)}projectTilePoint(s,l,d){return{x:s,y:l,z:0}}locationPoint(s,l,d=!0){return s._coordinatePoint(s.locationCoordinate(l),d)}pixelsPerMeter(s,l){return Pa(1,s)*l}pixelSpaceConversion(s,l,d){return 1}farthestPixelDistance(s){return US(s,s.pixelsPerMeter)}pointCoordinate(s,l,d,A){const _=s.horizonLineFromTop(!1),x=new W(l,Math.max(_,d));return s.rayIntersectionCoordinate(s.pointRayIntersection(x,A))}pointCoordinate3D(s,l,d){const A=new W(l,d);if(s.elevation)return s.elevation.pointCoordinate(A);{const _=this.pointCoordinate(s,A.x,A.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(s,l){if(s.elevation)return!this.pointCoordinate3D(s,l.x,l.y);const d=s.horizonLineFromTop();return l.y<d}createInversionMatrix(s,l){return F4}createTileMatrix(s,l,d){let A,_,x;const b=d.canonical,S=Ra(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=Zh(b,this);A=1,_=T.x+d.wrap*T.scale,x=T.y,Wh(S,S,[A/T.scale,A/T.scale,s.pixelsPerMeter/l])}else A=l/s.zoomScale(b.z),_=(b.x+Math.pow(2,b.z)*d.wrap)*A,x=b.y*A;return Gg(S,S,[_,x,0]),Wh(S,S,[A/Mi,A/Mi,1]),S}upVector(s,l,d){return[0,0,1]}upVectorScale(s,l,d){return{metersToTile:1}}}class N4 extends hu{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[l,d]=this.parallels=s.parallels||[29.5,45.5],A=Math.sin(te(l));this.n=(A+Math.sin(te(d)))/2,this.c=1+A*(2*this.n-A),this.r0=Math.sqrt(this.c)/this.n}project(s,l){const{n:d,c:A,r0:_}=this,x=te(s-this.center[0]),b=te(l),S=Math.sqrt(A-2*d*Math.sin(b))/d;return{x:S*Math.sin(x*d),y:S*Math.cos(x*d)-_,z:0}}unproject(s,l){const{n:d,c:A,r0:_}=this,x=_+l;let b=Math.atan2(s,Math.abs(x))*Math.sign(x);x*d<0&&(b-=Math.PI*Math.sign(s)*Math.sign(x));const S=te(this.center[0])*d;b=oe(b,-Math.PI-S,Math.PI-S);const T=ye(ce(b/d)+this.center[0],-180,180),k=Math.asin(ye((A-(s*s+x*x)*d*d)/(2*d),-1,1)),G=ye(ce(k),-as,as);return new Qn(T,G)}}const dm=1.340264,fm=-.081106,pm=893e-6,Am=.003796,Py=Math.sqrt(3)/2;class z4 extends hu{project(s,l){l=l/180*Math.PI,s=s/180*Math.PI;const d=Math.asin(Py*Math.sin(l)),A=d*d,_=A*A*A;return{x:.5*(s*Math.cos(d)/(Py*(dm+3*fm*A+_*(7*pm+9*Am*A)))/Math.PI+.5),y:1-.5*(d*(dm+fm*A+_*(pm+Am*A))/Math.PI+1),z:0}}unproject(s,l){s=(2*s-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,A=d*d,_=A*A*A;for(let k,G,V,K=0;K<12&&(G=d*(dm+fm*A+_*(pm+Am*A))-l,V=dm+3*fm*A+_*(7*pm+9*Am*A),k=G/V,d=ye(d-k,-Math.PI/3,Math.PI/3),A=d*d,_=A*A*A,!(Math.abs(k)<1e-12));++K);const x=Py*s*(dm+3*fm*A+_*(7*pm+9*Am*A))/Math.cos(d),b=Math.asin(Math.sin(d)/Py),S=ye(180*x/Math.PI,-180,180),T=ye(180*b/Math.PI,-as,as);return new Qn(S,T)}}class U4 extends hu{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,l){return{x:.5+s/360,y:.5-l/360,z:0}}unproject(s,l){const d=360*(s-.5),A=ye(360*(.5-l),-as,as);return new Qn(d,A)}}const sp=Math.PI/2;function ky(a){return Math.tan((sp+a)/2)}class O4 extends hu{constructor(s){super(s),this.center=s.center||[0,30];const[l,d]=this.parallels=s.parallels||[30,30];let A=te(l),_=te(d);this.southernCenter=A+_<0,this.southernCenter&&(A=-A,_=-_);const x=Math.cos(A),b=ky(A);this.n=A===_?Math.sin(A):Math.log(x/Math.cos(_))/Math.log(ky(_)/b),this.f=x*Math.pow(ky(A),this.n)/this.n}project(s,l){l=te(l),this.southernCenter&&(l=-l),s=te(s-this.center[0]);const d=1e-6,{n:A,f:_}=this;_>0?l<-sp+d&&(l=-sp+d):l>sp-d&&(l=sp-d);const x=_/Math.pow(ky(l),A);let b=x*Math.sin(A*s),S=_-x*Math.cos(A*s);return b=.5*(b/Math.PI+.5),S=.5*(S/Math.PI+.5),{x:b,y:this.southernCenter?S:1-S,z:0}}unproject(s,l){s=(2*s-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:d,f:A}=this,_=A-l,x=Math.sign(_),b=Math.sign(d)*Math.sqrt(s*s+_*_);let S=Math.atan2(s,Math.abs(_))*x;_*d<0&&(S-=Math.PI*Math.sign(s)*x);const T=ye(ce(S/d)+this.center[0],-180,180),k=ye(ce(2*Math.atan(Math.pow(A/b,1/d))-sp),-as,as);return new Qn(T,this.southernCenter?-k:k)}}class OS extends hu{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,l){return{x:hl(s),y:dl(l),z:0}}unproject(s,l){const d=wo(s),A=os(l);return new Qn(d,A)}}const GS=te(as);class G4 extends hu{project(s,l){const d=(l=te(l))*l,A=d*d;return{x:.5*((s=te(s))*(.8707-.131979*d+A*(A*(.003971*d-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+A*(.028874*d-.044475-.005916*A)))/Math.PI+1),z:0}}unproject(s,l){s=(2*s-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,A=25,_=0,x=d*d;do{x=d*d;const T=x*x;_=(d*(1.007226+x*(.015085+T*(.028874*x-.044475-.005916*T)))-l)/(1.007226+x*(.045255+T*(.259866*x-.311325-.005916*11*T))),d=ye(d-_,-GS,GS)}while(Math.abs(_)>1e-6&&--A>0);x=d*d;const b=ye(ce(s/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),S=ce(d);return new Qn(b,S)}}const HS=te(as);class H4 extends hu{project(s,l){l=te(l),s=te(s);const d=Math.cos(l),A=2/Math.PI,_=Math.acos(d*Math.cos(s/2)),x=Math.sin(_)/_,b=.5*(s*A+2*d*Math.sin(s/2)/x)||0,S=.5*(l+Math.sin(l)/x)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(s,l){let d=s=(2*s-.5)*Math.PI,A=l=(2*(1-l)-1)*Math.PI,_=25;const x=1e-6;let b=0,S=0;do{const T=Math.cos(A),k=Math.sin(A),G=2*k*T,V=k*k,K=T*T,$=Math.cos(d/2),re=Math.sin(d/2),ge=2*$*re,Me=re*re,He=1-K*$*$,Te=He?1/He:0,Ge=He?Math.acos(T*$)*Math.sqrt(1/He):0,qe=.5*(2*Ge*T*re+2*d/Math.PI)-s,We=.5*(Ge*k+A)-l,It=.5*Te*(K*Me+Ge*T*$*V)+1/Math.PI,gt=Te*(ge*G/4-Ge*k*re),Lt=.125*Te*(G*re-Ge*k*K*ge),$t=.5*Te*(V*$+Ge*Me*T)+.5,Bt=gt*Lt-$t*It;b=(We*gt-qe*$t)/Bt,S=(qe*Lt-We*It)/Bt,d=ye(d-b,-Math.PI,Math.PI),A=ye(A-S,-HS,HS)}while((Math.abs(b)>x||Math.abs(S)>x)&&--_>0);return new Qn(ce(d),ce(A))}}class VS extends hu{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(te(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,l){const{scale:d,cosPhi:A}=this;return{x:te(s)*A*d+.5,y:-Math.sin(te(l))/A*d+.5,z:0}}unproject(s,l){const{scale:d,cosPhi:A}=this,_=-(l-.5)/d,x=ye(ce((s-.5)/d)/A,-180,180),b=Math.asin(ye(_*A,-1,1)),S=ye(ce(b),-as,as);return new Qn(x,S)}}class V4 extends OS{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,l,d){const A=Jg(s,l,d);return dr(A,A,Xg(ul(d))),{x:A[0],y:A[1],z:A[2]}}locationPoint(s,l){const d=Vf(l.lat,l.lng),A=Ss([],d),_=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(l),s._centerAltitude):s._centerAltitude;Yg(d,d,A,Pa(1,0)*Mi*_);const x=Ra(new Float64Array(16));return Vh(x,s.pixelMatrix,s.globeMatrix),dr(d,d,x),new W(d[0],d[1])}pixelsPerMeter(s,l){return Pa(1,0)*l}pixelSpaceConversion(s,l,d){const A=Pa(1,s)*l,_=an(Pa(1,45)*l,A,d);return this.pixelsPerMeter(s,l)/_}createTileMatrix(s,l,d){const A=yI(ul(d.canonical));return Vh(new Float64Array(16),s.globeMatrix,A)}createInversionMatrix(s,l){const{center:d}=s,A=Xg(ul(l));return uy(A,A,te(d.lng)),cI(A,A,te(d.lat)),Wh(A,A,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(A)}pointCoordinate(s,l,d,A){return m2(s,l,d,!0)||new Yf(0,0)}pointCoordinate3D(s,l,d){const A=this.pointCoordinate(s,l,d,0);return[A.x,A.y,A.z]}isPointAboveHorizon(s,l){return!m2(s,l.x,l.y,!1)}farthestPixelDistance(s){const l=function(A,_){const x=A.cameraToCenterDistance,b=A._centerAltitude*_,S=A._camera,T=A._camera.forward(),k=Xl([],Eo([],T,-x),[0,0,b]),G=A.worldSize/(2*Math.PI),V=[0,0,-G],K=A.width/A.height,$=Math.tan(A.fovAboveCenter),re=Eo([],S.up(),$),ge=Eo([],S.right(),$*K),Me=Ss([],Xl([],Xl([],T,re),ge)),He=[];let Te;if(new fI(k,Me).closestPointOnSphere(V,G,He)){const Ge=Xl([],He,V),qe=La([],Ge,k);Te=Math.cos(A.fovAboveCenter)*Hg(qe)}else{const Ge=La([],k,V),qe=La([],V,k);Ss(qe,qe);const We=Hg(Ge)-G;Te=Math.sqrt(We*(We+2*G));const It=Math.acos(Te/(G+We))-Math.acos(jo(T,qe));Te*=Math.cos(It)}return 1.01*Te}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),d=Wf(s.zoom);if(d>0){const A=US(s,Pa(1,s.center.lat)*s.worldSize),_=s.worldSize/(2*Math.PI),x=Math.max(s.width,s.height)/s.worldSize*Math.PI;return an(l,A+_*(1-Math.cos(x)),Math.pow(d,10))}return l}upVector(s,l,d){return Jg(l,d,s,1)}upVectorScale(s){return{metersToTile:hy(fy(ul(s)))}}}function WS(a){const s=a.parallels,l=!!s&&Math.abs(s[0]+s[1])<.01;switch(a.name){case"mercator":return new OS(a);case"equirectangular":return new U4(a);case"naturalEarth":return new G4(a);case"equalEarth":return new z4(a);case"winkelTripel":return new H4(a);case"albers":return l?new VS(a):new N4(a);case"lambertConformalConic":return l?new VS(a):new O4(a);case"globe":return new V4(a)}throw new Error(`Invalid projection name: ${a.name}`)}const W4=Cy.types,Y4=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fy(a,s,l,d,A,_,x,b,S,T,k,G,V){const K=b?Math.min(uu,Math.round(b[0])):0,$=b?Math.min(uu,Math.round(b[1])):0;a.emplaceBack(s,l,Math.round(32*d),Math.round(32*A),_,x,(K<<1)+(S?1:0),$,16*T,16*k,256*G,256*V)}function Ny(a,s,l,d,A,_,x){a.emplaceBack(s,l,d,A,_,x)}function zy(a,s,l,d,A){a.emplaceBack(s,l,d,A),a.emplaceBack(s,l,d,A),a.emplaceBack(s,l,d,A),a.emplaceBack(s,l,d,A)}function j4(a){for(const s of a.sections)if(rI(s.text))return!0;return!1}class JI{constructor(s){this.layoutVertexArray=new jt,this.indexArray=new wi,this.programConfigurations=s,this.segments=new gr,this.dynamicLayoutVertexArray=new Jt,this.opacityVertexArray=new bi,this.placedSymbolArray=new Ar,this.globeExtVertexArray=new ti}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,l,d,A){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,t4.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,n4.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Y4,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,i4.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||A)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}vi(JI,"SymbolBuffers");class XI{constructor(s,l,d){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new d,this.segments=new gr,this.collisionVertexArray=new en,this.collisionVertexArrayExt=new Ji}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,r4.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,s4.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}vi(XI,"CollisionBuffers");class du{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(x=>x.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ra([]),this.placementViewportMatrix=Ra([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zI(this.zoom,l["text-size"]),this.iconSizeData=zI(this.zoom,l["icon-size"]);const d=this.layers[0].layout,A=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(x=>bo[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new JI(new Hh(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new JI(new Hh(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Bs,this.lineVertexArray=new zf,this.symbolInstances=new Hn}calculateGlyphDependencies(s,l,d,A,_){for(let x=0;x<s.length;x++)if(l[s.charCodeAt(x)]=!0,A&&_){const b=lm[s.charAt(x)];b&&(l[b.charCodeAt(0)]=!0)}}populate(s,l,d,A){const _=this.layers[0],x=_.layout,b=this.projection.name==="globe",S=x.get("text-font"),T=x.get("text-field"),k=x.get("icon-image"),G=(T.value.kind!=="constant"||T.value.value instanceof bs&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),V=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,K=x.get("symbol-sort-key");if(this.features=[],!G&&!V)return;const $=l.iconDependencies,re=l.glyphDependencies,ge=l.availableImages,Me=new U(this.zoom);for(const{feature:He,id:Te,index:Ge,sourceLayerIndex:qe}of s){const We=_._featureFilter.needGeometry,It=Kh(He,We);if(!_._featureFilter.filter(Me,It,d))continue;if(We||(It.geometry=Zl(He,d,A)),b&&He.type!==1&&d.z<=5){const Bt=It.geometry,Ht=.98078528056,Vt=(Kt,ii)=>jo(Jg(Kt.x,Kt.y,d,1),Jg(ii.x,ii.y,d,1))<Ht;for(let Kt=0;Kt<Bt.length;Kt++)Bt[Kt]=n5(Bt[Kt],Vt)}let gt,Lt;if(G){const Bt=_.getValueAndResolveTokens("text-field",It,d,ge),Ht=bs.factory(Bt);j4(Ht)&&(this.hasRTLText=!0),(!this.hasRTLText||B()==="unavailable"||this.hasRTLText&&L.isParsed())&&(gt=l4(Ht,_,It))}if(V){const Bt=_.getValueAndResolveTokens("icon-image",It,d,ge);Lt=Bt instanceof eo?Bt:eo.fromString(Bt)}if(!gt&&!Lt)continue;const $t=this.sortFeaturesByKey?K.evaluate(It,{},d):void 0;if(this.features.push({id:Te,text:gt,icon:Lt,index:Ge,sourceLayerIndex:qe,geometry:It.geometry,properties:He.properties,type:W4[He.type],sortKey:$t}),Lt&&($[Lt.name]=!0),gt){const Bt=S.evaluate(It,{},d).join(","),Ht=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(bo.vertical)>=0;for(const Vt of gt.sections)if(Vt.image)$[Vt.image.name]=!0;else{const Kt=Pg(gt.toString()),ii=Vt.fontStack||Bt,Rt=re[ii]=re[ii]||{};this.calculateGlyphDependencies(Vt.text,Rt,Ht,this.allowVerticalPlacement,Kt)}}}x.get("symbol-placement")==="line"&&(this.features=function(He){const Te={},Ge={},qe=[];let We=0;function It(Bt){qe.push(He[Bt]),We++}function gt(Bt,Ht,Vt){const Kt=Ge[Bt];return delete Ge[Bt],Ge[Ht]=Kt,qe[Kt].geometry[0].pop(),qe[Kt].geometry[0]=qe[Kt].geometry[0].concat(Vt[0]),Kt}function Lt(Bt,Ht,Vt){const Kt=Te[Ht];return delete Te[Ht],Te[Bt]=Kt,qe[Kt].geometry[0].shift(),qe[Kt].geometry[0]=Vt[0].concat(qe[Kt].geometry[0]),Kt}function $t(Bt,Ht,Vt){const Kt=Vt?Ht[0][Ht[0].length-1]:Ht[0][0];return`${Bt}:${Kt.x}:${Kt.y}`}for(let Bt=0;Bt<He.length;Bt++){const Ht=He[Bt],Vt=Ht.geometry,Kt=Ht.text?Ht.text.toString():null;if(!Kt){It(Bt);continue}const ii=$t(Kt,Vt),Rt=$t(Kt,Vt,!0);if(ii in Ge&&Rt in Te&&Ge[ii]!==Te[Rt]){const hi=Lt(ii,Rt,Vt),Ci=gt(ii,Rt,qe[hi].geometry);delete Te[ii],delete Ge[Rt],Ge[$t(Kt,qe[Ci].geometry,!0)]=Ci,qe[hi].geometry=null}else ii in Ge?gt(ii,Rt,Vt):Rt in Te?Lt(ii,Rt,Vt):(It(Bt),Te[ii]=We-1,Ge[Rt]=We-1)}return qe.filter(Bt=>Bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((He,Te)=>He.sortKey-Te.sortKey)}update(s,l,d,A){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,d,A),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,d,A))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=WS(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,l){const d=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:A,y:_}of l)this.lineVertexArray.emplaceBack(A,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,l,d,A,_,x,b,S,T,k,G,V,K,$){const re=s.indexArray,ge=s.layoutVertexArray,Me=s.globeExtVertexArray,He=s.segments.prepareSegment(4*l.length,ge,re,this.canOverlap?x.sortKey:void 0),Te=this.glyphOffsetArray.length,Ge=He.vertexLength,qe=this.allowVerticalPlacement&&b===bo.vertical?Math.PI/2:0,We=x.text&&x.text.sections;for(let gt=0;gt<l.length;gt++){const{tl:Lt,tr:$t,bl:Bt,br:Ht,tex:Vt,pixelOffsetTL:Kt,pixelOffsetBR:ii,minFontScaleX:Rt,minFontScaleY:hi,glyphOffset:Ci,isSDF:di,sectionIndex:Oi}=l[gt],ri=He.vertexLength,Si=Ci[1];if(Fy(ge,T.x,T.y,Lt.x,Si+Lt.y,Vt.x,Vt.y,d,di,Kt.x,Kt.y,Rt,hi),Fy(ge,T.x,T.y,$t.x,Si+$t.y,Vt.x+Vt.w,Vt.y,d,di,ii.x,Kt.y,Rt,hi),Fy(ge,T.x,T.y,Bt.x,Si+Bt.y,Vt.x,Vt.y+Vt.h,d,di,Kt.x,ii.y,Rt,hi),Fy(ge,T.x,T.y,Ht.x,Si+Ht.y,Vt.x+Vt.w,Vt.y+Vt.h,d,di,ii.x,ii.y,Rt,hi),S){const{x:Gi,y:hn,z:Hi}=S.anchor,[Ri,On,Vi]=S.up;Ny(Me,Gi,hn,Hi,Ri,On,Vi),Ny(Me,Gi,hn,Hi,Ri,On,Vi),Ny(Me,Gi,hn,Hi,Ri,On,Vi),Ny(Me,Gi,hn,Hi,Ri,On,Vi),zy(s.dynamicLayoutVertexArray,Gi,hn,Hi,qe)}else zy(s.dynamicLayoutVertexArray,T.x,T.y,T.z,qe);re.emplaceBack(ri,ri+1,ri+2),re.emplaceBack(ri+1,ri+2,ri+3),He.vertexLength+=4,He.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ci[0]),gt!==l.length-1&&Oi===l[gt+1].sectionIndex||s.programConfigurations.populatePaintArrays(ge.length,x,x.index,{},K,$,We&&We[Oi])}const It=S?S.anchor:T;s.placedSymbolArray.emplaceBack(It.x,It.y,It.z,T.x,T.y,Te,this.glyphOffsetArray.length-Te,Ge,k,G,T.segment,d?d[0]:0,d?d[1]:0,A[0],A[1],b,0,!1,0,V,0)}_commitLayoutVertex(s,l,d,A,_,x,b){s.emplaceBack(l,d,A,_,x,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(s,l,d,A,_,x,b){const S=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),T=S.vertexLength,k=b.tileAnchorX,G=b.tileAnchorY;for(let K=0;K<4;K++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(l,-s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(l,s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(l,s.padding,s.padding),d.collisionVertexArrayExt.emplaceBack(l,-s.padding,s.padding),this._commitLayoutVertex(d.layoutVertexArray,A,_,x,k,G,new W(s.x1,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,A,_,x,k,G,new W(s.x2,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,A,_,x,k,G,new W(s.x2,s.y2)),this._commitLayoutVertex(d.layoutVertexArray,A,_,x,k,G,new W(s.x1,s.y2)),S.vertexLength+=4;const V=d.indexArray;V.emplaceBack(T,T+1),V.emplaceBack(T+1,T+2),V.emplaceBack(T+2,T+3),V.emplaceBack(T+3,T),S.primitiveLength+=4}_addTextDebugCollisionBoxes(s,l,d,A,_,x){for(let b=A;b<_;b++){const S=d.get(b),T=this.getSymbolInstanceTextSize(s,x,l,b);this._addCollisionDebugVertices(S,T,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(s,l,d,A,_,x){for(let b=A;b<_;b++){const S=d.get(b),T=this.getSymbolInstanceIconSize(s,l,x.placedIconSymbolIndex);this._addCollisionDebugVertices(S,T,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,x)}}generateCollisionDebugBuffers(s,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new XI(Ii,uS.members,Fr),this.iconCollisionBox=new XI(Ii,uS.members,Fr);const d=Xf(this.iconSizeData,s),A=Xf(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const x=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(A,s,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(A,s,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,s,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,s,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(s,l,d,A){const _=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:A),x=By(this.textSizeData,s,_)/jr;return this.tilePixelRatio*x}getSymbolInstanceIconSize(s,l,d){const A=this.icon.placedSymbolArray.get(d),_=By(this.iconSizeData,s,A);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(s,l,d){s.emplaceBack(l,-d,-d),s.emplaceBack(l,d,-d),s.emplaceBack(l,d,d),s.emplaceBack(l,-d,d)}_updateTextDebugCollisionBoxes(s,l,d,A,_,x){for(let b=A;b<_;b++){const S=d.get(b),T=this.getSymbolInstanceTextSize(s,x,l,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,S.padding)}}_updateIconDebugCollisionBoxes(s,l,d,A,_,x){for(let b=A;b<_;b++){const S=d.get(b),T=this.getSymbolInstanceIconSize(s,l,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,S.padding)}}updateCollisionDebugBuffers(s,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Xf(this.iconSizeData,s),A=Xf(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const x=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(A,s,l,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(A,s,l,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(d,s,l,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,s,l,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,l,d,A,_,x,b,S,T){const k={};if(l<d){const{x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge,featureIndex:qe}=s.get(l);k.textBox={x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge},k.textFeatureIndex=qe}if(A<_){const{x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge,featureIndex:qe}=s.get(A);k.verticalTextBox={x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge},k.verticalTextFeatureIndex=qe}if(x<b){const{x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge,featureIndex:qe}=s.get(x);k.iconBox={x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge},k.iconFeatureIndex=qe}if(S<T){const{x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge,featureIndex:qe}=s.get(S);k.verticalIconBox={x1:G,y1:V,x2:K,y2:$,padding:re,projectedAnchorX:ge,projectedAnchorY:Me,projectedAnchorZ:He,tileAnchorX:Te,tileAnchorY:Ge},k.verticalIconFeatureIndex=qe}return k}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,l){const d=s.placedSymbolArray.get(l),A=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<A;_+=4)s.indexArray.emplaceBack(_,_+1,_+2),s.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(s),d=Math.cos(s),A=[],_=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const S=this.symbolInstances.get(b);A.push(0|Math.round(l*S.tileAnchorX+d*S.tileAnchorY)),_.push(S.featureIndex)}return x.sort((b,S)=>A[b]-A[S]||_[S]-_[b]),x}addToSortKeyRanges(s,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:T}=d;A>=0&&this.addIndicesForPlacedSymbol(this.text,A),_>=0&&_!==A&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&x!==_&&x!==A&&this.addIndicesForPlacedSymbol(this.text,x),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}vi(du,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),du.MAX_GLYPHS=65535,du.addDynamicAttributes=zy;const q4=new ke({"symbol-placement":new ne(Mt.layout_symbol["symbol-placement"]),"symbol-spacing":new ne(Mt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ne(Mt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ve(Mt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ne(Mt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ne(Mt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ne(Mt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ne(Mt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ne(Mt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ve(Mt.layout_symbol["icon-size"]),"icon-text-fit":new ne(Mt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ne(Mt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ve(Mt.layout_symbol["icon-image"]),"icon-rotate":new ve(Mt.layout_symbol["icon-rotate"]),"icon-padding":new ne(Mt.layout_symbol["icon-padding"]),"icon-keep-upright":new ne(Mt.layout_symbol["icon-keep-upright"]),"icon-offset":new ve(Mt.layout_symbol["icon-offset"]),"icon-anchor":new ve(Mt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ne(Mt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ne(Mt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ne(Mt.layout_symbol["text-rotation-alignment"]),"text-field":new ve(Mt.layout_symbol["text-field"]),"text-font":new ve(Mt.layout_symbol["text-font"]),"text-size":new ve(Mt.layout_symbol["text-size"]),"text-max-width":new ve(Mt.layout_symbol["text-max-width"]),"text-line-height":new ve(Mt.layout_symbol["text-line-height"]),"text-letter-spacing":new ve(Mt.layout_symbol["text-letter-spacing"]),"text-justify":new ve(Mt.layout_symbol["text-justify"]),"text-radial-offset":new ve(Mt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ne(Mt.layout_symbol["text-variable-anchor"]),"text-anchor":new ve(Mt.layout_symbol["text-anchor"]),"text-max-angle":new ne(Mt.layout_symbol["text-max-angle"]),"text-writing-mode":new ne(Mt.layout_symbol["text-writing-mode"]),"text-rotate":new ve(Mt.layout_symbol["text-rotate"]),"text-padding":new ne(Mt.layout_symbol["text-padding"]),"text-keep-upright":new ne(Mt.layout_symbol["text-keep-upright"]),"text-transform":new ve(Mt.layout_symbol["text-transform"]),"text-offset":new ve(Mt.layout_symbol["text-offset"]),"text-allow-overlap":new ne(Mt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ne(Mt.layout_symbol["text-ignore-placement"]),"text-optional":new ne(Mt.layout_symbol["text-optional"])});var ZI={paint:new ke({"icon-opacity":new ve(Mt.paint_symbol["icon-opacity"]),"icon-color":new ve(Mt.paint_symbol["icon-color"]),"icon-halo-color":new ve(Mt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ve(Mt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ve(Mt.paint_symbol["icon-halo-blur"]),"icon-translate":new ne(Mt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ne(Mt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ve(Mt.paint_symbol["text-opacity"]),"text-color":new ve(Mt.paint_symbol["text-color"],{runtimeType:Us,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ve(Mt.paint_symbol["text-halo-color"]),"text-halo-width":new ve(Mt.paint_symbol["text-halo-width"]),"text-halo-blur":new ve(Mt.paint_symbol["text-halo-blur"]),"text-translate":new ne(Mt.paint_symbol["text-translate"]),"text-translate-anchor":new ne(Mt.paint_symbol["text-translate-anchor"])}),layout:q4};class YS{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Gc,this.defaultValue=s}evaluate(s){if(s.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vi(YS,"FormatSectionOverride",{omit:["defaultValue"]});class Uy extends Qa{constructor(s){super(s,ZI)}recalculate(s,l){super.recalculate(s,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const A=[];for(const _ of d)A.indexOf(_)<0&&A.push(_);this.layout._values["text-writing-mode"]=A}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,l,d,A){const _=this.layout.get(s).evaluate(l,{},d,A),x=this._unevaluatedLayout._values[s];return x.isDataDriven()||eu(x.value)||!_?_:function(b,S){return S.replace(/{([^{}]+)}/g,(T,k)=>k in b?String(b[k]):"")}(l.properties,_)}createBucket(s){return new du(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of ZI.paint.overridableProperties){if(!Uy.hasPaintOverride(this.layout,s))continue;const l=this.paint.get(s),d=new YS(l),A=new Df(d,l.property.specification);let _=null;_=l.value.kind==="constant"||l.value.kind==="source"?new Eg("source",A):new Lh("composite",A,l.value.zoomStops,l.value._interpolationType),this.paint._values[s]=new we(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(s,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&Uy.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,l){const d=s.get("text-field"),A=ZI.paint.properties[l];let _=!1;const x=b=>{for(const S of b)if(A.overrides&&A.overrides.hasOverride(S))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof bs)x(d.value.value.sections);else if(d.value.kind==="source"){const b=T=>{_||(T instanceof Ul&&sr(T.value)===mh?x(T.value.sections):T instanceof ol?x(T.sections):T.eachChild(b))},S=d.value;S._styleExpression&&b(S._styleExpression.expression)}return _}getProgramConfiguration(s){return new au(this,s)}}var K4={paint:new ke({"background-color":new ne(Mt.paint_background["background-color"]),"background-pattern":new ne(Mt.paint_background["background-pattern"]),"background-opacity":new ne(Mt.paint_background["background-opacity"])})},J4={paint:new ke({"raster-opacity":new ne(Mt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ne(Mt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ne(Mt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ne(Mt.paint_raster["raster-brightness-max"]),"raster-saturation":new ne(Mt.paint_raster["raster-saturation"]),"raster-contrast":new ne(Mt.paint_raster["raster-contrast"]),"raster-resampling":new ne(Mt.paint_raster["raster-resampling"]),"raster-fade-duration":new ne(Mt.paint_raster["raster-fade-duration"])})};class X4 extends Qa{constructor(s){super(s,{}),this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var Z4={paint:new ke({"sky-type":new ne(Mt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ne(Mt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ne(Mt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ne(Mt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ne(Mt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Pe(Mt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ne(Mt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ne(Mt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ne(Mt.paint_sky["sky-opacity"])})};function $I(a,s,l){const d=[0,0,1],A=h2([]);return f2(A,A,l?-te(a)+Math.PI:te(a)),d2(A,A,-te(s)),a2(d,d,A),Ss(d,d)}const $4={circle:class extends Qa{constructor(a){super(a,u5)}createBucket(a){return new wI(a)}queryRadius(a){const s=a;return jf("circle-radius",this,s)+jf("circle-stroke-width",this,s)+gy(this.paint.get("circle-translate"))}queryIntersectsFeature(a,s,l,d,A,_,x,b){const S=P2(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l);return k2(a,d,_,x,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,T)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new au(this,a)}},heatmap:class extends Qa{createBucket(a){return new N2(a)}constructor(a){super(a,p5),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=MI({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return jf("heatmap-radius",this,a)}queryIntersectsFeature(a,s,l,d,A,_,x,b){const S=this.paint.get("heatmap-radius").evaluate(s,l);return k2(a,d,_,x,b,!0,!0,new W(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new au(this,a)}},hillshade:class extends Qa{constructor(a){super(a,A5)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Qa{constructor(a){super(a,D5)}getProgramIds(){const a=this.paint.get("fill-pattern"),s=a&&a.constantOr(1),l=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new au(this,a)}recalculate(a,s){super.recalculate(a,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new xy(a)}queryRadius(){return gy(this.paint.get("fill-translate"))}queryIntersectsFeature(a,s,l,d,A,_){return!a.queryGeometry.isAboveHorizon&&T2(L2(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Qa{constructor(a){super(a,j5)}createBucket(a){return new sm(a)}queryRadius(){return gy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new au(this,a)}queryIntersectsFeature(a,s,l,d,A,_,x,b,S){const T=P2(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(s,l),G=this.paint.get("fill-extrusion-base").evaluate(s,l),V=[0,0],K=b&&_.elevation,$=_.elevation?_.elevation.exaggeration():1,re=a.tile.getBucket(this);if(K&&re instanceof sm){const Ge=re.centroidVertexArray,qe=S+1;qe<Ge.length&&(V[0]=Ge.geta_centroid_pos0(qe),V[1]=Ge.geta_centroid_pos1(qe))}if(V[0]===0&&V[1]===1)return!1;_.projection.name==="globe"&&(d=iS([d],[new W(0,0),new W(Mi,Mi)],a.tileID.canonical).map(Ge=>Ge.polygon).flat());const ge=K?b:null,[Me,He]=function(Ge,qe,We,It,gt,Lt,$t,Bt,Ht,Vt,Kt){return Ge.projection.name==="globe"?function(ii,Rt,hi,Ci,di,Oi,ri,Si,Gi,hn,Hi){const Ri=[],On=[],Vi=ii.projection.upVectorScale(Hi,ii.center.lat,ii.worldSize).metersToTile,Wi=[0,0,0,1],Rn=[0,0,0,1],Nn=(Ln,Kn,or,_r)=>{Ln[0]=Kn,Ln[1]=or,Ln[2]=_r,Ln[3]=1},zn=tS();hi>0&&(hi+=zn),Ci+=zn;for(const Ln of Rt){const Kn=[],or=[];for(const _r of Ln){const Pn=_r.x+di.x,Er=_r.y+di.y,yr=ii.projection.projectTilePoint(Pn,Er,Hi),tr=ii.projection.upVector(Hi,_r.x,_r.y);let pn=hi,vr=Ci;if(ri){const Un=oS(Pn,Er,hi,Ci,ri,Si,Gi,hn);pn+=Un.base,vr+=Un.top}hi!==0?Nn(Wi,yr.x+tr[0]*Vi*pn,yr.y+tr[1]*Vi*pn,yr.z+tr[2]*Vi*pn):Nn(Wi,yr.x,yr.y,yr.z),Nn(Rn,yr.x+tr[0]*Vi*vr,yr.y+tr[1]*Vi*vr,yr.z+tr[2]*Vi*vr),dr(Wi,Wi,Oi),dr(Rn,Rn,Oi),Kn.push(new Jf(Wi[0],Wi[1],Wi[2])),or.push(new Jf(Rn[0],Rn[1],Rn[2]))}Ri.push(Kn),On.push(or)}return[Ri,On]}(Ge,qe,We,It,gt,Lt,$t,Bt,Ht,Vt,Kt):$t?function(ii,Rt,hi,Ci,di,Oi,ri,Si,Gi){const hn=[],Hi=[],Ri=[0,0,0,1];for(const On of ii){const Vi=[],Wi=[];for(const Rn of On){const Nn=Rn.x+Ci.x,zn=Rn.y+Ci.y,Ln=oS(Nn,zn,Rt,hi,Oi,ri,Si,Gi);Ri[0]=Nn,Ri[1]=zn,Ri[2]=Ln.base,Ri[3]=1,Yh(Ri,Ri,di),Ri[3]=Math.max(Ri[3],1e-5);const Kn=new Jf(Ri[0]/Ri[3],Ri[1]/Ri[3],Ri[2]/Ri[3]);Ri[0]=Nn,Ri[1]=zn,Ri[2]=Ln.top,Ri[3]=1,Yh(Ri,Ri,di),Ri[3]=Math.max(Ri[3],1e-5);const or=new Jf(Ri[0]/Ri[3],Ri[1]/Ri[3],Ri[2]/Ri[3]);Vi.push(Kn),Wi.push(or)}hn.push(Vi),Hi.push(Wi)}return[hn,Hi]}(qe,We,It,gt,Lt,$t,Bt,Ht,Vt):function(ii,Rt,hi,Ci,di){const Oi=[],ri=[],Si=di[8]*Rt,Gi=di[9]*Rt,hn=di[10]*Rt,Hi=di[11]*Rt,Ri=di[8]*hi,On=di[9]*hi,Vi=di[10]*hi,Wi=di[11]*hi;for(const Rn of ii){const Nn=[],zn=[];for(const Ln of Rn){const Kn=Ln.x+Ci.x,or=Ln.y+Ci.y,_r=di[0]*Kn+di[4]*or+di[12],Pn=di[1]*Kn+di[5]*or+di[13],Er=di[2]*Kn+di[6]*or+di[14],yr=di[3]*Kn+di[7]*or+di[15],tr=_r+Si,pn=Pn+Gi,vr=Er+hn,Un=Math.max(yr+Hi,1e-5),Ds=_r+Ri,xr=Pn+On,qr=Er+Vi,Nr=Math.max(yr+Wi,1e-5);Nn.push(new Jf(tr/Un,pn/Un,vr/Un)),zn.push(new Jf(Ds/Nr,xr/Nr,qr/Nr))}Oi.push(Nn),ri.push(zn)}return[Oi,ri]}(qe,We,It,gt,Lt)}(_,d,G,k,T,x,ge,V,$,_.center.lat,a.tileID.canonical),Te=a.queryGeometry;return function(Ge,qe,We){let It=1/0;T2(We,qe)&&(It=sS(We,qe[0]));for(let gt=0;gt<qe.length;gt++){const Lt=qe[gt],$t=Ge[gt];for(let Bt=0;Bt<Lt.length-1;Bt++){const Ht=Lt[Bt],Vt=[Ht,Lt[Bt+1],$t[Bt+1],$t[Bt],Ht];M2(We,Vt)&&(It=Math.min(It,sS(We,Vt)))}}return It!==1/0&&It}(Me,He,Te.isPointQuery()?Te.screenBounds:Te.screenGeometry)}},line:class extends Qa{constructor(a){super(a,aS),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof hg,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,s){super.recalculate(a,s),this.paint._values["line-floorwidth"]=lS.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new by(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new au(this,a)}queryRadius(a){const s=a,l=cS(jf("line-width",this,s),jf("line-gap-width",this,s)),d=jf("line-offset",this,s);return l/2+Math.abs(d)+gy(this.paint.get("line-translate"))}queryIntersectsFeature(a,s,l,d,A,_){if(a.queryGeometry.isAboveHorizon)return!1;const x=L2(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),b=a.pixelToTileUnitsFactor/2*cS(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),S=this.paint.get("line-offset").evaluate(s,l);return S&&(d=function(T,k){const G=[],V=new W(0,0);for(let K=0;K<T.length;K++){const $=T[K],re=[];for(let ge=0;ge<$.length;ge++){const Me=$[ge],He=$[ge+1],Te=ge===0?V:Me.sub($[ge-1])._unit()._perp(),Ge=ge===$.length-1?V:He.sub(Me)._unit()._perp(),qe=Te._add(Ge)._unit();qe._mult(1/(qe.x*Ge.x+qe.y*Ge.y)),re.push(qe._mult(k)._add(Me))}G.push(re)}return G}(d,S*a.pixelToTileUnitsFactor)),function(T,k,G){for(let V=0;V<k.length;V++){const K=k[V];if(T.length>=3){for(let $=0;$<K.length;$++)if(Jh(T,K[$]))return!0}if(o5(T,K,G))return!0}return!1}(x,d,b)}isTileClipped(){return!0}},symbol:Uy,background:class extends Qa{constructor(a){super(a,K4)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Qa{constructor(a){super(a,J4)}getProgramIds(){return["raster"]}},sky:class extends Qa{constructor(a){super(a,Z4),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=MI({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(a,s){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),A=!d,_=a.style.light,x=_.properties.get("position");return A&&_.properties.get("anchor")==="viewport"&&nt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),A?$I(x.azimuthal,90-x.polar,s):$I(d[0],90-d[1],s)}const l=this.paint.get("sky-gradient-center");return $I(l[0],90-l[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class gm{constructor(s,l,d,A){this.context=s,this.format=d,this.texture=s.gl.createTexture(),this.update(l,A)}update(s,l,d){const{width:A,height:_}=s,{context:x}=this,{gl:b}=x,{HTMLImageElement:S,HTMLCanvasElement:T,HTMLVideoElement:k,ImageData:G,ImageBitmap:V}=p;if(b.bindTexture(b.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!l||l.premultiply!==!1)),d||this.size&&this.size[0]===A&&this.size[1]===_){const{x:K,y:$}=d||{x:0,y:0};s instanceof S||s instanceof T||s instanceof k||s instanceof G||V&&s instanceof V?b.texSubImage2D(b.TEXTURE_2D,0,K,$,b.RGBA,b.UNSIGNED_BYTE,s):b.texSubImage2D(b.TEXTURE_2D,0,K,$,A,_,b.RGBA,b.UNSIGNED_BYTE,s.data)}else this.size=[A,_],s instanceof S||s instanceof T||s instanceof k||s instanceof G||V&&s instanceof V?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,s):b.texImage2D(b.TEXTURE_2D,0,this.format,A,_,0,this.format,b.UNSIGNED_BYTE,s.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(s,l){const{context:d}=this,{gl:A}=d;A.bindTexture(A.TEXTURE_2D,this.texture),s!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,s),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,this.useMipmap?s===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_NEAREST:s),this.filter=s),l!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,l),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class eN{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class tN{constructor(){this.tasks={},this.taskQueue=[],ft(["process"],this),this.invoker=new eN(this.process),this.nextId=0}add(s,l){const d=this.nextId++,A=function({type:_,isSymbolTile:x,zoom:b}){return b=b||0,_==="message"?0:_!=="maybePrepare"||x?_!=="parseTile"||x?_==="parseTile"&&x?300-b:_==="maybePrepare"&&x?400-b:500:200-b:100-b}(l);if(A===0){Qt();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:s,metadata:l,priority:A,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){Qt();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const l=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let s=null,l=1/0;for(let A=0;A<this.taskQueue.length;A++){const _=this.tasks[this.taskQueue[A]];_.priority<l&&(l=_.priority,s=A)}if(s===null)return null;const d=this.taskQueue[s];return this.taskQueue.splice(s,1),d}remove(){this.invoker.remove()}}class jS{constructor(s){this._stringToNumber={},this._numberToString=[];for(let l=0;l<s.length;l++){const d=s[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const iN=["tile","layer","source","sourceLayer","state"];class qS{constructor(s,l,d,A,_){this.type="Feature",this._vectorTileFeature=s,this._z=l,this._x=d,this._y=A,this.properties=s.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(s.id=this.id);for(const l of iN)this[l]!==void 0&&(s[l]=this[l]);return s}}const Jo=32,fl=33,fu=new Uint16Array(8184);for(let a=0;a<2046;a++){let s=a+2,l=0,d=0,A=0,_=0,x=0,b=0;for(1&s?A=_=x=Jo:l=d=b=Jo;(s>>=1)>1;){const T=l+A>>1,k=d+_>>1;1&s?(A=l,_=d,l=x,d=b):(l=A,d=_,A=x,_=b),x=T,b=k}const S=4*a;fu[S+0]=l,fu[S+1]=d,fu[S+2]=A,fu[S+3]=_}const pl=new Uint16Array(2178),pu=new Uint8Array(1089),Oy=new Uint16Array(1089);function KS(a){return a===0?-.03125:a===32?.03125:0}var JS=lt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const XS={type:2,extent:Mi,loadGeometry:()=>[[new W(0,0),new W(Mi+1,0),new W(Mi+1,Mi+1),new W(0,Mi+1),new W(0,0)]]};class eC{constructor(s,l,d,A,_){this.tileID=s,this.uid=Ke(),this.uses=0,this.tileSize=l,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",A&&A.transform&&(this.projection=A.transform.projection)}registerFadeDuration(s){const l=s+this.timeAdded;l<Mr.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Zh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,l,d){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(A,_){const x={};if(!_)return x;for(const b of A){const S=b.layerIds.map(T=>_.getLayer(T)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(T=>S.filter(k=>k.id===T)[0]));for(const T of S)x[T.id]=b}}return x}(s.buckets,l.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const _=this.buckets[A];if(_ instanceof du){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const _=this.buckets[A];if(_ instanceof du&&_.hasRTLText){this.hasRTLText=!0,L.isLoading()||L.isLoaded()||B()!=="deferred"||R();break}}this.queryPadding=0;for(const A in this.buckets){const _=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(A).queryRadius(_))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new Dn}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const d in this.buckets){const A=this.buckets[d];A.uploadPending()&&A.upload(s)}const l=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gm(s,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gm(s,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new gm(s,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,l,d,A,_,x,b,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:A,pixelPosMatrix:b,transform:x,params:_,tileTransform:this.tileTransform},s,l,d):{}}querySourceFeatures(s,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const A=d.loadVTLayers(),_=l?l.sourceLayer:"",x=A._geojsonTileLayer||A[_];if(!x)return;const b=Pf(l&&l.filter),{z:S,x:T,y:k}=this.tileID.canonical,G={z:S,x:T,y:k};for(let V=0;V<x.length;V++){const K=x.feature(V);if(b.needGeometry){const ge=Kh(K,!0);if(!b.filter(new U(this.tileID.overscaledZ),ge,this.tileID.canonical))continue}else if(!b.filter(new U(this.tileID.overscaledZ),K))continue;const $=d.getId(K,_),re=new qS(K,S,T,k,$);re.tile=G,s.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const l=this.expirationTime;if(s.cacheControl){const d=mt(s.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const d=Date.now();let A=!1;if(this.expirationTime>d)A=!1;else if(l)if(this.expirationTime<l)A=!0;else{const _=this.expirationTime-l;_?this.expirationTime=d+Math.max(_,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0||!l)return;const d=this.latestFeatureIndex.loadVTLayers(),A=l.style.listImages();for(const _ in this.buckets){if(!l.style.hasLayer(_))continue;const x=this.buckets[_],b=x.layers[0].sourceLayer||"_geojsonTileLayer",S=d[b],T=s[b];if(!S||!T||Object.keys(T).length===0)continue;if(x.update(T,S,A,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof by||x instanceof xy){const G=l.style._getSourceCache(x.layers[0].source);l._terrain&&l._terrain.enabled&&G&&x.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(G.id,this.tileID)}const k=l&&l.style&&l.style.getLayer(_);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=Mr.now()+s}setTexture(s,l){const d=l.context,A=d.gl;this.texture=this.texture||l.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new gm(d,s,A.RGBA,{useMipmap:!0}),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE))}setDependencies(s,l){const d={};for(const A of l)d[A]=!0;this.dependencies[s]=d}hasDependency(s,l){for(const d of s){const A=this.dependencies[d];if(A){for(const _ of l)if(A[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const d=Zl(XS,this.tileID.canonical,this.tileTransform)[0],A=new Zt,_=new no;for(let x=0;x<d.length;x++){const{x:b,y:S}=d[x];A.emplaceBack(b,S),_.emplaceBack(x)}_.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(_),this._tileDebugBuffer=s.createVertexBuffer(A,qg.members),this._tileDebugSegments=gr.simpleSegment(0,0,A.length,_.length)}_makeTileBoundsBuffers(s,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const d=Zl(XS,this.tileID.canonical,this.tileTransform)[0];let A,_;if(this.isRaster){const x=function(b,S){const T=Zh(b,S),k=Math.pow(2,b.z);for(let ge=0;ge<fl;ge++)for(let Me=0;Me<fl;Me++){const He=wo((b.x+(Me+KS(Me))/Jo)/k),Te=os((b.y+(ge+KS(ge))/Jo)/k),Ge=S.project(He,Te),qe=ge*fl+Me;pl[2*qe+0]=Math.round((Ge.x*T.scale-T.x)*Mi),pl[2*qe+1]=Math.round((Ge.y*T.scale-T.y)*Mi)}pu.fill(0),Oy.fill(0);for(let ge=2045;ge>=0;ge--){const Me=4*ge,He=fu[Me+0],Te=fu[Me+1],Ge=fu[Me+2],qe=fu[Me+3],We=He+Ge>>1,It=Te+qe>>1,gt=We+It-Te,Lt=It+He-We,$t=Te*fl+He,Bt=qe*fl+Ge,Ht=It*fl+We,Vt=Math.hypot((pl[2*$t+0]+pl[2*Bt+0])/2-pl[2*Ht+0],(pl[2*$t+1]+pl[2*Bt+1])/2-pl[2*Ht+1])>=16;pu[Ht]=pu[Ht]||(Vt?1:0),ge<1022&&(pu[Ht]=pu[Ht]||pu[(Te+Lt>>1)*fl+(He+gt>>1)]||pu[(qe+Lt>>1)*fl+(Ge+gt>>1)])}const G=new zt,V=new wi;let K=0;function $(ge,Me){const He=Me*fl+ge;return Oy[He]===0&&(G.emplaceBack(pl[2*He+0],pl[2*He+1],ge*Mi/Jo,Me*Mi/Jo),Oy[He]=++K),Oy[He]-1}function re(ge,Me,He,Te,Ge,qe){const We=ge+He>>1,It=Me+Te>>1;if(Math.abs(ge-Ge)+Math.abs(Me-qe)>1&&pu[It*fl+We])re(Ge,qe,ge,Me,We,It),re(He,Te,Ge,qe,We,It);else{const gt=$(ge,Me),Lt=$(He,Te),$t=$(Ge,qe);V.emplaceBack(gt,Lt,$t)}}return re(0,0,Jo,Jo,Jo,0),re(Jo,Jo,0,0,0,Jo),{vertices:G,indices:V}}(this.tileID.canonical,l);A=x.vertices,_=x.indices}else{A=new zt,_=new wi;for(const{x:b,y:S}of d)A.emplaceBack(b,S,0,0);const x=LI(A.int16,void 0,4);for(let b=0;b<x.length;b+=3)_.emplaceBack(x[b],x[b+1],x[b+2])}this._tileBoundsBuffer=s.createVertexBuffer(A,JS.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(_),this._tileBoundsSegments=gr.simpleSegment(0,0,A.length,_.length)}_makeGlobeTileDebugBuffers(s,l){const d=l.projection;if(!d||d.name!=="globe"||l.freezeTileCoverage)return;const A=this.tileID.canonical,_=Xg(_2(A,l)),x=Wf(l.zoom);let b;x>0&&(b=lI(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,A,l,_,b,x),this._makeGlobeTileDebugTextBuffer(s,A,l,_,b,x)}_globePoint(s,l,d,A,_,x,b){let S=Jg(s,l,d);if(x){const T=1<<d.z,k=hl(A.center.lng),G=dl(A.center.lat),V=(d.x+.5)/T-k;let K=0;V>.5?K=-1:V<-.5&&(K=1);let $=(s/Mi+d.x)/T+K,re=(l/Mi+d.y)/T;$=($-k)*A._pixelsPerMercatorPixel+k,re=(re-G)*A._pixelsPerMercatorPixel+G;const ge=[$*A.worldSize,re*A.worldSize,0];dr(ge,ge,x),S=qh(S,ge,b)}return dr(S,S,_)}_makeGlobeTileDebugBorderBuffer(s,l,d,A,_,x){const b=new Zt,S=new no,T=new At,k=(V,K,$,re,ge)=>{const Me=($-V)/(ge-1),He=(re-K)/(ge-1),Te=b.length;for(let Ge=0;Ge<ge;Ge++){const qe=V+Ge*Me,We=K+Ge*He;b.emplaceBack(qe,We);const It=this._globePoint(qe,We,l,d,A,_,x);T.emplaceBack(It[0],It[1],It[2]),S.emplaceBack(Te+Ge)}},G=Mi;k(0,0,G,0,16),k(G,0,G,G,16),k(G,G,0,G,16),k(0,G,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(S),this._tileDebugBuffer=s.createVertexBuffer(b,qg.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(T,A2.members),this._tileDebugSegments=gr.simpleSegment(0,0,b.length,S.length)}_makeGlobeTileDebugTextBuffer(s,l,d,A,_,x){const b=Mi/4,S=new Zt,T=new wi,k=new At,G=25;T.reserve(32),S.reserve(G),k.reserve(G);const V=(K,$)=>G*K+$;for(let K=0;K<G;K++){const $=K*b;for(let re=0;re<G;re++){const ge=re*b;S.emplaceBack(ge,$);const Me=this._globePoint(ge,$,l,d,A,_,x);k.emplaceBack(Me[0],Me[1],Me[2])}}for(let K=0;K<4;K++)for(let $=0;$<4;$++){const re=V(K,$),ge=V(K,$+1),Me=V(K+1,$),He=V(K+1,$+1);T.emplaceBack(re,ge,Me),T.emplaceBack(Me,ge,He)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(T),this._tileDebugTextBuffer=s.createVertexBuffer(S,qg.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(k,A2.members),this._tileDebugTextSegments=gr.simpleSegment(0,0,G,32)}}class nN{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,l,d){const A=String(l);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][A]=this.stateChanges[s][A]||{},st(this.stateChanges[s][A],d),this.deletedStates[s]===null){this.deletedStates[s]={};for(const _ in this.state[s])_!==A&&(this.deletedStates[s][_]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][A]===null){this.deletedStates[s][A]={};for(const _ in this.state[s][A])d[_]||(this.deletedStates[s][A][_]=null)}else for(const _ in d)this.deletedStates[s]&&this.deletedStates[s][A]&&this.deletedStates[s][A][_]===null&&delete this.deletedStates[s][A][_]}removeFeatureState(s,l,d){if(this.deletedStates[s]===null)return;const A=String(l);if(this.deletedStates[s]=this.deletedStates[s]||{},d&&l!==void 0)this.deletedStates[s][A]!==null&&(this.deletedStates[s][A]=this.deletedStates[s][A]||{},this.deletedStates[s][A][d]=null);else if(l!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][A])for(d in this.deletedStates[s][A]={},this.stateChanges[s][A])this.deletedStates[s][A][d]=null;else this.deletedStates[s][A]=null;else this.deletedStates[s]=null}getState(s,l){const d=String(l),A=st({},(this.state[s]||{})[d],(this.stateChanges[s]||{})[d]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const _=this.deletedStates[s][l];if(_===null)return{};for(const x in _)delete A[x]}return A}initializeTileState(s,l){s.setFeatureState(this.state,l)}coalesceChanges(s,l){const d={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const _={};for(const x in this.stateChanges[A])this.state[A][x]||(this.state[A][x]={}),st(this.state[A][x],this.stateChanges[A][x]),_[x]=this.state[A][x];d[A]=_}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const _={};if(this.deletedStates[A]===null)for(const x in this.state[A])_[x]={},this.state[A][x]={};else for(const x in this.deletedStates[A]){if(this.deletedStates[A][x]===null)this.state[A][x]={};else if(this.state[A][x])for(const b of Object.keys(this.deletedStates[A][x]))delete this.state[A][x][b];_[x]=this.state[A][x]}d[A]=d[A]||{},st(d[A],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const A in s)s[A].setFeatureState(d,l)}}class ZS{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,l){const d=this.toIdx(s,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(s,l){return this.leaves[this.toIdx(s,l)]}toIdx(s,l){return l*this.size+s}}function $S(a,s,l,d){let A=0,_=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(d[x])<1e-15){if(l[x]<a[x]||l[x]>s[x])return null}else{const b=1/d[x];let S=(a[x]-l[x])*b,T=(s[x]-l[x])*b;if(S>T){const k=S;S=T,T=k}if(S>A&&(A=S),T<_&&(_=T),A>_)return null}return A}function eM(a,s,l,d,A,_,x,b,S,T,k){const G=d-a,V=A-s,K=_-l,$=x-a,re=b-s,ge=S-l,Me=k[1]*ge-k[2]*re,He=k[2]*$-k[0]*ge,Te=k[0]*re-k[1]*$,Ge=G*Me+V*He+K*Te;if(Math.abs(Ge)<1e-15)return null;const qe=1/Ge,We=T[0]-a,It=T[1]-s,gt=T[2]-l,Lt=(We*Me+It*He+gt*Te)*qe;if(Lt<0||Lt>1)return null;const $t=It*K-gt*V,Bt=gt*G-We*K,Ht=We*V-It*G,Vt=(k[0]*$t+k[1]*Bt+k[2]*Ht)*qe;return Vt<0||Lt+Vt>1?null:($*$t+re*Bt+ge*Ht)*qe}function tM(a,s,l){return(a-s)/(l-s)}function iM(a,s,l,d,A,_,x,b,S){const T=1<<l,k=_-d,G=x-A,V=(a+1)/T*k+d,K=(s+0)/T*G+A,$=(s+1)/T*G+A;b[0]=(a+0)/T*k+d,b[1]=K,S[0]=V,S[1]=$}class nM{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(_){const x=Math.ceil(Math.log2(_.dim/8)),b=[];let S=Math.ceil(Math.pow(2,x));const T=1/S,k=(K,$,re,ge,Me)=>{const He=ge?1:0,Te=(K+1)*re-He,Ge=$*re,qe=($+1)*re-He;Me[0]=K*re,Me[1]=Ge,Me[2]=Te,Me[3]=qe};let G=new ZS(S);const V=[];for(let K=0;K<S*S;K++){k(K%S,Math.floor(K/S),T,!1,V);const $=Au(V[0],V[1],_),re=Au(V[2],V[1],_),ge=Au(V[2],V[3],_),Me=Au(V[0],V[3],_);G.minimums.push(Math.min($,re,ge,Me)),G.maximums.push(Math.max($,re,ge,Me)),G.leaves.push(1)}for(b.push(G),S/=2;S>=1;S/=2){const K=b[b.length-1];G=new ZS(S);for(let $=0;$<S*S;$++){k($%S,Math.floor($/S),2,!0,V);const re=K.getElevation(V[0],V[1]),ge=K.getElevation(V[2],V[1]),Me=K.getElevation(V[2],V[3]),He=K.getElevation(V[0],V[3]),Te=K.isLeaf(V[0],V[1]),Ge=K.isLeaf(V[2],V[1]),qe=K.isLeaf(V[2],V[3]),We=K.isLeaf(V[0],V[3]),It=Math.min(re.min,ge.min,Me.min,He.min),gt=Math.max(re.max,ge.max,Me.max,He.max),Lt=Te&&Ge&&qe&&We;G.maximums.push(gt),G.minimums.push(It),G.leaves.push(gt-It<=5&&Lt?1:0)}b.push(G)}return b}(this.dem),d=l.length-1,A=l[d];this._addNode(A.minimums[0],A.maximums[0],A.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(s,l,d,A,_,x,b=1){return $S([s,l,-100],[d,A,this.maximums[0]*b],_,x)}raycast(s,l,d,A,_,x,b=1){if(!this.nodeCount)return null;const S=this.raycastRoot(s,l,d,A,_,x,b);if(S==null)return null;const T=[],k=[],G=[],V=[],K=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:$,t:re,nodex:ge,nodey:Me,depth:He}=K.pop();if(this.leaves[$]){iM(ge,Me,He,s,l,d,A,G,V);const Ge=1<<He,qe=(ge+0)/Ge,We=(ge+1)/Ge,It=(Me+0)/Ge,gt=(Me+1)/Ge,Lt=Au(qe,It,this.dem)*b,$t=Au(We,It,this.dem)*b,Bt=Au(We,gt,this.dem)*b,Ht=Au(qe,gt,this.dem)*b,Vt=eM(G[0],G[1],Lt,V[0],G[1],$t,V[0],V[1],Bt,_,x),Kt=eM(V[0],V[1],Bt,G[0],V[1],Ht,G[0],G[1],Lt,_,x),ii=Math.min(Vt!==null?Vt:Number.MAX_VALUE,Kt!==null?Kt:Number.MAX_VALUE);if(ii!==Number.MAX_VALUE)return ii;{const Rt=Yg([],_,x,re);if(rM(Lt,$t,Ht,Bt,tM(Rt[0],G[0],V[0]),tM(Rt[1],G[1],V[1]))>=Rt[2])return re}continue}let Te=0;for(let Ge=0;Ge<this._siblingOffset.length;Ge++){iM((ge<<1)+this._siblingOffset[Ge][0],(Me<<1)+this._siblingOffset[Ge][1],He+1,s,l,d,A,G,V),G[2]=-100,V[2]=this.maximums[this.childOffsets[$]+Ge]*b;const qe=$S(G,V,_,x);if(qe!=null){const We=qe;T[Ge]=We;let It=!1;for(let gt=0;gt<Te&&!It;gt++)We>=T[k[gt]]&&(k.splice(gt,0,Ge),It=!0);It||(k[Te]=Ge),Te++}}for(let Ge=0;Ge<Te;Ge++){const qe=k[Ge];K.push({idx:this.childOffsets[$]+qe,t:T[qe],nodex:(ge<<1)+this._siblingOffset[qe][0],nodey:(Me<<1)+this._siblingOffset[qe][1],depth:He+1})}}return null}_addNode(s,l,d){return this.minimums.push(s),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(s,l,d,A,_){if(s[A].isLeaf(l,d)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const x=A-1,b=s[x];let S=0,T=0;for(let k=0;k<this._siblingOffset.length;k++){const G=2*l+this._siblingOffset[k][0],V=2*d+this._siblingOffset[k][1],K=b.getElevation(G,V),$=b.isLeaf(G,V),re=this._addNode(K.min,K.max,$);$&&(S|=1<<k),T||(T=re)}for(let k=0;k<this._siblingOffset.length;k++)S&1<<k||this._construct(s,2*l+this._siblingOffset[k][0],2*d+this._siblingOffset[k][1],x,T+k)}}function rM(a,s,l,d,A,_){return an(an(a,l,_),an(s,d,_),A)}function Au(a,s,l){const d=l.dim,A=ye(a*d-.5,0,d-1),_=ye(s*d-.5,0,d-1),x=Math.floor(A),b=Math.floor(_),S=Math.min(x+1,d-1),T=Math.min(b+1,d-1);return rM(l.get(x,b),l.get(S,b),l.get(x,T),l.get(S,T),A-x,_-b)}const sM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function rN(a,s,l){return(256*a*256+256*s+l)/10-1e4}function sN(a,s,l){return 256*a+s+l/256-32768}class Gy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,l,d,A=!1,_=!1){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return nt(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const x=this.dim=l.height-2,b=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=d||"mapbox",this.borderReady=A,!A){for(let S=0;S<x;S++)b[this._idx(-1,S)]=b[this._idx(0,S)],b[this._idx(x,S)]=b[this._idx(x-1,S)],b[this._idx(S,-1)]=b[this._idx(S,0)],b[this._idx(S,x)]=b[this._idx(S,x-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(x,-1)]=b[this._idx(x-1,0)],b[this._idx(-1,x)]=b[this._idx(0,x-1)],b[this._idx(x,x)]=b[this._idx(x-1,x-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new nM(this)}get(s,l,d=!1){d&&(s=ye(s,-1,this.dim),l=ye(l,-1,this.dim));const A=4*this._idx(s,l);return(this.encoding==="terrarium"?sN:rN)(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}static getUnpackVector(s){return sM[s]}get unpackVector(){return sM[this.encoding]}_idx(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)}static pack(s,l){const d=[0,0,0,0],A=Gy.getUnpackVector(l);let _=Math.floor((s+A[3])/A[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new so({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,l,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let A=l*this.dim,_=l*this.dim+this.dim,x=d*this.dim,b=d*this.dim+this.dim;switch(l){case-1:A=_-1;break;case 1:_=A+1}switch(d){case-1:x=b-1;break;case 1:b=x+1}const S=-l*this.dim,T=-d*this.dim;for(let k=x;k<b;k++)for(let G=A;G<_;G++){const V=4*this._idx(G,k),K=4*this._idx(G+S,k+T);this.pixels[V+0]=s.pixels[K+0],this.pixels[V+1]=s.pixels[K+1],this.pixels[V+2]=s.pixels[K+2],this.pixels[V+3]=s.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}vi(Gy,"DEMData"),vi(nM,"DemMinMaxQuadTree",{omit:["dem"]});class oN{constructor(s,l){this.max=s,this.onRemove=l,this.reset()}reset(){for(const s in this.data)for(const l of this.data[s])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(s,l,d){const A=s.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const _={value:l,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(s,_)},d)),this.data[A].push(_),this.order.push(A),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const l=this.data[s].shift();return l.timeout&&clearTimeout(l.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),l.value}getByKey(s){const l=this.data[s];return l?l[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,l){if(!this.has(s))return this;const d=s.wrapped().key,A=l===void 0?0:this.data[d].indexOf(l),_=this.data[d][A];return this.data[d].splice(A,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(s){const l=[];for(const d in this.data)for(const A of this.data[d])s(A.value)||l.push(A);for(const d of l)this.remove(d.value.tileID,d)}}class op{constructor(s,l,d){this.func=s,this.mask=l,this.range=d}}op.ReadOnly=!1,op.ReadWrite=!0,op.disabled=new op(519,op.ReadOnly,[0,1]);const tC=7680;class iC{constructor(s,l,d,A,_,x){this.test=s,this.ref=l,this.mask=d,this.fail=A,this.depthFail=_,this.pass=x}}iC.disabled=new iC({func:519,mask:0},0,0,tC,tC,tC);class Al{constructor(s,l,d){this.blendFunction=s,this.blendColor=l,this.mask=d}}Al.Replace=[1,0],Al.disabled=new Al(Al.Replace,hr.transparent,[!1,!1,!1,!1]),Al.unblended=new Al(Al.Replace,hr.transparent,[!0,!0,!0,!0]),Al.alphaBlended=new Al([1,771],hr.transparent,[!0,!0,!0,!0]);const nC=1029,rC=2305;class Na{constructor(s,l,d){this.enable=s,this.mode=l,this.frontFace=d}}Na.disabled=new Na(!1,nC,rC),Na.backCCW=new Na(!0,nC,rC),Na.backCW=new Na(!0,nC,2304),Na.frontCW=new Na(!0,1028,2304),Na.frontCCW=new Na(!0,1028,rC);class $h extends Ia{constructor(s,l,d){super(),this.id=s,this._onlySymbols=d,l.on("data",A=>{A.dataType==="source"&&A.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&A.dataType==="source"&&A.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new oN(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new nN,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const l=this._tiles[s];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,l){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,l)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(s),d.prepare(this.map.style.imageManager)}}getIds(){return Fe(this._tiles).map(s=>s.tileID).sort(oM).map(s=>s.key)}getRenderableIds(s){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,s)&&l.push(this._tiles[d]);return s?l.sort((d,A)=>{const _=d.tileID,x=A.tileID,b=new W(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),S=new W(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(oM).map(d=>d.key)}hasRenderableParent(s){const l=this.findLoadedParent(s,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(s,l){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(l||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,l){const d=this._tiles[s];d&&(d.state!=="loading"&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,s,l)))}_tileLoaded(s,l,d,A){if(A)if(s.state="errored",A.status!==404)this._source.fire(new As(A,{tile:s}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=Mr.now(),d==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(l,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new Go("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const l=this.getRenderableIds();for(let A=0;A<l.length;A++){const _=l[A];if(s.neighboringTiles&&s.neighboringTiles[_]){const x=this.getTileByID(_);d(s,x),d(x,s)}}function d(A,_){if(!A.dem||A.dem.borderReady)return;A.needsHillshadePrepare=!0,A.needsDEMTextureUpload=!0;let x=_.tileID.canonical.x-A.tileID.canonical.x;const b=_.tileID.canonical.y-A.tileID.canonical.y,S=Math.pow(2,A.tileID.canonical.z),T=_.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),_.dem&&A.dem&&(A.dem.backfillBorder(_.dem,x,b),A.neighboringTiles&&A.neighboringTiles[T]&&(A.neighboringTiles[T].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,l,d,A){for(const _ in this._tiles){let x=this._tiles[_];if(A[_]||!x.hasData()||x.tileID.overscaledZ<=l||x.tileID.overscaledZ>d)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>l+1;){const T=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[T.key],x&&x.hasData()&&(b=T)}let S=b;for(;S.overscaledZ>l;)if(S=S.scaledTo(S.overscaledZ-1),s[S.key]){A[b.key]=b;break}}}findLoadedParent(s,l){if(s.key in this._loadedParentTiles){const d=this._loadedParentTiles[s.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=s.overscaledZ-1;d>=l;d--){const A=s.scaledTo(d),_=this._getLoadedTile(A);if(_)return _}}_getLoadedTile(s){const l=this._tiles[s.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,l){l=l||this._source.tileSize;const d=Math.ceil(s.width/l)+1,A=Math.ceil(s.height/l)+1,_=Math.floor(d*A*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(b)}handleWrapJump(s){const l=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,l){const d={};for(const A in this._tiles){const _=this._tiles[A];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+l),d[_.tileID.key]=_}this._tiles=d;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(+A,this._tiles[A])}}update(s,l,d){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let A;this.updateCacheSize(s,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?A=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Ts(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(A=s.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(A=A.filter(b=>this._source.hasTile(b)))):A=[];const _=this._updateRetainedTiles(A);if(aM(this._source.type)&&A.length!==0){const b={},S={},T=Object.keys(_);for(const G of T){const V=_[G],K=this._tiles[G];if(!K||K.fadeEndTime&&K.fadeEndTime<=Mr.now())continue;const $=this.findLoadedParent(V,Math.max(V.overscaledZ-$h.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),b[$.tileID.key]=$.tileID),S[G]=V}const k=A[A.length-1].overscaledZ;for(const G in this._tiles){const V=this._tiles[G];if(_[G]||!V.hasData())continue;let K=V.tileID;for(;K.overscaledZ>k;){K=K.scaledTo(K.overscaledZ-1);const $=this._tiles[K.key];if($&&$.hasData()&&S[K.key]){_[G]=V.tileID;break}}}for(const G in b)_[G]||(this._coveredTiles[G]=!0,_[G]=b[G])}for(const b in _)this._tiles[b].clearFadeHold();const x=function(b,S){const T=[];for(const k in b)k in S||T.push(k);return T}(this._tiles,_);for(const b of x){const S=this._tiles[b];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const l={};if(s.length===0)return l;const d={},A=s.reduce((T,k)=>Math.min(T,k.overscaledZ),1/0),_=s[0].overscaledZ,x=Math.max(_-$h.maxOverzooming,this._source.minzoom),b=Math.max(_+$h.maxUnderzooming,this._source.minzoom),S={};for(const T of s){const k=this._addTile(T);l[T.key]=T,k.hasData()||A<this._source.maxzoom&&(S[T.key]=T)}this._retainLoadedChildren(S,A,b,l);for(const T of s){let k=this._tiles[T.key];if(k.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const V=T.children(this._source.maxzoom)[0],K=this.getTile(V);if(K&&K.hasData()){l[V.key]=V;continue}}else{const V=T.children(this._source.maxzoom);if(l[V[0].key]&&l[V[1].key]&&l[V[2].key]&&l[V[3].key])continue}let G=k.wasRequested();for(let V=T.overscaledZ-1;V>=x;--V){const K=T.scaledTo(V);if(d[K.key]||(d[K.key]=!0,k=this.getTile(K),!k&&G&&(k=this._addTile(K)),k&&(l[K.key]=K,G=k.wasRequested(),k.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const l=[];let d,A=this._tiles[s].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){d=this._loadedParentTiles[A.key];break}l.push(A.key);const _=A.scaledTo(A.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;A=_}for(const _ of l)this._loadedParentTiles[_]=d}}_addTile(s){let l=this._tiles[s.key];if(l)return l;l=this._cache.getAndRemove(s),l&&(this._setTileReloadTimer(s.key,l),l.tileID=s,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,l)));const d=Boolean(l);if(!d){const A=this.map?this.map.painter:null;l=new eC(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,A,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,s.key,l.state))}return l?(l.uses++,this._tiles[s.key]=l,d||this._source.fire(new Go("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(s,l){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const d=l.getExpiryTimeout();d&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},d))}_removeTile(s){const l=this._tiles[s];l&&(l.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,l,d){const A=[],_=this.transform;if(!_)return A;const x=_.projection.name==="globe",b=hl(_.center.lng);for(const S in this._tiles){const T=this._tiles[S];if(d&&T.clearQueryDebugViz(),T.holdingForFade())continue;let k;if(x){const G=T.tileID.canonical;if(G.z===0){const V=[Math.abs(ye(b,...mm(G,-1))-b),Math.abs(ye(b,...mm(G,1))-b)];k=[0,2*V.indexOf(Math.min(...V))-1]}else{const V=[Math.abs(ye(b,...mm(G,-1))-b),Math.abs(ye(b,...mm(G,0))-b),Math.abs(ye(b,...mm(G,1))-b)];k=[V.indexOf(Math.min(...V))-1]}}else k=[0];for(const G of k){const V=s.containsTile(T,_,l,G);V&&A.push(V)}}return A}getVisibleCoordinates(s){const l=this.getRenderableIds(s).map(d=>this._tiles[d].tileID);for(const d of l)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(aM(this._source.type))for(const s in this._tiles){const l=this._tiles[s];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=Mr.now())return!0}return!1}setFeatureState(s,l,d){this._state.updateState(s=s||"_geojsonTileLayer",l,d)}removeFeatureState(s,l,d){this._state.removeFeatureState(s=s||"_geojsonTileLayer",l,d)}getFeatureState(s,l){return this._state.getState(s=s||"_geojsonTileLayer",l)}setDependencies(s,l,d){const A=this._tiles[s];A&&A.setDependencies(l,d)}reloadTilesForDependencies(s,l){for(const d in this._tiles)this._tiles[d].hasDependency(s,l)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(s,l))}_preloadTiles(s,l){if(!this._sourceLoaded){const b=()=>{this._sourceLoaded&&(this._source.off("data",b),this._preloadTiles(s,l))};return void this._source.on("data",b)}const d=new Map,A=Array.isArray(s)?s:[s],_=this.map.painter.terrain,x=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const b of A){const S=b.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of S)d.set(T.key,T);this.usedForTerrain&&b.updateElevation(!1)}Tt(Array.from(d.values()),(b,S)=>{const T=new eC(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,k=>{this._source.type==="raster-dem"&&T.dem&&this._backfillDEM(T),S(k,T)})},l)}}function oM(a,s){const l=Math.abs(2*a.wrap)-+(a.wrap<0),d=Math.abs(2*s.wrap)-+(s.wrap<0);return a.overscaledZ-s.overscaledZ||d-l||s.canonical.y-a.canonical.y||s.canonical.x-a.canonical.x}function aM(a){return a==="raster"||a==="image"||a==="video"||a==="custom"}function mm(a,s){const l=1<<a.z;return[a.x/l+s,(a.x+1)/l+s]}$h.maxOverzooming=10,$h.maxUnderzooming=3;class Hy{constructor(s,l,d){this._demTile=s,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(s,l,d){const A=d||s.findDEMTileFor(l);if(!A||!A.dem)return;const _=A.dem,x=A.tileID,b=1<<l.canonical.z-x.canonical.z;return new Hy(A,A.tileSize/Mi/b,[(l.canonical.x/b-x.canonical.x)*_.dim,(l.canonical.y/b-x.canonical.y)*_.dim])}tileCoordToPixel(s,l){const d=l*this._scale+this._offset[1],A=Math.floor(s*this._scale+this._offset[0]),_=Math.floor(d);return new W(A,_)}getElevationAt(s,l,d,A){const _=s*this._scale+this._offset[0],x=l*this._scale+this._offset[1],b=Math.floor(_),S=Math.floor(x),T=this._dem;return A=!!A,d?an(an(T.get(b,S,A),T.get(b,S+1,A),x-S),an(T.get(b+1,S,A),T.get(b+1,S+1,A),x-S),_-b):T.get(b,S,A)}getElevationAtPixel(s,l,d){return this._dem.get(s,l,!!d)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Pa(1,s)*this._dem.stride}}class lM{constructor(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Wl(Mi,16,0),this.featureIndexArray=new Oh,this.promoteId=l}insert(s,l,d,A,_,x=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,A,_,x);const S=this.grid;for(let T=0;T<l.length;T++){const k=l[T],G=[1/0,1/0,-1/0,-1/0];for(let V=0;V<k.length;V++){const K=k[V];G[0]=Math.min(G[0],K.x),G[1]=Math.min(G[1],K.y),G[2]=Math.max(G[2],K.x),G[3]=Math.max(G[3],K.y)}G[0]<Mi&&G[1]<Mi&&G[2]>=0&&G[3]>=0&&S.insert(b,G[0],G[1],G[2],G[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new NI(new My(this.rawTileData)).layers,this.sourceLayerCoder=new jS(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,l,d,A){this.loadVTLayers();const _=s.params||{},x=Pf(_.filter),b=s.tileResult,S=s.transform,T=b.bufferedTilespaceBounds,k=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,($,re,ge,Me)=>R2(b.bufferedTilespaceGeometry,$,re,ge,Me));k.sort(aN);let G=null;S.elevation&&k.length>0&&(G=Hy.create(S.elevation,this.tileID));const V={};let K;for(let $=0;$<k.length;$++){const re=k[$];if(re===K)continue;K=re;const ge=this.featureIndexArray.get(re);let Me=null;this.loadMatchingFeature(V,ge,x,_.layers,_.availableImages,l,d,A,(He,Te,Ge,qe=0)=>(Me||(Me=Zl(He,this.tileID.canonical,s.tileTransform)),Te.queryIntersectsFeature(b,He,Ge,Me,this.z,s.transform,s.pixelPosMatrix,G,qe)))}return V}loadMatchingFeature(s,l,d,A,_,x,b,S,T){const{featureIndex:k,bucketIndex:G,sourceLayerIndex:V,layoutVertexArrayOffset:K}=l,$=this.bucketLayerIDs[G];if(A&&!function(He,Te){for(let Ge=0;Ge<He.length;Ge++)if(Te.indexOf(He[Ge])>=0)return!0;return!1}(A,$))return;const re=this.sourceLayerCoder.decode(V),ge=this.vtLayers[re].feature(k);if(d.needGeometry){const He=Kh(ge,!0);if(!d.filter(new U(this.tileID.overscaledZ),He,this.tileID.canonical))return}else if(!d.filter(new U(this.tileID.overscaledZ),ge))return;const Me=this.getId(ge,re);for(let He=0;He<$.length;He++){const Te=$[He];if(A&&A.indexOf(Te)<0)continue;const Ge=x[Te];if(!Ge)continue;let qe={};Me!==void 0&&S&&(qe=S.getState(Ge.sourceLayer||"_geojsonTileLayer",Me));const We=st({},b[Te]);We.paint=cM(We.paint,Ge.paint,ge,qe,_),We.layout=cM(We.layout,Ge.layout,ge,qe,_);const It=!T||T(ge,Ge,qe,K);if(!It)continue;const gt=new qS(ge,this.z,this.x,this.y,Me);gt.layer=We;let Lt=s[Te];Lt===void 0&&(Lt=s[Te]=[]),Lt.push({featureIndex:k,feature:gt,intersectionZ:It})}}lookupSymbolFeatures(s,l,d,A,_,x,b,S){const T={};this.loadVTLayers();const k=Pf(_);for(const G of s)this.loadMatchingFeature(T,{bucketIndex:d,sourceLayerIndex:A,featureIndex:G,layoutVertexArrayOffset:0},k,x,b,S,l);return T}loadFeature(s){const{featureIndex:l,sourceLayerIndex:d}=s;this.loadVTLayers();const A=this.sourceLayerCoder.decode(d),_=this.vtFeatures[A];if(_[l])return _[l];const x=this.vtLayers[A].feature(l);return _[l]=x,x}hasLayer(s){for(const l of this.bucketLayerIDs)for(const d of l)if(s===d)return!0;return!1}getId(s,l){let d=s.id;if(this.promoteId){const A=typeof this.promoteId=="string"?this.promoteId:this.promoteId[l];A!=null&&(d=s.properties[A]),typeof d=="boolean"&&(d=Number(d))}return d}}function cM(a,s,l,d,A){return Ye(a,(_,x)=>{const b=s instanceof Se?s.get(x):null;return b&&b.evaluate?b.evaluate(l,d,A):b})}function aN(a,s){return s-a}vi(lM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class uM{constructor(s,l){this.width=s,this.height=l,this.nextRow=0,this.image=new $l({width:s,height:l}),this.positions={},this.uploaded=!1}getDash(s,l){const d=this.getKey(s,l);return this.positions[d]}trim(){const s=this.width,l=this.height=dt(this.nextRow);this.image.resize({width:s,height:l})}getKey(s,l){return s.join(",")+l}getDashRanges(s,l,d){const A=[];let _=s.length%2==1?-s[s.length-1]*d:0,x=s[0]*d,b=!0;A.push({left:_,right:x,isDash:b,zeroLength:s[0]===0});let S=s[0];for(let T=1;T<s.length;T++){b=!b;const k=s[T];_=S*d,S+=k,x=S*d,A.push({left:_,right:x,isDash:b,zeroLength:k===0})}return A}addRoundDash(s,l,d){const A=l/2;for(let _=-d;_<=d;_++){const x=this.width*(this.nextRow+d+_);let b=0,S=s[b];for(let T=0;T<this.width;T++){T/S.right>1&&(S=s[++b]);const k=Math.abs(T-S.left),G=Math.abs(T-S.right),V=Math.min(k,G);let K;const $=_/d*(A+1);if(S.isDash){const re=A-Math.abs($);K=Math.sqrt(V*V+re*re)}else K=A-Math.sqrt(V*V+$*$);this.image.data[x+T]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(s,l){for(let S=s.length-1;S>=0;--S){const T=s[S],k=s[S+1];T.zeroLength?s.splice(S,1):k&&k.isDash===T.isDash&&(k.left=T.left,s.splice(S,1))}const d=s[0],A=s[s.length-1];d.isDash===A.isDash&&(d.left=A.left-this.width,A.right=d.right+this.width);const _=this.width*this.nextRow;let x=0,b=s[x];for(let S=0;S<this.width;S++){S/b.right>1&&(b=s[++x]);const T=Math.abs(S-b.left),k=Math.abs(S-b.right),G=Math.min(T,k);this.image.data[_+S]=Math.max(0,Math.min(255,(b.isDash?G:-G)+l+128))}}addDash(s,l){const d=this.getKey(s,l);if(this.positions[d])return this.positions[d];const A=l==="round",_=A?7:0,x=2*_+1;if(this.nextRow+x>this.height)return nt("LineAtlas out of space"),null;s.length===0&&s.push(1);let b=0;for(let k=0;k<s.length;k++)s[k]<0&&(nt("Negative value is found in line dasharray, replacing values with 0"),s[k]=0),b+=s[k];if(b!==0){const k=this.width/b,G=this.getDashRanges(s,this.width,k);A?this.addRoundDash(G,k,_):this.addRegularDash(G,l==="square"?.5*k:0)}const S=this.nextRow+_;this.nextRow+=x;const T={tl:[S,_],br:[b,0]};return this.positions[d]=T,T}}vi(uM,"LineAtlas");const hM=1*Fa;class dM{constructor(s){const l={},d=[];for(const b in s){const S=s[b],T=l[b]={};for(const k in S.glyphs){const G=S.glyphs[+k];if(!G||G.bitmap.width===0||G.bitmap.height===0)continue;const V=G.metrics.localGlyph?hM:1,K={x:0,y:0,w:G.bitmap.width+2*V,h:G.bitmap.height+2*V};d.push(K),T[k]=K}}const{w:A,h:_}=GI(d),x=new $l({width:A||1,height:_||1});for(const b in s){const S=s[b];for(const T in S.glyphs){const k=S.glyphs[+T];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const G=l[b][T],V=k.metrics.localGlyph?hM:1;$l.copy(k.bitmap,x,{x:0,y:0},{x:G.x+V,y:G.y+V},k.bitmap)}}this.image=x,this.positions=l}}vi(dM,"GlyphAtlas");class lN{constructor(s){this.tileID=new Ts(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=Zh(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,l,d,A,_){this.status="parsing",this.data=s,this.collisionBoxArray=new Dn;const x=new jS(Object.keys(s.layers).sort()),b=new lM(this.tileID,this.promoteId);b.bucketLayerIDs=[];const S={},T=new uM(256,256),k={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:d},G=l.familiesBySource[this.source];for(const qe in G){const We=s.layers[qe];if(!We)continue;let It=!1,gt=!1;for(const Bt of G[qe])Bt[0].type==="symbol"?It=!0:gt=!0;if(this.isSymbolTile===!0&&!It||this.isSymbolTile===!1&&!gt)continue;We.version===1&&nt(`Vector tile source "${this.source}" layer "${qe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Lt=x.encode(qe),$t=[];for(let Bt=0;Bt<We.length;Bt++){const Ht=We.feature(Bt),Vt=b.getId(Ht,qe);$t.push({feature:Ht,id:Vt,index:Bt,sourceLayerIndex:Lt})}for(const Bt of G[qe]){const Ht=Bt[0];this.isSymbolTile!==void 0&&Ht.type==="symbol"!==this.isSymbolTile||Ht.minzoom&&this.zoom<Math.floor(Ht.minzoom)||Ht.maxzoom&&this.zoom>=Ht.maxzoom||Ht.visibility!=="none"&&(sC(Bt,this.zoom,d),(S[Ht.id]=Ht.createBucket({index:b.bucketLayerIDs.length,layers:Bt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Lt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate($t,k,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(Bt.map(Vt=>Vt.id)))}}let V,K,$,re;T.trim();const ge={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Me=()=>{if(V)return _(V);if(K&&$&&re){const qe=new dM(K),We=new yS($,re);for(const It in S){const gt=S[It];gt instanceof du?(sC(gt.layers,this.zoom,d),L4(gt,K,qe.positions,$,We.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):gt.hasPattern&&(gt instanceof by||gt instanceof xy||gt instanceof sm)&&(sC(gt.layers,this.zoom,d),gt.addFeatures(k,this.tileID.canonical,We.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:Fe(S).filter(It=>!It.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qe.image,lineAtlas:T,imageAtlas:We,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?qe.positions:null})}},He=Ye(k.glyphDependencies,qe=>Object.keys(qe).map(Number));Object.keys(He).length?A.send("getGlyphs",{uid:this.uid,stacks:He},(qe,We)=>{V||(V=qe,K=We,Me())},void 0,!1,ge):K={};const Te=Object.keys(k.iconDependencies);Te.length?A.send("getImages",{icons:Te,source:this.source,tileID:this.tileID,type:"icons"},(qe,We)=>{V||(V=qe,$=We,Me())},void 0,!1,ge):$={};const Ge=Object.keys(k.patternDependencies);Ge.length?A.send("getImages",{icons:Ge,source:this.source,tileID:this.tileID,type:"patterns"},(qe,We)=>{V||(V=qe,re=We,Me())},void 0,!1,ge):re={},Me()}}function sC(a,s,l){const d=new U(s);for(const A of a)A.recalculate(d,l)}class fM{constructor(s){this.entries={},this.scheduler=s}request(s,l,d,A){const _=this.entries[s]=this.entries[s]||{callbacks:[]};if(_.result){const[x,b]=_.result;return this.scheduler?this.scheduler.add(()=>{A(x,b)},l):A(x,b),()=>{}}return _.callbacks.push(A),_.cancel||(_.cancel=d((x,b)=>{_.result=[x,b];for(const S of _.callbacks)this.scheduler?this.scheduler.add(()=>{S(x,b)},l):S(x,b);setTimeout(()=>delete this.entries[s],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(x=>x!==A),_.callbacks.length||(_.cancel(),delete this.entries[s]))}}}function pM(a,s,l){const d=JSON.stringify(a.request);return a.data&&(this.deduped.entries[d]={result:[null,a.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},A=>{const _=kt(a.request,(x,b,S,T)=>{x?A(x):b&&A(null,{vectorTile:l?void 0:new NI(new My(b)),rawData:b,cacheControl:S,expires:T})});return()=>{_.cancel(),A()}},s)}const AM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class oC{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(s,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const A=d>>4;if(A!==1)throw new Error(`Got v${A} data when expected v1.`);const _=AM[15&d];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(s,2,1),[b]=new Uint32Array(s,4,1);return new oC(b,x,_,s)}constructor(s,l=64,d=Float64Array,A){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const _=AM.indexOf(this.ArrayType),x=2*s*this.ArrayType.BYTES_PER_ELEMENT,b=s*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);A&&A instanceof ArrayBuffer?(this.data=A,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+b+S,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+S),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+b+S,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=s)}add(s,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=l,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return aC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,l,d,A){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:b}=this,S=[0,_.length-1,0],T=[];for(;S.length;){const k=S.pop()||0,G=S.pop()||0,V=S.pop()||0;if(G-V<=b){for(let ge=V;ge<=G;ge++){const Me=x[2*ge],He=x[2*ge+1];Me>=s&&Me<=d&&He>=l&&He<=A&&T.push(_[ge])}continue}const K=V+G>>1,$=x[2*K],re=x[2*K+1];$>=s&&$<=d&&re>=l&&re<=A&&T.push(_[K]),(k===0?s<=$:l<=re)&&(S.push(V),S.push(K-1),S.push(1-k)),(k===0?d>=$:A>=re)&&(S.push(K+1),S.push(G),S.push(1-k))}return T}within(s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:_,nodeSize:x}=this,b=[0,A.length-1,0],S=[],T=d*d;for(;b.length;){const k=b.pop()||0,G=b.pop()||0,V=b.pop()||0;if(G-V<=x){for(let ge=V;ge<=G;ge++)mM(_[2*ge],_[2*ge+1],s,l)<=T&&S.push(A[ge]);continue}const K=V+G>>1,$=_[2*K],re=_[2*K+1];mM($,re,s,l)<=T&&S.push(A[K]),(k===0?s-d<=$:l-d<=re)&&(b.push(V),b.push(K-1),b.push(1-k)),(k===0?s+d>=$:l+d>=re)&&(b.push(K+1),b.push(G),b.push(1-k))}return S}}function aC(a,s,l,d,A,_){if(A-d<=l)return;const x=d+A>>1;gM(a,s,x,d,A,_),aC(a,s,l,d,x-1,1-_),aC(a,s,l,x+1,A,1-_)}function gM(a,s,l,d,A,_){for(;A>d;){if(A-d>600){const T=A-d+1,k=l-d+1,G=Math.log(T),V=.5*Math.exp(2*G/3),K=.5*Math.sqrt(G*V*(T-V)/T)*(k-T/2<0?-1:1);gM(a,s,l,Math.max(d,Math.floor(l-k*V/T+K)),Math.min(A,Math.floor(l+(T-k)*V/T+K)),_)}const x=s[2*l+_];let b=d,S=A;for(_m(a,s,d,l),s[2*A+_]>x&&_m(a,s,d,A);b<S;){for(_m(a,s,b,S),b++,S--;s[2*b+_]<x;)b++;for(;s[2*S+_]>x;)S--}s[2*d+_]===x?_m(a,s,d,S):(S++,_m(a,s,S,A)),S<=l&&(d=S+1),l<=S&&(A=S-1)}}function _m(a,s,l,d){lC(a,l,d),lC(s,2*l,2*d),lC(s,2*l+1,2*d+1)}function lC(a,s,l){const d=a[s];a[s]=a[l],a[l]=d}function mM(a,s,l,d){const A=a-l,_=s-d;return A*A+_*_}r.ARRAY_TYPE=ro,r.AUTH_ERR_MSG=Ce,r.Aabb=Ms,r.Actor=class{constructor(a,s,l){this.target=a,this.parent=s,this.mapId=l,this.callbacks={},this.cancelCallbacks={},ft(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qt()?a:p,this.scheduler=new tN}send(a,s,l,d,A=!1,_){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=_,this.callbacks[x]=l);const b=Dt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:a,hasCallback:!!l,targetMapId:d,mustQueue:A,sourceMapId:this.mapId,data:ru(s,b)},b),{cancel:()=>{l&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const s=a.data,l=s.id;if(l&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(s.mustQueue||Qt()){const d=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,s),d&&d.metadata||{type:"message"})}else this.processTask(l,s)}processTask(a,s){if(s.type==="<response>"){const l=this.callbacks[a];delete this.callbacks[a],l&&(s.error?l(Yl(s.error)):l(null,Yl(s.data)))}else{const l=Dt(this.globalScope)?void 0:[],d=s.hasCallback?(_,x)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:_?ru(_):null,data:ru(x,l)},l)}:_=>{},A=Yl(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,A,d);else if(this.parent.getWorkerSource){const _=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,_[0],A.source)[_[1]](A,d)}else d(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=wy,r.Color=hr,r.ColorMode=Al,r.CullFaceMode=Na,r.DEMData=Gy,r.DataConstantProperty=ne,r.DedupedRequest=fM,r.DepthMode=op,r.EXTENT=Mi,r.Elevation=class{isDataAvailableAtPoint(a){const s=this._source();if(this.isUsingMockSource()||!s||a.y<0||a.y>1)return!1;const l=s.getSource().maxzoom,d=1<<l,A=Math.floor(a.x),_=Math.floor((a.x-A)*d),x=Math.floor(a.y*d),b=this.findDEMTileFor(new Ts(l,A,l,_,x));return!(!b||!b.dem)}getAtPointOrZero(a,s=0){return this.getAtPoint(a,s)||0}getAtPoint(a,s,l=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const d=this._source();if(!d||a.y<0||a.y>1)return s;const A=d.getSource().maxzoom,_=1<<A,x=Math.floor(a.x),b=a.x-x,S=new Ts(A,x,A,Math.floor(b*_),Math.floor(a.y*_)),T=this.findDEMTileFor(S);if(!T||!T.dem)return s;const k=T.dem,G=1<<T.tileID.canonical.z,V=(b*G-T.tileID.canonical.x)*k.dim,K=(a.y*G-T.tileID.canonical.y)*k.dim,$=Math.floor(V),re=Math.floor(K);return(l?this.exaggeration():1)*an(an(k.get($,re),k.get($,re+1),K-re),an(k.get($+1,re),k.get($+1,re+1),K-re),V-$)}getAtTileOffset(a,s,l){const d=1<<a.canonical.z;return this.getAtPointOrZero(new Yf(a.wrap+(a.canonical.x+s/Mi)/d,(a.canonical.y+l/Mi)/d))}getAtTileOffsetFunc(a,s,l,d){return A=>{const _=this.getAtTileOffset(a,A.x,A.y),x=d.upVector(a.canonical,A.x,A.y);return Eo(x,x,_*d.upVectorScale(a.canonical,s,l).metersToTile),x}}getForTilePoints(a,s,l,d){if(this.isUsingMockSource())return!1;const A=Hy.create(this,a,d);return!!A&&(s.forEach(_=>{_[2]=this.exaggeration()*A.getElevationAt(_[0],_[1],l)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(a);if(!s||!s.dem)return null;const l=s.dem.tree,d=s.tileID,A=1<<a.canonical.z-d.canonical.z;let _=a.canonical.x/A-d.canonical.x,x=a.canonical.y/A-d.canonical.y,b=0;for(let S=0;S<a.canonical.z-d.canonical.z&&!l.leaves[b];S++){_*=2,x*=2;const T=2*Math.floor(x)+Math.floor(_);b=l.childOffsets[b]+T,_%=1,x%=1}return{min:this.exaggeration()*l.minimums[b],max:this.exaggeration()*l.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,s,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=As,r.EvaluationParameters=U,r.Event=Go,r.Evented=Ia,r.FillExtrusionBucket=sm,r.Frustum=AI,r.FrustumCorners=pI,r.GLOBE_RADIUS=cl,r.GLOBE_SCALE_MATCH_LATITUDE=45,r.GLOBE_ZOOM_THRESHOLD_MAX=g2,r.GLOBE_ZOOM_THRESHOLD_MIN=gI,r.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,s){const l=new Zt,d=new wi,A=[],_=a+1+2,x=s[0]+1,b=s[0]+1+(1+s.length),S=(T,k,G)=>{let V=T===_-1?T-2:T===0?T:T-1;return V+=G?24575:0,[V,k]};for(let T=0;T<_;++T)l.emplaceBack(...S(T,0,!0));for(let T=0;T<x;++T)for(let k=0;k<_;++k)l.emplaceBack(...S(k,T,(k===0||k===_-1)&&!0));for(let T=0;T<s.length;++T){const k=s[T];for(let G=0;G<_;++G)l.emplaceBack(...S(G,k,!0))}for(let T=0;T<s.length;++T){const k=d.length,G=s[T]+1+2,V=new wi;for(let re=0;re<G-1;re++){const ge=re===G-2,Me=ge?_*(b-s.length+T-re):_;for(let He=0;He<_-1;He++){const Te=re*_+He;re===0||ge||He===0||He===_-2?(V.emplaceBack(Te+1,Te,Te+Me),V.emplaceBack(Te+Me,Te+Me+1,Te+1)):(d.emplaceBack(Te+1,Te,Te+Me),d.emplaceBack(Te+Me,Te+Me+1,Te+1))}}const K=gr.simpleSegment(0,k,l.length,d.length-k);for(let re=0;re<V.uint16.length;re+=3)d.emplaceBack(V.uint16[re],V.uint16[re+1],V.uint16[re+2]);const $=gr.simpleSegment(0,k,l.length,d.length-k);A.push({withoutSkirts:K,withSkirts:$})}return{vertices:l,indices:d,segments:A}}_createGrid(a){const s=this._fillGridMeshWithLods(jh,Kg);this._gridSegments=s.segments,this._gridBuffer=a.createVertexBuffer(s.vertices,qg.members),this._gridIndexBuffer=a.createIndexBuffer(s.indices,!0)}_createPoles(a){const s=new wi;for(let A=0;A<=jh;A++)s.emplaceBack(0,A+1,A+2);this._poleIndexBuffer=a.createIndexBuffer(s,!0);const l=new Tn,d=new Tn;this._poleSegments=[];for(let A=0,_=0;A<gI;A++){const x=360/(1<<A);l.emplaceBack(0,-cl,0,.5,0),d.emplaceBack(0,-cl,0,.5,1);for(let b=0;b<=jh;b++){const S=b/jh,T=an(0,x,S),[k,G,V]=Hf(t5,i5,T,cl);l.emplaceBack(k,G,V,S,0),d.emplaceBack(k,G,V,S,1)}this._poleSegments.push(gr.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(l,p2,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(d,p2,!1)}getGridBuffers(a,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,s){if(!this._wireframeSegments){const l=new Fr,d=jh,A=d+1+2,_=1;this._wireframeSegments=[];for(let x=0,b=0;x<Kg.length;x++){const S=Kg[x];for(let k=_;k<S+_;k++)for(let G=_;G<d+_;G++){const V=k*A+G;l.emplaceBack(V,V+1),l.emplaceBack(V,V+A),l.emplaceBack(V,V+A+1)}const T=S*d*3;this._wireframeSegments.push(gr.simpleSegment(0,b,(S+1)*A,T)),b+=T}this._wireframeIndexBuffer=a.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},r.GlyphManager=tp,r.ImagePosition=HI,r.KDBush=oC,r.LivePerformanceUtils=Pi,r.LngLat=Qn,r.LngLatBounds=lu,r.LocalGlyphMode=YI,r.MAX_MERCATOR_LATITUDE=as,r.MercatorCoordinate=Yf,r.ONE_EM=jr,r.OverscaledTileID=Ts,r.PerformanceMarkers=zi,r.Point=W,r.Properties=ke,r.RGBAImage=so,r.Ray=fI,r.RequestManager=class{constructor(a,s,l){this._transformRequestFn=a,this._customAccessToken=s,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let s="";for(let l=0;l<10;l++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,s){return this._transformRequestFn&&this._transformRequestFn(a,s)||{url:a}}normalizeStyleURL(a,s){if(!Le(a))return a;const l=Je(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeGlyphsURL(a,s){if(!Le(a))return a;const l=Je(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeSourceURL(a,s,l,d){if(!Le(a))return a;const A=Je(a);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),l&&A.params.push(`language=${l}`),d&&A.params.push(`worldview=${d}`),this._makeAPIURL(A,this._customAccessToken||s)}normalizeSpriteURL(a,s,l,d){const A=Je(a);return Le(a)?(A.path=`/styles/v1${A.path}/sprite${s}${l}`,this._makeAPIURL(A,this._customAccessToken||d)):(A.path+=`${s}${l}`,Xe(A))}normalizeTileURL(a,s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Le(a))return a;const d=Je(a);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||l&&d.authority!=="raster"&&l===512?"@2x":""}${C.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${I.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${I.TILE_URL_VERSION}${d.path}`);const A=this._customAccessToken||function(_){for(const x of _){const b=x.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(d.params)||I.ACCESS_TOKEN;return I.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,A)}canonicalizeTileURL(a,s){const l=Je(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let d="mapbox://";l.path.match(/^\/raster\/v1\//)?d+=`raster/${l.path.replace(`/${I.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${l.path.replace(`/${I.TILE_URL_VERSION}/`,"")}`;let A=l.params;return s&&(A=A.filter(_=>!_.match(/^access_token=/))),A.length&&(d+=`?${A.join("&")}`),d}canonicalizeTileset(a,s){const l=!!s&&Le(s),d=[];for(const A of a.tiles||[])Oe(A)?d.push(this.canonicalizeTileURL(A,l)):d.push(A);return d}_makeAPIURL(a,s){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=Je(I.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,a.protocol==="http"){const A=a.params.indexOf("secure");A>=0&&a.params.splice(A,1)}if(d.path!=="/"&&(a.path=`${d.path}${a.path}`),!I.REQUIRE_ACCESS_TOKEN)return Xe(a);if(s=s||I.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(A=>A.indexOf("access_token")===-1),a.params.push(`access_token=${s||""}`),Xe(a)}},r.ResourceType=Xt,r.SegmentVector=gr,r.SourceCache=$h,r.StencilMode=iC,r.StructArrayLayout1ui2=no,r.StructArrayLayout2f1f2i16=Ti,r.StructArrayLayout2i4=Zt,r.StructArrayLayout2ui4=Fr,r.StructArrayLayout3f12=Ji,r.StructArrayLayout3ui6=wi,r.StructArrayLayout4i8=zt,r.StructArrayLayout5f20=Tn,r.Texture=gm,r.Tile=eC,r.Transitionable=ie,r.Uniform1f=ly,r.Uniform1i=class extends Kl{constructor(a){super(a),this.current=0}set(a,s,l){this.fetchUniformLocation(a,s)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},r.Uniform2f=class extends Kl{constructor(a){super(a),this.current=[0,0]}set(a,s,l){this.fetchUniformLocation(a,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},r.Uniform3f=class extends Kl{constructor(a){super(a),this.current=[0,0,0]}set(a,s,l){this.fetchUniformLocation(a,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},r.Uniform4f=XB,r.UniformColor=ZB,r.UniformMatrix2f=class extends Kl{constructor(a){super(a),this.current=zF}set(a,s,l){if(this.fetchUniformLocation(a,s)){for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}},r.UniformMatrix3f=class extends Kl{constructor(a){super(a),this.current=NF}set(a,s,l){if(this.fetchUniformLocation(a,s)){for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},r.UniformMatrix4f=class extends Kl{constructor(a){super(a),this.current=FF}set(a,s,l){if(this.fetchUniformLocation(a,s)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},r.UnwrappedTileID=rS,r.ValidationError=mi,r.VectorTileFeature=Cy,r.VectorTileWorkerSource=class extends Ia{constructor(a,s,l,d,A){super(),this.actor=a,this.layerIndex=s,this.availableImages=l,this.loadVectorData=A||pM,this.loading={},this.loaded={},this.deduped=new fM(a.scheduler),this.isSpriteLoaded=d,this.scheduler=a.scheduler}loadTile(a,s){const l=a.uid,d=a&&a.request,A=d&&d.collectResourceTiming,_=this.loading[l]=new lN(a);_.abort=this.loadVectorData(a,(x,b)=>{const S=!this.loading[l];if(delete this.loading[l],S||x||!b)return _.status="done",S||(this.loaded[l]=_),s(x);const T=b.rawData,k={};b.expires&&(k.expires=b.expires),b.cacheControl&&(k.cacheControl=b.cacheControl),_.vectorTile=b.vectorTile||new NI(new My(T));const G=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(V,K)=>{if(V||!K)return s(V);const $={};if(A){const re=Gn(d);re.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(re)))}s(null,st({rawTileData:T.slice(0)},K,k,$))})};this.isSpriteLoaded?G():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(G,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):G()}),this.loaded=this.loaded||{},this.loaded[l]=_})}reloadTile(a,s){const l=this.loaded,d=a.uid,A=this;if(l&&l[d]){const _=l[d];_.showCollisionBoxes=a.showCollisionBoxes,_.enableTerrain=!!a.enableTerrain,_.projection=a.projection,_.tileTransform=Zh(a.tileID.canonical,a.projection);const x=(b,S)=>{const T=_.reloadCallback;T&&(delete _.reloadCallback,_.parse(_.vectorTile,A.layerIndex,this.availableImages,A.actor,T)),s(b,S)};_.status==="parsing"?_.reloadCallback=x:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(a,s){const l=a.uid,d=this.loading[l];d&&(d.abort&&d.abort(),delete this.loading[l]),s()}removeTile(a,s){const l=this.loaded,d=a.uid;l&&l[d]&&delete l[d],s()}},r.WritingMode=bo,r.ZoomDependentExpression=Lh,r.add=Xl,r.addDynamicAttributes=zy,r.adjoint=function(a,s){var l=s[0],d=s[1],A=s[2],_=s[3],x=s[4],b=s[5],S=s[6],T=s[7],k=s[8];return a[0]=x*k-b*T,a[1]=A*T-d*k,a[2]=d*b-A*x,a[3]=b*S-_*k,a[4]=l*k-A*S,a[5]=A*_-l*b,a[6]=_*T-x*S,a[7]=d*S-l*T,a[8]=l*x-d*_,a},r.asyncAll=Tt,r.bezier=De,r.bindAll=ft,r.boundsAttributes=JS,r.bufferConvexPolygon=function(a,s){const l=[];for(let d=0;d<a.length;d++){const A=oe(d-1,-1,a.length-1),_=oe(d+1,-1,a.length-1),x=a[d],b=a[_],S=a[A].sub(x).unit(),T=b.sub(x).unit(),k=T.angleWithSep(S.x,S.y),G=S.add(T).unit().mult(-1*s/Math.sin(k/2));l.push(x.add(G))}return l},r.cacheEntryPossiblyAdded=function(a){fi++,fi>yt&&(a.getActor().send("enforceCacheSizeLimit",St),fi=0)},r.calculateGlobeLabelMatrix=function(a,s){const{x:l,y:d}=a.point,A=x2(l,d,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Vh(A,A,yI(ul(s)))},r.calculateGlobeMatrix=function(a){const{x:s,y:l}=a.point,{lng:d,lat:A}=a._center;return x2(s,l,a.worldSize,d,A)},r.calculateGlobeMercatorMatrix=function(a){const s=a.pixelsPerMeter,l=s/Pa(1,a.center.lat),d=Ra(new Float64Array(16));return Gg(d,d,[a.point.x,a.point.y,0]),Wh(d,d,[l,l,s]),Float32Array.from(d)},r.circumferenceAtLatitude=xI,r.clamp=ye,r.clearTileCache=function(a){if(!Ue())return;const s=p.caches.delete(at);a&&s.catch(a).then(()=>a())},r.clipLine=QS,r.clone=function(a){var s=new ro(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},r.clone$1=_e,r.collisionCircleLayout=o4,r.config=I,r.conjugate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a[3]=s[3],a},r.create=function(){var a=new ro(16);return ro!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},r.create$1=t2,r.createExpression=tu,r.createLayout=lt,r.createStyleLayer=function(a){return a.type==="custom"?new X4(a):new $4[a.type](a)},r.cross=dI,r.degToRad=te,r.distance=function(a,s){return Math.hypot(s[0]-a[0],s[1]-a[1],s[2]-a[2])},r.div=function(a,s,l){return a[0]=s[0]/l[0],a[1]=s[1]/l[1],a[2]=s[2]/l[2],a},r.dot=jo,r.earthRadius=Zg,r.ease=Re,r.easeCubicInOut=Be,r.ecefToLatLng=function([a,s,l]){const d=Math.hypot(a,s,l),A=Math.atan2(a,l),_=.5*Math.PI-Math.acos(-s/d);return new Qn(ce(A),ce(_))},r.emitValidationErrors=iy,r.endsWith=Ve,r.enforceCacheSizeLimit=function(a){ot(),Pt&&Pt.then(s=>{s.keys().then(l=>{for(let d=0;d<l.length-a;d++)s.delete(l[d])})})},r.evaluateSizeForFeature=By,r.evaluateSizeForZoom=Xf,r.evaluateVariableOffset=FS,r.evented=w,r.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]},r.exactEquals$1=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]},r.exported=Mr,r.exported$1=C,r.extend=st,r.extend$1=Wr,r.fillExtrusionHeightLift=tS,r.filterObject=ae,r.fromMat4=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[4],a[4]=s[5],a[5]=s[6],a[6]=s[8],a[7]=s[9],a[8]=s[10],a},r.fromQuat=function(a,s){var l=s[0],d=s[1],A=s[2],_=s[3],x=l+l,b=d+d,S=A+A,T=l*x,k=d*x,G=d*b,V=A*x,K=A*b,$=A*S,re=_*x,ge=_*b,Me=_*S;return a[0]=1-G-$,a[1]=k+Me,a[2]=V-ge,a[3]=0,a[4]=k-Me,a[5]=1-T-$,a[6]=K+re,a[7]=0,a[8]=V+ge,a[9]=K-re,a[10]=1-T-G,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},r.fromRotation=function(a,s){var l=Math.sin(s),d=Math.cos(s);return a[0]=d,a[1]=l,a[2]=0,a[3]=-l,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},r.fromScaling=n2,r.furthestTileCorner=function(a){const s=Math.round((a+45+360)%360/90)%4;return Ee[s]},r.getAABBPointSquareDist=function(a,s,l){let d=0;for(let A=0;A<2;++A){const _=l?l[A]:0;a[A]>_&&(d+=(a[A]-_)*(a[A]-_)),s[A]<_&&(d+=(_-s[A])*(_-s[A]))}return d},r.getAnchorAlignment=WI,r.getAnchorJustification=qI,r.getBounds=function(a){let s=1/0,l=1/0,d=-1/0,A=-1/0;for(const _ of a)s=Math.min(s,_.x),l=Math.min(l,_.y),d=Math.max(d,_.x),A=Math.max(A,_.y);return{min:new W(s,l),max:new W(d,A)}},r.getColumn=ue,r.getDefaultExportFromCjs=F,r.getGridMatrix=function(a,s,l,d){const A=s.getNorth(),_=s.getSouth(),x=s.getWest(),b=s.getEast(),S=1<<a.z,T=b-x,k=A-_,G=T/jh,V=-k/Kg[l],K=[0,G,0,V,0,0,A,x,0];if(a.z>0){const $=180/d;i2(K,K,[$/T+1,0,0,0,$/k+1,0,-.5*$/G,.5*$/V,1])}return K[2]=S,K[5]=a.x,K[8]=a.y,K},r.getImage=Ae,r.getJSON=function(a,s){return wt(st(a,{type:"json"}),s)},r.getLatitudinalLod=function(a){const s=as-5;a=ye(a,-s,s)/s*90;const l=Math.pow(Math.abs(Math.sin(te(a))),3);return Math.round(l*(Kg.length-1))},r.getMapSessionAPI=oi,r.getPerformanceMeasurement=Gn,r.getProjection=WS,r.getRTLTextPluginStatus=B,r.getReferrer=si,r.getTilePoint=function(a,{x:s,y:l},d=0){return new W(((s-d)*a.scale-a.x)*Mi,(l*a.scale-a.y)*Mi)},r.getTileVec3=function(a,s,l=0){return Gf(((s.x-l)*a.scale-a.x)*Mi,(s.y*a.scale-a.y)*Mi,w2(s.z,s.y))},r.getVideo=function(a,s){const l=p.document.createElement("video");l.muted=!0,l.onloadstart=function(){s(null,l)};for(let d=0;d<a.length;d++){const A=p.document.createElement("source");yi(a[d])||(l.crossOrigin="Anonymous"),A.src=a[d],l.appendChild(A)}return{cancel:()=>{}}},r.globeCenterToScreenPoint=function(a){const s=[0,0,0],l=Ra(new Float64Array(16));return Vh(l,a.pixelMatrix,a.globeMatrix),dr(s,s,l),new W(s[0],s[1])},r.globeDenormalizeECEF=yI,r.globeECEFOrigin=function(a,s){const l=[0,0,0];return dr(l,l,Xg(ul(s.canonical))),dr(l,l,a),l},r.globeMetersToEcef=hy,r.globeNormalizeECEF=Xg,r.globePixelsToTileUnits=function(a,s){return Mi/(512*Math.pow(2,a))*fy(ul(s))},r.globePoleMatrixForTile=function(a,s,l){const d=Ra(new Float64Array(16)),A=(s/(1<<a)-.5)*Math.PI*2;return uy(d,l.globeMatrix,A),Float32Array.from(d)},r.globeTileBounds=ul,r.globeTiltAtLngLat=I2,r.globeToMercatorTransition=Wf,r.globeUseCustomAntiAliasing=function(a,s,l){const d=Wf(l.zoom),A=a.style.map._antialias,_=!!s.extStandardDerivatives,x=s.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return d===0&&!A&&!x&&_},r.identity=Ra,r.identity$1=h2,r.invert=lI,r.isFullscreen=function(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement},r.isLngLatBehindGlobe=vI,r.isMapAuthenticated=function(a){return ci.has(a)},r.isMapboxURL=Le,r.isSafariWithAntialiasingBug=function(a){const s=a.navigator?a.navigator.userAgent:null;return!!Dt(a)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=os,r.latLngToECEF=Vf,r.len=qF,r.length=Hg,r.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},r.lngFromMercatorX=wo,r.loadVectorTile=pM,r.makeRequest=wt,r.mapValue=function(a,s,l,d,A){return ye((a-s)/(l-s)*(A-d)+d,d,A)},r.mercatorScale=b2,r.mercatorXfromLng=hl,r.mercatorYfromLat=dl,r.mercatorZfromAltitude=Pa,r.mul=YF,r.mul$1=jF,r.multiply=Vh,r.multiply$1=i2,r.multiply$2=o2,r.nextPowerOfTwo=dt,r.normalize=Ss,r.normalize$1=KF,r.normalize$2=c2,r.number=an,r.ortho=function(a,s,l,d,A,_,x){var b=1/(s-l),S=1/(d-A),T=1/(_-x);return a[0]=-2*b,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*T,a[11]=0,a[12]=(s+l)*b,a[13]=(A+d)*S,a[14]=(x+_)*T,a[15]=1,a},r.pbf=hS,r.perspective=function(a,s,l,d,A){var _,x=1/Math.tan(s/2);return a[0]=x/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,A!=null&&A!==1/0?(a[10]=(A+d)*(_=1/(d-A)),a[14]=2*A*d*_):(a[10]=-1,a[14]=-2*d),a},r.pick=function(a,s){const l={};for(let d=0;d<s.length;d++){const A=s[d];A in a&&(l[A]=a[A])}return l},r.plugin=L,r.pointGeometry=q,r.polesInViewport=function(a){const s=Ra(new Float64Array(16));Vh(s,a.pixelMatrix,a.globeMatrix);const l=[0,qo,0],d=[0,Ko,0];return dr(l,l,s),dr(d,d,s),[l[0]>0&&l[0]<=a.width&&l[1]>0&&l[1]<=a.height&&!vI(a,new Qn(a.center.lat,90)),d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!vI(a,new Qn(a.center.lat,-90))]},r.polygonContainsPoint=Jh,r.polygonIntersectsBox=R2,r.polygonIntersectsPolygon=M2,r.polygonizeBounds=function(a,s,l=0,d=!0){const A=new W(l,l),_=a.sub(A),x=s.add(A),b=[_,new W(x.x,_.y),x,new W(_.x,x.y)];return d&&b.push(_.clone()),b},r.posAttributes=qg,r.postMapLoadEvent=it,r.postPerformanceEvent=li,r.postTurnstileEvent=je,r.potpack=GI,r.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},r.radToDeg=ce,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(a){return a({pluginStatus:m,pluginURL:c}),w.on("pluginStateChange",a),a},r.removeAuthState=function(a){ci.delete(a)},r.renderColorRamp=MI,r.resample=B2,r.rotateX=cI,r.rotateX$1=d2,r.rotateY=uy,r.rotateY$1=f2,r.rotateZ=function(a,s,l){var d=Math.sin(l),A=Math.cos(l),_=s[0],x=s[1],b=s[2],S=s[3],T=s[4],k=s[5],G=s[6],V=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=_*A+T*d,a[1]=x*A+k*d,a[2]=b*A+G*d,a[3]=S*A+V*d,a[4]=T*A-_*d,a[5]=k*A-x*d,a[6]=G*A-b*d,a[7]=V*A-S*d,a},r.rotateZ$1=function(a,s,l){l*=.5;var d=s[0],A=s[1],_=s[2],x=s[3],b=Math.sin(l),S=Math.cos(l);return a[0]=d*S+A*b,a[1]=A*S-d*b,a[2]=_*S+x*b,a[3]=x*S-_*b,a},r.scale=Wh,r.scale$1=l2,r.scale$2=Eo,r.scaleAndAdd=Yg,r.set=function(a,s,l,d){return a[0]=s,a[1]=l,a[2]=d,a},r.setCacheLimits=function(a,s){St=a,yt=s},r.setColumn=function(a,s,l){a[4*s+0]=l[0],a[4*s+1]=l[1],a[4*s+2]=l[2],a[4*s+3]=l[3]},r.setRTLTextPlugin=function(a,s,l=!1){if(m===Fg||m===Ng||m===zg)throw new Error("setRTLTextPlugin cannot be called multiple times.");c=Mr.resolveURL(a),m=Fg,su=s,y(),l||R()},r.smoothstep=ht,r.spec=Mt,r.squaredLength=function(a){var s=a[0],l=a[1],d=a[2];return s*s+l*l+d*d},r.storeAuthState=function(a,s){s?ci.add(a):ci.delete(a)},r.sub=La,r.subtract=hI,r.symbolSize=a4,r.tileAABB=function(a,s,l,d,A,_,x,b,S){if(S.name==="globe")return e5(a,s,new wy(l,d,A));const T=Zh({z:l,x:d,y:A},S);return new Ms([(_+T.x/T.scale)*s,s*(T.y/T.scale),x],[(_+T.x2/T.scale)*s,s*(T.y2/T.scale),b])},r.tileCornersToBounds=dy,r.tileTransform=Zh,r.transformMat3=function(a,s,l){var d=s[0],A=s[1],_=s[2];return a[0]=d*l[0]+A*l[3]+_*l[6],a[1]=d*l[1]+A*l[4]+_*l[7],a[2]=d*l[2]+A*l[5]+_*l[8],a},r.transformMat4=dr,r.transformMat4$1=Yh,r.transformQuat=a2,r.transitionTileAABBinECEF=_2,r.translate=Gg,r.transpose=function(a,s){if(a===s){var l=s[1],d=s[2],A=s[5];a[1]=s[3],a[2]=s[6],a[3]=l,a[5]=s[7],a[6]=d,a[7]=A}else a[0]=s[0],a[1]=s[3],a[2]=s[6],a[3]=s[1],a[4]=s[4],a[5]=s[7],a[6]=s[2],a[7]=s[5],a[8]=s[8];return a},r.triggerPluginCompletionEvent=f,r.uniqueId=Ke,r.updateGlobeVertexNormal=function(a,s,l,d,A){const _=5*s+2;a.float32[_+0]=l,a.float32[_+1]=d,a.float32[_+2]=A},r.validateCustomStyleLayer=function(a){const s=[],l=a.id;return l===void 0&&s.push({message:`layers.${l}: missing required property "id"`}),a.render===void 0&&s.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&s.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),s},r.validateFilter=a=>io(zh(a)),r.validateFog=a=>io($0(a)),r.validateLayer=a=>io(K0(a)),r.validateLight=a=>io(Z0(a)),r.validateSource=a=>io(X0(a)),r.validateStyle=ty,r.validateTerrain=a=>io(Qg(a)),r.values=Fe,r.vectorTile=Iy,r.version=g,r.warnOnce=nt,r.window=p,r.wrap=oe}),u(["./shared"],function(r){function p(ee){if(typeof ee=="number"||typeof ee=="boolean"||typeof ee=="string"||ee==null)return JSON.stringify(ee);if(Array.isArray(ee)){let Z="[";for(const Ae of ee)Z+=`${p(Ae)},`;return`${Z}]`}let J="{";for(const Z of Object.keys(ee).sort())J+=`${Z}:${p(ee[Z])},`;return`${J}}`}function g(ee){let J="";for(const Z of r.refProperties)J+=`/${p(ee[Z])}`;return J}class v{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,Z){for(const Ce of J)this._layerConfigs[Ce.id]=Ce,(this._layers[Ce.id]=r.createStyleLayer(Ce)).compileFilter(),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id];for(const Ce of Z)delete this.keyCache[Ce],delete this._layerConfigs[Ce],delete this._layers[Ce];this.familiesBySource={};const Ae=function(Ce,Le){const Oe={};for(let me=0;me<Ce.length;me++){const he=Le&&Le[Ce[me].id]||g(Ce[me]);Le&&(Le[Ce[me].id]=he);let Qe=Oe[he];Qe||(Qe=Oe[he]=[]),Qe.push(Ce[me])}const le=[];for(const me in Oe)le.push(Oe[me]);return le}(r.values(this._layerConfigs),this.keyCache);for(const Ce of Ae){const Le=Ce.map(Je=>this._layers[Je.id]),Oe=Le[0];if(Oe.visibility==="none")continue;const le=Oe.source||"";let me=this.familiesBySource[le];me||(me=this.familiesBySource[le]={});const he=Oe.sourceLayer||"_geojsonTileLayer";let Qe=me[he];Qe||(Qe=me[he]=[]),Qe.push(Le)}}}class I{loadTile(J,Z){const{uid:Ae,encoding:Ce,rawImageData:Le,padding:Oe,buildQuadTree:le}=J,me=r.window.ImageBitmap&&Le instanceof r.window.ImageBitmap?this.getImageData(Le,Oe):Le;Z(null,new r.DEMData(Ae,me,Ce,Oe<1,le))}getImageData(J,Z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(J.width,J.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=J.width,this.offscreenCanvas.height=J.height,this.offscreenCanvasContext.drawImage(J,0,0,J.width,J.height);const Ae=this.offscreenCanvasContext.getImageData(-Z,-Z,J.width+2*Z,J.height+2*Z);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}function C(ee,J){if(ee.length!==0){E(ee[0],J);for(var Z=1;Z<ee.length;Z++)E(ee[Z],!J)}}function E(ee,J){for(var Z=0,Ae=0,Ce=0,Le=ee.length,Oe=Le-1;Ce<Le;Oe=Ce++){var le=(ee[Ce][0]-ee[Oe][0])*(ee[Oe][1]+ee[Ce][1]),me=Z+le;Ae+=Math.abs(Z)>=Math.abs(le)?Z-me+le:le-me+Z,Z=me}Z+Ae>=0!=!!J&&ee.reverse()}var Q=r.getDefaultExportFromCjs(function ee(J,Z){var Ae,Ce=J&&J.type;if(Ce==="FeatureCollection")for(Ae=0;Ae<J.features.length;Ae++)ee(J.features[Ae],Z);else if(Ce==="GeometryCollection")for(Ae=0;Ae<J.geometries.length;Ae++)ee(J.geometries[Ae],Z);else if(Ce==="Feature")ee(J.geometry,Z);else if(Ce==="Polygon")C(J.coordinates,Z);else if(Ce==="MultiPolygon")for(Ae=0;Ae<J.coordinates.length;Ae++)C(J.coordinates[Ae],Z);return J});const M=r.VectorTileFeature.prototype.toGeoJSON;var D={exports:{}},P=r.pointGeometry,O=r.vectorTile.VectorTileFeature,F=N;function N(ee,J){this.options=J||{},this.features=ee,this.length=ee.length}function z(ee,J){this.id=typeof ee.id=="number"?ee.id:void 0,this.type=ee.type,this.rawGeometry=ee.type===1?[ee.geometry]:ee.geometry,this.properties=ee.tags,this.extent=J||4096}N.prototype.feature=function(ee){return new z(this.features[ee],this.options.extent)},z.prototype.loadGeometry=function(){var ee=this.rawGeometry;this.geometry=[];for(var J=0;J<ee.length;J++){for(var Z=ee[J],Ae=[],Ce=0;Ce<Z.length;Ce++)Ae.push(new P(Z[Ce][0],Z[Ce][1]));this.geometry.push(Ae)}return this.geometry},z.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ee=this.geometry,J=1/0,Z=-1/0,Ae=1/0,Ce=-1/0,Le=0;Le<ee.length;Le++)for(var Oe=ee[Le],le=0;le<Oe.length;le++){var me=Oe[le];J=Math.min(J,me.x),Z=Math.max(Z,me.x),Ae=Math.min(Ae,me.y),Ce=Math.max(Ce,me.y)}return[J,Ae,Z,Ce]},z.prototype.toGeoJSON=O.prototype.toGeoJSON;var X=r.pbf,q=F;function H(ee){var J=new X;return function(Z,Ae){for(var Ce in Z.layers)Ae.writeMessage(3,W,Z.layers[Ce])}(ee,J),J.finish()}function W(ee,J){var Z;J.writeVarintField(15,ee.version||1),J.writeStringField(1,ee.name||""),J.writeVarintField(5,ee.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<ee.length;Z++)Ae.feature=ee.feature(Z),J.writeMessage(2,se,Ae);var Ce=Ae.keys;for(Z=0;Z<Ce.length;Z++)J.writeStringField(3,Ce[Z]);var Le=Ae.values;for(Z=0;Z<Le.length;Z++)J.writeMessage(4,Be,Le[Z])}function se(ee,J){var Z=ee.feature;Z.id!==void 0&&J.writeVarintField(1,Z.id),J.writeMessage(2,de,ee),J.writeVarintField(3,Z.type),J.writeMessage(4,Ee,Z)}function de(ee,J){var Z=ee.feature,Ae=ee.keys,Ce=ee.values,Le=ee.keycache,Oe=ee.valuecache;for(var le in Z.properties){var me=Z.properties[le],he=Le[le];if(me!==null){he===void 0&&(Ae.push(le),Le[le]=he=Ae.length-1),J.writeVarint(he);var Qe=typeof me;Qe!=="string"&&Qe!=="boolean"&&Qe!=="number"&&(me=JSON.stringify(me));var Je=Qe+":"+me,Xe=Oe[Je];Xe===void 0&&(Ce.push(me),Oe[Je]=Xe=Ce.length-1),J.writeVarint(Xe)}}}function te(ee,J){return(J<<3)+(7&ee)}function ce(ee){return ee<<1^ee>>31}function Ee(ee,J){for(var Z=ee.loadGeometry(),Ae=ee.type,Ce=0,Le=0,Oe=Z.length,le=0;le<Oe;le++){var me=Z[le],he=1;Ae===1&&(he=me.length),J.writeVarint(te(1,he));for(var Qe=Ae===3?me.length-1:me.length,Je=0;Je<Qe;Je++){Je===1&&Ae!==1&&J.writeVarint(te(2,Qe-1));var Xe=me[Je].x-Ce,Ft=me[Je].y-Le;J.writeVarint(ce(Xe)),J.writeVarint(ce(Ft)),Ce+=Xe,Le+=Ft}Ae===3&&J.writeVarint(te(7,1))}}function Be(ee,J){var Z=typeof ee;Z==="string"?J.writeStringField(1,ee):Z==="boolean"?J.writeBooleanField(7,ee):Z==="number"&&(ee%1!=0?J.writeDoubleField(3,ee):ee<0?J.writeSVarintField(6,ee):J.writeVarintField(5,ee))}D.exports=H,D.exports.fromVectorTileJs=H,D.exports.fromGeojsonVt=function(ee,J){J=J||{};var Z={};for(var Ae in ee)Z[Ae]=new q(ee[Ae].features,J),Z[Ae].name=Ae,Z[Ae].version=J.version,Z[Ae].extent=J.extent;return H({layers:Z})},D.exports.GeoJSONWrapper=q;var De=r.getDefaultExportFromCjs(D.exports);const Re={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ee=>ee},ye=Math.fround||(ht=new Float32Array(1),ee=>(ht[0]=+ee,ht[0]));var ht;const oe=3,Tt=5,Fe=6;class st{constructor(J){this.options=Object.assign(Object.create(Re),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){const{log:Z,minZoom:Ae,maxZoom:Ce}=this.options;Z&&console.time("total time");const Le=`prepare ${J.length} points`;Z&&console.time(Le),this.points=J;const Oe=[];for(let me=0;me<J.length;me++){const he=J[me];if(!he.geometry)continue;const[Qe,Je]=he.geometry.coordinates,Xe=ye(Ne(Qe)),Ft=ye(dt(Je));Oe.push(Xe,Ft,1/0,me,-1,1),this.options.reduce&&Oe.push(0)}let le=this.trees[Ce+1]=this._createTree(Oe);Z&&console.timeEnd(Le);for(let me=Ce;me>=Ae;me--){const he=+Date.now();le=this.trees[me]=this._createTree(this._cluster(le,me)),Z&&console.log("z%d: %d clusters in %dms",me,le.numItems,+Date.now()-he)}return Z&&console.timeEnd("total time"),this}getClusters(J,Z){let Ae=((J[0]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,J[1]));let Le=J[2]===180?180:((J[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)Ae=-180,Le=180;else if(Ae>Le){const Je=this.getClusters([Ae,Ce,180,Oe],Z),Xe=this.getClusters([-180,Ce,Le,Oe],Z);return Je.concat(Xe)}const le=this.trees[this._limitZoom(Z)],me=le.range(Ne(Ae),dt(Oe),Ne(Le),dt(Ce)),he=le.data,Qe=[];for(const Je of me){const Xe=this.stride*Je;Qe.push(he[Xe+Tt]>1?Et(he,Xe,this.clusterProps):this.points[he[Xe+oe]])}return Qe}getChildren(J){const Z=this._getOriginId(J),Ae=this._getOriginZoom(J),Ce="No cluster with the specified id.",Le=this.trees[Ae];if(!Le)throw new Error(Ce);const Oe=Le.data;if(Z*this.stride>=Oe.length)throw new Error(Ce);const le=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),me=Le.within(Oe[Z*this.stride],Oe[Z*this.stride+1],le),he=[];for(const Qe of me){const Je=Qe*this.stride;Oe[Je+4]===J&&he.push(Oe[Je+Tt]>1?Et(Oe,Je,this.clusterProps):this.points[Oe[Je+oe]])}if(he.length===0)throw new Error(Ce);return he}getLeaves(J,Z,Ae){const Ce=[];return this._appendLeaves(Ce,J,Z=Z||10,Ae=Ae||0,0),Ce}getTile(J,Z,Ae){const Ce=this.trees[this._limitZoom(J)],Le=Math.pow(2,J),{extent:Oe,radius:le}=this.options,me=le/Oe,he=(Ae-me)/Le,Qe=(Ae+1+me)/Le,Je={features:[]};return this._addTileFeatures(Ce.range((Z-me)/Le,he,(Z+1+me)/Le,Qe),Ce.data,Z,Ae,Le,Je),Z===0&&this._addTileFeatures(Ce.range(1-me/Le,he,1,Qe),Ce.data,Le,Ae,Le,Je),Z===Le-1&&this._addTileFeatures(Ce.range(0,he,me/Le,Qe),Ce.data,-1,Ae,Le,Je),Je.features.length?Je:null}getClusterExpansionZoom(J){let Z=this._getOriginZoom(J)-1;for(;Z<=this.options.maxZoom;){const Ae=this.getChildren(J);if(Z++,Ae.length!==1)break;J=Ae[0].properties.cluster_id}return Z}_appendLeaves(J,Z,Ae,Ce,Le){const Oe=this.getChildren(Z);for(const le of Oe){const me=le.properties;if(me&&me.cluster?Le+me.point_count<=Ce?Le+=me.point_count:Le=this._appendLeaves(J,me.cluster_id,Ae,Ce,Le):Le<Ce?Le++:J.push(le),J.length===Ae)break}return Le}_createTree(J){const Z=new r.KDBush(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<J.length;Ae+=this.stride)Z.add(J[Ae],J[Ae+1]);return Z.finish(),Z.data=J,Z}_addTileFeatures(J,Z,Ae,Ce,Le,Oe){for(const le of J){const me=le*this.stride,he=Z[me+Tt]>1;let Qe,Je,Xe;if(he)Qe=Ke(Z,me,this.clusterProps),Je=Z[me],Xe=Z[me+1];else{const qt=this.points[Z[me+oe]];Qe=qt.properties;const[pe,je]=qt.geometry.coordinates;Je=Ne(pe),Xe=dt(je)}const Ft={type:1,geometry:[[Math.round(this.options.extent*(Je*Le-Ae)),Math.round(this.options.extent*(Xe*Le-Ce))]],tags:Qe};let Wt;Wt=he||this.options.generateId?Z[me+oe]:this.points[Z[me+oe]].id,Wt!==void 0&&(Ft.id=Wt),Oe.features.push(Ft)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,Z){const{radius:Ae,extent:Ce,reduce:Le,minPoints:Oe}=this.options,le=Ae/(Ce*Math.pow(2,Z)),me=J.data,he=[],Qe=this.stride;for(let Je=0;Je<me.length;Je+=Qe){if(me[Je+2]<=Z)continue;me[Je+2]=Z;const Xe=me[Je],Ft=me[Je+1],Wt=J.within(me[Je],me[Je+1],le),qt=me[Je+Tt];let pe=qt;for(const je of Wt){const pt=je*Qe;me[pt+2]>Z&&(pe+=me[pt+Tt])}if(pe>qt&&pe>=Oe){let je,pt=Xe*qt,it=Ft*qt,Ct=-1;const li=((Je/Qe|0)<<5)+(Z+1)+this.points.length;for(const Ai of Wt){const oi=Ai*Qe;if(me[oi+2]<=Z)continue;me[oi+2]=Z;const ci=me[oi+Tt];pt+=me[oi]*ci,it+=me[oi+1]*ci,me[oi+4]=li,Le&&(je||(je=this._map(me,Je,!0),Ct=this.clusterProps.length,this.clusterProps.push(je)),Le(je,this._map(me,oi)))}me[Je+4]=li,he.push(pt/pe,it/pe,1/0,li,-1,pe),Le&&he.push(Ct)}else{for(let je=0;je<Qe;je++)he.push(me[Je+je]);if(pe>1)for(const je of Wt){const pt=je*Qe;if(!(me[pt+2]<=Z)){me[pt+2]=Z;for(let it=0;it<Qe;it++)he.push(me[pt+it])}}}}return he}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,Z,Ae){if(J[Z+Tt]>1){const Oe=this.clusterProps[J[Z+Fe]];return Ae?Object.assign({},Oe):Oe}const Ce=this.points[J[Z+oe]].properties,Le=this.options.map(Ce);return Ae&&Le===Ce?Object.assign({},Le):Le}}function Et(ee,J,Z){return{type:"Feature",id:ee[J+oe],properties:Ke(ee,J,Z),geometry:{type:"Point",coordinates:[(Ae=ee[J],360*(Ae-.5)),xt(ee[J+1])]}};var Ae}function Ke(ee,J,Z){const Ae=ee[J+Tt],Ce=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,Le=ee[J+Fe],Oe=Le===-1?{}:Object.assign({},Z[Le]);return Object.assign(Oe,{cluster:!0,cluster_id:ee[J+oe],point_count:Ae,point_count_abbreviated:Ce})}function Ne(ee){return ee/360+.5}function dt(ee){const J=Math.sin(ee*Math.PI/180),Z=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return Z<0?0:Z>1?1:Z}function xt(ee){const J=(180-360*ee)*Math.PI/180;return 360*Math.atan(Math.exp(J))/Math.PI-90}function ft(ee,J,Z,Ae){for(var Ce,Le=Ae,Oe=Z-J>>1,le=Z-J,me=ee[J],he=ee[J+1],Qe=ee[Z],Je=ee[Z+1],Xe=J+3;Xe<Z;Xe+=3){var Ft=Ve(ee[Xe],ee[Xe+1],me,he,Qe,Je);if(Ft>Le)Ce=Xe,Le=Ft;else if(Ft===Le){var Wt=Math.abs(Xe-Oe);Wt<le&&(Ce=Xe,le=Wt)}}Le>Ae&&(Ce-J>3&&ft(ee,J,Ce,Ae),ee[Ce+2]=Le,Z-Ce>3&&ft(ee,Ce,Z,Ae))}function Ve(ee,J,Z,Ae,Ce,Le){var Oe=Ce-Z,le=Le-Ae;if(Oe!==0||le!==0){var me=((ee-Z)*Oe+(J-Ae)*le)/(Oe*Oe+le*le);me>1?(Z=Ce,Ae=Le):me>0&&(Z+=Oe*me,Ae+=le*me)}return(Oe=ee-Z)*Oe+(le=J-Ae)*le}function Ye(ee,J,Z,Ae){var Ce={id:ee===void 0?null:ee,type:J,geometry:Z,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Le){var Oe=Le.geometry,le=Le.type;if(le==="Point"||le==="MultiPoint"||le==="LineString")ae(Le,Oe);else if(le==="Polygon"||le==="MultiLineString")for(var me=0;me<Oe.length;me++)ae(Le,Oe[me]);else if(le==="MultiPolygon")for(me=0;me<Oe.length;me++)for(var he=0;he<Oe[me].length;he++)ae(Le,Oe[me][he])}(Ce),Ce}function ae(ee,J){for(var Z=0;Z<J.length;Z+=3)ee.minX=Math.min(ee.minX,J[Z]),ee.minY=Math.min(ee.minY,J[Z+1]),ee.maxX=Math.max(ee.maxX,J[Z]),ee.maxY=Math.max(ee.maxY,J[Z+1])}function _e(ee,J,Z,Ae){if(J.geometry){var Ce=J.geometry.coordinates,Le=J.geometry.type,Oe=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),le=[],me=J.id;if(Z.promoteId?me=J.properties[Z.promoteId]:Z.generateId&&(me=Ae||0),Le==="Point")Ze(Ce,le);else if(Le==="MultiPoint")for(var he=0;he<Ce.length;he++)Ze(Ce[he],le);else if(Le==="LineString")nt(Ce,le,Oe,!1);else if(Le==="MultiLineString"){if(Z.lineMetrics){for(he=0;he<Ce.length;he++)nt(Ce[he],le=[],Oe,!1),ee.push(Ye(me,"LineString",le,J.properties));return}ut(Ce,le,Oe,!1)}else if(Le==="Polygon")ut(Ce,le,Oe,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(he=0;he<J.geometry.geometries.length;he++)_e(ee,{id:me,geometry:J.geometry.geometries[he],properties:J.properties},Z,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(he=0;he<Ce.length;he++){var Qe=[];ut(Ce[he],Qe,Oe,!0),le.push(Qe)}}ee.push(Ye(me,Le,le,J.properties))}}function Ze(ee,J){J.push(ze(ee[0])),J.push(Qt(ee[1])),J.push(0)}function nt(ee,J,Z,Ae){for(var Ce,Le,Oe=0,le=0;le<ee.length;le++){var me=ze(ee[le][0]),he=Qt(ee[le][1]);J.push(me),J.push(he),J.push(0),le>0&&(Oe+=Ae?(Ce*he-me*Le)/2:Math.sqrt(Math.pow(me-Ce,2)+Math.pow(he-Le,2))),Ce=me,Le=he}var Qe=J.length-3;J[2]=1,ft(J,0,Qe,Z),J[Qe+2]=1,J.size=Math.abs(Oe),J.start=0,J.end=J.size}function ut(ee,J,Z,Ae){for(var Ce=0;Ce<ee.length;Ce++){var Le=[];nt(ee[Ce],Le,Z,Ae),J.push(Le)}}function ze(ee){return ee/360+.5}function Qt(ee){var J=Math.sin(ee*Math.PI/180),Z=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return Z<0?0:Z>1?1:Z}function mt(ee,J,Z,Ae,Ce,Le,Oe,le){if(Ae/=J,Le>=(Z/=J)&&Oe<Ae)return ee;if(Oe<Z||Le>=Ae)return null;for(var me=[],he=0;he<ee.length;he++){var Qe=ee[he],Je=Qe.geometry,Xe=Qe.type,Ft=Ce===0?Qe.minX:Qe.minY,Wt=Ce===0?Qe.maxX:Qe.maxY;if(Ft>=Z&&Wt<Ae)me.push(Qe);else if(!(Wt<Z||Ft>=Ae)){var qt=[];if(Xe==="Point"||Xe==="MultiPoint")Ut(Je,qt,Z,Ae,Ce);else if(Xe==="LineString")Dt(Je,qt,Z,Ae,Ce,!1,le.lineMetrics);else if(Xe==="MultiLineString")ue(Je,qt,Z,Ae,Ce,!1);else if(Xe==="Polygon")ue(Je,qt,Z,Ae,Ce,!0);else if(Xe==="MultiPolygon")for(var pe=0;pe<Je.length;pe++){var je=[];ue(Je[pe],je,Z,Ae,Ce,!0),je.length&&qt.push(je)}if(qt.length){if(le.lineMetrics&&Xe==="LineString"){for(pe=0;pe<qt.length;pe++)me.push(Ye(Qe.id,Xe,qt[pe],Qe.tags));continue}Xe!=="LineString"&&Xe!=="MultiLineString"||(qt.length===1?(Xe="LineString",qt=qt[0]):Xe="MultiLineString"),Xe!=="Point"&&Xe!=="MultiPoint"||(Xe=qt.length===3?"Point":"MultiPoint"),me.push(Ye(Qe.id,Xe,qt,Qe.tags))}}}return me.length?me:null}function Ut(ee,J,Z,Ae,Ce){for(var Le=0;Le<ee.length;Le+=3){var Oe=ee[Le+Ce];Oe>=Z&&Oe<=Ae&&(J.push(ee[Le]),J.push(ee[Le+1]),J.push(ee[Le+2]))}}function Dt(ee,J,Z,Ae,Ce,Le,Oe){for(var le,me,he=Ie(ee),Qe=Ce===0?St:yt,Je=ee.start,Xe=0;Xe<ee.length-3;Xe+=3){var Ft=ee[Xe],Wt=ee[Xe+1],qt=ee[Xe+2],pe=ee[Xe+3],je=ee[Xe+4],pt=Ce===0?Ft:Wt,it=Ce===0?pe:je,Ct=!1;Oe&&(le=Math.sqrt(Math.pow(Ft-pe,2)+Math.pow(Wt-je,2))),pt<Z?it>Z&&(me=Qe(he,Ft,Wt,pe,je,Z),Oe&&(he.start=Je+le*me)):pt>Ae?it<Ae&&(me=Qe(he,Ft,Wt,pe,je,Ae),Oe&&(he.start=Je+le*me)):at(he,Ft,Wt,qt),it<Z&&pt>=Z&&(me=Qe(he,Ft,Wt,pe,je,Z),Ct=!0),it>Ae&&pt<=Ae&&(me=Qe(he,Ft,Wt,pe,je,Ae),Ct=!0),!Le&&Ct&&(Oe&&(he.end=Je+le*me),J.push(he),he=Ie(ee)),Oe&&(Je+=le)}var li=ee.length-3;Ft=ee[li],Wt=ee[li+1],qt=ee[li+2],(pt=Ce===0?Ft:Wt)>=Z&&pt<=Ae&&at(he,Ft,Wt,qt),li=he.length-3,Le&&li>=3&&(he[li]!==he[0]||he[li+1]!==he[1])&&at(he,he[0],he[1],he[2]),he.length&&J.push(he)}function Ie(ee){var J=[];return J.size=ee.size,J.start=ee.start,J.end=ee.end,J}function ue(ee,J,Z,Ae,Ce,Le){for(var Oe=0;Oe<ee.length;Oe++)Dt(ee[Oe],J,Z,Ae,Ce,Le,!1)}function at(ee,J,Z,Ae){ee.push(J),ee.push(Z),ee.push(Ae)}function St(ee,J,Z,Ae,Ce,Le){var Oe=(Le-J)/(Ae-J);return ee.push(Le),ee.push(Z+(Ce-Z)*Oe),ee.push(1),Oe}function yt(ee,J,Z,Ae,Ce,Le){var Oe=(Le-Z)/(Ce-Z);return ee.push(J+(Ae-J)*Oe),ee.push(Le),ee.push(1),Oe}function Pt(ee,J){for(var Z=[],Ae=0;Ae<ee.length;Ae++){var Ce,Le=ee[Ae],Oe=Le.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Ce=Ot(Le.geometry,J);else if(Oe==="MultiLineString"||Oe==="Polygon"){Ce=[];for(var le=0;le<Le.geometry.length;le++)Ce.push(Ot(Le.geometry[le],J))}else if(Oe==="MultiPolygon")for(Ce=[],le=0;le<Le.geometry.length;le++){for(var me=[],he=0;he<Le.geometry[le].length;he++)me.push(Ot(Le.geometry[le][he],J));Ce.push(me)}Z.push(Ye(Le.id,Oe,Ce,Le.tags))}return Z}function Ot(ee,J){var Z=[];Z.size=ee.size,ee.start!==void 0&&(Z.start=ee.start,Z.end=ee.end);for(var Ae=0;Ae<ee.length;Ae+=3)Z.push(ee[Ae]+J,ee[Ae+1],ee[Ae+2]);return Z}function Ue(ee,J){if(ee.transformed)return ee;var Z,Ae,Ce,Le=1<<ee.z,Oe=ee.x,le=ee.y;for(Z=0;Z<ee.features.length;Z++){var me=ee.features[Z],he=me.geometry,Qe=me.type;if(me.geometry=[],Qe===1)for(Ae=0;Ae<he.length;Ae+=2)me.geometry.push(ot(he[Ae],he[Ae+1],J,Le,Oe,le));else for(Ae=0;Ae<he.length;Ae++){var Je=[];for(Ce=0;Ce<he[Ae].length;Ce+=2)Je.push(ot(he[Ae][Ce],he[Ae][Ce+1],J,Le,Oe,le));me.geometry.push(Je)}}return ee.transformed=!0,ee}function ot(ee,J,Z,Ae,Ce,Le){return[Math.round(Z*(ee*Ae-Ce)),Math.round(Z*(J*Ae-Le))]}function ni(ee,J,Z,Ae,Ce){for(var Le=J===Ce.maxZoom?0:Ce.tolerance/((1<<J)*Ce.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Z,y:Ae,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},le=0;le<ee.length;le++){Oe.numFeatures++,fi(Oe,ee[le],Le,Ce);var me=ee[le].minX,he=ee[le].minY,Qe=ee[le].maxX,Je=ee[le].maxY;me<Oe.minX&&(Oe.minX=me),he<Oe.minY&&(Oe.minY=he),Qe>Oe.maxX&&(Oe.maxX=Qe),Je>Oe.maxY&&(Oe.maxY=Je)}return Oe}function fi(ee,J,Z,Ae){var Ce=J.geometry,Le=J.type,Oe=[];if(Le==="Point"||Le==="MultiPoint")for(var le=0;le<Ce.length;le+=3)Oe.push(Ce[le]),Oe.push(Ce[le+1]),ee.numPoints++,ee.numSimplified++;else if(Le==="LineString")Xt(Oe,Ce,ee,Z,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(le=0;le<Ce.length;le++)Xt(Oe,Ce[le],ee,Z,Le==="Polygon",le===0);else if(Le==="MultiPolygon")for(var me=0;me<Ce.length;me++){var he=Ce[me];for(le=0;le<he.length;le++)Xt(Oe,he[le],ee,Z,!0,le===0)}if(Oe.length){var Qe=J.tags||null;if(Le==="LineString"&&Ae.lineMetrics){for(var Je in Qe={},J.tags)Qe[Je]=J.tags[Je];Qe.mapbox_clip_start=Ce.start/Ce.size,Qe.mapbox_clip_end=Ce.end/Ce.size}var Xe={geometry:Oe,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:Qe};J.id!==null&&(Xe.id=J.id),ee.features.push(Xe)}}function Xt(ee,J,Z,Ae,Ce,Le){var Oe=Ae*Ae;if(Ae>0&&J.size<(Ce?Oe:Ae))Z.numPoints+=J.length/3;else{for(var le=[],me=0;me<J.length;me+=3)(Ae===0||J[me+2]>Oe)&&(Z.numSimplified++,le.push(J[me]),le.push(J[me+1])),Z.numPoints++;Ce&&function(he,Qe){for(var Je=0,Xe=0,Ft=he.length,Wt=Ft-2;Xe<Ft;Wt=Xe,Xe+=2)Je+=(he[Xe]-he[Wt])*(he[Xe+1]+he[Wt+1]);if(Je>0===Qe)for(Xe=0,Ft=he.length;Xe<Ft/2;Xe+=2){var qt=he[Xe],pe=he[Xe+1];he[Xe]=he[Ft-2-Xe],he[Xe+1]=he[Ft-1-Xe],he[Ft-2-Xe]=qt,he[Ft-1-Xe]=pe}}(le,Le),ee.push(le)}}function _i(ee,J){var Z=(J=this.options=function(Ce,Le){for(var Oe in Le)Ce[Oe]=Le[Oe];return Ce}(Object.create(this.options),J)).debug;if(Z&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ae=function(Ce,Le){var Oe=[];if(Ce.type==="FeatureCollection")for(var le=0;le<Ce.features.length;le++)_e(Oe,Ce.features[le],Le,le);else _e(Oe,Ce.type==="Feature"?Ce:{geometry:Ce},Le);return Oe}(ee,J);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ae=function(Ce,Le){var Oe=Le.buffer/Le.extent,le=Ce,me=mt(Ce,1,-1-Oe,Oe,0,-1,2,Le),he=mt(Ce,1,1-Oe,2+Oe,0,-1,2,Le);return(me||he)&&(le=mt(Ce,1,-Oe,1+Oe,0,-1,2,Le)||[],me&&(le=Pt(me,1).concat(le)),he&&(le=le.concat(Pt(he,-1)))),le}(Ae,J),Ae.length&&this.splitTile(Ae,0,0,0),Z&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function si(ee,J,Z){return 32*((1<<ee)*Z+J)+ee}function wt(ee,J){const Z=ee.tileID.canonical;if(!this._geoJSONIndex)return J(null,null);const Ae=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!Ae)return J(null,null);const Ce=new class{constructor(Oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=Oe.length,this._features=Oe}feature(Oe){return new class{constructor(le){this._feature=le,this.extent=r.EXTENT,this.type=le.type,this.properties=le.tags,"id"in le&&!isNaN(le.id)&&(this.id=parseInt(le.id,10))}loadGeometry(){if(this._feature.type===1){const le=[];for(const me of this._feature.geometry)le.push([new r.Point(me[0],me[1])]);return le}{const le=[];for(const me of this._feature.geometry){const he=[];for(const Qe of me)he.push(new r.Point(Qe[0],Qe[1]));le.push(he)}return le}}toGeoJSON(le,me,he){return M.call(this,le,me,he)}}(this._features[Oe])}}(Ae.features);let Le=De(Ce);Le.byteOffset===0&&Le.byteLength===Le.buffer.byteLength||(Le=new Uint8Array(Le)),J(null,{vectorTile:Ce,rawData:Le.buffer})}_i.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_i.prototype.splitTile=function(ee,J,Z,Ae,Ce,Le,Oe){for(var le=[ee,J,Z,Ae],me=this.options,he=me.debug;le.length;){Ae=le.pop(),Z=le.pop(),J=le.pop(),ee=le.pop();var Qe=1<<J,Je=si(J,Z,Ae),Xe=this.tiles[Je];if(!Xe&&(he>1&&console.time("creation"),Xe=this.tiles[Je]=ni(ee,J,Z,Ae,me),this.tileCoords.push({z:J,x:Z,y:Ae}),he)){he>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,Z,Ae,Xe.numFeatures,Xe.numPoints,Xe.numSimplified),console.timeEnd("creation"));var Ft="z"+J;this.stats[Ft]=(this.stats[Ft]||0)+1,this.total++}if(Xe.source=ee,Ce){if(J===me.maxZoom||J===Ce)continue;var Wt=1<<Ce-J;if(Z!==Math.floor(Le/Wt)||Ae!==Math.floor(Oe/Wt))continue}else if(J===me.indexMaxZoom||Xe.numPoints<=me.indexMaxPoints)continue;if(Xe.source=null,ee.length!==0){he>1&&console.time("clipping");var qt,pe,je,pt,it,Ct,li=.5*me.buffer/me.extent,Ai=.5-li,oi=.5+li,ci=1+li;qt=pe=je=pt=null,it=mt(ee,Qe,Z-li,Z+oi,0,Xe.minX,Xe.maxX,me),Ct=mt(ee,Qe,Z+Ai,Z+ci,0,Xe.minX,Xe.maxX,me),ee=null,it&&(qt=mt(it,Qe,Ae-li,Ae+oi,1,Xe.minY,Xe.maxY,me),pe=mt(it,Qe,Ae+Ai,Ae+ci,1,Xe.minY,Xe.maxY,me),it=null),Ct&&(je=mt(Ct,Qe,Ae-li,Ae+oi,1,Xe.minY,Xe.maxY,me),pt=mt(Ct,Qe,Ae+Ai,Ae+ci,1,Xe.minY,Xe.maxY,me),Ct=null),he>1&&console.timeEnd("clipping"),le.push(qt||[],J+1,2*Z,2*Ae),le.push(pe||[],J+1,2*Z,2*Ae+1),le.push(je||[],J+1,2*Z+1,2*Ae),le.push(pt||[],J+1,2*Z+1,2*Ae+1)}}},_i.prototype.getTile=function(ee,J,Z){var Ae=this.options,Ce=Ae.extent,Le=Ae.debug;if(ee<0||ee>24)return null;var Oe=1<<ee,le=si(ee,J=(J%Oe+Oe)%Oe,Z);if(this.tiles[le])return Ue(this.tiles[le],Ce);Le>1&&console.log("drilling down to z%d-%d-%d",ee,J,Z);for(var me,he=ee,Qe=J,Je=Z;!me&&he>0;)he--,Qe=Math.floor(Qe/2),Je=Math.floor(Je/2),me=this.tiles[si(he,Qe,Je)];return me&&me.source?(Le>1&&console.log("found parent tile z%d-%d-%d",he,Qe,Je),Le>1&&console.time("drilling down"),this.splitTile(me.source,he,Qe,Je,ee,J,Z),Le>1&&console.timeEnd("drilling down"),this.tiles[le]?Ue(this.tiles[le],Ce):null):null};class kt extends r.VectorTileWorkerSource{constructor(J,Z,Ae,Ce,Le){super(J,Z,Ae,Ce,wt),Le&&(this.loadGeoJSON=Le)}loadData(J,Z){const Ae=J&&J.request,Ce=Ae&&Ae.collectResourceTiming;this.loadGeoJSON(J,(Le,Oe)=>{if(Le||!Oe)return Z(Le);if(typeof Oe!="object")return Z(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));{Q(Oe,!0);try{if(J.filter){const me=r.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(me.result==="error")throw new Error(me.value.map(Qe=>`${Qe.key}: ${Qe.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(Qe=>me.value.evaluate({zoom:0},Qe))}}this._geoJSONIndex=J.cluster?new st(function({superclusterOptions:me,clusterProperties:he}){if(!he||!me)return me;const Qe={},Je={},Xe={accumulated:null,zoom:0},Ft={properties:null},Wt=Object.keys(he);for(const qt of Wt){const[pe,je]=he[qt],pt=r.createExpression(je),it=r.createExpression(typeof pe=="string"?[pe,["accumulated"],["get",qt]]:pe);Qe[qt]=pt.value,Je[qt]=it.value}return me.map=qt=>{Ft.properties=qt;const pe={};for(const je of Wt)pe[je]=Qe[je].evaluate(Xe,Ft);return pe},me.reduce=(qt,pe)=>{Ft.properties=pe;for(const je of Wt)Xe.accumulated=qt[je],qt[je]=Je[je].evaluate(Xe,Ft)},me}(J)).load(Oe.features):function(me,he){return new _i(me,he)}(Oe,J.geojsonVtOptions)}catch(me){return Z(me)}this.loaded={};const le={};if(Ce){const me=r.getPerformanceMeasurement(Ae);me&&(le.resourceTiming={},le.resourceTiming[J.source]=JSON.parse(JSON.stringify(me)))}Z(null,le)}})}reloadTile(J,Z){const Ae=this.loaded;return Ae&&Ae[J.uid]?super.reloadTile(J,Z):this.loadTile(J,Z)}loadGeoJSON(J,Z){if(J.request)r.getJSON(J.request,Z);else{if(typeof J.data!="string")return Z(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));try{return Z(null,JSON.parse(J.data))}catch{return Z(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(J,Z){try{Z(null,this._geoJSONIndex.getClusterExpansionZoom(J.clusterId))}catch(Ae){Z(Ae)}}getClusterChildren(J,Z){try{Z(null,this._geoJSONIndex.getChildren(J.clusterId))}catch(Ae){Z(Ae)}}getClusterLeaves(J,Z){try{Z(null,this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset))}catch(Ae){Z(Ae)}}}class yi{constructor(J){this.self=J,this.actor=new r.Actor(J,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Z,Ae)=>{if(this.workerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.workerSourceTypes[Z]=Ae},this.self.registerRTLTextPlugin=Z=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=Z.applyArabicShaping,r.plugin.processBidirectionalText=Z.processBidirectionalText,r.plugin.processStyledBidirectionalText=Z.processStyledBidirectionalText}}clearCaches(J,Z,Ae){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],Ae()}checkIfReady(J,Z,Ae){Ae()}setReferrer(J,Z){this.referrer=Z}spriteLoaded(J,Z){this.isSpriteLoaded[J]=Z;for(const Ae in this.workerSources[J]){const Ce=this.workerSources[J][Ae];for(const Le in Ce)Ce[Le]instanceof r.VectorTileWorkerSource&&(Ce[Le].isSpriteLoaded=Z,Ce[Le].fire(new r.Event("isSpriteLoaded")))}}setImages(J,Z,Ae){this.availableImages[J]=Z;for(const Ce in this.workerSources[J]){const Le=this.workerSources[J][Ce];for(const Oe in Le)Le[Oe].availableImages=Z}Ae()}enableTerrain(J,Z,Ae){this.terrain=Z,Ae()}setProjection(J,Z){this.projections[J]=r.getProjection(Z)}setLayers(J,Z,Ae){this.getLayerIndex(J).replace(Z),Ae()}updateLayers(J,Z,Ae){this.getLayerIndex(J).update(Z.layers,Z.removedIds),Ae()}loadTile(J,Z,Ae){const Ce=this.enableTerrain?r.extend({enableTerrain:this.terrain},Z):Z;Ce.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,Z.type,Z.source).loadTile(Ce,Ae)}loadDEMTile(J,Z,Ae){const Ce=this.enableTerrain?r.extend({buildQuadTree:this.terrain},Z):Z;this.getDEMWorkerSource(J,Z.source).loadTile(Ce,Ae)}reloadTile(J,Z,Ae){const Ce=this.enableTerrain?r.extend({enableTerrain:this.terrain},Z):Z;Ce.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,Z.type,Z.source).reloadTile(Ce,Ae)}abortTile(J,Z,Ae){this.getWorkerSource(J,Z.type,Z.source).abortTile(Z,Ae)}removeTile(J,Z,Ae){this.getWorkerSource(J,Z.type,Z.source).removeTile(Z,Ae)}removeSource(J,Z,Ae){if(!this.workerSources[J]||!this.workerSources[J][Z.type]||!this.workerSources[J][Z.type][Z.source])return;const Ce=this.workerSources[J][Z.type][Z.source];delete this.workerSources[J][Z.type][Z.source],Ce.removeSource!==void 0?Ce.removeSource(Z,Ae):Ae()}loadWorkerSource(J,Z,Ae){try{this.self.importScripts(Z.url),Ae()}catch(Ce){Ae(Ce.toString())}}syncRTLPluginState(J,Z,Ae){try{r.plugin.setState(Z);const Ce=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&Ce!=null){this.self.importScripts(Ce);const Le=r.plugin.isParsed();Ae(Le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ce}`),Le)}}catch(Ce){Ae(Ce.toString())}}getAvailableImages(J){let Z=this.availableImages[J];return Z||(Z=[]),Z}getLayerIndex(J){let Z=this.layerIndexes[J];return Z||(Z=this.layerIndexes[J]=new v),Z}getWorkerSource(J,Z,Ae){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][Z]||(this.workerSources[J][Z]={}),!this.workerSources[J][Z][Ae]){const Ce={send:(Le,Oe,le,me,he,Qe)=>{this.actor.send(Le,Oe,le,J,he,Qe)},scheduler:this.actor.scheduler};this.workerSources[J][Z][Ae]=new this.workerSourceTypes[Z](Ce,this.getLayerIndex(J),this.getAvailableImages(J),this.isSpriteLoaded[J])}return this.workerSources[J][Z][Ae]}getDEMWorkerSource(J,Z){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][Z]||(this.demWorkerSources[J][Z]=new I),this.demWorkerSources[J][Z]}enforceCacheSizeLimit(J,Z){r.enforceCacheSizeLimit(Z)}getWorkerPerformanceMetrics(J,Z,Ae){Ae(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new yi(self)),yi}),u(["./shared"],function(r){function p(m,c){if(Array.isArray(m)){if(!Array.isArray(c)||m.length!==c.length)return!1;for(let f=0;f<m.length;f++)if(!p(m[f],c[f]))return!1;return!0}if(typeof m=="object"&&m!==null&&c!==null){if(typeof c!="object"||Object.keys(m).length!==Object.keys(c).length)return!1;for(const f in m)if(!p(m[f],c[f]))return!1;return!0}return m===c}var g=v;function v(m){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,B=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(B);try{w=new Worker(R),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(R),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var B=w.getImageData(0,0,1,1);return B&&B.width===y.width}()?(I[f=c&&c.failIfMajorPerformanceCaveat]===void 0&&(I[f]=function(y){var w,B=function(R){var L=document.createElement("canvas"),U=Object.create(v.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=R,L.getContext("webgl",U)||L.getContext("experimental-webgl",U)}(y);if(!B)return!1;try{w=B.createShader(B.VERTEX_SHADER)}catch{return!1}return!(!w||B.isContextLost())&&(B.shaderSource(w,"void main() {}"),B.compileShader(w),B.getShaderParameter(w,B.COMPILE_STATUS)===!0)}(f)),I[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(m)}var I={};function C(m,c,f){const y=r.window.document.createElement(m);return c!==void 0&&(y.className=c),f&&f.appendChild(y),y}function E(m,c,f){const y=r.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const w of Object.keys(c))y.setAttributeNS(null,w,c[w]);return f&&f.appendChild(y),y}v.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Q=r.window.document&&r.window.document.documentElement.style,M=Q&&Q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let D;function P(){Q&&M&&(D=Q[M],Q[M]="none")}function O(){Q&&M&&(Q[M]=D)}function F(m){m.preventDefault(),m.stopPropagation(),r.window.removeEventListener("click",F,!0)}function N(){r.window.addEventListener("click",F,!0),r.window.setTimeout(()=>{r.window.removeEventListener("click",F,!0)},0)}function z(m,c){const f=m.getBoundingClientRect();return H(m,f,c)}function X(m,c){const f=m.getBoundingClientRect(),y=[];for(let w=0;w<c.length;w++)y.push(H(m,f,c[w]));return y}function q(m){return r.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function H(m,c,f){const y=m.offsetWidth===c.width?1:m.offsetWidth/c.width;return new r.Point((f.clientX-c.left)*y,(f.clientY-c.top)*y)}function W(m,c){var f=c[0],y=c[1],w=c[2],B=c[3],R=f*B-w*y;return R?(m[0]=B*(R=1/R),m[1]=-y*R,m[2]=-w*R,m[3]=f*R,m):null}function se(m){const{userImage:c}=m;return!!(c&&c.render&&c.render())&&(m.data.replace(new Uint8Array(c.data.buffer)),!0)}class de extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:f,callback:y}of this.requestors)this._notify(f,y);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,f){this._validate(c,f)&&(this.images[c]=f)}_validate(c,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new r.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),y=!1),y}_validateStretch(c,f){if(!c)return!0;let y=0;for(const w of c){if(w[0]<y||w[1]<w[0]||f<w[1])return!1;y=w[1]}return!0}_validateContent(c,f){return!(c&&(c.length!==4||c[0]<0||f.data.width<c[0]||c[1]<0||f.data.height<c[1]||c[2]<0||f.data.width<c[2]||c[3]<0||f.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,f){f.version=this.images[c].version+1,this.images[c]=f,this.updatedImages[c]=!0}removeImage(c){const f=this.images[c];delete this.images[c],delete this.patterns[c],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,f){let y=!0;if(!this.isLoaded())for(const w of c)this.images[w]||(y=!1);this.isLoaded()||y?this._notify(c,f):this.requestors.push({ids:c,callback:f})}_notify(c,f){const y={};for(const w of c){this.images[w]||this.fire(new r.Event("styleimagemissing",{id:w}));const B=this.images[w];B?y[w]={data:B.data.clone(),pixelRatio:B.pixelRatio,sdf:B.sdf,version:B.version,stretchX:B.stretchX,stretchY:B.stretchY,content:B.content,hasRenderCallback:Boolean(B.userImage&&B.userImage.render)}:r.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,y)}getPixelSize(){const{width:c,height:f}=this.atlasImage;return{width:c,height:f}}getPattern(c){const f=this.patterns[c],y=this.getImage(c);if(!y)return null;if(f&&f.position.version===y.version)return f.position;if(f)f.position.version=y.version;else{const w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},B=new r.ImagePosition(w,y);this.patterns[c]={bin:w,position:B}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const f=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(c,this.atlasImage,f.RGBA),this.atlasTexture&&this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const B in this.patterns)c.push(this.patterns[B].bin);const{w:f,h:y}=r.potpack(c),w=this.atlasImage;w.resize({width:f||1,height:y||1});for(const B in this.patterns){const{bin:R}=this.patterns[B],L=R.x+1,U=R.y+1,j=this.images[B].data,Y=j.width,ie=j.height;r.RGBAImage.copy(j,w,{x:0,y:0},{x:L,y:U},{width:Y,height:ie}),r.RGBAImage.copy(j,w,{x:0,y:ie-1},{x:L,y:U-1},{width:Y,height:1}),r.RGBAImage.copy(j,w,{x:0,y:0},{x:L,y:U+ie},{width:Y,height:1}),r.RGBAImage.copy(j,w,{x:Y-1,y:0},{x:L-1,y:U},{width:1,height:ie}),r.RGBAImage.copy(j,w,{x:0,y:0},{x:L+Y,y:U},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const f of c){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const y=this.images[f];se(y)&&this.updateImage(f,y)}}}const te=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(m,c){return function([f,y,w]){const B=r.degToRad(y+90),R=r.degToRad(w);return{x:f*Math.cos(B)*Math.sin(R),y:f*Math.sin(B)*Math.sin(R),z:f*Math.cos(R),azimuthal:y,polar:w}}(m.expression.evaluate(c))}interpolate(m,c,f){return{x:r.number(m.x,c.x,f),y:r.number(m.y,c.y,f),z:r.number(m.z,c.z,f),azimuthal:r.number(m.azimuthal,c.azimuthal,f),polar:r.number(m.polar,c.polar,f)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)});class ce extends r.Evented{constructor(c){super(),this._transitionable=new r.Transitionable(te),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,f={}){if(!this._validate(r.validateLight,c,f))for(const y in c){const w=c[y];r.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,c.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const Ee=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)});let Be=class extends r.Evented{constructor(m,c){super(),this._transitionable=new r.Transitionable(Ee),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(m){for(const c in m){const f=m[c];r.endsWith(c,"-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}};function De(m,c,f,y){const w=r.smoothstep(45,65,f),[B,R]=Re(m,y),L=r.length(c);let U=1-Math.min(1,Math.exp((L-B)/(R-B)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*w*m.alpha}function Re(m,c){const f=.5/Math.tan(.5*c);return[m.range[0]+f,m.range[1]+f]}const ye=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"high-color":new r.DataConstantProperty(r.spec.fog["high-color"]),"space-color":new r.DataConstantProperty(r.spec.fog["space-color"]),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"]),"star-intensity":new r.DataConstantProperty(r.spec.fog["star-intensity"])});class ht extends r.Evented{constructor(c,f){super(),this._transitionable=new r.Transitionable(ye),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const c=this._transform,f=c.projection.name==="globe",y=r.globeToMercatorTransition(c.zoom),w=this.properties.get("range"),B=[.5,3];return{range:f?[r.number(B[0],w[0],y),r.number(B[1],w[1],y)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,f={}){if(!this._validate(r.validateFog,c,f)){for(const y of Object.keys(r.spec.fog))c&&c[y]===void 0&&(c[y]=r.spec.fog[y].default);for(const y in c){const w=c[y];r.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-11),w):this._transitionable.setValue(y,w)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.smoothstep(45,65,c))*f.a}getOpacityAtLatLng(c,f){return this._transform.projection.supportsFog?function(y,w,B){const R=r.MercatorCoordinate.fromLngLat(w),L=B.elevation?B.elevation.getAtPointOrZero(R):0,U=[R.x,R.y,L];return r.transformMat4(U,U,B.mercatorFogMatrix),De(y,U,B.pitch,B._fov)}(this.state,c,f):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Re(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,c.call(r.validateStyle,r.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class oe{constructor(c,f){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const y=this.workerPool.acquire(this.id);for(let w=0;w<y.length;w++){const B=new oe.Actor(y[w],f,this.id);B.name=`Worker ${w}`,this.actors.push(B)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,f,y){r.asyncAll(this.actors,(w,B)=>{w.send(c,f,B)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Tt(m,c,f){return c*(r.EXTENT/(m.tileSize*Math.pow(2,f-m.tileID.overscaledZ)))}oe.Actor=r.Actor;class Fe{constructor(c,f,y,w){this.screenBounds=c,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(c,f){let y,w;if(c instanceof r.Point||typeof c[0]=="number"){const B=r.Point.convert(c);y=[B],w=f.isPointAboveHorizon(B)}else{const B=r.Point.convert(c[0]),R=r.Point.convert(c[1]);y=[B,R],w=r.polygonizeBounds(B,R).every(L=>f.isPointAboveHorizon(L))}return new Fe(y,f.getCameraPoint(),w,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(c){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],w=r.polygonizeBounds(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?w[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(w[3]=this.cameraPoint)),r.bufferConvexPolygon(w,c)}bufferedCameraGeometryGlobe(c){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],w=r.polygonizeBounds(f,y,c),B=this.cameraPoint.clone();switch(3*((B.y>f.y)+(B.y>y.y))+((B.x>f.x)+(B.x>y.x))){case 0:w[0]=B,w[4]=B.clone();break;case 1:w.splice(1,0,B);break;case 2:w[1]=B;break;case 3:w.splice(4,0,B);break;case 5:w.splice(2,0,B);break;case 6:w[3]=B;break;case 7:w.splice(3,0,B);break;case 8:w[2]=B}return w}containsTile(c,f,y,w=0){const B=c.queryPadding/f._pixelsPerMercatorPixel+1,R=y?this._bufferedCameraMercator(B,f):this._bufferedScreenMercator(B,f);let L=c.tileID.wrap+(R.unwrapped?w:0);const U=R.polygon.map(Se=>r.getTilePoint(c.tileTransform,Se,L));if(!r.polygonIntersectsBox(U,0,0,r.EXTENT,r.EXTENT))return;L=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const j=this.screenGeometryMercator.polygon.map(Se=>r.getTileVec3(c.tileTransform,Se,L)),Y=j.map(Se=>new r.Point(Se[0],Se[1])),ie=f.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),fe=r.getTileVec3(c.tileTransform,ie,L),xe=j.map(Se=>{const ne=r.sub(Se,Se,fe);return r.normalize(ne,ne),new r.Ray(fe,ne)}),be=Tt(c,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:xe,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(we=r.getBounds(U),we.min.x=r.clamp(we.min.x,0,r.EXTENT),we.min.y=r.clamp(we.min.y,0,r.EXTENT),we.max.x=r.clamp(we.max.x,0,r.EXTENT),we.max.y=r.clamp(we.max.y,0,r.EXTENT),we),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:be};var we}_bufferedScreenMercator(c,f){const y=Ke(c);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(c),f):{polygon:this.bufferedScreenGeometry(c).map(B=>f.pointCoordinate3D(B)),unwrapped:!0},this._screenRaycastCache[y]=w,w}}_bufferedCameraMercator(c,f){const y=Ke(c);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),f):{polygon:this.bufferedCameraGeometry(c).map(B=>f.pointCoordinate3D(B)),unwrapped:!0},this._cameraRaycastCache[y]=w,w}}_projectAndResample(c,f){const y=function(B,R){const L=r.multiply([],R.pixelMatrix,R.globeMatrix),U=[0,-r.GLOBE_RADIUS,0,1],j=[0,r.GLOBE_RADIUS,0,1],Y=[0,0,0,1];r.transformMat4$1(U,U,L),r.transformMat4$1(j,j,L),r.transformMat4$1(Y,Y,L);const ie=new r.Point(U[0]/U[3],U[1]/U[3]),fe=new r.Point(j[0]/j[3],j[1]/j[3]),xe=r.polygonContainsPoint(B,ie)&&U[3]<Y[3],be=r.polygonContainsPoint(B,fe)&&j[3]<Y[3];if(!xe&&!be)return null;const we=function(et,ct,lt){for(let vt=1;vt<et.length;vt++){const Zt=Et(ct.pointCoordinate3D(et[vt-1]).x),At=Et(ct.pointCoordinate3D(et[vt]).x);if(lt<0){if(Zt<At)return{idx:vt,t:-Zt/(At-1-Zt)}}else if(At<Zt)return{idx:vt,t:(1-Zt)/(At+1-Zt)}}return null}(B,R,xe?-1:1);if(!we)return null;const{idx:Se,t:ne}=we;let ve=Se>1?st(B.slice(0,Se),R):[],Pe=Se<B.length?st(B.slice(Se),R):[];ve=ve.map(et=>new r.Point(Et(et.x),et.y)),Pe=Pe.map(et=>new r.Point(Et(et.x),et.y));const ke=[...ve];ke.length===0&&ke.push(Pe[Pe.length-1]);const $e=r.number(ke[ke.length-1].y,(Pe.length===0?ve[0]:Pe[0]).y,ne);let tt;return tt=xe?[new r.Point(0,$e),new r.Point(0,0),new r.Point(1,0),new r.Point(1,$e)]:[new r.Point(1,$e),new r.Point(1,1),new r.Point(0,1),new r.Point(0,$e)],ke.push(...tt),Pe.length===0?ke.push(ve[0]):ke.push(...Pe),{polygon:ke.map(et=>new r.MercatorCoordinate(et.x,et.y)),unwrapped:!1}}(c,f);if(y)return y;const w=function(B,R){let L=!1,U=-1/0,j=0;for(let ie=0;ie<B.length-1;ie++)B[ie].x>U&&(U=B[ie].x,j=ie);for(let ie=0;ie<B.length-1;ie++){const fe=(j+ie)%(B.length-1),xe=B[fe],be=B[fe+1];Math.abs(xe.x-be.x)>.5&&(xe.x<be.x?(xe.x+=1,fe===0&&(B[B.length-1].x+=1)):(be.x+=1,fe+1===B.length-1&&(B[0].x+=1)),L=!0)}const Y=r.mercatorXfromLng(R.center.lng);return L&&Y<Math.abs(Y-1)&&B.forEach(ie=>{ie.x-=1}),{polygon:B,unwrapped:L}}(st(c,f).map(B=>new r.Point(Et(B.x),B.y)),f);return{polygon:w.polygon.map(B=>new r.MercatorCoordinate(B.x,B.y)),unwrapped:w.unwrapped}}}function st(m,c){return r.resample(m,f=>{const y=c.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function Et(m){return m<0?1+m%1:m%1}function Ke(m){return 100*m|0}function Ne(m,c,f,y,w){const B=function(R,L){if(R)return w(R);if(L){m.url&&L.tiles&&m.tiles&&delete m.tiles;const U=r.pick(r.extend(L,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(U.vectorLayers=L.vector_layers,U.vectorLayerIds=U.vectorLayers.map(j=>j.id)),U.tiles=c.canonicalizeTileset(U,m.url),w(null,U)}};return m.url?r.getJSON(c.transformRequest(c.normalizeSourceURL(m.url,null,f,y),r.ResourceType.Source),B):r.exported.frame(()=>B(null,m))}class dt{constructor(c,f,y){this.bounds=r.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=y||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const f=Math.pow(2,c.z),y=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*f),w=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*f),B=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*f),R=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*f);return c.x>=y&&c.x<B&&c.y>=w&&c.y<R}}class xt{constructor(c,f,y){this.context=c;const w=c.gl;this.buffer=w.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ve{constructor(c,f,y,w){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.context=c;const B=c.gl;this.buffer=B.createBuffer(),c.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,f){for(let y=0;y<this.attributes.length;y++){const w=f.attributes[this.attributes[y].name];w!==void 0&&c.enableVertexAttribArray(w)}}setVertexAttribPointers(c,f,y){for(let w=0;w<this.attributes.length;w++){const B=this.attributes[w],R=f.attributes[B.name];R!==void 0&&c.vertexAttribPointer(R,B.components,c[ft[B.type]],!1,this.itemSize,B.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ye{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ae extends Ye{getDefault(){return r.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class _e extends Ye{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Ze extends Ye{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class nt extends Ye{getDefault(){return[!0,!0,!0,!0]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class ut extends Ye{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class ze extends Ye{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Qt extends Ye{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const f=this.current;(c.func!==f.func||c.ref!==f.ref||c.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class mt extends Ye{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Ut extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=c,this.dirty=!1}}class Dt extends Ye{getDefault(){return[0,1]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ie extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=c,this.dirty=!1}}class ue extends Ye{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class at extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.BLEND):f.disable(f.BLEND),this.current=c,this.dirty=!1}}class St extends Ye{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class yt extends Ye{getDefault(){return r.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Pt extends Ye{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Ot extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=c,this.dirty=!1}}class Ue extends Ye{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class ot extends Ye{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let ni,fi=class extends Ye{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Xt extends Ye{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class _i extends Ye{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class si extends Ye{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class wt extends Ye{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class kt extends Ye{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class yi extends Ye{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ee extends Ye{getDefault(){return null}set(c){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class J extends Ye{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Z extends Ye{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Ae extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Ce extends Ye{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Le extends Ye{constructor(c,f){super(c),this.context=c,this.parent=f}getDefault(){return null}}class Oe extends Le{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class le extends Le{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class me extends le{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class he{constructor(c,f,y,w){this.context=c,this.width=f,this.height=y;const B=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Oe(c,B),w&&(this.depthAttachment=new le(c,B))}destroy(){const c=this.context.gl,f=this.colorAttachment.get();if(f&&c.deleteTexture(f),this.depthAttachment){const y=this.depthAttachment.get();y&&c.deleteRenderbuffer(y)}c.deleteFramebuffer(this.framebuffer)}}class Qe{constructor(c,f=!1){if(this.gl=c,this.isWebGL2=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),f){const y=c;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(c),deleteVertexArrayOES:y.deleteVertexArray.bind(c),bindVertexArrayOES:y.bindVertexArray.bind(c)}}this.clearColor=new ae(this),this.clearDepth=new _e(this),this.clearStencil=new Ze(this),this.colorMask=new nt(this),this.depthMask=new ut(this),this.stencilMask=new ze(this),this.stencilFunc=new Qt(this),this.stencilOp=new mt(this),this.stencilTest=new Ut(this),this.depthRange=new Dt(this),this.depthTest=new Ie(this),this.depthFunc=new ue(this),this.blend=new at(this),this.blendFunc=new St(this),this.blendColor=new yt(this),this.blendEquation=new Pt(this),this.cullFace=new Ot(this),this.cullFaceSide=new Ue(this),this.frontFace=new ot(this),this.program=new fi(this),this.activeTexture=new Xt(this),this.viewport=new _i(this),this.bindFramebuffer=new si(this),this.bindRenderbuffer=new wt(this),this.bindTexture=new kt(this),this.bindVertexBuffer=new yi(this),this.bindElementBuffer=new ee(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new J(this),this.pixelStoreUnpack=new Z(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Ce(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),f||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(f||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=f||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,f){return new xt(this,c,f)}createVertexBuffer(c,f,y){return new Ve(this,c,f,y)}createRenderbuffer(c,f,y){const w=this.gl,B=w.createRenderbuffer();return this.bindRenderbuffer.set(B),w.renderbufferStorage(w.RENDERBUFFER,c,f,y),this.bindRenderbuffer.set(null),B}createFramebuffer(c,f,y){return new he(this,c,f,y)}clear({color:c,depth:f,stencil:y}){const w=this.gl;let B=0;c&&(B|=w.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(B|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(B|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),w.clear(B)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){p(c.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Je extends r.Evented{constructor(c,f,y,w){if(super(),this.id=c,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(f,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(c){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=Ne(this._options,this.map._requestManager,f,y,(w,B)=>{this._tileJSONRequest=null,this._loaded=!0,w?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),y&&y.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new r.ErrorEvent(w))):B&&(r.extend(this,B),B.bounds&&(this.tileBounds=new dt(B.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(B.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(w)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}loadTile(c,f){const y=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(y,r.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired")c.state==="loading"?c.reloadCallback=f:c.request=c.actor.send("reloadTile",w,B.bind(this));else if(c.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",w,B.bind(this),void 0,!0);else{const R=r.loadVectorTile.call({deduped:this._deduped},w,(L,U)=>{L||!U?B.call(this,L):(w.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},c.actor&&c.actor.send("loadTile",w,B.bind(this),void 0,!0))},!0);c.request={cancel:R}}function B(R,L){return delete c.request,c.aborted?f(null):R&&R.status!==404?f(R):(L&&L.resourceTiming&&(c.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&c.setExpiryData(L),c.loadVectorData(L,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Xe extends r.Evented{constructor(c,f,y,w){super(),this.id=c,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},f),r.extend(this,r.pick(f,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ne(this._options,this.map._requestManager,null,null,(f,y)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new r.ErrorEvent(f)):y&&(r.extend(this,y),y.bounds&&(this.tileBounds=new dt(y.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(y.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(f)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,f){const y=r.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);c.request=r.getImage(this.map._requestManager.transformRequest(w,r.ResourceType.Tile),(B,R,L,U)=>(delete c.request,c.aborted?(c.state="unloaded",f(null)):B?(c.state="errored",f(B)):R?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:L,expires:U}),c.setTexture(R,this.map.painter),c.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(c,f,y){c.setTexture(f,y)}static unloadTileData(c,f){c.texture&&f.saveTileTexture(c.texture)}abortTile(c,f){c.request&&(c.request.cancel(),delete c.request),f()}unloadTile(c,f){c.texture&&this.map.painter.saveTileTexture(c.texture),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ft(m,c,f,y,w,B,R,L){const U=[m,f,w,c,y,B,1,1,1],j=[R,L,1],Y=r.adjoint([],U),[ie,fe,xe]=r.transformMat3(j,j,r.transpose(Y,Y));return r.multiply$1(U,[ie,0,0,0,fe,0,0,0,xe],U)}class Wt extends r.Evented{constructor(c,f,y,w){super(),this.id=c,this.dispatcher=y,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=f,this._dirty=!1}load(c,f){this._loaded=f||!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),(y,w)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new r.ErrorEvent(y));else if(w){const{HTMLImageElement:B}=r.window;this.image=w instanceof B?r.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const f=c.map(r.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let w=1/0,B=1/0,R=-1/0,L=-1/0;for(const ie of y)w=Math.min(w,ie.x),B=Math.min(B,ie.y),R=Math.max(R,ie.x),L=Math.max(L,ie.y);const U=Math.max(R-w,L-B),j=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),Y=Math.pow(2,j);return new r.CanonicalTileID(j,Math.floor((w+R)/2*Y),Math.floor((B+L)/2*Y))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const U in this.tiles){const j=this.tiles[U];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture)}if(this._boundsArray)return;const f=r.tileTransform(this.tileID,this.map.transform.projection),[y,w,B,R]=this.coordinates.map(U=>{const j=f.projection.project(U[0],U[1]);return r.getTilePoint(f,j)._round()});this.perspectiveTransform=function(U,j,Y,ie,fe,xe,be,we,Se,ne){const ve=Ft(0,0,U,0,0,j,U,j),Pe=Ft(Y,ie,fe,xe,be,we,Se,ne);return r.multiply$1(Pe,r.adjoint(ve,ve),Pe),[Pe[6]/Pe[8]*U/r.EXTENT,Pe[7]/Pe[8]*j/r.EXTENT]}(this.width,this.height,y.x,y.y,w.x,w.y,R.x,R.y,B.x,B.y);const L=this._boundsArray=new r.StructArrayLayout4i8;L.emplaceBack(y.x,y.y,0,0),L.emplaceBack(w.x,w.y,r.EXTENT,0),L.emplaceBack(R.x,R.y,0,r.EXTENT),L.emplaceBack(B.x,B.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(L,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,f=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new r.Texture(c,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,f){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},f(null)):(c.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const qt={vector:Je,raster:Xe,"raster-dem":class extends Xe{constructor(m,c,f,y){super(m,c,f,y),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(m,c){const f=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(w,B){w&&(m.state="errored",c(w)),B&&(m.dem=B,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",c(null))}m.request=r.getImage(this.map._requestManager.transformRequest(f,r.ResourceType.Tile),function(w,B,R,L){if(delete m.request,m.aborted)m.state="unloaded",c(null);else if(w)m.state="errored",c(w);else if(B){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:R,expires:L});const U=r.window.ImageBitmap&&B instanceof r.window.ImageBitmap&&(ni==null&&(ni=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),ni),j=1-(B.width-r.prevPowerOfTwo(B.width))/2;j<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const Y=U?B:r.exported.getImageData(B,j),ie={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:Y,encoding:this.encoding,padding:j};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",ie,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const c=m.canonical,f=Math.pow(2,c.z),y=(c.x-1+f)%f,w=c.x===0?m.wrap-1:m.wrap,B=(c.x+1+f)%f,R=c.x+1===f?m.wrap+1:m.wrap,L={};return L[new r.OverscaledTileID(m.overscaledZ,w,c.z,y,c.y).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,R,c.z,B,c.y).key]={backfilled:!1},c.y>0&&(L[new r.OverscaledTileID(m.overscaledZ,w,c.z,y,c.y-1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,m.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,R,c.z,B,c.y-1).key]={backfilled:!1}),c.y+1<f&&(L[new r.OverscaledTileID(m.overscaledZ,w,c.z,y,c.y+1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,m.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,R,c.z,B,c.y+1).key]={backfilled:!1}),L}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends r.Evented{constructor(m,c,f,y){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=c.data,this._options=r.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const w=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*w,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*w,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:r.EXTENT,radius:(c.clusterRadius!==void 0?c.clusterRadius:50)*w,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},c),this}getClusterChildren(m,c){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},c),this}getClusterLeaves(m,c,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:c,offset:f},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=r.extend({},this.workerOptions),c=this._data;typeof c=="string"?(m.request=this.map._requestManager.transformRequest(r.exported.resolveURL(c),r.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(f,y)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new r.ErrorEvent(f));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(w.resourceTiming=y.resourceTiming[this.id]),this.fire(new r.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,c){const f=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(f,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,w)=>(delete m.request,m.unloadVectorData(),m.aborted?c(null):y?c(y):(m.loadVectorData(w,this.map.painter,f==="reloadTile"),c(null))),void 0,f==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Wt{constructor(m,c,f,y){super(m,c,f,y),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const c of m.urls)this.urls.push(this.map._requestManager.transformRequest(c,r.ResourceType.Source).url);r.getVideo(this.urls,(c,f)=>{this._loaded=!0,c?this.fire(new r.ErrorEvent(c)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const c=this.video.seekable;m<c.start(0)||m>c.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,c=m.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(m,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Wt,canvas:class extends Wt{constructor(m,c,f,y){super(m,c,f,y),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(B=>typeof B!="number"))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.Evented{constructor(m,c,f,y){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=c,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new dt(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:c,y:f,z:y}=m.canonical;return this._implementation.hasTile({x:c,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,c){const{x:f,y,z:w}=m.tileID.canonical,B=new r.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:f,y,z:w},{signal:B.signal})).then(function(R){return delete m.request,m.aborted?(m.state="unloaded",c(null)):R===void 0?(m.state="errored",c(null)):R===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",c(null)):function(L){return L instanceof r.window.ImageData||L instanceof r.window.HTMLCanvasElement||L instanceof r.window.ImageBitmap||L instanceof r.window.HTMLImageElement}(R)?(this.loadTileData(m,R),m.state="loaded",void c(null)):(m.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(R=>{R.code!==20&&(m.state="errored",c(R))}),m.request.cancel=()=>B.abort()}loadTileData(m,c){Xe.loadTileData(m,c,this._map.painter)}unloadTileData(m){Xe.unloadTileData(m,this._map.painter)}unloadTile(m,c){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:f,y,z:w}=m.tileID.canonical;this._implementation.unloadTile({x:f,y,z:w})}c()}abortTile(m,c){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},pe=function(m,c,f,y){const w=new qt[c.type](m,c,f,y);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],w),w};function je(m,c){const f=r.identity([]);return r.scale(f,f,[.5*m.width,.5*-m.height,1]),r.translate(f,f,[1,-1,0]),r.multiply(f,f,m.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(f)}function pt(m,c,f,y,w,B,R,L=!1){const U=m.tilesIn(y,R,L);U.sort(Ct);const j=[];for(const ie of U)j.push({wrappedTileID:ie.tile.tileID.wrapped().key,queryResults:ie.tile.queryRenderedFeatures(c,f,m._state,ie,w,B,je(m.transform,ie.tile.tileID),L)});const Y=function(ie){const fe={},xe={};for(const be of ie){const we=be.queryResults,Se=be.wrappedTileID,ne=xe[Se]=xe[Se]||{};for(const ve in we){const Pe=we[ve],ke=ne[ve]=ne[ve]||{},$e=fe[ve]=fe[ve]||[];for(const tt of Pe)ke[tt.featureIndex]||(ke[tt.featureIndex]=!0,$e.push(tt))}}return fe}(j);for(const ie in Y)Y[ie].forEach(fe=>{const xe=fe.feature,be=xe.layer;be&&be.type!=="background"&&be.type!=="sky"&&(xe.source=be.source,be["source-layer"]&&(xe.sourceLayer=be["source-layer"]),xe.state=xe.id!==void 0?m.getFeatureState(be["source-layer"],xe.id):{})});return Y}function it(m,c){const f=m.getRenderableIds().map(B=>m.getTileByID(B)),y=[],w={};for(let B=0;B<f.length;B++){const R=f[B],L=R.tileID.canonical.key;w[L]||(w[L]=!0,R.querySourceFeatures(y,c))}return y}function Ct(m,c){const f=m.tileID,y=c.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function li(){return su.workerClass!=null?new su.workerClass:new r.window.Worker(su.workerUrl)}const Ai="mapboxgl_preloaded_worker_pool";class oi{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<oi.workerCount;)this.workers.push(new li);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ai]}numActive(){return Object.keys(this.active).length}}let ci;function zi(){return ci||(ci=new oi),ci}function Pi(m,c){const f={};for(const y in m)y!=="ref"&&(f[y]=m[y]);return r.refProperties.forEach(y=>{y in c&&(f[y]=c[y])}),f}function Li(m){m=m.slice();const c=Object.create(null);for(let f=0;f<m.length;f++)c[m[f].id]=m[f];for(let f=0;f<m.length;f++)"ref"in m[f]&&(m[f]=Pi(m[f],c[m[f].ref]));return m}oi.workerCount=2;const xi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Gn(m,c,f){f.push({command:xi.addSource,args:[m,c[m]]})}function Sr(m,c,f){c.push({command:xi.removeSource,args:[m]}),f[m]=!0}function Es(m,c,f,y){Sr(m,f,y),Gn(m,c,f)}function wn(m,c,f){let y;for(y in m[f])if(m[f].hasOwnProperty(y)&&y!=="data"&&!p(m[f][y],c[f][y]))return!1;for(y in c[f])if(c[f].hasOwnProperty(y)&&y!=="data"&&!p(m[f][y],c[f][y]))return!1;return!0}function ki(m,c,f,y,w,B){let R;for(R in c=c||{},m=m||{})m.hasOwnProperty(R)&&(p(m[R],c[R])||f.push({command:B,args:[y,R,c[R],w]}));for(R in c)c.hasOwnProperty(R)&&!m.hasOwnProperty(R)&&(p(m[R],c[R])||f.push({command:B,args:[y,R,c[R],w]}))}function Mr(m){return m.id}function ur(m,c){return m[c.id]=c,m}class vo{constructor(c,f){this.reset(c,f)}reset(c,f){this.points=c||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=r.clamp(c,0,1);let f=1,y=this._distances[f];const w=c*this.paddedLength+this.padding;for(;y<w&&f<this._distances.length;)y=this._distances[++f];const B=f-1,R=this._distances[B],L=y-R,U=L>0?(w-R)/L:0;return this.points[B].mult(1-U).add(this.points[f].mult(U))}}class Go{constructor(c,f,y){const w=this.boxCells=[],B=this.circleCells=[];this.xCellCount=Math.ceil(c/y),this.yCellCount=Math.ceil(f/y);for(let R=0;R<this.xCellCount*this.yCellCount;R++)w.push([]),B.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,f,y,w,B){this._forEachCell(f,y,w,B,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(B)}insertCircle(c,f,y,w){this._forEachCell(f-w,y-w,f+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(y),this.circles.push(w)}_insertBoxCell(c,f,y,w,B,R){this.boxCells[B].push(R)}_insertCircleCell(c,f,y,w,B,R){this.circleCells[B].push(R)}_query(c,f,y,w,B,R){if(y<0||c>this.width||w<0||f>this.height)return!B&&[];const L=[];if(c<=0&&f<=0&&this.width<=y&&this.height<=w){if(B)return!0;for(let U=0;U<this.boxKeys.length;U++)L.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const j=this.circles[3*U],Y=this.circles[3*U+1],ie=this.circles[3*U+2];L.push({key:this.circleKeys[U],x1:j-ie,y1:Y-ie,x2:j+ie,y2:Y+ie})}return R?L.filter(R):L}return this._forEachCell(c,f,y,w,this._queryCell,L,{hitTest:B,seenUids:{box:{},circle:{}}},R),B?L.length>0:L}_queryCircle(c,f,y,w,B){const R=c-y,L=c+y,U=f-y,j=f+y;if(L<0||R>this.width||j<0||U>this.height)return!w&&[];const Y=[];return this._forEachCell(R,U,L,j,this._queryCellCircle,Y,{hitTest:w,circle:{x:c,y:f,radius:y},seenUids:{box:{},circle:{}}},B),w?Y.length>0:Y}query(c,f,y,w,B){return this._query(c,f,y,w,!1,B)}hitTest(c,f,y,w,B){return this._query(c,f,y,w,!0,B)}hitTestCircle(c,f,y,w){return this._queryCircle(c,f,y,!0,w)}_queryCell(c,f,y,w,B,R,L,U){const j=L.seenUids,Y=this.boxCells[B];if(Y!==null){const fe=this.bboxes;for(const xe of Y)if(!j.box[xe]){j.box[xe]=!0;const be=4*xe;if(c<=fe[be+2]&&f<=fe[be+3]&&y>=fe[be+0]&&w>=fe[be+1]&&(!U||U(this.boxKeys[xe]))){if(L.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[xe],x1:fe[be],y1:fe[be+1],x2:fe[be+2],y2:fe[be+3]})}}}const ie=this.circleCells[B];if(ie!==null){const fe=this.circles;for(const xe of ie)if(!j.circle[xe]){j.circle[xe]=!0;const be=3*xe;if(this._circleAndRectCollide(fe[be],fe[be+1],fe[be+2],c,f,y,w)&&(!U||U(this.circleKeys[xe]))){if(L.hitTest)return R.push(!0),!0;{const we=fe[be],Se=fe[be+1],ne=fe[be+2];R.push({key:this.circleKeys[xe],x1:we-ne,y1:Se-ne,x2:we+ne,y2:Se+ne})}}}}}_queryCellCircle(c,f,y,w,B,R,L,U){const j=L.circle,Y=L.seenUids,ie=this.boxCells[B];if(ie!==null){const xe=this.bboxes;for(const be of ie)if(!Y.box[be]){Y.box[be]=!0;const we=4*be;if(this._circleAndRectCollide(j.x,j.y,j.radius,xe[we+0],xe[we+1],xe[we+2],xe[we+3])&&(!U||U(this.boxKeys[be])))return R.push(!0),!0}}const fe=this.circleCells[B];if(fe!==null){const xe=this.circles;for(const be of fe)if(!Y.circle[be]){Y.circle[be]=!0;const we=3*be;if(this._circlesCollide(xe[we],xe[we+1],xe[we+2],j.x,j.y,j.radius)&&(!U||U(this.circleKeys[be])))return R.push(!0),!0}}}_forEachCell(c,f,y,w,B,R,L,U){const j=this._convertToXCellCoord(c),Y=this._convertToYCellCoord(f),ie=this._convertToXCellCoord(y),fe=this._convertToYCellCoord(w);for(let xe=j;xe<=ie;xe++)for(let be=Y;be<=fe;be++)if(B.call(this,c,f,y,w,this.xCellCount*be+xe,R,L,U))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,f,y,w,B,R){const L=w-c,U=B-f,j=y+R;return j*j>L*L+U*U}_circleAndRectCollide(c,f,y,w,B,R,L){const U=(R-w)/2,j=Math.abs(c-(w+U));if(j>U+y)return!1;const Y=(L-B)/2,ie=Math.abs(f-(B+Y));if(ie>Y+y)return!1;if(j<=U||ie<=Y)return!0;const fe=j-U,xe=ie-Y;return fe*fe+xe*xe<=y*y}}const As={unknown:0,flipRequired:1,flipNotRequired:2},Ia=Math.tan(85*Math.PI/180);function Mt(m,c,f,y,w,B,R){const L=r.create();if(f)if(B.name==="globe"){const U=r.calculateGlobeLabelMatrix(w,c);r.multiply(L,L,U)}else{const U=W([],R);L[0]=U[0],L[1]=U[1],L[4]=U[2],L[5]=U[3],y||r.rotateZ(L,L,w.angle)}else r.multiply(L,w.labelPlaneMatrix,m);return L}function Wr(m,c,f,y,w,B,R){const L=Mt(m,c,f,y,w,B,R);return B.name==="globe"&&f||(L[2]=L[6]=L[10]=L[14]=0),L}function qn(m,c,f,y,w,B,R){if(f){if(B.name==="globe"){const L=Mt(m,c,f,y,w,B,R);return r.invert(L,L),r.multiply(L,m,L),L}{const L=r.clone(m),U=r.identity([]);return U[0]=R[0],U[1]=R[1],U[4]=R[2],U[5]=R[3],r.multiply(L,L,U),y||r.rotateZ(L,L,-w.angle),L}}return w.glCoordMatrix}function In(m,c,f,y){const w=[m,c,f,1];f?r.transformMat4$1(w,w,y):$i(w,w,y);const B=w[3];return w[0]/=B,w[1]/=B,w[2]/=B,w}function Uc(m,c){return Math.min(.5+m/c*.5,1.5)}function Zs(m,c){const f=m[0]/m[3],y=m[1]/m[3];return f>=-c[0]&&f<=c[0]&&y>=-c[1]&&y<=c[1]}function Oc(m,c,f,y,w,B,R,L,U,j){const Y=f.transform,ie=y?m.textSizeData:m.iconSizeData,fe=r.evaluateSizeForZoom(ie,f.transform.zoom),xe=Y.projection.name==="globe",be=[256/f.width*2+1,256/f.height*2+1],we=y?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;we.clear();let Se=null;xe&&(Se=y?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const ne=m.lineVertexArray,ve=y?m.text.placedSymbolArray:m.icon.placedSymbolArray,Pe=f.transform.width/f.transform.height;let ke,$e=!1;for(let tt=0;tt<ve.length;tt++){const et=ve.get(tt),{numGlyphs:ct,writingMode:lt}=et;if(lt!==r.WritingMode.vertical||$e||ke===r.WritingMode.horizontal||($e=!0),ke=lt,(et.hidden||lt===r.WritingMode.vertical)&&!$e){xo(ct,we);continue}$e=!1;const vt=new r.Point(et.tileAnchorX,et.tileAnchorY);let{x:Zt,y:At,z:zt}=Y.projection.projectTilePoint(vt.x,vt.y,j.canonical);if(U){const[Ni,Ii,Ti]=U(vt);Zt+=Ni,At+=Ii,zt+=Ti}const bt=[Zt,At,zt,1];if(r.transformMat4$1(bt,bt,c),!Zs(bt,be)){xo(ct,we);continue}const Jt=Uc(f.transform.cameraToCenterDistance,bt[3]),_t=r.evaluateSizeForFeature(ie,fe,et),Nt=R?_t/Jt:_t*Jt,ei=In(Zt,At,zt,w);if(ei[3]<=0){xo(ct,we);continue}let jt={};const ti=R?null:U,bi=gi(et,Nt,!1,L,c,w,B,m.glyphOffsetArray,ne,we,Se,ei,vt,jt,Pe,ti,Y.projection,j,R);$e=bi.useVertical,ti&&bi.needsFlipping&&(jt={}),(bi.notEnoughRoom||$e||bi.needsFlipping&&gi(et,Nt,!0,L,c,w,B,m.glyphOffsetArray,ne,we,Se,ei,vt,jt,Pe,ti,Y.projection,j,R).notEnoughRoom)&&xo(ct,we)}y?(m.text.dynamicLayoutVertexBuffer.updateData(we),Se&&m.text.globeExtVertexBuffer.updateData(Se)):(m.icon.dynamicLayoutVertexBuffer.updateData(we),Se&&m.icon.globeExtVertexBuffer.updateData(Se))}function x0(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we){const{lineStartIndex:Se,glyphStartIndex:ne,segment:ve}=L,Pe=ne+L.numGlyphs,ke=Se+L.lineLength,$e=c.getoffsetX(ne),tt=c.getoffsetX(Pe-1),et=Us(m*$e,f,y,w,B,R,ve,Se,ke,U,j,Y,ie,fe,!0,xe,be,we);if(!et)return null;const ct=Us(m*tt,f,y,w,B,R,ve,Se,ke,U,j,Y,ie,fe,!0,xe,be,we);return ct?{first:et,last:ct}:null}function Gc(m,c,f,y){return m===r.WritingMode.horizontal&&Math.abs(y)>Math.abs(f)?{useVertical:!0}:m===r.WritingMode.vertical?y>0?{needsFlipping:!0}:null:c!==As.unknown&&function(w,B){return w===0||Math.abs(B/w)>Ia}(f,y)?c===As.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function gi(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we,Se,ne,ve){const Pe=c/24,ke=m.lineOffsetX*Pe,$e=m.lineOffsetY*Pe,{lineStartIndex:tt,glyphStartIndex:et,numGlyphs:ct,segment:lt,writingMode:vt,flipState:Zt}=m,At=tt+m.lineLength,zt=bt=>{if(Y){const[ei,jt,ti]=bt.up,bi=j.length;r.updateGlobeVertexNormal(Y,bi+0,ei,jt,ti),r.updateGlobeVertexNormal(Y,bi+1,ei,jt,ti),r.updateGlobeVertexNormal(Y,bi+2,ei,jt,ti),r.updateGlobeVertexNormal(Y,bi+3,ei,jt,ti)}const[Jt,_t,Nt]=bt.point;r.addDynamicAttributes(j,Jt,_t,Nt,bt.angle)};if(ct>1){const bt=x0(Pe,L,ke,$e,f,ie,fe,m,U,B,xe,we,!1,Se,ne,ve);if(!bt)return{notEnoughRoom:!0};if(y&&!f){let[Jt,_t,Nt]=bt.first.point,[ei,jt,ti]=bt.last.point;[Jt,_t]=In(Jt,_t,Nt,R),[ei,jt]=In(ei,jt,ti,R);const bi=Gc(vt,Zt,(ei-Jt)*be,jt-_t);if(m.flipState=bi&&bi.needsFlipping?As.flipRequired:As.flipNotRequired,bi)return bi}zt(bt.first);for(let Jt=et+1;Jt<et+ct-1;Jt++){const _t=Us(Pe*L.getoffsetX(Jt),ke,$e,f,ie,fe,lt,tt,At,U,B,xe,we,!1,!1,Se,ne,ve);if(!_t)return j.length-=4*(Jt-et),{notEnoughRoom:!0};zt(_t)}zt(bt.last)}else{if(y&&!f){const Jt=In(fe.x,fe.y,0,w),_t=tt+lt+1,Nt=new r.Point(U.getx(_t),U.gety(_t)),ei=In(Nt.x,Nt.y,0,w),jt=ei[3]>0?ei:Zi(fe,Nt,Jt,1,w,void 0,Se,ne.canonical),ti=Gc(vt,Zt,(jt[0]-Jt[0])*be,jt[1]-Jt[1]);if(m.flipState=ti&&ti.needsFlipping?As.flipRequired:As.flipNotRequired,ti)return ti}const bt=Us(Pe*L.getoffsetX(et),ke,$e,f,ie,fe,lt,tt,At,U,B,xe,we,!1,!1,Se,ne,ve);if(!bt)return{notEnoughRoom:!0};zt(bt)}return{}}function nn(m,c,f,y,w){const{x:B,y:R,z:L}=y.projectTilePoint(m.x,m.y,c);if(!w)return In(B,R,L,f);const[U,j,Y]=w(m);return In(B+U,R+j,L+Y,f)}function Zi(m,c,f,y,w,B,R,L){const U=nn(m.sub(c)._unit()._add(m),L,w,R,B);return r.sub(U,f,U),r.normalize(U,U),r.scaleAndAdd(U,f,U,y)}function Us(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we,Se,ne){const ve=y?m-c:m+c;let Pe=ve>0?1:-1,ke=0;y&&(Pe*=-1,ke=Math.PI),Pe<0&&(ke+=Math.PI);let $e=L+R+(Pe>0?0:1)|0,tt=w,et=w,ct=0,lt=0;const vt=Math.abs(ve),Zt=[],At=[];let zt=B,bt=zt;const Jt=()=>Zi(bt,zt,et,vt-ct+1,Y,fe,we,Se.canonical);for(;ct+lt<=vt;){if($e+=Pe,$e<L||$e>=U)return null;if(et=tt,bt=zt,Zt.push(et),xe&&At.push(bt),zt=new r.Point(j.getx($e),j.gety($e)),tt=ie[$e],!tt){const Ti=nn(zt,Se.canonical,Y,we,fe);tt=Ti[3]>0?ie[$e]=Ti:Jt()}ct+=lt,lt=r.distance(et,tt)}be&&fe&&(ie[$e]&&(tt=Jt(),lt=r.distance(et,tt)),ie[$e]=tt);const _t=(vt-ct)/lt,Nt=zt.sub(bt)._mult(_t)._add(bt),ei=r.sub([],tt,et),jt=r.scaleAndAdd([],et,ei,_t);let ti=[0,0,1],bi=ei[0],Ni=ei[1];if(ne&&(ti=we.upVector(Se.canonical,Nt.x,Nt.y),ti[0]!==0||ti[1]!==0||ti[2]!==1)){const Ti=[ti[2],0,-ti[0]],en=r.cross([],ti,Ti);r.normalize(Ti,Ti),r.normalize(en,en),bi=r.dot(ei,Ti),Ni=r.dot(ei,en)}if(f){const Ti=r.cross([],ti,ei);r.normalize(Ti,Ti),r.scaleAndAdd(jt,jt,Ti,f*Pe)}const Ii=ke+Math.atan2(Ni,bi);return Zt.push(jt),xe&&At.push(Nt),{point:jt,angle:Ii,path:Zt,tilePath:At,up:ti}}function xo(m,c){const f=c.length,y=f+4*m;c.resize(y),c.float32.fill(-1/0,4*f,4*y)}function $i(m,c,f){const y=c[0],w=c[1];return m[0]=f[0]*y+f[4]*w+f[12],m[1]=f[1]*y+f[5]*w+f[13],m[3]=f[3]*y+f[7]*w+f[15],m}const Os=100;class mh{constructor(c,f,y=new Go(c.width+200,c.height+200,25),w=new Go(c.width+200,c.height+200,25)){this.transform=c,this.grid=y,this.ignoredGrid=w,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Os,this.screenBottomBoundary=c.height+Os,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=f}placeCollisionBox(c,f,y,w,B,R,L,U){let j=y.projectedAnchorX,Y=y.projectedAnchorY,ie=y.projectedAnchorZ;const fe=y.elevation,xe=y.tileID,be=c.getProjection();if(fe&&xe){const[tt,et,ct]=be.upVector(xe.canonical,y.tileAnchorX,y.tileAnchorY),lt=be.upVectorScale(xe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=tt*fe*lt,Y+=et*fe*lt,ie+=ct*fe*lt}const we=this.projectAndGetPerspectiveRatio(L,j,Y,ie,y.tileID,be.name==="globe"||!!fe||this.transform.pitch>0,be),Se=R*we.perspectiveRatio,ne=(y.x1*f+w.x-y.padding)*Se+we.point.x,ve=(y.y1*f+w.y-y.padding)*Se+we.point.y,Pe=(y.x2*f+w.x+y.padding)*Se+we.point.x,ke=(y.y2*f+w.y+y.padding)*Se+we.point.y,$e=we.perspectiveRatio<=.55||we.occluded;return!this.isInsideGrid(ne,ve,Pe,ke)||!B&&this.grid.hitTest(ne,ve,Pe,ke,U)||$e?{box:[],offscreen:!1,occluded:we.occluded}:{box:[ne,ve,Pe,ke],offscreen:this.isOffscreen(ne,ve,Pe,ke),occluded:!1}}placeCollisionCircles(c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we){const Se=[],ne=this.transform.elevation,ve=c.getProjection(),Pe=ne?ne.getAtTileOffsetFunc(we,this.transform.center.lat,this.transform.worldSize,ve):null,ke=new r.Point(y.tileAnchorX,y.tileAnchorY);let{x:$e,y:tt,z:et}=ve.projectTilePoint(ke.x,ke.y,we.canonical);if(Pe){const[Nt,ei,jt]=Pe(ke);$e+=Nt,tt+=ei,et+=jt}const ct=ve.name==="globe",lt=this.projectAndGetPerspectiveRatio(L,$e,tt,et,we,ct||!!ne||this.transform.pitch>0,ve),{perspectiveRatio:vt}=lt,Zt=(ie?R/vt:R*vt)/r.ONE_EM,At=In($e,tt,et,U),zt=lt.signedDistanceFromCamera>0?x0(Zt,B,y.lineOffsetX*Zt,y.lineOffsetY*Zt,!1,At,ke,y,w,U,{},ne&&!ie?Pe:null,ie&&!!ne,ve,we,ie):null;let bt=!1,Jt=!1,_t=!0;if(zt&&!lt.occluded){const Nt=.5*xe*vt+be,ei=new r.Point(-100,-100),jt=new r.Point(this.screenRightBoundary,this.screenBottomBoundary),ti=new vo,{first:bi,last:Ni}=zt,Ii=bi.path.length;let Ti=[];for(let wi=Ii-1;wi>=1;wi--)Ti.push(bi.path[wi]);for(let wi=1;wi<Ni.path.length;wi++)Ti.push(Ni.path[wi]);const en=2.5*Nt;j&&(Ti=Ti.map(([wi,yn,Sn],Mn)=>(Pe&&!ct&&(Sn=Pe(Mn<Ii-1?bi.tilePath[Ii-1-Mn]:Ni.tilePath[Mn-Ii+2])[2]),In(wi,yn,Sn,j))),Ti.some(wi=>wi[3]<=0)&&(Ti=[]));let Ji=[];if(Ti.length>0){let wi=1/0,yn=-1/0,Sn=1/0,Mn=-1/0;for(const Tn of Ti)wi=Math.min(wi,Tn[0]),Sn=Math.min(Sn,Tn[1]),yn=Math.max(yn,Tn[0]),Mn=Math.max(Mn,Tn[1]);yn>=ei.x&&wi<=jt.x&&Mn>=ei.y&&Sn<=jt.y&&(Ji=[Ti.map(Tn=>new r.Point(Tn[0],Tn[1]))],(wi<ei.x||yn>jt.x||Sn<ei.y||Mn>jt.y)&&(Ji=r.clipLine(Ji,ei.x,ei.y,jt.x,jt.y)))}for(const wi of Ji){ti.reset(wi,.25*Nt);let yn=0;yn=ti.length<=.5*Nt?1:Math.ceil(ti.paddedLength/en)+1;for(let Sn=0;Sn<yn;Sn++){const Mn=Sn/Math.max(yn-1,1),Tn=ti.lerp(Mn),ss=Tn.x+Os,Fr=Tn.y+Os;Se.push(ss,Fr,Nt,0);const no=ss-Nt,Yo=Fr-Nt,jn=ss+Nt,Dn=Fr+Nt;if(_t=_t&&this.isOffscreen(no,Yo,jn,Dn),Jt=Jt||this.isInsideGrid(no,Yo,jn,Dn),!f&&this.grid.hitTestCircle(ss,Fr,Nt,fe)&&(bt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:bt,occluded:!1}}}}return{circles:!Y&&bt||!Jt?[]:Se,offscreen:_t,collisionDetected:bt,occluded:lt.occluded}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,w=1/0,B=-1/0,R=-1/0;for(const Y of c){const ie=new r.Point(Y.x+Os,Y.y+Os);y=Math.min(y,ie.x),w=Math.min(w,ie.y),B=Math.max(B,ie.x),R=Math.max(R,ie.y),f.push(ie)}const L=this.grid.query(y,w,B,R).concat(this.ignoredGrid.query(y,w,B,R)),U={},j={};for(const Y of L){const ie=Y.key;if(U[ie.bucketInstanceId]===void 0&&(U[ie.bucketInstanceId]={}),U[ie.bucketInstanceId][ie.featureIndex])continue;const fe=[new r.Point(Y.x1,Y.y1),new r.Point(Y.x2,Y.y1),new r.Point(Y.x2,Y.y2),new r.Point(Y.x1,Y.y2)];r.polygonIntersectsPolygon(f,fe)&&(U[ie.bucketInstanceId][ie.featureIndex]=!0,j[ie.bucketInstanceId]===void 0&&(j[ie.bucketInstanceId]=[]),j[ie.bucketInstanceId].push(ie.featureIndex))}return j}insertCollisionBox(c,f,y,w,B){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:B},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,f,y,w,B){const R=f?this.ignoredGrid:this.grid,L={bucketInstanceId:y,featureIndex:w,collisionGroupID:B};for(let U=0;U<c.length;U+=4)R.insertCircle(L,c[U],c[U+1],c[U+2])}projectAndGetPerspectiveRatio(c,f,y,w,B,R,L){const U=[f,y,w,1];let j=!1;w||this.transform.pitch>0?(r.transformMat4$1(U,U,c),this.fogState&&B&&L.name!=="globe"&&(j=function(fe,xe,be,we,Se,ne){const ve=ne.calculateFogTileMatrix(Se),Pe=[xe,be,we];return r.transformMat4(Pe,Pe,ve),De(fe,Pe,ne.pitch,ne._fov)}(this.fogState,f,y,w,B.toUnwrapped(),this.transform)>.9)):$i(U,U,c);const Y=U[3];return{point:new r.Point((U[0]/Y+1)/2*this.transform.width+Os,(-U[1]/Y+1)/2*this.transform.height+Os),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:R&&U[2]>Y||j}}isOffscreen(c,f,y,w){return y<Os||c>=this.screenRightBoundary||w<Os||f>this.screenBottomBoundary}isInsideGrid(c,f,y,w){return y>=0&&c<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const c=r.identity([]);return r.translate(c,c,[-100,-100,0]),c}}function zl(m,c,f){const y=c.createTileMatrix(m,m.worldSize,f.toUnwrapped());return r.multiply(new Float32Array(16),m.projMatrix,y)}function $s(m,c,f){if(c.projection.name===f.projection.name)return m.projMatrix;const y=f.clone();return y.setProjection(c.projection),zl(y,c.getProjection(),m)}function Yn(m,c,f){return c.name===f.projection.name?m.projMatrix:zl(f,c,m)}class I0{constructor(c,f,y,w){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Ca{constructor(c,f,y,w,B,R=!1){this.text=new I0(c?c.text:null,f,y,B),this.icon=new I0(c?c.icon:null,f,w,B),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _h{constructor(c,f,y,w=!1){this.text=c,this.icon=f,this.skipFade=y,this.clipped=w}}class yh{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class JA{constructor(c,f,y,w,B){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=B}}class C0{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[c]}}function vh(m,c,f,y,w){const{horizontalAlign:B,verticalAlign:R}=r.getAnchorAlignment(m),L=-(B-.5)*c,U=-(R-.5)*f,j=r.evaluateVariableOffset(m,y);return new r.Point(L+j[0]*w,U+j[1]*w)}function xh(m,c,f,y,w){const B=new r.Point(m,c);return f&&B._rotate(y?w:-w),B}class df{constructor(c,f,y,w,B){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new mh(this.transform,B),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new C0(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,f,y,w){const B=y.getBucket(f),R=y.latestFeatureIndex;if(!B||!R||f.id!==B.layerIds[0])return;const L=B.layers[0].layout,U=y.collisionBoxArray,j=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),Y=y.tileSize/r.EXTENT,ie=y.tileID.toUnwrapped();this.transform.setProjection(B.projection);const fe=(xe=y.tileID,be=B.getProjection(),we=this.transform,be.name===this.projection?we.calculateProjMatrix(xe.toUnwrapped()):zl(we,be,xe));var xe,be,we;const Se=L.get("text-pitch-alignment")==="map",ne=L.get("text-rotation-alignment")==="map";f.compileFilter();const ve=f.dynamicFilter(),Pe=f.dynamicFilterNeedsFeature(),ke=this.transform.calculatePixelsToTileUnitsMatrix(y),$e=Wr(fe,y.tileID.canonical,Se,ne,this.transform,B.getProjection(),ke);let tt=null;if(Se){const lt=qn(fe,y.tileID.canonical,Se,ne,this.transform,B.getProjection(),ke);tt=r.multiply([],this.transform.labelPlaneMatrix,lt)}let et=null;ve&&y.latestFeatureIndex&&(et={unwrappedTileID:ie,dynamicFilter:ve,dynamicFilterNeedsFeature:Pe,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[B.bucketInstanceId]=new JA(B.bucketInstanceId,R,B.sourceLayerIndex,B.index,y.tileID);const ct={bucket:B,layout:L,posMatrix:fe,textLabelPlaneMatrix:$e,labelToScreenMatrix:tt,clippingData:et,scale:j,textPixelRatio:Y,holdingForFade:y.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(B.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom(B.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(B.sourceID)};if(w)for(const lt of B.sortKeyRanges){const{sortKey:vt,symbolInstanceStart:Zt,symbolInstanceEnd:At}=lt;c.push({sortKey:vt,symbolInstanceStart:Zt,symbolInstanceEnd:At,parameters:ct})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:B.symbolInstances.length,parameters:ct})}attemptAnchorPlacement(c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we,Se,ne,ve){const{textOffset0:Pe,textOffset1:ke,crossTileID:$e}=fe,tt=[Pe,ke],et=vh(c,y,w,tt,B),ct=this.collisionIndex.placeCollisionBox(be,B,f,xh(et.x,et.y,R,L,this.transform.angle),ie,U,j,Y.predicate);if(Se){const lt=be.getSymbolInstanceIconSize(ve,this.transform.zoom,fe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(be,lt,Se,xh(et.x,et.y,R,L,this.transform.angle),ie,U,j,Y.predicate).box.length===0)return}if(ct.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(lt=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:tt,width:y,height:w,anchor:c,textScale:B,prevAnchor:lt},this.markUsedJustification(be,c,fe,we),be.allowVerticalPlacement&&(this.markUsedOrientation(be,we,fe),this.placedOrientations[$e]=we),{shift:et,placedGlyphBoxes:ct}}}placeLayerBucketPart(c,f,y,w){const{bucket:B,layout:R,posMatrix:L,textLabelPlaneMatrix:U,labelToScreenMatrix:j,clippingData:Y,textPixelRatio:ie,holdingForFade:fe,collisionBoxArray:xe,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:we,collisionGroup:Se}=c.parameters,ne=R.get("text-optional"),ve=R.get("icon-optional"),Pe=R.get("text-allow-overlap"),ke=R.get("icon-allow-overlap"),$e=R.get("text-rotation-alignment")==="map",tt=R.get("text-pitch-alignment")==="map",et=R.get("icon-text-fit")!=="none",ct=R.get("symbol-z-order")==="viewport-y";this.transform.setProjection(B.projection);let lt=Pe&&(ke||!B.hasIconData()||ve),vt=ke&&(Pe||!B.hasTextData()||ne);!B.collisionArrays&&xe&&B.deserializeCollisionBoxes(xe),y&&w&&B.updateCollisionDebugBuffers(this.transform.zoom,xe);const Zt=(At,zt,bt)=>{const{crossTileID:Jt,numVerticalGlyphVertices:_t}=At;if(Y){const jn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Dn=null;if(Y.dynamicFilterNeedsFeature){const fn=this.retainedQueryData[B.bucketInstanceId];Dn=Y.featureIndex.loadFeature({featureIndex:At.featureIndex,bucketIndex:fn.bucketIndex,sourceLayerIndex:fn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Y.dynamicFilter)(jn,Dn,this.retainedQueryData[B.bucketInstanceId].tileID.canonical,new r.Point(At.tileAnchorX,At.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[Jt]=new _h(!1,!1,!1,!0),void f.add(Jt)}if(f.has(Jt))return;if(fe)return void(this.placements[Jt]=new _h(!1,!1,!1));let Nt=!1,ei=!1,jt=!0,ti=!1,bi=!1,Ni=null,Ii={box:null,offscreen:null,occluded:null},Ti={box:null,offscreen:null,occluded:null},en=null,Ji=null,wi=null,yn=0,Sn=0,Mn=0;bt.textFeatureIndex?yn=bt.textFeatureIndex:At.useRuntimeCollisionCircles&&(yn=At.featureIndex),bt.verticalTextFeatureIndex&&(Sn=bt.verticalTextFeatureIndex);const Tn=jn=>{jn.tileID=this.retainedQueryData[B.bucketInstanceId].tileID;const Dn=this.transform.elevation;(Dn||jn.elevation)&&(jn.elevation=Dn?Dn.getAtTileOffset(jn.tileID,jn.tileAnchorX,jn.tileAnchorY):0)},ss=bt.textBox;if(ss){Tn(ss);const jn=fn=>{let Ar=r.WritingMode.horizontal;if(B.allowVerticalPlacement&&!fn&&this.prevPlacement){const gs=this.prevPlacement.placedOrientations[Jt];gs&&(this.placedOrientations[Jt]=gs,Ar=gs,this.markUsedOrientation(B,Ar,At))}return Ar},Dn=(fn,Ar)=>{if(B.allowVerticalPlacement&&_t>0&&bt.verticalTextBox){for(const gs of B.writingModes)if(gs===r.WritingMode.vertical?(Ii=Ar(),Ti=Ii):Ii=fn(),Ii&&Ii.box&&Ii.box.length)break}else Ii=fn()};if(R.get("text-variable-anchor")){let fn=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Jt]){const Hn=this.prevPlacement.variableOffsets[Jt];fn.indexOf(Hn.anchor)>0&&(fn=fn.filter(Bs=>Bs!==Hn.anchor),fn.unshift(Hn.anchor))}const Ar=(Hn,Bs,zf)=>{const jl=B.getSymbolInstanceTextSize(be,At,this.transform.zoom,zt),Oh=(Hn.x2-Hn.x1)*jl+2*Hn.padding,Ta=(Hn.y2-Hn.y1)*jl+2*Hn.padding,ll=et&&!ke?Bs:null;ll&&Tn(ll);let ql={box:[],offscreen:!1,occluded:!1};const Uf=Pe?2*fn.length:fn.length;for(let Gh=0;Gh<Uf;++Gh){const Ug=this.attemptAnchorPlacement(fn[Gh%fn.length],Hn,Oh,Ta,jl,$e,tt,ie,L,Se,Gh>=fn.length,At,zt,B,zf,ll,be,we);if(Ug&&(ql=Ug.placedGlyphBoxes,ql&&ql.box&&ql.box.length)){Nt=!0,Ni=Ug.shift;break}}return ql};Dn(()=>Ar(ss,bt.iconBox,r.WritingMode.horizontal),()=>{const Hn=bt.verticalTextBox;return Hn&&Tn(Hn),B.allowVerticalPlacement&&!(Ii&&Ii.box&&Ii.box.length)&&_t>0&&Hn?Ar(Hn,bt.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ii&&(Nt=Ii.box,jt=Ii.offscreen,ti=Ii.occluded);const gs=jn(!(!Ii||!Ii.box));if(!Nt&&this.prevPlacement){const Hn=this.prevPlacement.variableOffsets[Jt];Hn&&(this.variableOffsets[Jt]=Hn,this.markUsedJustification(B,Hn.anchor,At,gs))}}else{const fn=(Ar,gs)=>{const Hn=B.getSymbolInstanceTextSize(be,At,this.transform.zoom,zt),Bs=this.collisionIndex.placeCollisionBox(B,Hn,Ar,new r.Point(0,0),Pe,ie,L,Se.predicate);return Bs&&Bs.box&&Bs.box.length&&(this.markUsedOrientation(B,gs,At),this.placedOrientations[Jt]=gs),Bs};Dn(()=>fn(ss,r.WritingMode.horizontal),()=>{const Ar=bt.verticalTextBox;return B.allowVerticalPlacement&&_t>0&&Ar?(Tn(Ar),fn(Ar,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),jn(!!(Ii&&Ii.box&&Ii.box.length))}}if(en=Ii,Nt=en&&en.box&&en.box.length>0,jt=en&&en.offscreen,ti=en&&en.occluded,At.useRuntimeCollisionCircles){const jn=B.text.placedSymbolArray.get(At.centerJustifiedTextSymbolIndex>=0?At.centerJustifiedTextSymbolIndex:At.verticalPlacedTextSymbolIndex),Dn=r.evaluateSizeForFeature(B.textSizeData,be,jn),fn=R.get("text-padding");Ji=this.collisionIndex.placeCollisionCircles(B,Pe,jn,B.lineVertexArray,B.glyphOffsetArray,Dn,L,U,j,y,tt,Se.predicate,At.collisionCircleDiameter*Dn/r.ONE_EM,fn,this.retainedQueryData[B.bucketInstanceId].tileID),Nt=Pe||Ji.circles.length>0&&!Ji.collisionDetected,jt=jt&&Ji.offscreen,ti=Ji.occluded}if(bt.iconFeatureIndex&&(Mn=bt.iconFeatureIndex),bt.iconBox){const jn=Dn=>{Tn(Dn);const fn=et&&Ni?xh(Ni.x,Ni.y,$e,tt,this.transform.angle):new r.Point(0,0),Ar=B.getSymbolInstanceIconSize(we,this.transform.zoom,At.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(B,Ar,Dn,fn,ke,ie,L,Se.predicate)};Ti&&Ti.box&&Ti.box.length&&bt.verticalIconBox?(wi=jn(bt.verticalIconBox),ei=wi.box.length>0):(wi=jn(bt.iconBox),ei=wi.box.length>0),jt=jt&&wi.offscreen,bi=wi.occluded}const Fr=ne||At.numHorizontalGlyphVertices===0&&_t===0,no=ve||At.numIconVertices===0;if(Fr||no?no?Fr||(ei=ei&&Nt):Nt=ei&&Nt:ei=Nt=ei&&Nt,Nt&&en&&en.box&&this.collisionIndex.insertCollisionBox(en.box,R.get("text-ignore-placement"),B.bucketInstanceId,Ti&&Ti.box&&Sn?Sn:yn,Se.ID),ei&&wi&&this.collisionIndex.insertCollisionBox(wi.box,R.get("icon-ignore-placement"),B.bucketInstanceId,Mn,Se.ID),Ji&&(Nt&&this.collisionIndex.insertCollisionCircles(Ji.circles,R.get("text-ignore-placement"),B.bucketInstanceId,yn,Se.ID),y)){const jn=B.bucketInstanceId;let Dn=this.collisionCircleArrays[jn];Dn===void 0&&(Dn=this.collisionCircleArrays[jn]=new yh);for(let fn=0;fn<Ji.circles.length;fn+=4)Dn.circles.push(Ji.circles[fn+0]),Dn.circles.push(Ji.circles[fn+1]),Dn.circles.push(Ji.circles[fn+2]),Dn.circles.push(Ji.collisionDetected?1:0)}const Yo=B.projection.name!=="globe";lt=lt&&(Yo||!ti),vt=vt&&(Yo||!bi),this.placements[Jt]=new _h(Nt||lt,ei||vt,jt||B.justReloaded),f.add(Jt)};if(ct){const At=B.getSortedSymbolIndexes(this.transform.angle);for(let zt=At.length-1;zt>=0;--zt){const bt=At[zt];Zt(B.symbolInstances.get(bt),bt,B.collisionArrays[bt])}}else for(let At=c.symbolInstanceStart;At<c.symbolInstanceEnd;At++)Zt(B.symbolInstances.get(At),At,B.collisionArrays[At]);if(y&&B.bucketInstanceId in this.collisionCircleArrays){const At=this.collisionCircleArrays[B.bucketInstanceId];r.invert(At.invProjMatrix,L),At.viewportMatrix=this.collisionIndex.getViewportMatrix()}B.justReloaded=!1}markUsedJustification(c,f,y,w){const{leftJustifiedTextSymbolIndex:B,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:U,crossTileID:j}=y,Y=r.getAnchorJustification(f),ie=w===r.WritingMode.vertical?U:Y==="left"?B:Y==="center"?R:Y==="right"?L:-1;B>=0&&(c.text.placedSymbolArray.get(B).crossTileID=ie>=0&&B!==ie?0:j),R>=0&&(c.text.placedSymbolArray.get(R).crossTileID=ie>=0&&R!==ie?0:j),L>=0&&(c.text.placedSymbolArray.get(L).crossTileID=ie>=0&&L!==ie?0:j),U>=0&&(c.text.placedSymbolArray.get(U).crossTileID=ie>=0&&U!==ie?0:j)}markUsedOrientation(c,f,y){const w=f===r.WritingMode.horizontal||f===r.WritingMode.horizontalOnly?f:0,B=f===r.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:j}=y,Y=c.text.placedSymbolArray;R>=0&&(Y.get(R).placedOrientation=w),L>=0&&(Y.get(L).placedOrientation=w),U>=0&&(Y.get(U).placedOrientation=w),j>=0&&(Y.get(j).placedOrientation=B)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const w=f?f.symbolFadeChange(c):1,B=f?f.opacities:{},R=f?f.variableOffsets:{},L=f?f.placedOrientations:{};for(const U in this.placements){const j=this.placements[U],Y=B[U];Y?(this.opacities[U]=new Ca(Y,w,j.text,j.icon,null,j.clipped),y=y||j.text!==Y.text.placed||j.icon!==Y.icon.placed):(this.opacities[U]=new Ca(null,w,j.text,j.icon,j.skipFade,j.clipped),y=y||j.text||j.icon)}for(const U in B){const j=B[U];if(!this.opacities[U]){const Y=new Ca(j,w,!1,!1);Y.isHidden()||(this.opacities[U]=Y,y=y||j.text.placed||j.icon.placed)}}for(const U in R)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=R[U]);for(const U in L)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=L[U]);y?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)}updateLayerOpacities(c,f){const y=new Set;for(const w of f){const B=w.getBucket(c);B&&w.latestFeatureIndex&&c.id===B.layerIds[0]&&this.updateBucketOpacities(B,y,w.collisionBoxArray)}}updateBucketOpacities(c,f,y){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const w=c.layers[0].layout,B=!!c.layers[0].dynamicFilter(),R=new Ca(null,0,!1,!1,!0),L=w.get("text-allow-overlap"),U=w.get("icon-allow-overlap"),j=w.get("text-variable-anchor"),Y=w.get("text-rotation-alignment")==="map",ie=w.get("text-pitch-alignment")==="map",fe=w.get("icon-text-fit")!=="none",xe=new Ca(null,0,L&&(U||!c.hasIconData()||w.get("icon-optional")),U&&(L||!c.hasTextData()||w.get("text-optional")),!0);!c.collisionArrays&&y&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(y);const be=(Se,ne,ve)=>{for(let Pe=0;Pe<ne/4;Pe++)Se.opacityVertexArray.emplaceBack(ve)};let we=0;for(let Se=0;Se<c.symbolInstances.length;Se++){const ne=c.symbolInstances.get(Se),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:Pe,crossTileID:ke,numIconVertices:$e}=ne,tt=f.has(ke);let et=this.opacities[ke];tt?et=R:et||(et=xe,this.opacities[ke]=et),f.add(ke);const ct=ve>0||Pe>0,lt=$e>0,vt=this.placedOrientations[ke],Zt=vt===r.WritingMode.vertical,At=vt===r.WritingMode.horizontal||vt===r.WritingMode.horizontalOnly;if(!ct&&!lt||et.isHidden()||we++,ct){const zt=Ih(et.text);be(c.text,ve,Zt?sr:zt),be(c.text,Pe,At?sr:zt);const bt=et.text.isHidden(),{leftJustifiedTextSymbolIndex:Jt,centerJustifiedTextSymbolIndex:_t,rightJustifiedTextSymbolIndex:Nt,verticalPlacedTextSymbolIndex:ei}=ne,jt=c.text.placedSymbolArray,ti=bt||Zt?1:0;Jt>=0&&(jt.get(Jt).hidden=ti),_t>=0&&(jt.get(_t).hidden=ti),Nt>=0&&(jt.get(Nt).hidden=ti),ei>=0&&(jt.get(ei).hidden=bt||At?1:0);const bi=this.variableOffsets[ke];bi&&this.markUsedJustification(c,bi.anchor,ne,vt);const Ni=this.placedOrientations[ke];Ni&&(this.markUsedJustification(c,"left",ne,Ni),this.markUsedOrientation(c,Ni,ne))}if(lt){const zt=Ih(et.icon),{placedIconSymbolIndex:bt,verticalPlacedIconSymbolIndex:Jt}=ne,_t=c.icon.placedSymbolArray,Nt=et.icon.isHidden()?1:0;bt>=0&&(be(c.icon,$e,Zt?sr:zt),_t.get(bt).hidden=Nt),Jt>=0&&(be(c.icon,ne.numVerticalIconVertices,At?sr:zt),_t.get(Jt).hidden=Nt)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const zt=c.collisionArrays[Se];if(zt){let bt=new r.Point(0,0),Jt=!0;if(zt.textBox||zt.verticalTextBox){if(j){const Nt=this.variableOffsets[ke];Nt?(bt=vh(Nt.anchor,Nt.width,Nt.height,Nt.textOffset,Nt.textScale),Y&&bt._rotate(ie?this.transform.angle:-this.transform.angle)):Jt=!1}B&&(Jt=!et.clipped),zt.textBox&&Hc(c.textCollisionBox.collisionVertexArray,et.text.placed,!Jt||Zt,bt.x,bt.y),zt.verticalTextBox&&Hc(c.textCollisionBox.collisionVertexArray,et.text.placed,!Jt||At,bt.x,bt.y)}const _t=Jt&&Boolean(!At&&zt.verticalIconBox);zt.iconBox&&Hc(c.iconCollisionBox.collisionVertexArray,et.icon.placed,_t,fe?bt.x:0,fe?bt.y:0),zt.verticalIconBox&&Hc(c.iconCollisionBox.collisionVertexArray,et.icon.placed,!_t,fe?bt.x:0,fe?bt.y:0)}}}if(c.fullyClipped=we===0,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const Se=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=Se.invProjMatrix,c.placementViewportMatrix=Se.viewportMatrix,c.collisionCircleArray=Se.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>c}setStale(){this.stale=!0}}function Hc(m,c,f,y,w){m.emplaceBack(c?1:0,f?1:0,y||0,w||0),m.emplaceBack(c?1:0,f?1:0,y||0,w||0),m.emplaceBack(c?1:0,f?1:0,y||0,w||0),m.emplaceBack(c?1:0,f?1:0,y||0,w||0)}const ws=Math.pow(2,25),hr=Math.pow(2,24),XA=Math.pow(2,17),ZA=Math.pow(2,16),bs=Math.pow(2,9),eo=Math.pow(2,8),E0=Math.pow(2,1);function Ih(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const c=m.placed?1:0,f=Math.floor(127*m.opacity);return f*ws+c*hr+f*XA+c*ZA+f*bs+c*eo+f*E0+c}const sr=0;class Ch{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,f,y,w,B){const R=this._bucketParts;for(;this._currentTileIndex<c.length;)if(f.getBucketParts(R,w,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,B())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((L,U)=>L.sortKey-U.sortKey));this._currentPartIndex<R.length;){const L=R[this._currentPartIndex];if(f.placeLayerBucketPart(L,this._seenCrossTileIDs,y,L.symbolInstanceStart===0),this._currentPartIndex++,B())return!0}return!1}}class $A{constructor(c,f,y,w,B,R,L,U){this.placement=new df(c,B,R,L,U),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(c,f,y){const w=r.exported.now(),B=()=>{const R=r.exported.now()-w;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=f[c[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=L)&&(!R.maxzoom||R.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Ch(R)),this._inProgressLayer.continuePlacement(y[R.source],this.placement,this._showCollisionBoxes,R,B))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Ul=512/r.EXTENT/2;class Yr{constructor(c,f,y){this.tileID=c,this.bucketInstanceId=y,this.index=new r.KDBush(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=c.canonical.x*r.EXTENT,B=c.canonical.y*r.EXTENT;for(let R=0;R<f.length;R++){const{key:L,crossTileID:U,tileAnchorX:j,tileAnchorY:Y}=f.get(R),ie=Math.floor((w+j)*Ul),fe=Math.floor((B+Y)*Ul);this.index.add(ie,fe),this.keys.push(L),this.crossTileIDs.push(U)}this.index.finish()}findMatches(c,f,y){const w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),B=Ul/Math.pow(2,f.canonical.z-this.tileID.canonical.z),R=f.canonical.x*r.EXTENT,L=f.canonical.y*r.EXTENT;for(let U=0;U<c.length;U++){const j=c.get(U);if(j.crossTileID)continue;const{key:Y,tileAnchorX:ie,tileAnchorY:fe}=j,xe=Math.floor((R+ie)*B),be=Math.floor((L+fe)*B),we=this.index.range(xe-w,be-w,xe+w,be+w);for(const Se of we){const ne=this.crossTileIDs[Se];if(this.keys[Se]===Y&&!y.has(ne)){y.add(ne),j.crossTileID=ne;break}}}}}class eg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class tg{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const f=Math.round((c-this.lng)/360);if(f!==0)for(const y in this.indexes){const w=this.indexes[y],B={};for(const R in w){const L=w[R];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+f),B[L.tileID.key]=L}this.indexes[y]=B}this.lng=c}addBucket(c,f,y){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let B=0;B<f.symbolInstances.length;B++)f.symbolInstances.get(B).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const w=this.usedCrossTileIDs[c.overscaledZ];for(const B in this.indexes){const R=this.indexes[B];if(Number(B)>c.overscaledZ)for(const L in R){const U=R[L];U.tileID.isChildOf(c)&&U.findMatches(f.symbolInstances,c,w)}else{const L=R[c.scaledTo(Number(B)).key];L&&L.findMatches(f.symbolInstances,c,w)}}for(let B=0;B<f.symbolInstances.length;B++){const R=f.symbolInstances.get(B);R.crossTileID||(R.crossTileID=y.generate(),w.add(R.crossTileID))}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Yr(c,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(c,f){for(const y of f.crossTileIDs)this.usedCrossTileIDs[c].delete(y)}removeStaleBuckets(c){let f=!1;for(const y in this.indexes){const w=this.indexes[y];for(const B in w)c[w[B].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[B]),delete w[B],f=!0)}return f}}class Ea{constructor(){this.layerIndexes={},this.crossTileIDs=new eg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,f,y,w){let B=this.layerIndexes[c.id];B===void 0&&(B=this.layerIndexes[c.id]=new tg);let R=!1;const L={};w.name!=="globe"&&B.handleWrapJump(y);for(const U of f){const j=U.getBucket(c);j&&c.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),B.addBucket(U.tileID,j,this.crossTileIDs)&&(R=!0),L[j.bucketInstanceId]=!0)}return B.removeStaleBuckets(L)&&(R=!0),R}pruneUnusedLayers(c){const f={};c.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const ol=(m,c)=>r.emitValidationErrors(m,c&&c.filter(f=>f.identifier!=="source.canvas")),ff=r.pick(xi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),F1=r.pick(xi,["setCenter","setZoom","setBearing","setPitch"]),ig={version:8,layers:[],sources:{}},Vc={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ho extends r.Evented{constructor(c,f={}){super(),this.map=c,this.dispatcher=new oe(zi(),this),this.imageManager=new de,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(c._requestManager,f.localFontFamily?r.LocalGlyphMode.all:f.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new Ea,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const y=this;this._rtlTextPluginCallback=Ho.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(B,R)=>{if(r.triggerPluginCompletionEvent(B),R&&R.every(L=>L))for(const L in y._sourceCaches){const U=y._sourceCaches[L],j=U.getSource().type;j!=="vector"&&j!=="geojson"||U.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const B=this.getSource(w.sourceId);if(B&&B.vectorLayerIds)for(const R in this._layers){const L=this._layers[R];L.source===B.id&&this._validateLayer(L)}})}loadURL(c,f={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!r.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,f.accessToken);const w=this.map._requestManager.transformRequest(c,r.ResourceType.Style);this._request=r.getJSON(w,(B,R)=>{this._request=null,B?this.fire(new r.ErrorEvent(B)):R&&this._load(R,y)})}loadJSON(c,f={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame(()=>{this._request=null,this._load(c,f.validate!==!1)})}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(ig,!1)}_updateLayerCount(c,f){const y=f?1:-1;c.is3D()&&(this._num3DLayers+=y),c.type==="circle"&&(this._numCircleLayers+=y),c.type==="symbol"&&(this._numSymbolLayers+=y)}_load(c,f){if(f&&ol(this,r.validateStyle(c)))return;this._loaded=!0,this.stylesheet=r.clone$1(c),this._updateMapProjection();for(const w in c.sources)this.addSource(w,c.sources[w],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const y=Li(this.stylesheet.layers);this._order=y.map(w=>w.id),this._layers={},this._serializedLayers={};for(const w of y){const B=r.createStyleLayer(w);B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B,this._serializedLayers[B.id]=B.serialize(),this._updateLayerCount(B,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ce(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(f,y,w){let B,R,L;const U=r.exported.devicePixelRatio>1?"@2x":"";let j=r.getJSON(y.transformRequest(y.normalizeSpriteURL(f,U,".json"),r.ResourceType.SpriteJSON),(fe,xe)=>{j=null,L||(L=fe,B=xe,ie())}),Y=r.getImage(y.transformRequest(y.normalizeSpriteURL(f,U,".png"),r.ResourceType.SpriteImage),(fe,xe)=>{Y=null,L||(L=fe,R=xe,ie())});function ie(){if(L)w(L);else if(B&&R){const fe=r.exported.getImageData(R),xe={};for(const be in B){const{width:we,height:Se,x:ne,y:ve,sdf:Pe,pixelRatio:ke,stretchX:$e,stretchY:tt,content:et}=B[be],ct=new r.RGBAImage({width:we,height:Se});r.RGBAImage.copy(fe,ct,{x:ne,y:ve},{x:0,y:0},{width:we,height:Se}),xe[be]={data:ct,pixelRatio:ke,sdf:Pe,stretchX:$e,stretchY:tt,content:et}}w(null,xe)}}return{cancel(){j&&(j.cancel(),j=null),Y&&(Y.cancel(),Y=null)}}}(c,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new r.ErrorEvent(f));else if(y)for(const w in y)this.imageManager.addImage(w,y[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))})}_validateLayer(c){const f=this.getSource(c.source);if(!f)return;const y=c.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const f=[];for(const y of c){const w=this._layers[y];w.type!=="custom"&&f.push(w.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&(typeof c.isLayerDraped=="function"?c.isLayerDraped():Vc[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const f=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),B=Object.keys(this._removedLayers);(w.length||B.length)&&this._updateWorkerLayers(w,B);for(const R in this._updatedSources){const L=this._updatedSources[R];L==="reload"?this._reloadSource(R):L==="clear"&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const y={};for(const w in this._sourceCaches){const B=this._sourceCaches[w];y[w]=B.used,B.used=!1}for(const w of this._order){const B=this._layers[w];if(B.recalculate(c,this._availableImages),!B.isHidden(c.zoom)){const L=this._getLayerSourceCache(B);L&&(L.used=!0)}const R=this.map.painter;if(R){const L=B.getProgramIds();if(!L)continue;const U=B.getProgramConfiguration(c.zoom);for(const j of L)R.useProgram(j,U)}}for(const w in y){const B=this._sourceCaches[w];y[w]!==B.used&&B.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:B.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),ol(this,r.validateStyle(c)))return!1;(c=r.clone$1(c)).layers=Li(c.layers);const f=function(w,B){if(!w)return[{command:xi.setStyle,args:[B]}];let R=[];try{if(!p(w.version,B.version))return[{command:xi.setStyle,args:[B]}];p(w.center,B.center)||R.push({command:xi.setCenter,args:[B.center]}),p(w.zoom,B.zoom)||R.push({command:xi.setZoom,args:[B.zoom]}),p(w.bearing,B.bearing)||R.push({command:xi.setBearing,args:[B.bearing]}),p(w.pitch,B.pitch)||R.push({command:xi.setPitch,args:[B.pitch]}),p(w.sprite,B.sprite)||R.push({command:xi.setSprite,args:[B.sprite]}),p(w.glyphs,B.glyphs)||R.push({command:xi.setGlyphs,args:[B.glyphs]}),p(w.transition,B.transition)||R.push({command:xi.setTransition,args:[B.transition]}),p(w.light,B.light)||R.push({command:xi.setLight,args:[B.light]}),p(w.fog,B.fog)||R.push({command:xi.setFog,args:[B.fog]}),p(w.projection,B.projection)||R.push({command:xi.setProjection,args:[B.projection]});const L={},U=[];(function(ie,fe,xe,be){let we;for(we in fe=fe||{},ie=ie||{})ie.hasOwnProperty(we)&&(fe.hasOwnProperty(we)||Sr(we,xe,be));for(we in fe){if(!fe.hasOwnProperty(we))continue;const Se=fe[we];ie.hasOwnProperty(we)?p(ie[we],Se)||(ie[we].type==="geojson"&&Se.type==="geojson"&&wn(ie,fe,we)?xe.push({command:xi.setGeoJSONSourceData,args:[we,Se.data]}):Es(we,fe,xe,be)):Gn(we,fe,xe)}})(w.sources,B.sources,U,L);const j=[];w.layers&&w.layers.forEach(ie=>{ie.source&&L[ie.source]?R.push({command:xi.removeLayer,args:[ie.id]}):j.push(ie)});let Y=w.terrain;Y&&L[Y.source]&&(R.push({command:xi.setTerrain,args:[void 0]}),Y=void 0),R=R.concat(U),p(Y,B.terrain)||R.push({command:xi.setTerrain,args:[B.terrain]}),function(ie,fe,xe){fe=fe||[];const be=(ie=ie||[]).map(Mr),we=fe.map(Mr),Se=ie.reduce(ur,{}),ne=fe.reduce(ur,{}),ve=be.slice(),Pe=Object.create(null);let ke,$e,tt,et,ct,lt,vt;for(ke=0,$e=0;ke<be.length;ke++)tt=be[ke],ne.hasOwnProperty(tt)?$e++:(xe.push({command:xi.removeLayer,args:[tt]}),ve.splice(ve.indexOf(tt,$e),1));for(ke=0,$e=0;ke<we.length;ke++)tt=we[we.length-1-ke],ve[ve.length-1-ke]!==tt&&(Se.hasOwnProperty(tt)?(xe.push({command:xi.removeLayer,args:[tt]}),ve.splice(ve.lastIndexOf(tt,ve.length-$e),1)):$e++,lt=ve[ve.length-ke],xe.push({command:xi.addLayer,args:[ne[tt],lt]}),ve.splice(ve.length-ke,0,tt),Pe[tt]=!0);for(ke=0;ke<we.length;ke++)if(tt=we[ke],et=Se[tt],ct=ne[tt],!Pe[tt]&&!p(et,ct))if(p(et.source,ct.source)&&p(et["source-layer"],ct["source-layer"])&&p(et.type,ct.type)){for(vt in ki(et.layout,ct.layout,xe,tt,null,xi.setLayoutProperty),ki(et.paint,ct.paint,xe,tt,null,xi.setPaintProperty),p(et.filter,ct.filter)||xe.push({command:xi.setFilter,args:[tt,ct.filter]}),p(et.minzoom,ct.minzoom)&&p(et.maxzoom,ct.maxzoom)||xe.push({command:xi.setLayerZoomRange,args:[tt,ct.minzoom,ct.maxzoom]}),et)et.hasOwnProperty(vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&(vt.indexOf("paint.")===0?ki(et[vt],ct[vt],xe,tt,vt.slice(6),xi.setPaintProperty):p(et[vt],ct[vt])||xe.push({command:xi.setLayerProperty,args:[tt,vt,ct[vt]]}));for(vt in ct)ct.hasOwnProperty(vt)&&!et.hasOwnProperty(vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&(vt.indexOf("paint.")===0?ki(et[vt],ct[vt],xe,tt,vt.slice(6),xi.setPaintProperty):p(et[vt],ct[vt])||xe.push({command:xi.setLayerProperty,args:[tt,vt,ct[vt]]}))}else xe.push({command:xi.removeLayer,args:[tt]}),lt=ve[ve.lastIndexOf(tt)+1],xe.push({command:xi.addLayer,args:[ct,lt]})}(j,B.layers,R)}catch(L){console.warn("Unable to compute style diff:",L),R=[{command:xi.setStyle,args:[B]}]}return R}(this.serialize(),c).filter(w=>!(w.command in F1));if(f.length===0)return!1;const y=f.filter(w=>!(w.command in ff));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);return f.forEach(w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,f){return this.getImage(c)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,f),this._afterImageUpdated(c),this)}updateImage(c,f){this.imageManager.updateImage(c,f)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,f,y={}){if(this._checkLoaded(),this.getSource(c)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(r.validateSource,`sources.${c}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const w=pe(c,f,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:w.serialize(),sourceId:c}));const B=R=>{const L=(R?"symbol:":"other:")+c,U=this._sourceCaches[L]=new r.SourceCache(L,w,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[c]=U,U.style=this,U.onAdd(this.map)};B(!1),f.type!=="vector"&&f.type!=="geojson"||B(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const f=this.getSource(c);if(!f)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===c)return this.fire(new r.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new r.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(c);for(const w of y)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,f){this._checkLoaded(),this.getSource(c).setData(f),this._changed=!0}getSource(c){const f=this._getSourceCache(c);return f&&f.getSource()}_getSources(){const c=[];for(const f in this._otherSourceCaches){const y=this._getSourceCache(f);y&&c.push(y.getSource())}return c}addLayer(c,f,y={}){this._checkLoaded();const w=c.id;if(this.getLayer(w))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let B;if(c.type==="custom"){if(ol(this,r.validateCustomStyleLayer(c)))return;B=r.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(w,c.source),c=r.clone$1(c),c=r.extend(c,{source:w})),this._validate(r.validateLayer,`layers.${w}`,c,{arrayIndex:-1},y))return;B=r.createStyleLayer(c),this._validateLayer(B),B.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[B.id]=B.serialize(),this._updateLayerCount(B,!0)}const R=f?this._order.indexOf(f):this._order.length;if(f&&R===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(R,0,w),this._layerOrderChanged=!0,this._layers[w]=B;const L=this._getLayerSourceCache(B);if(this._removedLayers[w]&&B.source&&L&&B.type!=="custom"){const U=this._removedLayers[w];delete this._removedLayers[w],U.type!==B.type?this._updatedSources[B.source]="clear":(this._updatedSources[B.source]="reload",L.pause())}this._updateLayer(B),B.onAdd&&B.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,f){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===f)return;const y=this._order.indexOf(c);this._order.splice(y,1);const w=f?this._order.indexOf(f):this._order.length;f&&w===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(w,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const f=this._layers[c];if(!f)return void this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const y=this._order.indexOf(c);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=f,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const f in this._layers)if(this._layers[f].type===c)return!0;return!1}setLayerZoomRange(c,f,y){this._checkLoaded();const w=this.getLayer(c);w?w.minzoom===f&&w.maxzoom===y||(f!=null&&(w.minzoom=f),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,f,y={}){this._checkLoaded();const w=this.getLayer(c);if(w){if(!p(w.filter,f))return f==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(r.validateFilter,`layers.${w.id}.filter`,f,{layerType:w.type},y)||(w.filter=r.clone$1(f),this._updateLayer(w)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const f=this.getLayer(c);return f&&r.clone$1(f.filter)}setLayoutProperty(c,f,y,w={}){this._checkLoaded();const B=this.getLayer(c);B?p(B.getLayoutProperty(f),y)||(B.setLayoutProperty(f,y,w),this._updateLayer(B)):this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,f){const y=this.getLayer(c);if(y)return y.getLayoutProperty(f);this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,f,y,w={}){this._checkLoaded();const B=this.getLayer(c);B?p(B.getPaintProperty(f),y)||(B.setPaintProperty(f,y,w)&&this._updateLayer(B),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,f){const y=this.getLayer(c);return y&&y.getPaintProperty(f)}setFeatureState(c,f){this._checkLoaded();const y=c.source,w=c.sourceLayer,B=this.getSource(y);if(!B)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const R=B.type;if(R==="geojson"&&w)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!w)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));c.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const L=this._getSourceCaches(y);for(const U of L)U.setFeatureState(w,c.id,f)}removeFeatureState(c,f){this._checkLoaded();const y=c.source,w=this.getSource(y);if(!w)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const B=w.type,R=B==="vector"?c.sourceLayer:void 0;if(B==="vector"&&!R)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof c.id!="string"&&typeof c.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const L=this._getSourceCaches(y);for(const U of L)U.removeFeatureState(R,c.id,f)}getFeatureState(c){this._checkLoaded();const f=c.source,y=c.sourceLayer,w=this.getSource(f);if(w){if(w.type!=="vector"||y)return c.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(y,c.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();c[y.id]||(c[y.id]=y.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0;const f=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",f.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const f=R=>this._layers[R].type==="fill-extrusion",y={},w=[];for(let R=this._order.length-1;R>=0;R--){const L=this._order[R];if(f(L)){y[L]=R;for(const U of c){const j=U[L];if(j)for(const Y of j)w.push(Y)}}}w.sort((R,L)=>L.intersectionZ-R.intersectionZ);const B=[];for(let R=this._order.length-1;R>=0;R--){const L=this._order[R];if(f(L))for(let U=w.length-1;U>=0;U--){const j=w[U].feature;if(y[j.layer.id]<R)break;B.push(j),w.pop()}else for(const U of c){const j=U[L];if(j)for(const Y of j)B.push(Y.feature)}}return B}queryRenderedFeatures(c,f,y){f&&f.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const w={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of f.layers){const j=this._layers[U];if(!j)return this.fire(new r.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];w[j.source]=!0}}const B=[];f.availableImages=this._availableImages;const R=f&&f.layers?f.layers.some(U=>{const j=this.getLayer(U);return j&&j.is3D()}):this.has3DLayers(),L=Fe.createFromScreenPoints(c,y);for(const U in this._sourceCaches){const j=this._sourceCaches[U].getSource().id;f.layers&&!w[j]||B.push(pt(this._sourceCaches[U],this._layers,this._serializedLayers,L,f,y,R,!!this.map._showQueryGeometry))}return this.placement&&B.push(function(U,j,Y,ie,fe,xe,be){const we={},Se=xe.queryRenderedSymbols(ie),ne=[];for(const ve of Object.keys(Se).map(Number))ne.push(be[ve]);ne.sort(Ct);for(const ve of ne){const Pe=ve.featureIndex.lookupSymbolFeatures(Se[ve.bucketInstanceId],j,ve.bucketIndex,ve.sourceLayerIndex,fe.filter,fe.layers,fe.availableImages,U);for(const ke in Pe){const $e=we[ke]=we[ke]||[],tt=Pe[ke];tt.sort((et,ct)=>{const lt=ve.featureSortOrder;if(lt){const vt=lt.indexOf(et.featureIndex);return lt.indexOf(ct.featureIndex)-vt}return ct.featureIndex-et.featureIndex});for(const et of tt)$e.push(et)}}for(const ve in we)we[ve].forEach(Pe=>{const ke=Pe.feature,$e=Y(U[ve]);if(!$e)return;const tt=$e.getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=tt});return we}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),L.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(B)}querySourceFeatures(c,f){f&&f.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const y=this._getSourceCaches(c);let w=[];for(const B of y)w=w.concat(it(B,f));return w}addSourceType(c,f,y){return Ho.getSourceType(c)?y(new Error(`A source type called "${c}" already exists.`)):(Ho.setSourceType(c,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:f.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(c,f={}){this._checkLoaded();const y=this.light.getLight();let w=!1;for(const R in c)if(!p(c[R],y[R])){w=!0;break}if(!w)return;const B=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,f),this.light.updateTransitions(B)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,f=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=c;if(f===1){if(typeof y.source=="object"){const w="terrain-dem-src";this.addSource(w,y.source),y=r.clone$1(y),y=r.extend(y,{source:w})}if(this._validate(r.validateTerrain,"terrain",y))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,f)}else{const w=this.terrain,B=w.get();for(const R of Object.keys(r.spec.terrain))!y.hasOwnProperty(R)&&r.spec.terrain[R].default&&(y[R]=r.spec.terrain[R].default);for(const R in y)if(!p(y[R],B[R])){w.set(y),this.stylesheet.terrain=y;const L=this._setTransitionParameters({duration:0});w.updateTransitions(L);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const f=this.fog=new ht(c,this.map.transform);this.stylesheet.fog=c;const y=this._setTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,y=f.get();Object.keys(c).length===0&&f.set(c);for(const w in c)if(!p(c[w],y[w])){f.set(c),this.stylesheet.fog=c;const B=this._setTransitionParameters({duration:0});f.updateTransitions(B);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:r.exported.now(),transition:r.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(y=>this.isLayerDraped(this._layers[y])),f=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...f)}_createTerrain(c,f){const y=this.terrain=new Be(c,f);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});y.updateTransitions(w)}_force3DLayerUpdate(){for(const c in this._layers){const f=this._layers[c];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const f=this._layers[c];f.type==="symbol"&&this._updateLayer(f)}}_validate(c,f,y,w,B={}){return(!B||B.validate!==!1)&&ol(this,c.call(r.validateStyle,r.extend({key:f,style:this.serialize(),value:y,styleSpec:r.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const f=this._getSourceCaches(c);for(const y of f)y.clearTiles()}_reloadSource(c){const f=this._getSourceCaches(c);for(const y of f)y.resume(),y.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const f in this._sourceCaches)this._sourceCaches[f].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const f=this._sourceCaches[c];f.resume(),f.reload()}}_updatePlacement(c,f,y,w,B=!1){let R=!1,L=!1;const U={};for(const j of this._order){const Y=this._layers[j];if(Y.type!=="symbol")continue;if(!U[Y.source]){const fe=this._getLayerSourceCache(Y);if(!fe)continue;U[Y.source]=fe.getRenderableIds(!0).map(xe=>fe.getTileByID(xe)).sort((xe,be)=>be.tileID.overscaledZ-xe.tileID.overscaledZ||(xe.tileID.isLessThan(be.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(Y,U[Y.source],c.center.lng,c.projection);R=R||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),B=B||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),(B||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),c.zoom))&&(this.pauseablePlacement=new $A(c,this._order,B,f,y,w,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),L=!0),R&&this.pauseablePlacement.placement.setStale()),L||R)for(const j of this._order){const Y=this._layers[j];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,U[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,f,y){this.imageManager.getImages(f.icons,y),this._updateTilesForChangedImages();const w=B=>{B&&B.setDependencies(f.tileID.key,f.type,f.icons)};w(this._otherSourceCaches[f.source]),w(this._symbolSourceCaches[f.source])}getGlyphs(c,f,y){this.glyphManager.getGlyphs(f.stacks,y)}getResource(c,f,y){return r.makeRequest(f,y)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return c.type==="symbol"?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const f=[];return this._otherSourceCaches[c]&&f.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&f.push(this._symbolSourceCaches[c]),f}_isSourceCacheLoaded(c){const f=this._getSourceCaches(c);return f.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ho.getSourceType=function(m){return qt[m]},Ho.setSourceType=function(m,c){qt[m]=c},Ho.registerForPluginStateChange=r.registerForPluginStateChange;var ng=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ol="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",wa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Eh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ba=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let pf={},Wc={};const wh=[];Yc(ng,wh),Yc(wa,wh),Yc(Eh,wh),Yc(ba,wh),pf=gn("",wa),Wc=gn(ba,Eh);const w0=gn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Af=ng,rg=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var sg={background:gn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:gn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:gn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:gn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:gn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:gn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:gn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:gn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:gn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:gn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:gn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:gn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:gn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:gn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ol),skyboxGradient:gn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ol),skyboxCapture:gn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Yc(m,c){const f=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of f)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=y.split(" ");for(const B of w)c.includes(B)||c.push(B)}}function gn(m,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},B=[...wh];return Yc(m,B),Yc(c,B),{fragmentSource:m=m.replace(f,(R,L,U,j,Y)=>(w[Y]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${U} ${j} ${Y};
#else
uniform ${U} ${j} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${U} ${j} ${Y} = u_${Y};
#endif
`)),vertexSource:c=c.replace(f,(R,L,U,j,Y)=>{const ie=j==="float"?"vec2":"vec4",fe=Y.match(/color/)?"color":ie;return w[Y]?L==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${U} ${ie} a_${Y};
varying ${U} ${j} ${Y};
#else
uniform ${U} ${j} u_${Y};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${U} ${j} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${U} ${j} ${Y} = u_${Y};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${U} ${ie} a_${Y};
#else
uniform ${U} ${j} u_${Y};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${U} ${j} ${Y} = a_${Y};
#else
    ${U} ${j} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${U} ${j} ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${U} ${j} ${Y} = u_${Y};
#endif
`}),staticAttributes:y,usedDefines:B}}class N1{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,f,y,w,B,R,L){this.context=c;let U=this.boundPaintVertexBuffers.length!==w.length;for(let Y=0;!U&&Y<w.length;Y++)this.boundPaintVertexBuffers[Y]!==w[Y]&&(U=!0);let j=this.boundDynamicVertexBuffers.length!==L.length;for(let Y=0;!j&&Y<L.length;Y++)this.boundDynamicVertexBuffers[Y]!==L[Y]&&(j=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||U||j||this.boundIndexBuffer!==B||this.boundVertexOffset!==R)this.freshBind(f,y,w,B,R,L);else{c.bindVertexArrayOES.set(this.vao);for(const Y of L)Y&&Y.bind();B&&B.dynamicDraw&&B.bind()}}freshBind(c,f,y,w,B,R){let L;const U=c.numAttributes,j=this.context,Y=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),L=0,this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=B,this.boundDynamicVertexBuffers=R;else{L=j.currentNumAttributes||0;for(let ie=U;ie<L;ie++)Y.disableVertexAttribArray(ie)}f.enableAttributes(Y,c),f.bind(),f.setVertexAttribPointers(Y,c,B);for(const ie of y)ie.enableAttributes(Y,c),ie.bind(),ie.setVertexAttribPointers(Y,c,B);for(const ie of R)ie&&(ie.enableAttributes(Y,c),ie.bind(),ie.setVertexAttribPointers(Y,c,B));w&&w.bind(),j.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function og(m,c){const f=Math.pow(2,c.canonical.z),y=c.canonical.y;return[new r.MercatorCoordinate(0,y/f).toLngLat().lat,new r.MercatorCoordinate(0,(y+1)/f).toLngLat().lat]}function b0(m,c,f,y,w,B,R){const L=m.context,U=L.gl,j=f.fbo;if(!j)return;m.prepareDrawTile();const Y=m.useProgram("hillshade");L.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,j.colorAttachment.get());const ie=((we,Se,ne,ve)=>{const Pe=ne.paint.get("hillshade-shadow-color"),ke=ne.paint.get("hillshade-highlight-color"),$e=ne.paint.get("hillshade-accent-color");let tt=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);ne.paint.get("hillshade-illumination-anchor")==="viewport"&&(tt-=we.transform.angle);const et=!we.options.moving;return{u_matrix:ve||we.transform.calculateProjMatrix(Se.tileID.toUnwrapped(),et),u_image:0,u_latrange:og(0,Se.tileID),u_light:[ne.paint.get("hillshade-exaggeration"),tt],u_shadow:Pe,u_highlight:ke,u_accent:$e}})(m,f,y,m.terrain?c.projMatrix:null);m.prepareDrawProgram(L,Y,c.toUnwrapped());const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:xe,tileBoundsSegments:be}=m.getTileBoundsBuffers(f);Y.draw(L,U.TRIANGLES,w,B,R,r.CullFaceMode.disabled,ie,y.id,fe,xe,be)}function ag(m,c,f){if(!c.needsDEMTextureUpload)return;const y=m.context,w=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||m.getTileTexture(f.stride);const B=f.getPixels();c.demTexture?c.demTexture.update(B,{premultiply:!1}):c.demTexture=new r.Texture(y,B,w.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function B0(m,c,f,y,w,B){const R=m.context,L=R.gl;if(!c.dem)return;const U=c.dem;if(R.activeTexture.set(L.TEXTURE1),ag(m,c,U),!c.demTexture)return;c.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);const j=U.dim;R.activeTexture.set(L.TEXTURE0);let Y=c.fbo;if(!Y){const be=new r.Texture(R,{width:j,height:j,data:null},L.RGBA);be.bind(L.LINEAR,L.CLAMP_TO_EDGE),Y=c.fbo=R.createFramebuffer(j,j,!0),Y.colorAttachment.set(be.texture)}R.bindFramebuffer.set(Y.framebuffer),R.viewport.set([0,0,j,j]);const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:fe,tileBoundsSegments:xe}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(R,L.TRIANGLES,y,w,B,r.CullFaceMode.disabled,((be,we)=>{const Se=we.stride,ne=r.create();return r.ortho(ne,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(ne,ne,[0,-r.EXTENT,0]),{u_matrix:ne,u_image:1,u_dimension:[Se,Se],u_zoom:be.overscaledZ,u_unpack:we.unpackVector}})(c.tileID,U),f.id,ie,fe,xe),c.needsHillshadePrepare=!1}const lg=m=>({u_matrix:new r.UniformMatrix4f(m),u_image0:new r.Uniform1i(m),u_skirt_height:new r.Uniform1f(m)}),jc=(m,c)=>({u_matrix:m,u_image0:0,u_skirt_height:c}),gf=(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:w,u_merc_center:B,u_image0:0,u_frustum_tl:R,u_frustum_tr:L,u_frustum_br:U,u_frustum_bl:j,u_globe_pos:Y,u_globe_radius:ie,u_viewport:fe,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9),u_skirt_height:xe});function qc(m,c){return m!=null&&c!=null&&!(!m.hasData()||!c.hasData())&&m.demTexture!=null&&c.demTexture!=null&&m.tileID.key!==c.tileID.key}const Ba=new class{constructor(){this.operations={}}newMorphing(m,c,f,y,w){if(m in this.operations){const B=this.operations[m];B.to.tileID.key!==f.tileID.key&&(B.queued=f)}else this.operations[m]={startTime:y,phase:0,duration:w,from:c,to:f,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const c=this.operations[m];return{from:c.from,to:c.to,phase:c.phase}}update(m){for(const c in this.operations){const f=this.operations[c];for(f.phase=(m-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,m)){delete this.operations[c];break}}}_nextOp(m,c){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=c,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Gl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function mf(m){return 6*Math.pow(1.5,22-m)}function S0(m,c){const f=1<<m.z;return!c&&(m.x===0||m.x===f-1)||m.y===0||m.y===f-1}const bh=m=>({u_matrix:m});function cg(m,c,f,y,w){if(w>0){const B=r.exported.now(),R=(B-m.timeAdded)/w,L=c?(B-c.timeAdded)/w:-1,U=f.getSource(),j=y.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),Y=!c||Math.abs(c.tileID.overscaledZ-j)>Math.abs(m.tileID.overscaledZ-j),ie=Y&&m.refreshedUponExpiration?1:r.clamp(Y?R:1-L,0,1);return m.refreshedUponExpiration&&R>=1&&(m.refreshedUponExpiration=!1),c?{opacity:1,mix:1-ie}:{opacity:ie,mix:0}}return{opacity:1,mix:0}}class ug extends r.SourceCache{constructor(c){const f={type:"raster-dem",maxzoom:c.transform.maxZoom},y=new oe(zi(),null),w=pe("mock-dem",f,y,c.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,f){c.state="loaded",f(null)}}class _f extends r.SourceCache{constructor(c){const f=pe("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new oe(zi(),null),c.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,f,y){if(c.freezeTileCoverage)return;this.transform=c;const w=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((B,R)=>{if(B[R.key]="",!this._tiles[R.key]){const L=new r.Tile(R,this._source.tileSize*R.overscaleFactor(),c.tileZoom);L.state="loaded",this._tiles[R.key]=L}return B},{});for(const B in this._tiles)B in w||(this.freeFBO(B),this._tiles[B].unloadVectorData(),delete this._tiles[B])}freeFBO(c){const f=this.proxyCachedFBO[c];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class yf extends r.OverscaledTileID{constructor(c,f,y){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class hg extends r.Elevation{constructor(c,f){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,w,B]=function(U){const j=new r.StructArrayLayout2i4,Y=new r.StructArrayLayout3ui6,ie=131;j.reserve(17161),Y.reserve(33800);const fe=r.EXTENT/128,xe=r.EXTENT+fe/2,be=xe+fe;for(let Se=-fe;Se<be;Se+=fe)for(let ne=-fe;ne<be;ne+=fe){const ve=ne<0||ne>xe||Se<0||Se>xe?24575:0,Pe=r.clamp(Math.round(ne),0,r.EXTENT),ke=r.clamp(Math.round(Se),0,r.EXTENT);j.emplaceBack(Pe+ve,ke)}const we=(Se,ne)=>{const ve=ne*ie+Se;Y.emplaceBack(ve+1,ve,ve+ie),Y.emplaceBack(ve+ie,ve+ie+1,ve+1)};for(let Se=1;Se<129;Se++)for(let ne=1;ne<129;ne++)we(ne,Se);return[0,129].forEach(Se=>{for(let ne=0;ne<130;ne++)we(ne,Se),we(Se,ne)}),[j,Y,32768]}(),R=c.context;this.gridBuffer=R.createVertexBuffer(y,r.posAttributes.members),this.gridIndexBuffer=R.createIndexBuffer(w),this.gridSegments=r.SegmentVector.simpleSegment(0,0,y.length,w.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,y.length,B),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new _f(f.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.EXTENT,0,r.EXTENT,0,1);const L=R.gl;this._overlapStencilMode=new r.StencilMode({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ug(f.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,f,y){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const w=c.terrain.properties;this.sourceCache=c.terrain.drapeRenderMode===0?this._mockSourceCache:c._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const B=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(f,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,B(),this._initializing=!0),B(),f.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||c.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&c.dataType==="source"?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):c.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=f.getIds().map(U=>{const j=f.getTileByID(U).tileID;return j.projMatrix=y.calculateProjMatrix(j.toUnwrapped()),j});(function(U,j){const Y=j.transform.pointCoordinate(j.transform.getCameraPoint()),ie=new r.Point(Y.x,Y.y);U.sort((fe,xe)=>{if(xe.overscaledZ-fe.overscaledZ)return xe.overscaledZ-fe.overscaledZ;const be=new r.Point(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),we=new r.Point(xe.canonical.x+(1<<xe.canonical.z)*xe.wrap,xe.canonical.y),Se=ie.mult(1<<fe.canonical.z);return Se.x-=.5,Se.y-=.5,Se.distSqr(be)-Se.distSqr(we)})})(w,this.painter),this._previousZoom=y.zoom;const B=this.proxyToSource||{};this.proxyToSource={},w.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const U in R){const j=R[U];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,c[U],B),j.usedForTerrain))continue;const Y=c[U];j.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[f.id]=w.map(U=>new yf(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(B),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const L={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const j=this.terrainTileForTile[U.key];if(!j)continue;const Y=j.tileID.key;Y in L||(this._visibleDemTiles.push(j),L[Y]=Y)}}_assignTerrainTiles(c){this._initializing||c.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const c=this.painter.context,f=c.gl;for(const y in this.terrainTileForTile){const w=this.terrainTileForTile[y],B=w.dem;!B||w.demTexture&&!w.needsDEMTextureUpload||(c.activeTexture.set(f.TEXTURE1),ag(this.painter,w,B))}}_prepareDemTileUniforms(c,f,y,w){if(!f||f.demTexture==null)return!1;const B=c.tileID.canonical,R=Math.pow(2,f.tileID.canonical.z-B.z),L=w||"";return y[`u_dem_tl${L}`]=[B.x*R%1,B.y*R%1],y[`u_dem_scale${L}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,f=c.gl;if(!this._emptyDepthBufferTexture){const y=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(c,y,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const f=this._visibleDemTiles.reduce((y,w)=>{if(!w.dem)return y;const B=w.dem.tree.minimums[0];return B>0&&c++,y+B},0);return c?f/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,f=c.gl;c.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),w=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let B=this._emptyDEMTexture;return B?B.update(w,{premultiply:!1}):B=this._emptyDEMTexture=new r.Texture(c,w,f.RGBA,{premultiply:!1}),B}setupElevationDraw(c,f,y){const w=this.painter.context,B=w.gl,R=(L=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(L),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var L;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let U=null,j=null,Y=1;if(y&&y.morphing&&this._useVertexMorphing){const ie=y.morphing.srcDemTile,fe=y.morphing.dstDemTile;Y=y.morphing.phase,ie&&fe&&(this._prepareDemTileUniforms(c,ie,R,"_prev")&&(j=ie),this._prepareDemTileUniforms(c,fe,R)&&(U=fe))}if(j&&U?(w.activeTexture.set(B.TEXTURE2),U.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE,B.NEAREST),w.activeTexture.set(B.TEXTURE4),j.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE,B.NEAREST),R.u_dem_lerp=Y):(U=this.terrainTileForTile[c.tileID.key],w.activeTexture.set(B.TEXTURE2),(this._prepareDemTileUniforms(c,U,R)?U.demTexture:this.emptyDEMTexture).bind(B.NEAREST,B.CLAMP_TO_EDGE)),w.activeTexture.set(B.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&U){const ie=(1<<U.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=ie}if(y&&y.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(w,R),this.painter.transform.projection.name==="globe"){const ie=this.globeUniformValues(this.painter.transform,c.tileID.canonical,y&&y.useDenormalizedUpVectorScale);f.setGlobeUniformValues(w,ie)}}globeUniformValues(c,f,y){const w=c.projection;return{u_tile_tl_up:w.upVector(f,0,0),u_tile_tr_up:w.upVector(f,r.EXTENT,0),u_tile_br_up:w.upVector(f,r.EXTENT,r.EXTENT),u_tile_bl_up:w.upVector(f,0,r.EXTENT),u_tile_up_scale:y?r.globeMetersToEcef(1):w.upVectorScale(f,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const f=this.painter,y=this.painter.context;c.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,B,R,L,U){if(w.transform.projection.name==="globe")(function(j,Y,ie,fe,xe){const be=j.context,we=be.gl;let Se,ne;const ve=j.options.showTerrainWireframe?2:0,Pe=j.transform,ke=r.globeUseCustomAntiAliasing(j,be,Pe),$e=(Jt,_t)=>{if(ne===Jt)return;const Nt=[Gl[Jt],"PROJECTION_GLOBE_VIEW"];ke&&Nt.push("CUSTOM_ANTIALIASING"),_t&&Nt.push(Gl[ve]),Se=j.useProgram("globeRaster",null,Nt),ne=Jt},tt=j.colorModeForRenderPass(),et=new r.DepthMode(we.LEQUAL,r.DepthMode.ReadWrite,j.depthRangeFor3D);Ba.update(xe);const ct=r.calculateGlobeMercatorMatrix(Pe),lt=[r.mercatorXfromLng(Pe.center.lng),r.mercatorYfromLat(Pe.center.lat)],vt=ve?[!1,!0]:[!1],Zt=j.globeSharedBuffers,At=[Pe.width*r.exported.devicePixelRatio,Pe.height*r.exported.devicePixelRatio],zt=Float32Array.from(Pe.globeMatrix),bt={useDenormalizedUpVectorScale:!0};if(vt.forEach(Jt=>{const _t=j.transform,Nt=mf(_t.zoom)*Y.exaggeration();ne=-1;const ei=Jt?we.LINES:we.TRIANGLES;for(const jt of fe){const ti=ie.getTile(jt),bi=r.StencilMode.disabled,Ni=Y.prevTerrainTileForTile[jt.key],Ii=Y.terrainTileForTile[jt.key];qc(Ni,Ii)&&Ba.newMorphing(jt.key,Ni,Ii,xe,250),be.activeTexture.set(we.TEXTURE0),ti.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE);const Ti=Ba.getMorphValuesForProxy(jt.key),en=Ti?1:0;Ti&&r.extend$1(bt,{morphing:{srcDemTile:Ti.from,dstDemTile:Ti.to,phase:r.easeCubicInOut(Ti.phase)}});const Ji=r.tileCornersToBounds(jt.canonical),wi=r.getLatitudinalLod(Ji.getCenter().lat),yn=r.getGridMatrix(jt.canonical,Ji,wi,_t.worldSize/_t._pixelsPerMercatorPixel),Sn=r.globeNormalizeECEF(r.globeTileBounds(jt.canonical)),Mn=gf(_t.projMatrix,zt,ct,Sn,r.globeToMercatorTransition(_t.zoom),lt,_t.frustumCorners.TL,_t.frustumCorners.TR,_t.frustumCorners.BR,_t.frustumCorners.BL,_t.globeCenterInViewSpace,_t.globeRadius,At,Nt,yn);if($e(en,Jt),Y.setupElevationDraw(ti,Se,bt),j.prepareDrawProgram(be,Se,jt.toUnwrapped()),Zt){const[Tn,ss,Fr]=Jt?Zt.getWirefameBuffers(j.context,wi):Zt.getGridBuffers(wi,Nt!==0);Se.draw(be,ei,et,bi,tt,r.CullFaceMode.backCCW,Mn,"globe_raster",Tn,ss,Fr)}}}),Zt){const Jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ke&&Jt.push("CUSTOM_ANTIALIASING"),Se=j.useProgram("globeRaster",null,Jt);for(const _t of fe){const{x:Nt,y:ei,z:jt}=_t.canonical,ti=ei===0,bi=ei===(1<<jt)-1,[Ni,Ii,Ti,en]=Zt.getPoleBuffers(jt);if(en&&(ti||bi)){const Ji=ie.getTile(_t);be.activeTexture.set(we.TEXTURE0),Ji.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE);let wi=r.globePoleMatrixForTile(jt,Nt,Pe);const yn=r.globeNormalizeECEF(r.globeTileBounds(_t.canonical)),Sn=(Mn,Tn)=>Mn.draw(be,we.TRIANGLES,et,r.StencilMode.disabled,tt,r.CullFaceMode.disabled,gf(Pe.projMatrix,wi,wi,yn,0,lt,Pe.frustumCorners.TL,Pe.frustumCorners.TR,Pe.frustumCorners.BR,Pe.frustumCorners.BL,Pe.globeCenterInViewSpace,Pe.globeRadius,At,0),"globe_pole_raster",Tn,Ti,en);Y.setupElevationDraw(Ji,Se,bt),j.prepareDrawProgram(be,Se,_t.toUnwrapped()),ti&&Sn(Se,Ni),bi&&(wi=r.scale(r.create(),wi,[1,-1,1]),Sn(Se,Ii))}}}})(w,B,R,L,U);else{const j=w.context,Y=j.gl;let ie,fe;const xe=w.options.showTerrainWireframe?2:0,be=(Pe,ke)=>{if(fe===Pe)return;const $e=[Gl[Pe]];ke&&$e.push(Gl[xe]),ie=w.useProgram("terrainRaster",null,$e),fe=Pe},we=w.colorModeForRenderPass(),Se=new r.DepthMode(Y.LEQUAL,r.DepthMode.ReadWrite,w.depthRangeFor3D);Ba.update(U);const ne=w.transform,ve=mf(ne.zoom)*B.exaggeration();(xe?[!1,!0]:[!1]).forEach(Pe=>{fe=-1;const ke=Pe?Y.LINES:Y.TRIANGLES,[$e,tt]=Pe?B.getWirefameBuffer():[B.gridIndexBuffer,B.gridSegments];for(const et of L){const ct=R.getTile(et),lt=r.StencilMode.disabled,vt=B.prevTerrainTileForTile[et.key],Zt=B.terrainTileForTile[et.key];qc(vt,Zt)&&Ba.newMorphing(et.key,vt,Zt,U,250),j.activeTexture.set(Y.TEXTURE0),ct.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST);const At=Ba.getMorphValuesForProxy(et.key),zt=At?1:0;let bt;At&&(bt={morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:r.easeCubicInOut(At.phase)}});const Jt=jc(et.projMatrix,S0(et.canonical,ne.renderWorldCopies)?ve/10:ve);be(zt,Pe),B.setupElevationDraw(ct,ie,bt),w.prepareDrawProgram(j,ie,et.toUnwrapped()),ie.draw(j,ke,Se,lt,we,r.CullFaceMode.backCCW,Jt,"terrain_raster",B.gridBuffer,$e,tt)}})}}(f,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(this._drapedRenderBatches.length===0)return c+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,w=this.proxySourceCache,B=this.proxiedCoords[w.id],R=this._drapedRenderBatches.shift(),L=[],U=f.style.order;let j=0;for(const Y of B){const ie=w.getTileByID(Y.proxyTileKey),fe=w.proxyCachedFBO[Y.key]?w.proxyCachedFBO[Y.key][c]:void 0,xe=fe!==void 0?w.renderCache[fe]:this.pool[j++],be=fe!==void 0;if(ie.texture=xe.tex,be&&!xe.dirty){L.push(ie.tileID);continue}let we;y.bindFramebuffer.set(xe.fb.framebuffer),this.renderedToTile=!1,xe.dirty&&(y.clear({color:r.Color.transparent,stencil:0}),xe.dirty=!1);for(let Se=R.start;Se<=R.end;++Se){const ne=f.style._layers[U[Se]];if(ne.isHidden(f.transform.zoom))continue;const ve=f.style._getLayerSourceCache(ne),Pe=ve?this.proxyToSource[Y.key][ve.id]:[Y];if(!Pe)continue;const ke=Pe;y.viewport.set([0,0,xe.fb.width,xe.fb.height]),we!==(ve?ve.id:null)&&(this._setupStencil(xe,Pe,ne,ve),we=ve?ve.id:null),f.renderLayer(f,ve,ne,ke)}this.renderedToTile?(xe.dirty=!0,L.push(ie.tileID)):be||--j,j===5&&(j=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),R.end+1}postRender(){}renderCacheEfficiency(c){const f=c.order.length;if(f===0)return{efficiency:100};let y,w=0,B=0,R=!1;for(let L=0;L<f;++L){const U=c._layers[c.order[L]];this._style.isLayerDraped(U)?(R&&++w,++B):R||(R=!0,y=U.id)}return B===0?{efficiency:100}:{efficiency:100*(1-w/B),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{c=Math.min(c,f.dem.tree.minimums[0])}),c===0?c:(c-30)*this._exaggeration}raycast(c,f,y){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(B=>B.dem).map(B=>{const R=B.tileID,L=1<<R.overscaledZ,{x:U,y:j}=R.canonical,Y=U/L,ie=(U+1)/L,fe=j/L,xe=(j+1)/L;return{minx:Y,miny:fe,maxx:ie,maxy:xe,t:B.dem.tree.raycastRoot(Y,fe,ie,xe,c,f,y),tile:B}});w.sort((B,R)=>(B.t!==null?B.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE));for(const B of w){if(B.t==null)return null;const R=B.tile.dem.tree.raycast(B.minx,B.miny,B.maxx,B.maxy,c,f,y);if(R!=null)return R}return null}_createFBO(){const c=this.painter.context,f=c.gl,y=this.drapeBufferSize;c.activeTexture.set(f.TEXTURE0);const w=new r.Texture(c,{width:y[0],height:y[1],data:null},f.RGBA);w.bind(f.LINEAR,f.CLAMP_TO_EDGE);const B=c.createFramebuffer(y[0],y[1],!1);return B.colorAttachment.set(w.texture),B.depthAttachment=new me(c,B.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,B.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):B.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:B,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const f=this._style._layers[c],y=f.isHidden(this.painter.transform.zoom);return f.type==="custom"?!y&&f.shouldRedrape():!y&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const y of this._style._getSources())if(y instanceof Je){c=!0;break}if(!c)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._layers[this._style.order[y]],B=this._style._getLayerSourceCache(w);if(B&&!f[B.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof r.ZoomDependentExpression){f[B.id]=!0;for(const R of this.proxyCoords){const L=this.proxyToSource[R.key][B.id];if(L)for(const U of L)this._clearRenderCacheForTile(B.id,U)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof Xe){c=!0;break}if(!c)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._layers[this._style.order[y]],B=this._style._getLayerSourceCache(w);if(!B||f[B.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const R=w.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const U=this.proxyToSource[L.key][B.id];if(U)for(const j of U){const Y=cg(B.getTile(j),B.findLoadedParent(j,0),B,this.painter.transform,R);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(B.id,j)}}}}_setupDrapedRenderBatches(){const c=this._style.order,f=c.length;if(f===0)return;const y=[];let w,B=0,R=this._style._layers[c[B]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++B<f;)R=this._style._layers[c[B]];for(;B<f;++B){const L=this._style._layers[c[B]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?w===void 0&&(w=B):w!==void 0&&(y.push({start:w,end:B-1}),w=void 0))}w!==void 0&&y.push({start:w,end:B-1}),this._drapedRenderBatches=y}_setupRenderCache(c){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const R=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let L=0;L<R.length;++L){const U=Object.values(R[L]);f.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,w=this._tilesDirty;for(let R=y.length-1;R>=0;R--){const L=y[R];if(f.getTileByID(L.key),f.proxyCachedFBO[L.key]!==void 0){const U=c[L.key],j=this.proxyToSource[L.key];let Y=0;for(const ie in j){const fe=j[ie],xe=U[ie];if(!xe||xe.length!==fe.length||fe.some((be,we)=>be!==xe[we]||w[ie]&&w[ie].hasOwnProperty(be.key))){Y=-1;break}++Y}for(const ie in f.proxyCachedFBO[L.key])f.renderCache[f.proxyCachedFBO[L.key][ie]].dirty=Y<0||Y!==Object.values(U).length}}const B=[...this._drapedRenderBatches];B.sort((R,L)=>L.end-L.start-(R.end-R.start));for(const R of B)for(const L of y){if(f.proxyCachedFBO[L.key])continue;let U=f.renderCachePool.pop();U===void 0&&f.renderCache.length<50&&(U=f.renderCache.length,f.renderCache.push(this._createFBO())),U!==void 0&&(f.proxyCachedFBO[L.key]={},f.proxyCachedFBO[L.key][R.start]=U,f.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(c,f,y,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const B=this.painter.context,R=B.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let L;if(y.isTileClipped())L=f.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(B.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(c,f){const y=this.painter,w=this.painter.context,B=w.gl;y._tileClippingMaskIDs={},w.setColorMode(r.ColorMode.disabled),w.setDepthMode(r.DepthMode.disabled);const R=y.useProgram("clippingMask");for(const L of c){const U=y._tileClippingMaskIDs[L.key]=--f;R.draw(w,B.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:B.ALWAYS,mask:0},U,255,B.KEEP,B.KEEP,B.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,bh(L.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(c){const f=this.painter.transform;if(c.x<0||c.x>f.width||c.y<0||c.y>f.height)return null;const y=[c.x,c.y,1,1];r.transformMat4$1(y,y,f.pixelMatrixInverse),r.scale$1(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const w=f._camera.position,B=r.mercatorZfromAltitude(1,f.center.lat),R=[w[0],w[1],w[2]/B,0],L=r.subtract([],y.slice(0,3),R);r.normalize(L,L);const U=this.raycast(R,L,this._exaggeration);return U!==null&&U?(r.scaleAndAdd(R,R,L,U),R[3]=R[2],R[2]*=B,R):null}drawDepth(){const c=this.painter,f=c.context,y=this.proxySourceCache,w=Math.ceil(c.width),B=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===B||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=f.gl,L=f.createFramebuffer(w,B,!0);f.activeTexture.set(R.TEXTURE0);const U=new r.Texture(f,{width:w,height:B,data:null},R.RGBA);U.bind(R.NEAREST,R.CLAMP_TO_EDGE),L.colorAttachment.set(U.texture);const j=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,w,B);L.depthAttachment.set(j),this._depthFBO=L,this._depthTexture=U}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,w,B]),function(R,L,U,j){if(R.transform.projection.name==="globe")return;const Y=R.context,ie=Y.gl;Y.clear({depth:1});const fe=R.useProgram("terrainDepth"),xe=new r.DepthMode(ie.LESS,r.DepthMode.ReadWrite,R.depthRangeFor3D);for(const be of j){const we=U.getTile(be),Se=jc(be.projMatrix,0);L.setupElevationDraw(we,fe),fe.draw(Y,ie.TRIANGLES,xe,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,Se,"terrain_depth",L.gridBuffer,L.gridIndexBuffer,L.gridNoSkirtSegments)}}(c,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,f,y){if(c.getSource()instanceof Wt)return this._setupProxiedCoordsForImageSource(c,f,y);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const w=this.proxiedCoords[c.id]=[],B=this.proxyCoords;for(let L=0;L<B.length;L++){const U=B[L],j=this._findTileCoveringTileID(U,c);if(j){const Y=this._createProxiedId(U,j,y[U.key]&&y[U.key][c.id]);w.push(Y),this.proxyToSource[U.key][c.id]=[Y]}}let R=!1;for(let L=0;L<f.length;L++){const U=c.getTile(f[L]);if(!U||!U.hasData())continue;const j=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==U.tileID.canonical.z){const Y=this.proxyToSource[j.tileID.key][c.id],ie=this._createProxiedId(j.tileID,U,y[j.tileID.key]&&y[j.tileID.key][c.id]);Y?Y.splice(Y.length-1,0,ie):this.proxyToSource[j.tileID.key][c.id]=[ie],w.push(ie),R=!0}}this._sourceTilesOverlap[c.id]=R}_setupProxiedCoordsForImageSource(c,f,y){if(!c.getSource().loaded())return;const w=this.proxiedCoords[c.id]=[],B=this.proxyCoords,R=c.getSource(),L=new r.Point(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),U=R.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce((Y,ie)=>(Y.min.x=Math.min(Y.min.x,ie.x-L.x),Y.min.y=Math.min(Y.min.y,ie.y-L.y),Y.max.x=Math.max(Y.max.x,ie.x-L.x),Y.max.y=Math.max(Y.max.y,ie.y-L.y),Y),{min:new r.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(Y,ie)=>{const fe=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),xe=Y.canonical.y/(1<<Y.canonical.z),be=r.EXTENT/(1<<Y.canonical.z),we=ie.wrap+ie.canonical.x/(1<<ie.canonical.z),Se=ie.canonical.y/(1<<ie.canonical.z);return fe+be<we+U.min.x||fe>we+U.max.x||xe+be<Se+U.min.y||xe>Se+U.max.y};for(let Y=0;Y<B.length;Y++){const ie=B[Y];for(let fe=0;fe<f.length;fe++){const xe=c.getTile(f[fe]);if(!xe||!xe.hasData()||j(ie,xe.tileID))continue;const be=this._createProxiedId(ie,xe,y[ie.key]&&y[ie.key][c.id]),we=this.proxyToSource[ie.key][c.id];we?we.push(be):this.proxyToSource[ie.key][c.id]=[be],w.push(be)}}}_createProxiedId(c,f,y){let w=this.orthoMatrix;if(y){const B=y.find(R=>R.key===f.tileID.key);if(B)return B}if(f.tileID.key!==c.key){const B=c.canonical.z-f.tileID.canonical.z;let R,L,U;w=r.create();const j=f.tileID.wrap-c.wrap<<c.overscaledZ;B>0?(R=r.EXTENT>>B,L=R*((f.tileID.canonical.x<<B)-c.canonical.x+j),U=R*((f.tileID.canonical.y<<B)-c.canonical.y)):(R=r.EXTENT<<-B,L=r.EXTENT*(f.tileID.canonical.x-(c.canonical.x+j<<-B)),U=r.EXTENT*(f.tileID.canonical.y-(c.canonical.y<<-B))),r.ortho(w,0,R,0,R,0,1),r.translate(w,w,[L,U,0])}return new yf(f.tileID,c.key,w)}_findTileCoveringTileID(c,f){let y=f.getTile(c);if(y&&y.hasData())return y;const w=this._findCoveringTileCache[f.id],B=w[c.key];if(y=B?f.getTileByID(B):null,y&&y.hasData()||B===null)return y;let R=y?y.tileID:c,L=R.overscaledZ;const U=f.getSource().minzoom,j=[];if(!B){const ie=f.getSource().maxzoom;if(c.canonical.z>=ie){const fe=c.canonical.z-ie;f.getSource().reparseOverscaled?(L=Math.max(c.canonical.z+2,f.transform.tileZoom),R=new r.OverscaledTileID(L,c.wrap,ie,c.canonical.x>>fe,c.canonical.y>>fe)):fe!==0&&(L=ie,R=new r.OverscaledTileID(L,c.wrap,ie,c.canonical.x>>fe,c.canonical.y>>fe))}R.key!==c.key&&(j.push(R.key),y=f.getTile(R))}const Y=ie=>{j.forEach(fe=>{w[fe]=ie}),j.length=0};for(L-=1;L>=U&&(!y||!y.hasData());L--){y&&Y(y.tileID.key);const ie=R.calculateScaledKey(L);if(y=f.getTileByID(ie),y&&y.hasData())break;const fe=w[ie];if(fe===null)break;fe===void 0?j.push(ie):y=f.getTileByID(fe)}return Y(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,f){let y=this._tilesDirty[c];y||(y=this._tilesDirty[c]={}),y[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(f){let y=0;const w=new r.StructArrayLayout2ui4,B=131;for(let R=1;R<129;R++){for(let L=1;L<129;L++)y=R*B+L,w.emplaceBack(y,y+1),w.emplaceBack(y,y+B),w.emplaceBack(y+1,y+B),R===128&&w.emplaceBack(y+B,y+B+1);w.emplaceBack(y+1,y+1+B)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class an{static cacheKey(c,f,y,w){let B=`${f}${w?w.cacheKey:""}`;for(const R of y)c.usedDefines.includes(R)&&(B+=`/${R}`);return B}constructor(c,f,y,w,B,R){const L=c.gl;this.program=L.createProgram();const U=function(ne){const ve=[];for(let Pe=0;Pe<ne.length;Pe++){if(ne[Pe]===null)continue;const ke=ne[Pe].split(" ");ve.push(ke.pop())}return ve}(y.staticAttributes),j=w?w.getBinderAttributes():[],Y=U.concat(j);let ie=w?w.defines():[];ie=ie.concat(R.map(ne=>`#define ${ne}`));const fe=c.isWebGL2?`#version 300 es
`:"",xe=fe+ie.concat(c.extStandardDerivatives&&fe.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(rg):rg,rg,Af,w0.fragmentSource,Wc.fragmentSource,y.fragmentSource).join(`
`),be=fe+ie.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Af,w0.vertexSource,Wc.vertexSource,pf.vertexSource,y.vertexSource).join(`
`),we=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(we,xe),L.compileShader(we),L.attachShader(this.program,we);const Se=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(Se,be),L.compileShader(Se),L.attachShader(this.program,Se),this.attributes={},this.numAttributes=Y.length;for(let ne=0;ne<this.numAttributes;ne++)Y[ne]&&(L.bindAttribLocation(this.program,ne,Y[ne]),this.attributes[Y[ne]]=ne);L.linkProgram(this.program),L.deleteShader(Se),L.deleteShader(we),this.fixedUniforms=B(c),this.binderUniforms=w?w.getUniforms(c):[],R.includes("TERRAIN")&&(this.terrainUniforms=(ne=>({u_dem:new r.Uniform1i(ne),u_dem_prev:new r.Uniform1i(ne),u_dem_unpack:new r.Uniform4f(ne),u_dem_tl:new r.Uniform2f(ne),u_dem_scale:new r.Uniform1f(ne),u_dem_tl_prev:new r.Uniform2f(ne),u_dem_scale_prev:new r.Uniform1f(ne),u_dem_size:new r.Uniform1f(ne),u_dem_lerp:new r.Uniform1f(ne),u_exaggeration:new r.Uniform1f(ne),u_depth:new r.Uniform1i(ne),u_depth_size_inv:new r.Uniform2f(ne),u_meter_to_dem:new r.Uniform1f(ne),u_label_plane_matrix_inv:new r.UniformMatrix4f(ne)}))(c)),R.includes("GLOBE")&&(this.globeUniforms=(ne=>({u_tile_tl_up:new r.Uniform3f(ne),u_tile_tr_up:new r.Uniform3f(ne),u_tile_br_up:new r.Uniform3f(ne),u_tile_bl_up:new r.Uniform3f(ne),u_tile_up_scale:new r.Uniform1f(ne)}))(c)),R.includes("FOG")&&(this.fogUniforms=(ne=>({u_fog_matrix:new r.UniformMatrix4f(ne),u_fog_range:new r.Uniform2f(ne),u_fog_color:new r.Uniform4f(ne),u_fog_horizon_blend:new r.Uniform1f(ne),u_fog_temporal_offset:new r.Uniform1f(ne),u_frustum_tl:new r.Uniform3f(ne),u_frustum_tr:new r.Uniform3f(ne),u_frustum_br:new r.Uniform3f(ne),u_frustum_bl:new r.Uniform3f(ne),u_globe_pos:new r.Uniform3f(ne),u_globe_radius:new r.Uniform1f(ne),u_globe_transition:new r.Uniform1f(ne),u_is_globe:new r.Uniform1i(ne),u_viewport:new r.Uniform2f(ne)}))(c))}}setTerrainUniformValues(c,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setGlobeUniformValues(c,f){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setFogUniformValues(c,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}draw(c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we){const Se=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(y),c.setStencilMode(w),c.setColorMode(B),c.setCullFace(R);for(const ve of Object.keys(this.fixedUniforms))this.fixedUniforms[ve].set(this.program,ve,L[ve]);be&&be.setUniforms(this.program,c,this.binderUniforms,fe,{zoom:xe});const ne={[Se.LINES]:2,[Se.TRIANGLES]:3,[Se.LINE_STRIP]:1}[f];for(const ve of ie.get()){const Pe=ve.vaos||(ve.vaos={});(Pe[U]||(Pe[U]=new N1)).bind(c,this,j,be?be.getPaintVertexBuffers():[],Y,ve.vertexOffset,we||[]),Se.drawElements(f,ve.primitiveLength*ne,Se.UNSIGNED_SHORT,ve.primitiveOffset*ne*2)}}}function Bh(m,c){const f=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,m.transform.tileZoom)/f,w=y*(c.tileID.canonical.x+c.tileID.wrap*f),B=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/Tt(c,1,m.transform.tileZoom),u_pixel_coord_upper:[w>>16,B>>16],u_pixel_coord_lower:[65535&w,65535&B]}}const M0=r.create(),dg=(m,c,f,y,w,B,R,L,U,j,Y)=>{const ie=c.style.light,fe=ie.properties.get("position"),xe=[fe.x,fe.y,fe.z],be=r.create$1();ie.properties.get("anchor")==="viewport"&&(r.fromRotation(be,-c.transform.angle),r.transformMat3(xe,xe,be));const we=ie.properties.get("color"),Se=c.transform,ne={u_matrix:m,u_lightpos:xe,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[we.r,we.g,we.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:M0,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:B};return Se.projection.name==="globe"&&(ne.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],ne.u_zoom_transition=U,ne.u_inv_rot_matrix=Y,ne.u_merc_center=j,ne.u_up_dir=Se.projection.upVector(new r.CanonicalTileID(0,0,0),j[0]*r.EXTENT,j[1]*r.EXTENT),ne.u_height_lift=L),ne},T0=(m,c,f,y,w,B,R,L,U,j,Y,ie)=>{const fe=dg(m,c,f,y,w,B,R,U,j,Y,ie),xe={u_height_factor:-Math.pow(2,R.overscaledZ)/L.tileSize/8};return r.extend(fe,Bh(c,L),xe)},Hl=m=>({u_matrix:m}),fg=(m,c,f)=>r.extend(Hl(m),Bh(c,f)),z1=(m,c)=>({u_matrix:m,u_world:c}),U1=(m,c,f,y)=>r.extend(fg(m,c,f),{u_world:y}),O1=r.create(),pg=(m,c,f,y,w,B)=>{const R=m.transform,L=R.projection.name==="globe";let U;if(B.paint.get("circle-pitch-alignment")==="map")if(L){const Y=r.globePixelsToTileUnits(R.zoom,c.canonical)*R._pixelsPerMercatorPixel;U=Float32Array.from([Y,0,0,Y])}else U=R.calculatePixelsToTileUnitsMatrix(f);else U=new Float32Array([R.pixelsToGLUnits[0],0,0,R.pixelsToGLUnits[1]]);const j={u_camera_to_center_distance:R.cameraToCenterDistance,u_matrix:m.translatePosMatrix(c.projMatrix,f,B.paint.get("circle-translate"),B.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:O1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){j.u_inv_rot_matrix=y,j.u_merc_center=w,j.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],j.u_zoom_transition=r.globeToMercatorTransition(R.zoom);const Y=w[0]*r.EXTENT,ie=w[1]*r.EXTENT;j.u_up_dir=R.projection.upVector(new r.CanonicalTileID(0,0,0),Y,ie)}return j},Ag=m=>{const c=[];return m.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c},gg=(m,c,f,y)=>{const w=r.EXTENT/f.tileSize;return{u_matrix:m,u_camera_to_center_distance:c.getCameraToCenterDistance(y),u_extrude_scale:[c.pixelsToGLUnits[0]/w,c.pixelsToGLUnits[1]/w]}},vf=(m,c,f=1)=>({u_matrix:m,u_color:c,u_overlay:0,u_overlay_scale:f}),D0=r.create(),Q0=(m,c,f,y,w,B,R)=>{const L=m.transform,U=L.projection.name==="globe",j=U?r.globePixelsToTileUnits(L.zoom,c.canonical)*L._pixelsPerMercatorPixel:Tt(f,1,B),Y={u_matrix:c.projMatrix,u_extrude_scale:j,u_intensity:R,u_inv_rot_matrix:D0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){Y.u_inv_rot_matrix=y,Y.u_merc_center=w,Y.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],Y.u_zoom_transition=r.globeToMercatorTransition(L.zoom);const ie=w[0]*r.EXTENT,fe=w[1]*r.EXTENT;Y.u_up_dir=L.projection.upVector(new r.CanonicalTileID(0,0,0),ie,fe)}return Y},G1=(m,c,f,y,w,B,R)=>{const L=m.transform,U=L.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:mg(m,c,f,y),u_pixels_to_tile_units:U,u_device_pixel_ratio:B,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:Mh(f)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Kc(c,m.transform),u_alpha_discard_threshold:0,u_trim_offset:R}},Sh=(m,c,f,y,w)=>{const B=m.transform;return{u_matrix:mg(m,c,f,y),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:B.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:Kc(c,B),u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Kc(m,c){return 1/Tt(m,1,c.tileZoom)}function mg(m,c,f,y){return m.translatePosMatrix(y||c.tileID.projMatrix,c,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function Mh(m){const c=m.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}const _g=(m,c,f,y,w,B)=>{return{u_matrix:m,u_tl_parent:c,u_scale_parent:f,u_fade_t:y.mix,u_opacity:y.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(L=w.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(R=w.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Vo(w.paint.get("raster-hue-rotate")),u_perspective_transform:B};var R,L};function Vo(m){m*=Math.PI/180;const c=Math.sin(m),f=Math.cos(m);return[(2*f+1)/3,(-Math.sqrt(3)*c-f+1)/3,(Math.sqrt(3)*c-f+1)/3]}const xf=r.create(),yg=(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we)=>{const Se=w.transform,ne={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:Se.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:Se.width/Se.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:B,u_label_plane_matrix:R,u_coord_matrix:L,u_is_text:+U,u_pitch_with_map:+y,u_texsize:j,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:xf,u_up_vector:[0,-1,0]};return we.name==="globe"&&(ne.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],ne.u_zoom_transition=ie,ne.u_inv_rot_matrix=xe,ne.u_merc_center=fe,ne.u_camera_forward=Se._camera.forward(),ne.u_ecef_origin=r.globeECEFOrigin(Se.globeMatrix,Y.toUnwrapped()),ne.u_tile_matrix=Float32Array.from(Se.globeMatrix),ne.u_up_vector=be),ne},If=(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we,Se)=>r.extend(yg(m,c,f,y,w,B,R,L,U,j,ie,fe,xe,be,we,Se),{u_gamma_scale:y?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:+Y}),R0=(m,c,f,y,w,B,R,L,U,j,Y,ie,fe,xe,be,we)=>r.extend(If(m,c,f,y,w,B,R,L,!0,U,!0,Y,ie,fe,xe,be,we),{u_texsize_icon:j,u_texture_icon:1}),vg=(m,c,f)=>({u_matrix:m,u_opacity:c,u_color:f}),H1=(m,c,f,y,w)=>r.extend(function(B,R,L){const U=R.imageManager.getPattern(B.toString()),{width:j,height:Y}=R.imageManager.getPixelSize(),ie=Math.pow(2,L.tileID.overscaledZ),fe=L.tileSize*Math.pow(2,R.transform.tileZoom)/ie,xe=fe*(L.tileID.canonical.x+L.tileID.wrap*ie),be=fe*L.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[j,Y],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/Tt(L,1,R.transform.tileZoom),u_pixel_coord_upper:[xe>>16,be>>16],u_pixel_coord_lower:[65535&xe,65535&be]}}(y,f,w),{u_matrix:m,u_opacity:c}),xg={fillExtrusion:m=>({u_matrix:new r.UniformMatrix4f(m),u_lightpos:new r.Uniform3f(m),u_lightintensity:new r.Uniform1f(m),u_lightcolor:new r.Uniform3f(m),u_vertical_gradient:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_edge_radius:new r.Uniform1f(m),u_ao:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_up_dir:new r.Uniform3f(m),u_height_lift:new r.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_lightpos:new r.Uniform3f(m),u_lightintensity:new r.Uniform1f(m),u_lightcolor:new r.Uniform3f(m),u_vertical_gradient:new r.Uniform1f(m),u_height_factor:new r.Uniform1f(m),u_edge_radius:new r.Uniform1f(m),u_ao:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_up_dir:new r.Uniform3f(m),u_height_lift:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m)}),fill:m=>({u_matrix:new r.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),fillOutline:m=>({u_matrix:new r.UniformMatrix4f(m),u_world:new r.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_world:new r.Uniform2f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new r.Uniform1f(m),u_extrude_scale:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_up_dir:new r.Uniform3f(m)}),collisionBox:m=>({u_matrix:new r.UniformMatrix4f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_extrude_scale:new r.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new r.UniformMatrix4f(m),u_inv_matrix:new r.UniformMatrix4f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_viewport_size:new r.Uniform2f(m)}),debug:m=>({u_color:new r.UniformColor(m),u_matrix:new r.UniformMatrix4f(m),u_overlay:new r.Uniform1i(m),u_overlay_scale:new r.Uniform1f(m)}),clippingMask:m=>({u_matrix:new r.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new r.Uniform1f(m),u_intensity:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_up_dir:new r.Uniform3f(m)}),heatmapTexture:m=>({u_image:new r.Uniform1i(m),u_color_ramp:new r.Uniform1i(m),u_opacity:new r.Uniform1f(m)}),hillshade:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_latrange:new r.Uniform2f(m),u_light:new r.Uniform2f(m),u_shadow:new r.UniformColor(m),u_highlight:new r.UniformColor(m),u_accent:new r.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_dimension:new r.Uniform2f(m),u_zoom:new r.Uniform1f(m),u_unpack:new r.Uniform4f(m)}),line:m=>({u_matrix:new r.UniformMatrix4f(m),u_pixels_to_tile_units:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_units_to_pixels:new r.Uniform2f(m),u_dash_image:new r.Uniform1i(m),u_gradient_image:new r.Uniform1i(m),u_image_height:new r.Uniform1f(m),u_texsize:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_alpha_discard_threshold:new r.Uniform1f(m),u_trim_offset:new r.Uniform2f(m)}),linePattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_texsize:new r.Uniform2f(m),u_pixels_to_tile_units:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_units_to_pixels:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_alpha_discard_threshold:new r.Uniform1f(m)}),raster:m=>({u_matrix:new r.UniformMatrix4f(m),u_tl_parent:new r.Uniform2f(m),u_scale_parent:new r.Uniform1f(m),u_fade_t:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_image0:new r.Uniform1i(m),u_image1:new r.Uniform1i(m),u_brightness_low:new r.Uniform1f(m),u_brightness_high:new r.Uniform1f(m),u_saturation_factor:new r.Uniform1f(m),u_contrast_factor:new r.Uniform1f(m),u_spin_weights:new r.Uniform3f(m),u_perspective_transform:new r.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_camera_forward:new r.Uniform3f(m),u_tile_matrix:new r.UniformMatrix4f(m),u_up_vector:new r.Uniform3f(m),u_ecef_origin:new r.Uniform3f(m),u_texture:new r.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_texture:new r.Uniform1i(m),u_gamma_scale:new r.Uniform1f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_camera_forward:new r.Uniform3f(m),u_tile_matrix:new r.UniformMatrix4f(m),u_up_vector:new r.Uniform3f(m),u_ecef_origin:new r.Uniform3f(m),u_is_halo:new r.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_texsize_icon:new r.Uniform2f(m),u_texture:new r.Uniform1i(m),u_texture_icon:new r.Uniform1i(m),u_gamma_scale:new r.Uniform1f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_is_halo:new r.Uniform1i(m)}),background:m=>({u_matrix:new r.UniformMatrix4f(m),u_opacity:new r.Uniform1f(m),u_color:new r.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_opacity:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_pattern_tl:new r.Uniform2f(m),u_pattern_br:new r.Uniform2f(m),u_texsize:new r.Uniform2f(m),u_pattern_size:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),terrainRaster:lg,terrainDepth:lg,skybox:m=>({u_matrix:new r.UniformMatrix4f(m),u_sun_direction:new r.Uniform3f(m),u_cubemap:new r.Uniform1i(m),u_opacity:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new r.UniformMatrix4f(m),u_color_ramp:new r.Uniform1i(m),u_center_direction:new r.Uniform3f(m),u_radius:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new r.UniformMatrix3f(m),u_sun_direction:new r.Uniform3f(m),u_sun_intensity:new r.Uniform1f(m),u_color_tint_r:new r.Uniform4f(m),u_color_tint_m:new r.Uniform4f(m),u_luminance:new r.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new r.UniformMatrix4f(m),u_globe_matrix:new r.UniformMatrix4f(m),u_normalize_matrix:new r.UniformMatrix4f(m),u_merc_matrix:new r.UniformMatrix4f(m),u_zoom_transition:new r.Uniform1f(m),u_merc_center:new r.Uniform2f(m),u_image0:new r.Uniform1i(m),u_grid_matrix:new r.UniformMatrix3f(m),u_skirt_height:new r.Uniform1f(m),u_frustum_tl:new r.Uniform3f(m),u_frustum_tr:new r.Uniform3f(m),u_frustum_br:new r.Uniform3f(m),u_frustum_bl:new r.Uniform3f(m),u_globe_pos:new r.Uniform3f(m),u_globe_radius:new r.Uniform1f(m),u_viewport:new r.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new r.Uniform3f(m),u_frustum_tr:new r.Uniform3f(m),u_frustum_br:new r.Uniform3f(m),u_frustum_bl:new r.Uniform3f(m),u_horizon:new r.Uniform1f(m),u_transition:new r.Uniform1f(m),u_fadeout_range:new r.Uniform1f(m),u_color:new r.Uniform4f(m),u_high_color:new r.Uniform4f(m),u_space_color:new r.Uniform4f(m),u_star_intensity:new r.Uniform1f(m),u_star_density:new r.Uniform1f(m),u_star_size:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m),u_horizon_angle:new r.Uniform1f(m),u_rotation_matrix:new r.UniformMatrix4f(m)})};let Cf;function Th(m,c,f,y,w,B,R){const L=m.context,U=L.gl,j=m.transform,Y=m.useProgram("collisionBox"),ie=[];let fe=0,xe=0;for(let ke=0;ke<y.length;ke++){const $e=y[ke],tt=c.getTile($e),et=tt.getBucket(f);if(!et)continue;const ct=$s($e,et,j);let lt=ct;w[0]===0&&w[1]===0||(lt=m.translatePosMatrix(ct,tt,w,B));const vt=R?et.textCollisionBox:et.iconCollisionBox,Zt=et.collisionCircleArray;if(Zt.length>0){const At=r.create(),zt=lt;r.mul(At,et.placementInvProjMatrix,j.glCoordMatrix),r.mul(At,At,et.placementViewportMatrix),ie.push({circleArray:Zt,circleOffset:xe,transform:zt,invTransform:At,projection:et.getProjection()}),fe+=Zt.length/4,xe=fe}vt&&(m.terrain&&m.terrain.setupElevationDraw(tt,Y),Y.draw(L,U.LINES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,gg(lt,j,tt,et.getProjection()),f.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,null,j.zoom,null,[vt.collisionVertexBuffer,vt.collisionVertexBufferExt]))}if(!R||!ie.length)return;const be=m.useProgram("collisionCircle"),we=new r.StructArrayLayout2f1f2i16;we.resize(4*fe),we._trim();let Se=0;for(const ke of ie)for(let $e=0;$e<ke.circleArray.length/4;$e++){const tt=4*$e,et=ke.circleArray[tt+0],ct=ke.circleArray[tt+1],lt=ke.circleArray[tt+2],vt=ke.circleArray[tt+3];we.emplace(Se++,et,ct,lt,vt,0),we.emplace(Se++,et,ct,lt,vt,1),we.emplace(Se++,et,ct,lt,vt,2),we.emplace(Se++,et,ct,lt,vt,3)}(!Cf||Cf.length<2*fe)&&(Cf=function(ke){const $e=2*ke,tt=new r.StructArrayLayout3ui6;tt.resize($e),tt._trim();for(let et=0;et<$e;et++){const ct=6*et;tt.uint16[ct+0]=4*et+0,tt.uint16[ct+1]=4*et+1,tt.uint16[ct+2]=4*et+2,tt.uint16[ct+3]=4*et+2,tt.uint16[ct+4]=4*et+3,tt.uint16[ct+5]=4*et+0}return tt}(fe));const ne=L.createIndexBuffer(Cf,!0),ve=L.createVertexBuffer(we,r.collisionCircleLayout.members,!0);for(const ke of ie){const $e={u_matrix:ke.transform,u_inv_matrix:ke.invTransform,u_camera_to_center_distance:(Pe=j).getCameraToCenterDistance(ke.projection),u_viewport_size:[Pe.width,Pe.height]};be.draw(L,U.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,$e,f.id,ve,ne,r.SegmentVector.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,j.zoom)}var Pe;ve.destroy(),ne.destroy()}const L0=r.create();function Ig({width:m,height:c,anchor:f,textOffset:y,textScale:w},B){const{horizontalAlign:R,verticalAlign:L}=r.getAnchorAlignment(f),U=-(R-.5)*m,j=-(L-.5)*c,Y=r.evaluateVariableOffset(f,y);return new r.Point((U/w+Y[0])*B,(j/w+Y[1])*B)}function V1(m,c,f,y,w,B,R,L,U,j,Y){const ie=m.text.placedSymbolArray,fe=m.text.dynamicLayoutVertexArray,xe=m.icon.dynamicLayoutVertexArray,be={},we=m.getProjection(),Se=Yn(L,we,B),ne=B.elevation,ve=we.upVectorScale(L.canonical,B.center.lat,B.worldSize).metersToTile;fe.clear();for(let Pe=0;Pe<ie.length;Pe++){const ke=ie.get(Pe),{tileAnchorX:$e,tileAnchorY:tt,numGlyphs:et}=ke,ct=ke.hidden||!ke.crossTileID||m.allowVerticalPlacement&&!ke.placedOrientation?null:y[ke.crossTileID];if(ct){let lt=0,vt=0,Zt=0;if(ne){const ti=ne?ne.getAtTileOffset(L,$e,tt):0,[bi,Ni,Ii]=we.upVector(L.canonical,$e,tt);lt=ti*bi*ve,vt=ti*Ni*ve,Zt=ti*Ii*ve}let[At,zt,bt,Jt]=In(ke.projectedAnchorX+lt,ke.projectedAnchorY+vt,ke.projectedAnchorZ+Zt,f?Se:R);const _t=Uc(B.getCameraToCenterDistance(we),Jt);let Nt=w.evaluateSizeForFeature(m.textSizeData,j,ke)*_t/r.ONE_EM;f&&(Nt*=m.tilePixelRatio/U);const ei=Ig(ct,Nt);f?({x:At,y:zt,z:bt}=we.projectTilePoint($e+ei.x,tt+ei.y,L.canonical),[At,zt,bt]=In(At+lt,zt+vt,bt+Zt,R)):(c&&ei._rotate(-B.angle),At+=ei.x,zt+=ei.y,bt=0);const jt=m.allowVerticalPlacement&&ke.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let ti=0;ti<et;ti++)r.addDynamicAttributes(fe,At,zt,bt,jt);Y&&ke.associatedIconIndex>=0&&(be[ke.associatedIconIndex]={x:At,y:zt,z:bt,angle:jt})}else xo(et,fe)}if(Y){xe.clear();const Pe=m.icon.placedSymbolArray;for(let ke=0;ke<Pe.length;ke++){const $e=Pe.get(ke),{numGlyphs:tt}=$e,et=be[ke];if($e.hidden||!et)xo(tt,xe);else{const{x:ct,y:lt,z:vt,angle:Zt}=et;for(let At=0;At<tt;At++)r.addDynamicAttributes(xe,ct,lt,vt,Zt)}}m.icon.dynamicLayoutVertexBuffer.updateData(xe)}m.text.dynamicLayoutVertexBuffer.updateData(fe)}function Cg(m,c,f){return f.iconsInText&&c?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function P0(m,c,f,y,w,B,R,L,U,j,Y,ie){const fe=m.context,xe=fe.gl,be=m.transform,we=L==="map",Se=U==="map",ne=we&&f.layout.get("symbol-placement")!=="point",ve=we&&!Se&&!ne,Pe=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ke=!1;const $e=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),tt=[r.mercatorXfromLng(be.center.lng),r.mercatorYfromLat(be.center.lat)],et=f.layout.get("text-variable-anchor"),ct=be.projection.name==="globe",lt=[],vt=[0,-1,0];let Zt=vt;!ct&&!be.mercatorFromTransition||we||(Zt=function(At){const zt=At._camera.getWorldToCamera(At.worldSize,1),bt=r.multiply([],zt,At.globeMatrix);r.invert(bt,bt);const Jt=[0,0,0],_t=[0,1,0,0];return r.transformMat4$1(_t,_t,bt),Jt[0]=_t[0],Jt[1]=_t[1],Jt[2]=_t[2],r.normalize(Jt,Jt),Jt}(be));for(const At of y){const zt=c.getTile(At),bt=zt.getBucket(f);if(!bt||bt.projection.name==="mercator"&&ct)continue;const Jt=w?bt.text:bt.icon;if(!Jt||bt.fullyClipped||!Jt.segments.get().length)continue;const _t=Jt.programConfigurations.get(f.id),Nt=w||bt.sdfIcons,ei=w?bt.textSizeData:bt.iconSizeData,jt=Se||be.pitch!==0,ti=r.evaluateSizeForZoom(ei,be.zoom);let bi,Ni,Ii,Ti,en=[0,0],Ji=null;if(w)Ni=zt.glyphAtlasTexture,Ii=xe.LINEAR,bi=zt.glyphAtlasTexture.size,bt.iconsInText&&(en=zt.imageAtlasTexture.size,Ji=zt.imageAtlasTexture,Ti=jt||m.options.rotating||m.options.zooming||ei.kind==="composite"||ei.kind==="camera"?xe.LINEAR:xe.NEAREST);else{const Ta=f.layout.get("icon-size").constantOr(0)!==1||bt.iconsNeedLinear;Ni=zt.imageAtlasTexture,Ii=Nt||m.options.rotating||m.options.zooming||Ta||jt?xe.LINEAR:xe.NEAREST,bi=zt.imageAtlasTexture.size}const wi=bt.projection.name==="globe",yn=wi?Zt:vt,Sn=wi?r.globeToMercatorTransition(be.zoom):0,Mn=Yn(At,bt.getProjection(),be),Tn=be.calculatePixelsToTileUnitsMatrix(zt),ss=Mt(Mn,zt.tileID.canonical,Se,we,be,bt.getProjection(),Tn),Fr=m.terrain&&Se&&ne?r.invert(r.create(),ss):L0,no=qn(Mn,zt.tileID.canonical,Se,we,be,bt.getProjection(),Tn),Yo=et&&bt.hasTextData(),jn=f.layout.get("icon-text-fit")!=="none"&&Yo&&bt.hasIconData();if(ne){const Ta=be.elevation,ll=Ta?Ta.getAtTileOffsetFunc(At,be.center.lat,be.worldSize,bt.getProjection()):null,ql=Wr(Mn,zt.tileID.canonical,Se,we,be,bt.getProjection(),Tn);Oc(bt,Mn,m,w,ql,no,Se,j,ll,At)}const Dn=ne||w&&et||jn,fn=m.translatePosMatrix(Mn,zt,B,R),Ar=Dn?L0:ss,gs=m.translatePosMatrix(no,zt,B,R,!0),Hn=bt.getProjection().createInversionMatrix(be,At.canonical),Bs=[];m.terrainRenderModeElevated()&&Se&&Bs.push("PITCH_WITH_MAP_TERRAIN"),wi&&Bs.push("PROJECTION_GLOBE_VIEW"),Dn&&Bs.push("PROJECTED_POS_ON_VIEWPORT");const zf=Nt&&f.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let jl;jl=Nt?bt.iconsInText?R0(ei.kind,ti,ve,Se,m,fn,Ar,gs,bi,en,At,Sn,tt,Hn,yn,bt.getProjection()):If(ei.kind,ti,ve,Se,m,fn,Ar,gs,w,bi,!0,At,Sn,tt,Hn,yn,bt.getProjection()):yg(ei.kind,ti,ve,Se,m,fn,Ar,gs,w,bi,At,Sn,tt,Hn,yn,bt.getProjection());const Oh={program:m.useProgram(Cg(Nt,w,bt),_t,Bs),buffers:Jt,uniformValues:jl,atlasTexture:Ni,atlasTextureIcon:Ji,atlasInterpolation:Ii,atlasInterpolationIcon:Ti,isSDF:Nt,hasHalo:zf,tile:zt,labelPlaneMatrixInv:Fr};if(Pe&&bt.canOverlap){ke=!0;const Ta=Jt.segments.get();for(const ll of Ta)lt.push({segments:new r.SegmentVector([ll]),sortKey:ll.sortKey,state:Oh})}else lt.push({segments:Jt.segments,sortKey:0,state:Oh})}ke&&lt.sort((At,zt)=>At.sortKey-zt.sortKey);for(const At of lt){const zt=At.state;if(m.terrain&&m.terrain.setupElevationDraw(zt.tile,zt.program,{useDepthForOcclusion:!ct,labelPlaneMatrixInv:zt.labelPlaneMatrixInv}),fe.activeTexture.set(xe.TEXTURE0),zt.atlasTexture.bind(zt.atlasInterpolation,xe.CLAMP_TO_EDGE),zt.atlasTextureIcon&&(fe.activeTexture.set(xe.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,xe.CLAMP_TO_EDGE)),zt.isSDF){const bt=zt.uniformValues;zt.hasHalo&&(bt.u_is_halo=1,Dh(zt.buffers,At.segments,f,m,zt.program,$e,Y,ie,bt)),bt.u_is_halo=0}Dh(zt.buffers,At.segments,f,m,zt.program,$e,Y,ie,zt.uniformValues)}}function Dh(m,c,f,y,w,B,R,L,U){const j=y.context,Y=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];w.draw(j,j.gl.TRIANGLES,B,R,L,r.CullFaceMode.disabled,U,f.id,m.layoutVertexBuffer,m.indexBuffer,c,f.paint,y.transform.zoom,m.programConfigurations.get(f.id),Y)}function k0(m,c,f,y,w,B,R){const L=m.context.gl,U=f.paint.get("fill-pattern"),j=U&&U.constantOr(1);let Y,ie,fe,xe,be;R?(ie=j&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=L.LINES):(ie=j?"fillPattern":"fill",Y=L.TRIANGLES);for(const we of y){const Se=c.getTile(we);if(j&&!Se.patternsLoaded())continue;const ne=Se.getBucket(f);if(!ne)continue;m.prepareDrawTile();const ve=ne.programConfigurations.get(f.id),Pe=m.useProgram(ie,ve);j&&(m.context.activeTexture.set(L.TEXTURE0),Se.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ve.updatePaintBuffers());const ke=U.constantOr(null);if(ke&&Se.imageAtlas){const tt=Se.imageAtlas.patternPositions[ke.toString()];tt&&ve.setConstantPatternPositions(tt)}const $e=m.translatePosMatrix(we.projMatrix,Se,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(R){xe=ne.indexBuffer2,be=ne.segments2;const tt=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[L.drawingBufferWidth,L.drawingBufferHeight];fe=ie==="fillOutlinePattern"&&j?U1($e,m,Se,tt):z1($e,tt)}else xe=ne.indexBuffer,be=ne.segments,fe=j?fg($e,m,Se):Hl($e);m.prepareDrawProgram(m.context,Pe,we.toUnwrapped()),Pe.draw(m.context,Y,w,m.stencilModeForClipping(we),B,r.CullFaceMode.disabled,fe,f.id,ne.layoutVertexBuffer,xe,be,f.paint,m.transform.zoom,ve)}}function Ef(m,c,f,y,w,B,R){const L=m.context,U=L.gl,j=m.transform,Y=f.paint.get("fill-extrusion-pattern"),ie=Y.constantOr(1),fe=f.paint.get("fill-extrusion-opacity"),xe=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],be=f.layout.get("fill-extrusion-edge-radius"),we=be>0&&!f.paint.get("fill-extrusion-rounded-roof"),Se=we?0:be,ne=j.projection.name==="globe"?r.fillExtrusionHeightLift():0,ve=j.projection.name==="globe",Pe=ve?r.globeToMercatorTransition(j.zoom):0,ke=[r.mercatorXfromLng(j.center.lng),r.mercatorYfromLat(j.center.lat)],$e=[];ve&&$e.push("PROJECTION_GLOBE_VIEW"),xe[0]>0&&$e.push("FAUX_AO"),we&&$e.push("ZERO_ROOF_RADIUS");for(const tt of y){const et=c.getTile(tt),ct=et.getBucket(f);if(!ct||ct.projection.name!==j.projection.name)continue;const lt=ct.programConfigurations.get(f.id),vt=m.useProgram(ie?"fillExtrusionPattern":"fillExtrusion",lt,$e);if(m.terrain){const Nt=m.terrain;if(m.style.terrainSetForDrapingOnly())Nt.setupElevationDraw(et,vt,{useMeterToDem:!0});else{if(!ct.enableTerrain)continue;if(Nt.setupElevationDraw(et,vt,{useMeterToDem:!0}),F0(L,c,tt,ct,f,Nt),!ct.centroidVertexBuffer){const ei=vt.attributes.a_centroid_pos;ei!==void 0&&U.vertexAttrib2f(ei,0,0)}}}ie&&(m.context.activeTexture.set(U.TEXTURE0),et.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),lt.updatePaintBuffers());const Zt=Y.constantOr(null);if(Zt&&et.imageAtlas){const Nt=et.imageAtlas.patternPositions[Zt.toString()];Nt&&lt.setConstantPatternPositions(Nt)}const At=m.translatePosMatrix(tt.projMatrix,et,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),zt=j.projection.createInversionMatrix(j,tt.canonical),bt=f.paint.get("fill-extrusion-vertical-gradient"),Jt=ie?T0(At,m,bt,fe,xe,Se,tt,et,ne,Pe,ke,zt):dg(At,m,bt,fe,xe,Se,tt,ne,Pe,ke,zt);m.prepareDrawProgram(L,vt,tt.toUnwrapped());const _t=[];m.terrain&&_t.push(ct.centroidVertexBuffer),ve&&_t.push(ct.layoutVertexExtBuffer),vt.draw(L,L.gl.TRIANGLES,w,B,R,r.CullFaceMode.backCCW,Jt,f.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,f.paint,m.transform.zoom,lt,_t)}}function F0(m,c,f,y,w,B){const R=[ne=>{let ve=ne.canonical.x-1,Pe=ne.wrap;return ve<0&&(ve=(1<<ne.canonical.z)-1,Pe--),new r.OverscaledTileID(ne.overscaledZ,Pe,ne.canonical.z,ve,ne.canonical.y)},ne=>{let ve=ne.canonical.x+1,Pe=ne.wrap;return ve===1<<ne.canonical.z&&(ve=0,Pe++),new r.OverscaledTileID(ne.overscaledZ,Pe,ne.canonical.z,ve,ne.canonical.y)},ne=>new r.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,(ne.canonical.y===0?1<<ne.canonical.z:ne.canonical.y)-1),ne=>new r.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,ne.canonical.y===(1<<ne.canonical.z)-1?0:ne.canonical.y+1)],L=ne=>{const ve=c.getSource().minzoom,Pe=$e=>{const tt=c.getTileByID($e);if(tt&&tt.hasData())return tt.getBucket(w)},ke=[0,-1,1];for(const $e of ke){if(ne.overscaledZ+$e<ve)continue;const tt=Pe(ne.calculateScaledKey(ne.overscaledZ+$e));if(tt)return tt}},U=[0,0,0],j=(ne,ve)=>(U[0]=Math.min(ne.min.y,ve.min.y),U[1]=Math.max(ne.max.y,ve.max.y),U[2]=r.EXTENT-ve.min.x>ne.max.x?ve.min.x-r.EXTENT:ne.max.x,U),Y=(ne,ve)=>(U[0]=Math.min(ne.min.x,ve.min.x),U[1]=Math.max(ne.max.x,ve.max.x),U[2]=r.EXTENT-ve.min.y>ne.max.y?ve.min.y-r.EXTENT:ne.max.y,U),ie=[(ne,ve)=>j(ne,ve),(ne,ve)=>j(ve,ne),(ne,ve)=>Y(ne,ve),(ne,ve)=>Y(ve,ne)],fe=new r.Point(0,0);let xe,be,we;const Se=(ne,ve,Pe,ke,$e)=>{const tt=[[ke?Pe:ne,ke?ne:Pe,0],[ke?Pe:ve,ke?ve:Pe,0]],et=$e<0?r.EXTENT+$e:$e,ct=[ke?et:(ne+ve)/2,ke?(ne+ve)/2:et,0];return Pe===0&&$e<0||Pe!==0&&$e>0?B.getForTilePoints(we,[ct],!0,be):tt.push(ct),B.getForTilePoints(f,tt,!0,xe),Math.max(tt[0][2],tt[1][2],ct[2])/B.exaggeration()};for(let ne=0;ne<4;ne++){const ve=(ne<2?1:5)-ne,Pe=y.borders[ne];if(Pe.length===0)continue;const ke=we=R[ne](f),$e=L(ke);if(!($e&&$e instanceof r.FillExtrusionBucket&&$e.enableTerrain)||y.borderDoneWithNeighborZ[ne]===$e.canonical.z&&$e.borderDoneWithNeighborZ[ve]===y.canonical.z||(be=B.findDEMTileFor(ke),!be||!be.dem))continue;if(!xe){const lt=B.findDEMTileFor(f);if(!lt||!lt.dem)return;xe=lt}const tt=$e.borders[ve];let et=0;const ct=$e.borderDoneWithNeighborZ[ve]!==y.canonical.z;if(y.canonical.z===$e.canonical.z){for(let lt=0;lt<Pe.length;lt++){const vt=y.featuresOnBorder[Pe[lt]],Zt=vt.borders[ne];let At;for(;et<tt.length&&(At=$e.featuresOnBorder[tt[et]],!(At.borders[ve][1]>Zt[0]+3));)ct&&$e.encodeCentroid(void 0,At,!1),et++;if(At&&et<tt.length){const zt=et;let bt=0;for(;!(At.borders[ve][0]>Zt[1]-3)&&(bt++,++et!==tt.length);)At=$e.featuresOnBorder[tt[et]];if(At=$e.featuresOnBorder[tt[zt]],vt.intersectsCount()>1||At.intersectsCount()>1||bt!==1){bt!==1&&(et=zt),y.encodeCentroid(void 0,vt,!1),ct&&$e.encodeCentroid(void 0,At,!1);continue}const Jt=ie[ne](vt,At),_t=ne%2?r.EXTENT-1:0;fe.x=Se(Jt[0],Math.min(r.EXTENT-1,Jt[1]),_t,ne<2,Jt[2]),fe.y=0,y.encodeCentroid(fe,vt,!1),ct&&$e.encodeCentroid(fe,At,!1)}else y.encodeCentroid(void 0,vt,!1)}y.borderDoneWithNeighborZ[ne]=$e.canonical.z,y.needsCentroidUpdate=!0,ct&&($e.borderDoneWithNeighborZ[ve]=y.canonical.z,$e.needsCentroidUpdate=!0)}else{for(const lt of Pe)y.encodeCentroid(void 0,y.featuresOnBorder[lt],!1);if(ct){for(const lt of tt)$e.encodeCentroid(void 0,$e.featuresOnBorder[lt],!1);$e.borderDoneWithNeighborZ[ve]=y.canonical.z,$e.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[ne]=$e.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(m)}const Jc=new r.Color(1,0,0,1),W1=new r.Color(0,1,0,1),Y1=new r.Color(0,0,1,1),j1=new r.Color(1,0,1,1),q1=new r.Color(0,1,1,1);function K1(m,c,f){const y=m.context,w=m.transform,B=y.gl,R=w.projection.name==="globe",L=R?["PROJECTION_GLOBE_VIEW"]:null;let U=f.projMatrix;if(R&&r.globeToMercatorTransition(w.zoom)>0){const vt=r.transitionTileAABBinECEF(f.canonical,w),Zt=r.globeDenormalizeECEF(vt);U=r.multiply(new Float32Array(16),w.globeMatrix,Zt),r.multiply(U,w.projMatrix,U)}const j=m.useProgram("debug",null,L),Y=c.getTileByID(f.key);m.terrain&&m.terrain.setupElevationDraw(Y,j);const ie=r.DepthMode.disabled,fe=r.StencilMode.disabled,xe=m.colorModeForRenderPass(),be="$debug";y.activeTexture.set(B.TEXTURE0),m.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),R?Y._makeGlobeTileDebugBuffers(m.context,w):Y._makeDebugTileBoundsBuffers(m.context,w.projection);const we=Y._tileDebugBuffer||m.debugBuffer,Se=Y._tileDebugIndexBuffer||m.debugIndexBuffer,ne=Y._tileDebugSegments||m.debugSegments;j.draw(y,B.LINE_STRIP,ie,fe,xe,r.CullFaceMode.disabled,vf(U,r.Color.red),be,we,Se,ne,null,null,null,[Y._globeTileDebugBorderBuffer]);const ve=Y.latestRawTileData,Pe=Math.floor((ve&&ve.byteLength||0)/1024),ke=c.getTile(f).tileSize,$e=512/Math.min(ke,512)*(f.overscaledZ/w.zoom)*.5;let tt=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(tt+=` => ${f.overscaledZ}`),tt+=` ${Pe}kb`,function(vt,Zt){vt.initDebugOverlayCanvas();const At=vt.debugOverlayCanvas,zt=vt.context.gl,bt=vt.debugOverlayCanvas.getContext("2d");bt.clearRect(0,0,At.width,At.height),bt.shadowColor="white",bt.shadowBlur=2,bt.lineWidth=1.5,bt.strokeStyle="white",bt.textBaseline="top",bt.font="bold 36px Open Sans, sans-serif",bt.fillText(Zt,5,5),bt.strokeText(Zt,5,5),vt.debugOverlayTexture.update(At),vt.debugOverlayTexture.bind(zt.LINEAR,zt.CLAMP_TO_EDGE)}(m,tt);const et=Y._tileDebugTextBuffer||m.debugBuffer,ct=Y._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,lt=Y._tileDebugTextSegments||m.debugSegments;j.draw(y,B.TRIANGLES,ie,fe,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,vf(U,r.Color.transparent,$e),be,et,ct,lt,null,null,null,[Y._globeTileDebugTextBuffer])}function N0(m,c,f,y){Xc(m,0,c+f/2,m.transform.width,f,y)}function wf(m,c,f,y){Xc(m,c-f/2,0,f,m.transform.height,y)}function Xc(m,c,f,y,w,B){const R=m.context,L=R.gl;L.enable(L.SCISSOR_TEST),L.scissor(c*r.exported.devicePixelRatio,f*r.exported.devicePixelRatio,y*r.exported.devicePixelRatio,w*r.exported.devicePixelRatio),R.clear({color:B}),L.disable(L.SCISSOR_TEST)}const z0=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:U0}=z0;function Sa(m,c,f,y){m.emplaceBack(c,f,y)}class bf{constructor(c){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,Sa(this.vertexArray,-1,-1,1),Sa(this.vertexArray,1,-1,1),Sa(this.vertexArray,-1,1,1),Sa(this.vertexArray,1,1,1),Sa(this.vertexArray,-1,-1,-1),Sa(this.vertexArray,1,-1,-1),Sa(this.vertexArray,-1,1,-1),Sa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,U0),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function to(m,c,f,y,w,B){const R=m.gl,L=c.paint.get("sky-atmosphere-color"),U=c.paint.get("sky-atmosphere-halo-color"),j=c.paint.get("sky-atmosphere-sun-intensity"),Y=((ie,fe,xe,be,we)=>({u_matrix_3f:ie,u_sun_direction:fe,u_sun_intensity:xe,u_color_tint_r:[be.r,be.g,be.b,be.a],u_color_tint_m:[we.r,we.g,we.b,we.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),y),w,j,L,U);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+B,c.skyboxTexture,0),f.draw(m,R.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,Y,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Qh=r.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class O0{constructor(c){const f=new r.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new r.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(f,Qh.members),this.indexBuffer=c.createIndexBuffer(y),this.segments=r.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Vl={symbol:function(m,c,f,y,w){if(m.renderPass!=="translucent")return;const B=r.StencilMode.disabled,R=m.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(L,U,j,Y,ie,fe,xe){const be=U.transform,we=ie==="map",Se=fe==="map";for(const ne of L){const ve=Y.getTile(ne),Pe=ve.getBucket(j);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;const ke=r.evaluateSizeForZoom(Pe.textSizeData,be.zoom),$e=Yn(ne,Pe.getProjection(),be),tt=be.calculatePixelsToTileUnitsMatrix(ve),et=Mt($e,ve.tileID.canonical,Se,we,be,Pe.getProjection(),tt),ct=j.layout.get("icon-text-fit")!=="none"&&Pe.hasIconData();if(ke){const lt=Math.pow(2,be.zoom-ve.tileID.overscaledZ);V1(Pe,we,Se,xe,r.symbolSize,be,et,ne,lt,ke,ct)}}}(y,m,f,c,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),w),f.paint.get("icon-opacity").constantOr(1)!==0&&P0(m,c,f,y,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),B,R),f.paint.get("text-opacity").constantOr(1)!==0&&P0(m,c,f,y,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),B,R),c.map.showCollisionBoxes&&(Th(m,c,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Th(m,c,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(m,c,f,y){if(m.renderPass!=="translucent")return;const w=f.paint.get("circle-opacity"),B=f.paint.get("circle-stroke-width"),R=f.paint.get("circle-stroke-opacity"),L=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(B.constantOr(1)===0||R.constantOr(1)===0))return;const U=m.context,j=U.gl,Y=m.transform,ie=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),fe=r.StencilMode.disabled,xe=m.colorModeForRenderPass(),be=Y.projection.name==="globe",we=[r.mercatorXfromLng(Y.center.lng),r.mercatorYfromLat(Y.center.lat)],Se=[];for(let ve=0;ve<y.length;ve++){const Pe=y[ve],ke=c.getTile(Pe),$e=ke.getBucket(f);if(!$e||$e.projection.name!==Y.projection.name)continue;const tt=$e.programConfigurations.get(f.id),et=Ag(f);be&&et.push("PROJECTION_GLOBE_VIEW");const ct=m.useProgram("circle",tt,et),lt=$e.layoutVertexBuffer,vt=$e.globeExtVertexBuffer,Zt=$e.indexBuffer,At=Y.projection.createInversionMatrix(Y,Pe.canonical),zt={programConfiguration:tt,program:ct,layoutVertexBuffer:lt,globeExtVertexBuffer:vt,indexBuffer:Zt,uniformValues:pg(m,Pe,ke,At,we,f),tile:ke};if(L){const bt=$e.segments.get();for(const Jt of bt)Se.push({segments:new r.SegmentVector([Jt]),sortKey:Jt.sortKey,state:zt})}else Se.push({segments:$e.segments,sortKey:0,state:zt})}L&&Se.sort((ve,Pe)=>ve.sortKey-Pe.sortKey);const ne={useDepthForOcclusion:!be};for(const ve of Se){const{programConfiguration:Pe,program:ke,layoutVertexBuffer:$e,globeExtVertexBuffer:tt,indexBuffer:et,uniformValues:ct,tile:lt}=ve.state,vt=ve.segments;m.terrain&&m.terrain.setupElevationDraw(lt,ke,ne),m.prepareDrawProgram(U,ke,lt.tileID.toUnwrapped()),ke.draw(U,j.TRIANGLES,ie,fe,xe,r.CullFaceMode.disabled,ct,f.id,$e,et,vt,f.paint,Y.zoom,Pe,[tt])}},heatmap:function(m,c,f,y){if(f.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const w=m.context,B=w.gl,R=r.StencilMode.disabled,L=new r.ColorMode([B.ONE,B.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(xe,be,we,Se){const ne=xe.gl,ve=be.width*Se,Pe=be.height*Se;xe.activeTexture.set(ne.TEXTURE1),xe.viewport.set([0,0,ve,Pe]);let ke=we.heatmapFbo;if(!ke||ke&&(ke.width!==ve||ke.height!==Pe)){ke&&ke.destroy();const $e=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,$e),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),ke=we.heatmapFbo=xe.createFramebuffer(ve,Pe,!1),function(tt,et,ct,lt,vt,Zt){const At=tt.gl;At.texImage2D(At.TEXTURE_2D,0,tt.isWebGL2&&tt.extRenderToTextureHalfFloat?At.RGBA16F:At.RGBA,vt,Zt,0,At.RGBA,tt.extRenderToTextureHalfFloat?tt.isWebGL2?At.HALF_FLOAT:tt.extTextureHalfFloat.HALF_FLOAT_OES:At.UNSIGNED_BYTE,null),lt.colorAttachment.set(ct)}(xe,0,$e,ke,ve,Pe)}else ne.bindTexture(ne.TEXTURE_2D,ke.colorAttachment.get()),xe.bindFramebuffer.set(ke.framebuffer)})(w,m,f,m.transform.projection.name==="globe"?.5:.25),w.clear({color:r.Color.transparent});const U=m.transform,j=U.projection.name==="globe",Y=j?["PROJECTION_GLOBE_VIEW"]:null,ie=j?r.CullFaceMode.frontCCW:r.CullFaceMode.disabled,fe=[r.mercatorXfromLng(U.center.lng),r.mercatorYfromLat(U.center.lat)];for(let xe=0;xe<y.length;xe++){const be=y[xe];if(c.hasRenderableParent(be))continue;const we=c.getTile(be),Se=we.getBucket(f);if(!Se||Se.projection.name!==U.projection.name)continue;const ne=Se.programConfigurations.get(f.id),ve=m.useProgram("heatmap",ne,Y),{zoom:Pe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(we,ve),m.prepareDrawProgram(w,ve,be.toUnwrapped());const ke=U.projection.createInversionMatrix(U,be.canonical);ve.draw(w,B.TRIANGLES,r.DepthMode.disabled,R,L,ie,Q0(m,be,we,ke,fe,Pe,f.paint.get("heatmap-intensity")),f.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,f.paint,m.transform.zoom,ne,j?[Se.globeExtVertexBuffer]:null)}w.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(w,B){const R=w.context,L=R.gl,U=B.heatmapFbo;if(!U)return;R.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,U.colorAttachment.get()),R.activeTexture.set(L.TEXTURE1);let j=B.colorRampTexture;j||(j=B.colorRampTexture=new r.Texture(R,B.colorRamp,L.RGBA)),j.bind(L.LINEAR,L.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(R,L.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,w.colorModeForRenderPass(),r.CullFaceMode.disabled,((Y,ie,fe,xe)=>({u_image:0,u_color_ramp:1,u_opacity:ie.paint.get("heatmap-opacity")}))(0,B),B.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,B.paint,w.transform.zoom)}(m,f))},line:function(m,c,f,y){if(m.renderPass!=="translucent")return;const w=f.paint.get("line-opacity"),B=f.paint.get("line-width");if(w.constantOr(1)===0||B.constantOr(1)===0)return;const R=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),L=m.colorModeForRenderPass(),U=m.terrain&&m.terrain.renderingToTexture?1:r.exported.devicePixelRatio,j=f.paint.get("line-dasharray"),Y=j.constantOr(1),ie=f.layout.get("line-cap"),fe=f.paint.get("line-pattern"),xe=fe.constantOr(1),be=f.paint.get("line-gradient"),we=xe?"linePattern":"line",Se=m.context,ne=Se.gl,ve=(ke=>{const $e=[];Mh(ke)&&$e.push("RENDER_LINE_DASH"),ke.paint.get("line-gradient")&&$e.push("RENDER_LINE_GRADIENT");const tt=ke.paint.get("line-trim-offset");tt[0]===0&&tt[1]===0||$e.push("RENDER_LINE_TRIM_OFFSET");const et=ke.paint.get("line-pattern").constantOr(1),ct=ke.paint.get("line-opacity").constantOr(1)!==1;return!et&&ct&&$e.push("RENDER_LINE_ALPHA_DISCARD"),$e})(f);let Pe=ve.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Pe=!1);for(const ke of y){const $e=c.getTile(ke);if(xe&&!$e.patternsLoaded())continue;const tt=$e.getBucket(f);if(!tt)continue;m.prepareDrawTile();const et=tt.programConfigurations.get(f.id),ct=m.useProgram(we,et,ve),lt=fe.constantOr(null);if(lt&&$e.imageAtlas){const Nt=$e.imageAtlas.patternPositions[lt.toString()];Nt&&et.setConstantPatternPositions(Nt)}const vt=j.constantOr(null),Zt=ie.constantOr(null);if(!xe&&vt&&Zt&&$e.lineAtlas){const Nt=$e.lineAtlas.getDash(vt,Zt);Nt&&et.setConstantPatternPositions(Nt)}let[At,zt]=f.paint.get("line-trim-offset");(Zt==="round"||Zt==="square")&&At!==zt&&(At===0&&(At-=1),zt===1&&(zt+=1));const bt=m.terrain?ke.projMatrix:null,Jt=xe?Sh(m,$e,f,bt,U):G1(m,$e,f,bt,tt.lineClipsArray.length,U,[At,zt]);if(be){const Nt=tt.gradients[f.id];let ei=Nt.texture;if(f.gradientVersion!==Nt.version){let jt=256;if(f.stepInterpolant){const ti=c.getSource().maxzoom,bi=ke.canonical.z===ti?Math.ceil(1<<m.transform.maxZoom-ke.canonical.z):1;jt=r.clamp(r.nextPowerOfTwo(tt.maxLineLength/r.EXTENT*1024*bi),256,Se.maxTextureSize)}Nt.gradient=r.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:jt,image:Nt.gradient||void 0,clips:tt.lineClipsArray}),Nt.texture?Nt.texture.update(Nt.gradient):Nt.texture=new r.Texture(Se,Nt.gradient,ne.RGBA),Nt.version=f.gradientVersion,ei=Nt.texture}Se.activeTexture.set(ne.TEXTURE1),ei.bind(f.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Y&&(Se.activeTexture.set(ne.TEXTURE0),$e.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),et.updatePaintBuffers()),xe&&(Se.activeTexture.set(ne.TEXTURE0),$e.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),et.updatePaintBuffers()),m.prepareDrawProgram(Se,ct,ke.toUnwrapped());const _t=Nt=>{ct.draw(Se,ne.TRIANGLES,R,Nt,L,r.CullFaceMode.disabled,Jt,f.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,f.paint,m.transform.zoom,et,[tt.layoutVertexBuffer2])};if(Pe){const Nt=m.stencilModeForClipping(ke).ref;Nt===0&&m.terrain&&Se.clear({stencil:0});const ei={func:ne.EQUAL,mask:255};Jt.u_alpha_discard_threshold=.8,_t(new r.StencilMode(ei,Nt,255,ne.KEEP,ne.KEEP,ne.INVERT)),Jt.u_alpha_discard_threshold=0,_t(new r.StencilMode(ei,Nt,255,ne.KEEP,ne.KEEP,ne.KEEP))}else _t(m.stencilModeForClipping(ke))}Pe&&(m.resetStencilClippingMasks(),m.terrain&&Se.clear({stencil:0}))},fill:function(m,c,f,y){const w=f.paint.get("fill-color"),B=f.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const R=m.colorModeForRenderPass(),L=f.paint.get("fill-pattern"),U=m.opaquePassEnabledForLayer()&&!L.constantOr(1)&&w.constantOr(r.Color.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===U){const j=m.depthModeForSublayer(1,m.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);k0(m,c,f,y,j,R,!1)}if(m.renderPass==="translucent"&&f.paint.get("fill-antialias")){const j=m.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);k0(m,c,f,y,j,R,!0)}},"fill-extrusion":function(m,c,f,y){const w=f.paint.get("fill-extrusion-opacity");if(w!==0&&m.renderPass==="translucent"){const B=new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D);if(w!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Ef(m,c,f,y,B,r.StencilMode.disabled,r.ColorMode.disabled),Ef(m,c,f,y,B,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const R=m.colorModeForRenderPass();Ef(m,c,f,y,B,r.StencilMode.disabled,R)}}},hillshade:function(m,c,f,y){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const w=m.context,B=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),R=m.colorModeForRenderPass(),L=m.terrain&&m.terrain.renderingToTexture,[U,j]=m.renderPass!=="translucent"||L?[{},y]:m.stencilConfigForOverlap(y);for(const Y of j){const ie=c.getTile(Y);if(ie.needsHillshadePrepare&&m.renderPass==="offscreen")B0(m,ie,f,B,r.StencilMode.disabled,R);else if(m.renderPass==="translucent"){const fe=L&&m.terrain?m.terrain.stencilModeForRTTOverlap(Y):U[Y.overscaledZ];b0(m,Y,ie,f,B,fe,R)}}w.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,c,f,y,w,B){if(m.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!y.length)return;const R=m.context,L=R.gl,U=c.getSource(),j=m.useProgram("raster"),Y=m.colorModeForRenderPass(),ie=m.terrain&&m.terrain.renderingToTexture,[fe,xe]=U instanceof Wt||ie?[{},y]:m.stencilConfigForOverlap(y),be=xe[xe.length-1].overscaledZ,we=!m.options.moving;for(const Se of xe){const ne=ie?r.DepthMode.disabled:m.depthModeForSublayer(Se.overscaledZ-be,f.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,L.LESS),ve=Se.toUnwrapped(),Pe=c.getTile(Se);if(ie&&(!Pe||!Pe.hasData()))continue;const ke=ie?Se.projMatrix:m.transform.calculateProjMatrix(ve,we),$e=m.terrain&&ie?m.terrain.stencilModeForRTTOverlap(Se):fe[Se.overscaledZ],tt=B?0:f.paint.get("raster-fade-duration");Pe.registerFadeDuration(tt);const et=c.findLoadedParent(Se,0),ct=cg(Pe,et,c,m.transform,tt);let lt,vt;m.terrain&&m.terrain.prepareDrawTile();const Zt=f.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;R.activeTexture.set(L.TEXTURE0),Pe.texture.bind(Zt,L.CLAMP_TO_EDGE),R.activeTexture.set(L.TEXTURE1),et?(et.texture.bind(Zt,L.CLAMP_TO_EDGE),lt=Math.pow(2,et.tileID.overscaledZ-Pe.tileID.overscaledZ),vt=[Pe.tileID.canonical.x*lt%1,Pe.tileID.canonical.y*lt%1]):Pe.texture.bind(Zt,L.CLAMP_TO_EDGE),Pe.texture.useMipmap&&R.extTextureFilterAnisotropic&&m.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const At=_g(ke,vt||[0,0],lt||1,ct,f,U instanceof Wt?U.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(R,j,ve),U instanceof Wt)U.boundsBuffer&&U.boundsSegments&&j.draw(R,L.TRIANGLES,ne,r.StencilMode.disabled,Y,r.CullFaceMode.disabled,At,f.id,U.boundsBuffer,m.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:zt,tileBoundsIndexBuffer:bt,tileBoundsSegments:Jt}=m.getTileBoundsBuffers(Pe);j.draw(R,L.TRIANGLES,ne,$e,Y,r.CullFaceMode.disabled,At,f.id,zt,bt,Jt)}}m.resetStencilClippingMasks()},background:function(m,c,f,y){const w=f.paint.get("background-color"),B=f.paint.get("background-opacity");if(B===0)return;const R=m.context,L=R.gl,U=m.transform,j=U.tileSize,Y=f.paint.get("background-pattern");if(m.isPatternMissing(Y))return;const ie=!Y&&w.a===1&&B===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ie)return;const fe=r.StencilMode.disabled,xe=m.depthModeForSublayer(0,ie==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),be=m.colorModeForRenderPass(),we=m.useProgram(Y?"backgroundPattern":"background");let Se,ne=y;ne||(Se=m.getBackgroundTiles(),ne=Object.values(Se).map(ve=>ve.tileID)),Y&&(R.activeTexture.set(L.TEXTURE0),m.imageManager.bind(m.context));for(const ve of ne){const Pe=ve.toUnwrapped(),ke=y?ve.projMatrix:m.transform.calculateProjMatrix(Pe);m.prepareDrawTile();const $e=c?c.getTile(ve):Se?Se[ve.key]:new r.Tile(ve,j,U.zoom,m),tt=Y?H1(ke,B,m,Y,{tileID:ve,tileSize:j}):vg(ke,B,w);m.prepareDrawProgram(R,we,Pe);const{tileBoundsBuffer:et,tileBoundsIndexBuffer:ct,tileBoundsSegments:lt}=m.getTileBoundsBuffers($e);we.draw(R,L.TRIANGLES,xe,fe,be,r.CullFaceMode.disabled,tt,f.id,et,ct,lt)}},sky:function(m,c,f){const y=m.transform,w=y.projection.name==="mercator"||y.projection.name==="globe"?1:r.smoothstep(7,8,y.zoom),B=f.paint.get("sky-opacity")*w;if(B===0)return;const R=m.context,L=f.paint.get("sky-type"),U=new r.DepthMode(R.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),j=m.frameCounter/1e3%1;L==="atmosphere"?m.renderPass==="offscreen"?f.needsSkyboxCapture(m)&&(function(Y,ie,fe,xe){const be=Y.context,we=be.gl;let Se=ie.skyboxFbo;if(!Se){Se=ie.skyboxFbo=be.createFramebuffer(32,32,!1),ie.skyboxGeometry=new bf(be),ie.skyboxTexture=be.gl.createTexture(),we.bindTexture(we.TEXTURE_CUBE_MAP,ie.skyboxTexture),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MAG_FILTER,we.LINEAR);for(let ke=0;ke<6;++ke)we.texImage2D(we.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,we.RGBA,32,32,0,we.RGBA,we.UNSIGNED_BYTE,null)}be.bindFramebuffer.set(Se.framebuffer),be.viewport.set([0,0,32,32]);const ne=ie.getCenter(Y,!0),ve=Y.useProgram("skyboxCapture"),Pe=new Float64Array(16);r.identity(Pe),r.rotateY(Pe,Pe,.5*-Math.PI),to(be,ie,ve,Pe,ne,0),r.identity(Pe),r.rotateY(Pe,Pe,.5*Math.PI),to(be,ie,ve,Pe,ne,1),r.identity(Pe),r.rotateX(Pe,Pe,.5*-Math.PI),to(be,ie,ve,Pe,ne,2),r.identity(Pe),r.rotateX(Pe,Pe,.5*Math.PI),to(be,ie,ve,Pe,ne,3),r.identity(Pe),to(be,ie,ve,Pe,ne,4),r.identity(Pe),r.rotateY(Pe,Pe,Math.PI),to(be,ie,ve,Pe,ne,5),be.viewport.set([0,0,Y.width,Y.height])}(m,f),f.markSkyboxValid(m)):m.renderPass==="sky"&&function(Y,ie,fe,xe,be){const we=Y.context,Se=we.gl,ne=Y.transform,ve=Y.useProgram("skybox");we.activeTexture.set(Se.TEXTURE0),Se.bindTexture(Se.TEXTURE_CUBE_MAP,ie.skyboxTexture);const Pe=((ke,$e,tt,et,ct)=>({u_matrix:ke,u_sun_direction:$e,u_cubemap:0,u_opacity:et,u_temporal_offset:ct}))(ne.skyboxMatrix,ie.getCenter(Y,!1),0,xe,be);Y.prepareDrawProgram(we,ve),ve.draw(we,Se.TRIANGLES,fe,r.StencilMode.disabled,Y.colorModeForRenderPass(),r.CullFaceMode.backCW,Pe,"skybox",ie.skyboxGeometry.vertexBuffer,ie.skyboxGeometry.indexBuffer,ie.skyboxGeometry.segment)}(m,f,U,B,j):L==="gradient"&&m.renderPass==="sky"&&function(Y,ie,fe,xe,be){const we=Y.context,Se=we.gl,ne=Y.transform,ve=Y.useProgram("skyboxGradient");ie.skyboxGeometry||(ie.skyboxGeometry=new bf(we)),we.activeTexture.set(Se.TEXTURE0);let Pe=ie.colorRampTexture;Pe||(Pe=ie.colorRampTexture=new r.Texture(we,ie.colorRamp,Se.RGBA)),Pe.bind(Se.LINEAR,Se.CLAMP_TO_EDGE);const ke=(($e,tt,et,ct,lt)=>({u_matrix:$e,u_color_ramp:0,u_center_direction:tt,u_radius:r.degToRad(et),u_opacity:ct,u_temporal_offset:lt}))(ne.skyboxMatrix,ie.getCenter(Y,!1),ie.paint.get("sky-gradient-radius"),xe,be);Y.prepareDrawProgram(we,ve),ve.draw(we,Se.TRIANGLES,fe,r.StencilMode.disabled,Y.colorModeForRenderPass(),r.CullFaceMode.backCW,ke,"skyboxGradient",ie.skyboxGeometry.vertexBuffer,ie.skyboxGeometry.indexBuffer,ie.skyboxGeometry.segment)}(m,f,U,B,j)},debug:function(m,c,f){for(let y=0;y<f.length;y++)K1(m,c,f[y])},custom:function(m,c,f,y){const w=m.context,B=f.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&f.isLayerDraped()){if(m.renderPass==="offscreen"){const R=B.prerender;if(R){if(m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const L=m.transform.pointMerc;R.call(B,w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(m.transform.zoom),[L.x,L.y],m.transform.pixelsPerMeterRatio)}else R.call(B,w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const L=B.renderToTile;if(L){const U=y[0].canonical,j=new r.MercatorCoordinate(U.x+y[0].wrap*(1<<U.z),U.y,U.z);w.setDepthMode(r.DepthMode.disabled),w.setStencilMode(r.StencilMode.disabled),w.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),L.call(B,w.gl,j),w.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),w.setStencilMode(r.StencilMode.disabled);const R=B.renderingMode==="3d"?new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,r.DepthMode.ReadOnly);if(w.setDepthMode(R),m.transform.projection.name==="globe"){const L=m.transform.pointMerc;B.render(w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(m.transform.zoom),[L.x,L.y],m.transform.pixelsPerMeterRatio)}else B.render(w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState(),w.bindFramebuffer.set(null)}}else r.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Zc{constructor(c,f,y=!1){this.context=new Qe(c,y),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,f){const y=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new hg(this,c));const w=this._terrain;this.transform.elevation=y?w:null,w.update(c,this.transform,f)}_updateFog(c){const f=c.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,w]=f.getFovAdjustedRange(this.transform._fov);if(y>w)return void(this.transform.fogCullDistSq=null);const B=y+.78*(w-y);this.transform.fogCullDistSq=B*B}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,f){if(this.width=c*r.exported.devicePixelRatio,this.height=f*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const c=this.context,f=new r.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(r.EXTENT,0),f.emplaceBack(0,r.EXTENT),f.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(f,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const y=new r.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(r.EXTENT,0),y.emplaceBack(0,r.EXTENT),y.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=c.createVertexBuffer(y,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const w=new r.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(w,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const B=new r.StructArrayLayout4i8;B.emplaceBack(0,0,0,0),B.emplaceBack(r.EXTENT,0,r.EXTENT,0),B.emplaceBack(0,r.EXTENT,0,r.EXTENT),B.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(B,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const R=new r.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(R);const L=new r.StructArrayLayout1ui2;for(const j of[0,1,3,2,0])L.emplaceBack(j);this.debugIndexBuffer=c.createIndexBuffer(L),this.emptyTexture=new r.Texture(c,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=r.create();const U=this.context.gl;this.stencilClearMode=new r.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(r.window.performance.now()),this.atmosphereBuffer=new O0(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,f=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,f.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,bh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,f,y){if(!f||this.currentStencilSource===f.id||!c.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const U of y)if(this._tileClippingMaskIDs[U.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=f.id;const w=this.context,B=w.gl;this.nextStencilID+y.length>256&&this.clearStencil(),w.setColorMode(r.ColorMode.disabled),w.setDepthMode(r.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of y){const U=f.getTile(L),j=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ie,tileBoundsSegments:fe}=this.getTileBoundsBuffers(U);R.draw(w,B.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:B.ALWAYS,mask:0},j,255,B.KEEP,B.KEEP,B.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,bh(L.projMatrix),"$clipping",Y,ie,fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,f=this.context.gl;return new r.StencilMode({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const f=this.context.gl;return new r.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(c){const f=this.context.gl,y=c.sort((R,L)=>L.overscaledZ-R.overscaledZ),w=y[y.length-1].overscaledZ,B=y[0].overscaledZ-w+1;if(B>1){this.currentStencilSource=void 0,this.nextStencilID+B>256&&this.clearStencil();const R={};for(let L=0;L<B;L++)R[L+w]=new r.StencilMode({func:f.GEQUAL,mask:255},L+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=B,[R,y]}return[{[w]:r.StencilMode.disabled},y]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([c.CONSTANT_COLOR,c.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(c,f,y){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new r.DepthMode(y||this.context.gl.LEQUAL,f,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,f){this.style=c,this.options=f,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const y=this.style.order,w=this.style._sourceCaches;for(const j in w){const Y=w[j];Y.used&&Y.prepare(this.context)}const B={},R={},L={};for(const j in w){const Y=w[j];B[j]=Y.getVisibleCoordinates(),R[j]=B[j].slice().reverse(),L[j]=Y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let j=0;j<y.length;j++)if(this.style._layers[y[j]].is3D()){this.opaquePassCutoff=j;break}if(this.terrain&&(this.terrain.updateTileBinding(L),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),!r.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const j of y){const Y=this.style._layers[j],ie=c._getLayerSourceCache(Y);if(!Y.hasOffscreenPass()||Y.isHidden(this.transform.zoom))continue;const fe=ie?R[ie.id]:void 0;(Y.type==="custom"||Y.isSky()||fe&&fe.length)&&this.renderLayer(this,ie,Y,fe)}this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const j=this.style._layers[y[this.currentLayer]],Y=c._getLayerSourceCache(j);if(j.isSky())continue;const ie=Y?R[Y.id]:void 0;this._renderTileClippingMasks(j,Y,ie),this.renderLayer(this,Y,j,ie)}if(this.style.fog&&this.transform.projection.supportsFog&&function(j,Y){const ie=j.context,fe=ie.gl,xe=j.transform,be=new r.DepthMode(fe.LEQUAL,r.DepthMode.ReadOnly,[0,1]),we=j.useProgram("globeAtmosphere",null,xe.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Se=r.globeToMercatorTransition(xe.zoom),ne=Y.properties.get("color").toArray01(),ve=Y.properties.get("high-color").toArray01(),Pe=Y.properties.get("space-color").toArray01PremultipliedAlpha(),ke=r.identity$1([]);r.rotateY$1(ke,ke,-r.degToRad(xe._center.lng)),r.rotateX$1(ke,ke,r.degToRad(xe._center.lat)),r.rotateZ$1(ke,ke,xe.angle),r.rotateX$1(ke,ke,-xe._pitch);const $e=r.fromQuat(new Float32Array(16),ke),tt=r.mapValue(Y.properties.get("star-intensity"),0,1,0,.25),et=5e-4,ct=r.mapValue(Y.properties.get("horizon-blend"),0,1,et,.25),lt=r.globeUseCustomAntiAliasing(j,ie,xe)&&ct===et?xe.worldSize/(2*Math.PI*1.025)-1:xe.globeRadius,vt=j.frameCounter/1e3%1,Zt=r.length(xe.globeCenterInViewSpace),At=Math.sqrt(Math.pow(Zt,2)-Math.pow(lt,2)),zt=Math.acos(At/Zt),bt=((_t,Nt,ei,jt,ti,bi,Ni,Ii,Ti,en,Ji,wi,yn,Sn)=>({u_frustum_tl:_t,u_frustum_tr:Nt,u_frustum_br:ei,u_frustum_bl:jt,u_horizon:ti,u_transition:bi,u_fadeout_range:Ni,u_color:Ii,u_high_color:Ti,u_space_color:en,u_star_intensity:Ji,u_star_size:5*r.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:wi,u_horizon_angle:yn,u_rotation_matrix:Sn}))(xe.frustumCorners.TL,xe.frustumCorners.TR,xe.frustumCorners.BR,xe.frustumCorners.BL,xe.frustumCorners.horizon,Se,ct,ne,ve,Pe,tt,vt,zt,$e);j.prepareDrawProgram(ie,we);const Jt=j.atmosphereBuffer;Jt&&we.draw(ie,fe.TRIANGLES,be,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,bt,"skybox",Jt.vertexBuffer,Jt.indexBuffer,Jt.segments)}(this,this.style.fog),this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const j=this.style._layers[y[this.currentLayer]],Y=c._getLayerSourceCache(j);j.isSky()&&this.renderLayer(this,Y,j,Y?R[Y.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const j=this.style._layers[y[this.currentLayer]],Y=c._getLayerSourceCache(j);if(j.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(j)){if(j.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ie=Y?(j.type==="symbol"?L:R)[Y.id]:void 0;this._renderTileClippingMasks(j,Y,Y?B[Y.id]:void 0),this.renderLayer(this,Y,j,ie),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let j=null;r.values(this.style._layers).forEach(Y=>{const ie=c._getLayerSourceCache(Y);ie&&!Y.isHidden(this.transform.zoom)&&(!j||j.getSource().maxzoom<ie.getSource().maxzoom)&&(j=ie)}),j&&this.options.showTileBoundaries&&Vl.debug(this,j,j.getVisibleCoordinates())}this.options.showPadding&&function(j){const Y=j.transform.padding;N0(j,j.transform.height-(Y.top||0),3,Jc),N0(j,Y.bottom||0,3,W1),wf(j,Y.left||0,3,Y1),wf(j,j.transform.width-(Y.right||0),3,j1);const ie=j.transform.centerPoint;(function(fe,xe,be,we){Xc(fe,xe-1,be-10,2,20,we),Xc(fe,xe-10,be-1,20,2,we)})(j,ie.x,j.transform.height-ie.y,q1)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}renderLayer(c,f,y,w){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||w&&w.length)&&(this.id=y.id,this.gpuTimingStart(y),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(y.type)||c.terrain&&y.type==="custom")&&Vl[y.type](c,f,y,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let y=this.gpuTimers[c.id];y||(y=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),y.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,f=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),c.beginQueryEXT(c.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const f={};for(const y in c){const w=c[y],B=this.context.extTimerQuery,R=B.getQueryObjectEXT(w.query,B.QUERY_RESULT_EXT)/1e6;B.deleteQueryEXT(w.query),f[y]=R}return f}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let y=0;for(const w of c)y+=f.getQueryObjectEXT(w,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(w);return y}translatePosMatrix(c,f,y,w,B){if(!y[0]&&!y[1])return c;const R=B?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(R){const j=Math.sin(R),Y=Math.cos(R);y=[y[0]*Y-y[1]*j,y[0]*j+y[1]*Y]}const L=[B?y[0]:Tt(f,y[0],this.transform.zoom),B?y[1]:Tt(f,y[1],this.transform.zoom),0],U=new Float32Array(16);return r.translate(U,c,L),U}saveTileTexture(c){const f=this._tileTextures[c.size[0]];f?f.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const f=this._tileTextures[c];return f&&f.length>0?f.pop():null}isPatternMissing(c){return c===null||c!==void 0&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&this.terrain.exaggeration()===0,y=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),this.transform.projection.name==="globe"&&w.push("GLOBE"),f&&w.push("ZERO_EXAGGERATION"),y&&!c&&y.getOpacity(this.transform.pitch)!==0&&w.push("FOG"),c&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(c,f,y){this.cache=this.cache||{};const w=y||[],B=this.currentGlobalDefines().concat(w),R=an.cacheKey(sg[c],c,B,f);return this.cache[R]||(this.cache[R]=new an(this.context,c,sg[c],f,xg[c],B)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,f,y){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const B=w.getOpacity(this.transform.pitch),R=((L,U,j,Y,ie,fe,xe,be,we,Se,ne)=>{const ve=L.transform,Pe=U.properties.get("color").toArray01();Pe[3]=Y;const ke=L.frameCounter/1e3%1;return{u_fog_matrix:j?ve.calculateFogTileMatrix(j):L.identityMat,u_fog_range:U.getFovAdjustedRange(ve._fov),u_fog_color:Pe,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:ke,u_frustum_tl:ie,u_frustum_tr:fe,u_frustum_br:xe,u_frustum_bl:be,u_globe_pos:we,u_globe_radius:Se,u_viewport:ne,u_globe_transition:r.globeToMercatorTransition(ve.zoom),u_is_globe:+(ve.projection.name==="globe")}})(this,w,y,B,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.exported.devicePixelRatio,this.transform.height*r.exported.devicePixelRatio]);f.setFogUniformValues(c,R)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,f=c.createTexture();return c.bindTexture(c.TEXTURE_2D,f),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&c.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const c=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const w of y)f[w.key]=c[w.key]||new r.Tile(w,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class Bf{constructor(c=0,f=0,y=0,w=0){if(isNaN(c)||c<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=y,this.right=w}interpolate(c,f,y){return f.top!=null&&c.top!=null&&(this.top=r.number(c.top,f.top,y)),f.bottom!=null&&c.bottom!=null&&(this.bottom=r.number(c.bottom,f.bottom,y)),f.left!=null&&c.left!=null&&(this.left=r.number(c.left,f.left,y)),f.right!=null&&c.right!=null&&(this.right=r.number(c.right,f.right,y)),this}getCenter(c,f){const y=r.clamp((this.left+c-this.right)/2,0,c),w=r.clamp((this.top+f-this.bottom)/2,0,f);return new r.Point(y,w)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Bf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Sf(m,c){const f=r.getColumn(m,3);r.fromQuat(m,c),r.setColumn(m,3,f)}function un(m,c){const f=r.identity$1([]);return r.rotateZ$1(f,f,-c),r.rotateX$1(f,f,-m),f}function Rh(m,c){const f=[m[0],m[1],0],y=[c[0],c[1],0];if(r.length(f)>=1e-15){const R=r.normalize([],f);r.scale$2(y,R,r.dot(y,R)),c[0]=y[0],c[1]=y[1]}const w=r.cross([],c,m);if(r.len(w)<1e-15)return null;const B=Math.atan2(-w[1],w[0]);return un(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),B)}class G0{constructor(c,f){this.position=c,this.orientation=f}get position(){return this._position}set position(c){if(c){const f=c instanceof r.MercatorCoordinate?c:new r.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(f.x=r.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(c,f){if(this.orientation=null,!this.position)return;const y=this.position,w=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(c)):0,B=r.MercatorCoordinate.fromLngLat(c,w),R=[B.x-y.x,B.y-y.y,B.z-y.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Rh(R,f)}setPitchBearing(c,f){this.orientation=un(r.degToRad(c),r.degToRad(-f))}}class Mf{constructor(c,f){this._transform=r.identity([]),this.orientation=f,this.position=c}get mercatorPosition(){const c=this.position;return new r.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=r.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var f;c&&r.setColumn(this._transform,3,[(f=c)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||r.identity$1([]),c&&Sf(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,f){this._orientation=un(c,f),Sf(this._transform,this._orientation)}forward(){const c=r.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=r.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=r.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,f){const y=new Float64Array(16);return r.invert(y,this.getWorldToCamera(c,f)),y}getWorldToCameraPosition(c,f,y){const w=this.position;r.scale$2(w,w,-c);const B=new Float64Array(16);return r.fromScaling(B,[y,y,y]),r.translate(B,B,w),B[10]*=f,B}getWorldToCamera(c,f){const y=new Float64Array(16),w=new Float64Array(4),B=this.position;return r.conjugate(w,this._orientation),r.scale$2(B,B,-c),r.fromQuat(y,w),r.translate(y,y,B),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(c,f,y,w){const B=new Float64Array(16);return r.perspective(B,c,f,y,w),B}getDistanceToElevation(c,f=!1){const y=c===0?0:r.mercatorZfromAltitude(c,f?r.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(y-this.position[2])/w[2]}clone(){return new Mf([...this.position],[...this.orientation])}}function $c(m,c){const f=Tf(m.projection,m.zoom,m.width,m.height),y=function(B,R,L,U,j){const Y=new r.LngLat(L.lng-180*Ma,L.lat),ie=new r.LngLat(L.lng+180*Ma,L.lat),fe=B.project(Y.lng,Y.lat),xe=B.project(ie.lng,ie.lat),be=-Math.atan2(xe.y-fe.y,xe.x-fe.x),we=r.MercatorCoordinate.fromLngLat(L);we.y=r.clamp(we.y,-1+Ma,1-Ma);const Se=we.toLngLat(),ne=B.project(Se.lng,Se.lat),ve=r.MercatorCoordinate.fromLngLat(Se);ve.x+=Ma;const Pe=ve.toLngLat(),ke=B.project(Pe.lng,Pe.lat),$e=Df(ke.x-ne.x,ke.y-ne.y,be),tt=r.MercatorCoordinate.fromLngLat(Se);tt.y+=Ma;const et=tt.toLngLat(),ct=B.project(et.lng,et.lat),lt=Df(ct.x-ne.x,ct.y-ne.y,be),vt=Math.abs($e.x)/Math.abs(lt.y),Zt=r.identity([]);r.rotateZ(Zt,Zt,-be*(1-(j?0:U)));const At=r.identity([]);return r.scale(At,At,[1,1-(1-vt)*U,1]),At[4]=-lt.x/lt.y*U,r.rotateZ(At,At,be),r.multiply(At,Zt,At),At}(m.projection,0,m.center,f,c),w=H0(m);return r.scale(y,y,[w,w,1]),y}function H0(m){const c=m.projection,f=Tf(m.projection,m.zoom,m.width,m.height),y=V0(c,m.center),w=V0(c,r.LngLat.convert(c.center));return Math.pow(2,y*f+(1-f)*w)}function Tf(m,c,f,y,w=1/0){const B=m.range;if(!B)return 0;const R=Math.min(w,Math.max(f,y)),L=Math.log(R/1024)/Math.LN2;return r.smoothstep(B[0]+L,B[1]+L,c)}const Ma=1/4e4;function V0(m,c){const f=r.clamp(c.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=new r.LngLat(c.lng-180*Ma,f),w=new r.LngLat(c.lng+180*Ma,f),B=m.project(y.lng,f),R=m.project(w.lng,f),L=r.MercatorCoordinate.fromLngLat(y),U=r.MercatorCoordinate.fromLngLat(w),j=R.x-B.x,Y=R.y-B.y,ie=U.x-L.x,fe=U.y-L.y,xe=Math.sqrt((ie*ie+fe*fe)/(j*j+Y*Y));return Math.log(xe)/Math.LN2}function Df(m,c,f){const y=Math.cos(f),w=Math.sin(f);return{x:m*y-c*w,y:m*w+c*y}}class eu{constructor(c,f,y,w,B,R,L){this.tileSize=512,this._renderWorldCopies=B===void 0||B,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=w??60,this.setProjection(R),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Mf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new eu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,f=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(c||y)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=r.getProjection(this.projectionOptions);const y=!p(f,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.getProjection({name:"mercator"});const f=c!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.Point(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const f=-c*Math.PI/180;var y;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(y=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(w,B,R){var L=B[0],U=B[1],j=B[2],Y=B[3],ie=Math.sin(R),fe=Math.cos(R);w[0]=L*fe+j*ie,w[1]=U*fe+Y*ie,w[2]=L*-ie+j*fe,w[3]=U*-ie+Y*fe}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const f=r.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=r.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let w=0,B=0;for(let R=0;R<f.length;R++){const L=new r.Point(f[R][0]*this.width,y+f[R][1]*(this.height-y)),U=c.pointCoordinate(L);if(!U)continue;const j=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);w+=U[3]*j,B+=j}return B===0?NaN:w/B}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const c=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,w=this._mercatorZfromZoom(c),B=this._mercatorZfromZoom(this._maxZoom),R=Math.max(w-y,B);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let y;y=c.z<this._camera.position[2]?[f.x,f.y,f.z]:[c.x,c.y,c.z];const w=r.length(r.sub([],this._camera.position,y));return r.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let f=!1;if(c.orientation&&!r.exactEquals(c.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(c.orientation)),c.position){const y=[c.position.x,c.position.y,c.position.z];r.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,f=new G0;return f.position=new r.MercatorCoordinate(c[0],c[1],c[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(c){if(!r.length$1(c))return!1;r.normalize$1(c,c);const f=r.transformQuat([],[0,0,-1],c),y=r.transformQuat([],[0,-1,0],c);if(y[2]<0)return!1;const w=Rh(f,y);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(c){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;c[2]=r.clamp(c[2],w/y,w/f),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,f,y){this._unmodified=!1,this._edgeInsets.interpolate(c,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(c){const f=[new r.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const y=this.pointCoordinate(new r.Point(0,0)),w=this.pointCoordinate(new r.Point(this.width,0)),B=this.pointCoordinate(new r.Point(this.width,this.height)),R=this.pointCoordinate(new r.Point(0,this.height)),L=Math.floor(Math.min(y.x,w.x,B.x,R.x)),U=Math.floor(Math.max(y.x,w.x,B.x,R.x)),j=1;for(let Y=L-j;Y<=U+j;Y++)Y!==0&&f.push(new r.UnwrappedTileID(Y,c))}return f}coveringTiles(c){let f=this.coveringZoomLevel(c);const y=f,w=this.elevation&&!c.isTerrainDEM,B=this.projection.name==="mercator";if(c.minzoom!==void 0&&f<c.minzoom)return[];c.maxzoom!==void 0&&f>c.maxzoom&&(f=c.maxzoom);const R=this.locationCoordinate(this.center),L=this.center.lat,U=1<<f,j=[U*R.x,U*R.y,0],Y=this.projection.name==="globe",ie=!Y,fe=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,ie),xe=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),be=U*r.mercatorZfromAltitude(1,this.center.lat),we=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),Se=[U*xe.x,U*xe.y,we*(ie?1:be)],ne=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),ve=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,Pe=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ke=c.isTerrainDEM?-Pe:this._elevation?this._elevation.getMinElevationBelowMSL():0,$e=this.projection.isReprojectedInTileSpace?H0(this):1,tt=_t=>{const ei=new r.MercatorCoordinate(_t.x+25e-6,_t.y,_t.z),jt=new r.MercatorCoordinate(_t.x,_t.y+25e-6,_t.z),ti=_t.toLngLat(),bi=ei.toLngLat(),Ni=jt.toLngLat(),Ii=this.locationCoordinate(ti),Ti=this.locationCoordinate(bi),en=this.locationCoordinate(Ni),Ji=Math.hypot(Ti.x-Ii.x,Ti.y-Ii.y),wi=Math.hypot(en.x-Ii.x,en.y-Ii.y);return Math.sqrt(Ji*wi)*$e/25e-6},et=_t=>{const Nt=Pe,ei=ke;return{aabb:r.tileAABB(this,U,0,0,0,_t,ei,Nt,this.projection),zoom:0,x:0,y:0,minZ:ei,maxZ:Nt,wrap:_t,fullyVisible:!1}},ct=[];let lt=[];const vt=f,Zt=c.reparseOverscaled?y:f,At=_t=>_t*_t,zt=At((we-this._centerAltitude)*be),bt=_t=>{if(!this._elevation||!_t.tileID||!B)return;const Nt=this._elevation.getMinMaxForTile(_t.tileID),ei=_t.aabb;Nt?(ei.min[2]=Nt.min,ei.max[2]=Nt.max,ei.center[2]=(ei.min[2]+ei.max[2])/2):(_t.shouldSplit=Jt(_t),_t.shouldSplit||(ei.min[2]=ei.max[2]=ei.center[2]=this._centerAltitude))},Jt=_t=>{if(_t.zoom<ve)return!0;if(_t.zoom===vt)return!1;if(_t.shouldSplit!=null)return _t.shouldSplit;const Nt=_t.aabb.distanceX(Se),ei=_t.aabb.distanceY(Se);let jt=zt,ti=1;if(Y){jt=At(_t.aabb.distanceZ(Se));const Ii=Math.pow(2,_t.zoom),Ti=r.latFromMercatorY((_t.y+1)/Ii),en=r.latFromMercatorY(_t.y/Ii),Ji=Math.min(Math.max(L,Ti),en),wi=r.circumferenceAtLatitude(Ji)/r.circumferenceAtLatitude(L);if(ti=Ji===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,wi/this._mercatorScaleRatio),this.zoom<=r.GLOBE_ZOOM_THRESHOLD_MIN&&_t.zoom===vt-1&&wi>=.9)return!0}else if(w&&(jt=At(_t.aabb.distanceZ(Se)*be)),this.projection.isReprojectedInTileSpace&&y<=5){const Ii=Math.pow(2,_t.zoom),Ti=tt(new r.MercatorCoordinate((_t.x+.5)/Ii,(_t.y+.5)/Ii));ti=Ti>.85?1:Ti}const bi=Nt*Nt+ei*ei+jt,Ni=At((1<<vt-_t.zoom)*ne*ti*((Ii,Ti)=>{if(Ti*At(.707)<Ii)return 1;const en=Math.sqrt(Ti/Ii);return en/(1.4144271570014144+(Math.pow(1.1,en-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(jt,zt),bi));return bi<Ni};if(this.renderWorldCopies)for(let _t=1;_t<=3;_t++)ct.push(et(-_t)),ct.push(et(_t));for(ct.push(et(0));ct.length>0;){const _t=ct.pop(),Nt=_t.x,ei=_t.y;let jt=_t.fullyVisible;if(!jt){const ti=_t.aabb.intersects(fe);if(ti===0)continue;jt=ti===2}if(_t.zoom!==vt&&Jt(_t))for(let ti=0;ti<4;ti++){const bi=(Nt<<1)+ti%2,Ni=(ei<<1)+(ti>>1),Ii={aabb:B?_t.aabb.quadrant(ti):r.tileAABB(this,U,_t.zoom+1,bi,Ni,_t.wrap,_t.minZ,_t.maxZ,this.projection),zoom:_t.zoom+1,x:bi,y:Ni,wrap:_t.wrap,fullyVisible:jt,tileID:void 0,shouldSplit:void 0,minZ:_t.minZ,maxZ:_t.maxZ};w&&!Y&&(Ii.tileID=new r.OverscaledTileID(_t.zoom+1===vt?Zt:_t.zoom+1,_t.wrap,_t.zoom+1,bi,Ni),bt(Ii)),ct.push(Ii)}else{const ti=_t.zoom===vt?Zt:_t.zoom;if(c.minzoom&&c.minzoom>ti)continue;const bi=j[0]-(.5+Nt+(_t.wrap<<_t.zoom))*(1<<f-_t.zoom),Ni=j[1]-.5-ei,Ii=_t.tileID?_t.tileID:new r.OverscaledTileID(ti,_t.wrap,_t.zoom,Nt,ei);lt.push({tileID:Ii,distanceSq:bi*bi+Ni*Ni})}}if(this.fogCullDistSq){const _t=this.fogCullDistSq,Nt=this.horizonLineFromTop();lt=lt.filter(ei=>{const jt=[0,0,0,1],ti=[r.EXTENT,r.EXTENT,0,1],bi=this.calculateFogTileMatrix(ei.tileID.toUnwrapped());r.transformMat4$1(jt,jt,bi),r.transformMat4$1(ti,ti,bi);const Ni=r.getAABBPointSquareDist(jt,ti);if(Ni===0)return!0;let Ii=!1;const Ti=this._elevation;if(Ti&&Ni>_t&&Nt!==0){const en=this.calculateProjMatrix(ei.tileID.toUnwrapped());let Ji;c.isTerrainDEM||(Ji=Ti.getMinMaxForTile(ei.tileID)),Ji||(Ji={min:ke,max:Pe});const wi=r.furthestTileCorner(this.rotation),yn=[wi[0]*r.EXTENT,wi[1]*r.EXTENT,Ji.max];r.transformMat4(yn,yn,en),Ii=(1-yn[1])*this.height*.5<Nt}return Ni<_t||Ii})}return lt.sort((_t,Nt)=>_t.distanceSq-Nt.distanceSq).map(_t=>_t.tileID)}resize(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const f=r.clamp(c.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=this.projection.project(c.lng,f);return new r.Point(y.x*this.worldSize,y.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,f){let y,w;const B=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;y=(f.x-B.x)/L,w=(f.y-B.y)/L}else{const L=this.pointCoordinate(f),U=this.pointCoordinate(B);y=L.x-U.x,w=L.y-U.y}const R=this.locationCoordinate(c);this.setLocation(new r.MercatorCoordinate(R.x-y,R.y-w))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,f){const y=f?r.mercatorZfromAltitude(f,c.lat):void 0,w=this.projection.project(c.lng,c.lat);return new r.MercatorCoordinate(w.x,w.y,y)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,f){const y=f??this._centerAltitude,w=[c.x,c.y,0,1],B=[c.x,c.y,1,1];r.transformMat4$1(w,w,this.pixelMatrixInverse),r.transformMat4$1(B,B,this.pixelMatrixInverse);const R=B[3];r.scale$1(w,w,1/w[3]),r.scale$1(B,B,1/R);const L=w[2],U=B[2];return{p0:w,p1:B,t:L===U?0:(y-L)/(U-L)}}screenPointToMercatorRay(c){const f=[c.x,c.y,0,1],y=[c.x,c.y,1,1];return r.transformMat4$1(f,f,this.pixelMatrixInverse),r.transformMat4$1(y,y,this.pixelMatrixInverse),r.scale$1(f,f,1/f[3]),r.scale$1(y,y,1/y[3]),f[2]=r.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,y[2]=r.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,r.scale$1(f,f,1/this.worldSize),r.scale$1(y,y,1/this.worldSize),new r.Ray([f[0],f[1],f[2]],r.normalize([],r.sub([],y,f)))}rayIntersectionCoordinate(c){const{p0:f,p1:y,t:w}=c,B=r.mercatorZfromAltitude(f[2],this._center.lat),R=r.mercatorZfromAltitude(y[2],this._center.lat);return new r.MercatorCoordinate(r.number(f[0],y[0],w)/this.worldSize,r.number(f[1],y[1],w)/this.worldSize,r.number(B,R,w))}pointCoordinate(c,f=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,f)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let f=this.projection.pointCoordinate3D(this,c.x,c.y);if(f)return new r.MercatorCoordinate(f[0],f[1],f[2]);let y=0,w=this.horizonLineFromTop();if(c.y>w)return this.pointCoordinate(c);const B=.02*w,R=c.clone();for(let L=0;L<10&&w-y>B;L++){R.y=r.number(y,w,.66);const U=this.projection.pointCoordinate3D(this,R.x,R.y);U?(w=R.y,f=U):y=R.y}return f?new r.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(c);const f=this.pointCoordinate(c);return f.y>=0&&f.y<=1}_coordinatePoint(c,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,w=[c.x*this.worldSize,c.y*this.worldSize,y+c.toAltitude(),1];return r.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new r.Point(w[0]/w[3],w[1]/w[3]):new r.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:f}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,B=this.pointLocation3D(new r.Point(f,c)),R=this.pointLocation3D(new r.Point(w,c)),L=this.pointLocation3D(new r.Point(w,y)),U=this.pointLocation3D(new r.Point(f,y));let j=Math.min(B.lng,R.lng,L.lng,U.lng),Y=Math.max(B.lng,R.lng,L.lng,U.lng),ie=Math.min(B.lat,R.lat,L.lat,U.lat),fe=Math.max(B.lat,R.lat,L.lat,U.lat);const xe=Math.pow(2,-this.zoom)/16*270,be=this.projection.name==="globe"?1:4,we=(Se,ne,ve,Pe,ke)=>{const $e=(Se+ve)/2,tt=(ne+Pe)/2,et=new r.Point($e,tt),{lng:ct,lat:lt}=this.pointLocation3D(et),vt=Math.max(0,j-ct,ie-lt,ct-Y,lt-fe);j=Math.min(j,ct),Y=Math.max(Y,ct),ie=Math.min(ie,lt),fe=Math.max(fe,lt),(ke<be||vt>xe)&&(we(Se,ne,$e,tt,ke+1),we($e,tt,ve,Pe,ke+1))};if(we(f,c,w,c,1),we(w,c,w,y,1),we(w,y,f,y,1),we(f,y,f,c,1),this.projection.name==="globe"){const[Se,ne]=r.polesInViewport(this);Se?(fe=90,Y=180,j=-180):ne&&(ie=-90,Y=180,j=-180)}return new r.LngLatBounds(new r.LngLat(j,ie),new r.LngLat(Y,fe))}_getBoundsRectangular(c,f){const{top:y,left:w}=this._edgeInsets,B=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,L=new r.Point(w,y),U=new r.Point(R,y),j=new r.Point(R,B),Y=new r.Point(w,B);let ie=this.pointCoordinate(L,c),fe=this.pointCoordinate(U,c);const xe=this.pointCoordinate(j,f),be=this.pointCoordinate(Y,f),we=(Se,ne)=>(ne.y-Se.y)/(ne.x-Se.x);return ie.y>1&&fe.y>=0?ie=new r.MercatorCoordinate((1-be.y)/we(be,ie)+be.x,1):ie.y<0&&fe.y<=1&&(ie=new r.MercatorCoordinate(-be.y/we(be,ie)+be.x,0)),fe.y>1&&ie.y>=0?fe=new r.MercatorCoordinate((1-xe.y)/we(xe,fe)+xe.x,1):fe.y<0&&ie.y<=1&&(fe=new r.MercatorCoordinate(-xe.y/we(xe,fe)+xe.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(xe))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=c.visibleDemTiles.reduce((y,w)=>{if(w.dem){const B=w.dem.tree;y.min=Math.min(y.min,B.minimums[0]),y.max=Math.max(y.max,B.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*c.exaggeration(),f.max*c.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return c?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,f){return this.projection.createTileMatrix(this,f,c)}calculateDistanceTileData(c){const f=c.key,y=this._distanceTileDataCache;if(y[f])return y[f];const w=c.canonical,B=1/this.height,R=this.cameraWorldSize,L=R/this.zoomScale(w.z),U=(w.x+Math.pow(2,w.z)*c.wrap)*L,j=w.y*L,Y=this.point;Y.x*=R/this.worldSize,Y.y*=R/this.worldSize;const ie=this.angle,fe=Math.sin(-ie),xe=-Math.cos(-ie);return y[f]={bearing:[fe,xe],center:[(Y.x-U)*B,(Y.y-j)*B],scale:L/r.EXTENT*B},y[f]}calculateFogTileMatrix(c){const f=c.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return r.multiply(w,this.worldToFogMatrix,w),y[f]=new Float32Array(w),y[f]}calculateProjMatrix(c,f=!1){const y=c.key,w=f?this._alignedProjMatrixCache:this._projMatrixCache;if(w[y])return w[y];const B=this.calculatePosMatrix(c,this.worldSize);return r.multiply(B,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,B),w[y]=new Float32Array(B),w[y]}calculatePixelsToTileUnitsMatrix(c){const f=c.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const w=function(B,R){const{scale:L}=B.tileTransform,U=L*r.EXTENT/(B.tileSize*Math.pow(2,R.zoom-B.tileID.overscaledZ+B.tileID.canonical.z));return j=new Float32Array(4),fe=(Y=R.inverseAdjustmentMatrix)[1],xe=Y[2],be=Y[3],Se=(ie=[U,U])[1],j[0]=Y[0]*(we=ie[0]),j[1]=fe*we,j[2]=xe*Se,j[3]=be*Se,j;var j,Y,ie,fe,xe,be,we,Se}(c,this);return y[f]=w,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const c=1/this.worldSize,f=r.fromScaling([],[c,c,c]);return r.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const c=this._elevation;this._updateCameraState();const f=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),w=this._camera.forward(),B=r.mercatorZfromAltitude(1,this._center.lat);y[2]/=B,w[2]/=B,r.normalize(w,w);const R=c.raycast(y,w,c.exaggeration());if(R){const L=r.scaleAndAdd([],y,w,R),U=new r.MercatorCoordinate(L[0],L[1],r.mercatorZfromAltitude(L[2],r.latFromMercatorY(L[1]))),j=(U.z+r.length([U.x-y[0],U.y-y[1],U.z-y[2]*B]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const f=this._elevation,y=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(y),B=f.getAtPointOrZero(new r.MercatorCoordinate(...w)),R=this.pixelsPerMeter/this.worldSize*B,L=this._minimumHeightOverTerrain(),U=w[2]-R;if(U<=L)if(U<0||c){const j=this.locationCoordinate(this._center,this._centerAltitude),Y=[w[0],w[1],j.z-w[2]],ie=r.length(Y);Y[2]-=(L-U)/this._pixelsPerMercatorPixel;const fe=r.length(Y);if(fe===0)return;r.scale$2(Y,Y,ie/fe*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],j.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const fe=this.center;return fe.lat=r.clamp(fe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(fe.lng=r.clamp(fe.lng,this.minLng,this.maxLng)),this.center=fe,void(this._constraining=!1)}const f=this._unmodified,{x:y,y:w}=this.point;let B=0,R=y,L=w;const U=this.width/2,j=this.height/2,Y=this.worldMinY*this.scale,ie=this.worldMaxY*this.scale;if(w-j<Y&&(L=Y+j),w+j>ie&&(L=ie-j),ie-Y<this.height&&(B=Math.max(B,this.height/(ie-Y)),L=(ie+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const fe=this.worldMinX*this.scale,xe=this.worldMaxX*this.scale,be=this.worldSize/2-(fe+xe)/2;R=(y+be+this.worldSize)%this.worldSize-be,R-U<fe&&(R=fe+U),R+U>xe&&(R=xe-U),xe-fe<this.width&&(B=Math.max(B,this.width/(xe-fe)),R=(xe+fe)/2)}R===y&&L===w||(this.center=this.unproject(new r.Point(R,L))),B&&(this.zoom+=this.scaleZoom(B)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.mercatorZfromAltitude(1,this.center.lat)/r.mercatorZfromAltitude(1,r.GLOBE_SCALE_MATCH_LATITUDE));const y=Tf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?f:1,B=this._camera.getWorldToCamera(this.worldSize,w),R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);R[8]=2*-c.x/this.width,R[9]=2*c.y/this.height;let L=r.mul([],R,B);if(this.projection.isReprojectedInTileSpace){const tt=this.locationCoordinate(this.center),et=r.identity([]);r.translate(et,et,[tt.x*this.worldSize,tt.y*this.worldSize,0]),r.multiply(et,et,$c(this)),r.translate(et,et,[-tt.x*this.worldSize,-tt.y*this.worldSize,0]),r.multiply(L,L,et),this.inverseAdjustmentMatrix=function(ct){const lt=$c(ct,!0);return W([],[lt[0],lt[1],lt[4],lt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],L,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=L,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const U=r.invert([],R);this.frustumCorners=r.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const j=new Float32Array(16);r.identity(j),r.scale(j,j,[1,-1,1]),r.rotateX(j,j,this._pitch),r.rotateZ(j,j,this.angle);const Y=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ie=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-c.x/this.width,Y[9]=2*(c.y+ie)/this.height,this.skyboxMatrix=r.multiply(j,Y,j);const fe=this.point,xe=fe.x,be=fe.y,we=this.width%2/2,Se=this.height%2/2,ne=Math.cos(this.angle),ve=Math.sin(this.angle),Pe=xe-Math.round(xe)+ne*we+ve*Se,ke=be-Math.round(be)+ne*Se+ve*we,$e=new Float64Array(L);if(r.translate($e,$e,[Pe>.5?Pe-1:Pe,ke>.5?ke-1:ke,0]),this.alignedProjMatrix=$e,L=r.create(),r.scale(L,L,[this.width/2,-this.height/2,1]),r.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=r.create(),r.scale(L,L,[1,-1,1]),r.translate(L,L,[-1,-1,0]),r.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},L=r.invert(new Float64Array(16),this.pixelMatrix),!L)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=L,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.calculateGlobeMatrix(this);const tt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.transformMat4(tt,tt,B),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=L;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,y=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,B=[c,c,f];r.scale$2(B,B,w),r.scale$2(y,y,-1),r.multiply$2(y,y,B);const R=r.create();r.translate(R,R,y),r.scale(R,R,B),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,f,w)}_computeCameraPosition(c){const f=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),w=this.point,B=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-c/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-y[0]*B,w.y/this.worldSize-y[1]*B,c/this.worldSize*this._centerAltitude-y[2]*B]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],w=c[2];let B=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(B=Math.min((f-y)/w,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,c,B),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:w}=this._camera.getPitchBearing(),B=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),L=Math.max((c[2]-B)/Math.cos(y),R),U=this._zoomFromMercatorZ(L);r.scaleAndAdd(c,c,f,L),this._pitch=r.clamp(y,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(w,-Math.PI,Math.PI),this._setZoom(r.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let f=0,y=r.GLOBE_ZOOM_THRESHOLD_MAX,w=0,B=1/0;for(;y-f>1e-6&&y>f;){const R=f+.5*(y-f),L=this.tileSize*Math.pow(2,R),U=this.getCameraToCenterDistance(this.projection,R,L),j=this.scaleZoom(U/(c*this.tileSize)),Y=Math.abs(R-j);Y<B&&(B=Y,w=R),R<j?f=R:y=R}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,f){const y=Math.min(c.x,f.x),w=Math.max(c.x,f.x),B=Math.min(c.y,f.y),R=Math.max(c.y,f.y);if(B<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new r.Point(y,B),new r.Point(w,R),new r.Point(y,R),new r.Point(w,B)],U=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const Y of L){const ie=this.pointRayIntersection(Y);if(ie.t<0)return!0;const fe=this.rayIntersectionCoordinate(ie);if(fe.x<U||fe.y<0||fe.x>j||fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.Point(0,0),new r.Point(this.width,this.height))}zoomDeltaToMovement(c,f){const y=r.length(r.sub([],this._camera.position,c)),w=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const c=function([f,y,w],B){const R=[f,y,w,1];r.transformMat4$1(R,R,B);const L=R[3]=Math.max(R[3],1e-6);return R[0]/=L,R[1]/=L,R[2]/=L,R}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.Point(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.Point(0,c))}}getCameraToCenterDistance(c,f=this.zoom,y=this.worldSize){const w=Tf(c,f,this.width,this.height,1024),B=c.pixelSpaceConversion(this.center.lat,y,w);return .5/Math.tan(.5*this._fov)*this.height*B}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.multiply(c,c,this.globeMatrix),c}}function tu(m,c){let f=!1,y=null;const w=()=>{y=null,f&&(m(),y=setTimeout(w,c),f=!1)};return()=>(f=!0,y||w(),y)}class Eg{constructor(c){this._hashName=c&&encodeURIComponent(c),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=tu(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,r.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const f=Lh(c);if(this._hashName){const y=this._hashName;let w=!1;const B=r.window.location.hash.slice(1).split("&").map(R=>{const L=R.split("=")[0];return L===y?(w=!0,`${L}=${f}`):R}).filter(R=>R);return w||B.push(`${y}=${f}`),`#${B.join("&")}`}return`#${f}`}_getCurrentHash(){const c=r.window.location.hash.replace("#","");if(this._hashName){let f;return c.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(y))){const y=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(f[3]||0):c.getBearing();return c.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,c)}}function Lh(m,c){const f=m.getCenter(),y=Math.round(100*m.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),B=Math.pow(10,w),R=Math.round(f.lng*B)/B,L=Math.round(f.lat*B)/B,U=m.getBearing(),j=m.getPitch();let Y=c?`/${R}/${L}/${y}`:`${y}/${L}/${R}`;return(U||j)&&(Y+="/"+Math.round(10*U)/10),j&&(Y+=`/${Math.round(j)}`),Y}const Ph={linearity:.3,easing:r.bezier(0,0,.3,1)},Qf=r.extend({deceleration:2500,maxSpeed:1400},Ph),Rf=r.extend({deceleration:20,maxSpeed:1400},Ph),mi=r.extend({deceleration:1e3,maxSpeed:360},Ph),Io=r.extend({deceleration:1e3,maxSpeed:90},Ph);class W0{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,f=r.exported.now();for(;c.length>0&&f-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new r.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:B}of this._inertiaBuffer)f.zoom+=B.zoomDelta||0,f.bearing+=B.bearingDelta||0,f.pitch+=B.pitchDelta||0,B.panDelta&&f.pan._add(B.panDelta),B.around&&(f.around=B.around),B.pinchAround&&(f.pinchAround=B.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){const B=Fh(f.pan.mag(),y,r.extend({},Qf,c||{}));w.offset=f.pan.mult(B.amount/f.pan.mag()),w.center=this._map.transform.center,kh(w,B)}if(f.zoom){const B=Fh(f.zoom,y,Rf);w.zoom=this._map.transform.zoom+B.amount,kh(w,B)}if(f.bearing){const B=Fh(f.bearing,y,mi);w.bearing=this._map.transform.bearing+r.clamp(B.amount,-179,179),kh(w,B)}if(f.pitch){const B=Fh(f.pitch,y,Io);w.pitch=this._map.transform.pitch+B.amount,kh(w,B)}if(w.zoom||w.bearing){const B=f.pinchAround===void 0?f.around:f.pinchAround;w.around=B?this._map.unproject(B):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function kh(m,c){(!m.duration||m.duration<c.duration)&&(m.duration=c.duration,m.easing=c.easing)}function Fh(m,c,f){const{maxSpeed:y,linearity:w,deceleration:B}=f,R=r.clamp(m*w/(c/1e3),-y,y),L=Math.abs(R)/(B*w);return{easing:f.easing,duration:1e3*L,amount:R*(L/2)}}class kr extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,y,w={}){const B=z(f.getCanvasContainer(),y),R=f.unproject(B);super(c,r.extend({point:B,lngLat:R,originalEvent:y},w)),this._defaultPrevented=!1,this.target=f}}class Nh extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,y){const w=c==="touchend"?y.changedTouches:y.touches,B=X(f.getCanvasContainer(),w),R=B.map(U=>f.unproject(U)),L=B.reduce((U,j,Y,ie)=>U.add(j.div(ie.length)),new r.Point(0,0));super(c,{points:B,point:L,lngLats:R,lngLat:f.unproject(L),originalEvent:y}),this._defaultPrevented=!1}}class Lf extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,y){super(c,{originalEvent:y}),this._defaultPrevented=!1}}class wg{constructor(c,f){this._map=c,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new Lf(c.type,this._map,c))}mousedown(c,f){return this._mousedownPos=f,this._firePreventable(new kr(c.type,this._map,c))}mouseup(c){this._map.fire(new kr(c.type,this._map,c))}preclick(c){const f=r.extend({},c);f.type="preclick",this._map.fire(new kr(f.type,this._map,f))}click(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(c),this._map.fire(new kr(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new kr(c.type,this._map,c))}mouseover(c){this._map.fire(new kr(c.type,this._map,c))}mouseout(c){this._map.fire(new kr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Nh(c.type,this._map,c))}touchmove(c){this._map.fire(new Nh(c.type,this._map,c))}touchend(c){this._map.fire(new Nh(c.type,this._map,c))}touchcancel(c){this._map.fire(new Nh(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pf{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new kr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new kr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new kr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Y0{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,f){this.isEnabled()&&c.shiftKey&&c.button===0&&(P(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(c,f){if(!this._active)return;const y=f,w=this._startPos,B=this._lastPos;if(!w||!B||B.equals(y)||!this._box&&y.dist(w)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=C("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const R=Math.min(w.x,y.x),L=Math.max(w.x,y.x),U=Math.min(w.y,y.y),j=Math.max(w.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${R}px,${U}px)`,this._box.style.width=L-R+"px",this._box.style.height=j-U+"px")})}mouseupWindow(c,f){if(!this._active)return;const y=this._startPos,w=f;if(y&&c.button===0){if(this.reset(),N(),y.x!==w.x||y.y!==w.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:B=>B.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),O(),delete this._startPos,delete this._lastPos}_fireEvent(c,f){return this._map.fire(new r.Event(c,{originalEvent:f}))}}function kf(m,c){const f={};for(let y=0;y<m.length;y++)f[m[y].identifier]=c[y];return f}class iu{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const B=new r.Point(0,0);for(const R of w)B._add(R);return B.div(w.length)}(f),this.touches=kf(y,f)))}touchmove(c,f,y){if(this.aborted||!this.centroid)return;const w=kf(y,f);for(const B in this.touches){const R=w[B];(!R||R.dist(this.touches[B])>30)&&(this.aborted=!0)}}touchend(c,f,y){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class bg{constructor(c){this.singleTap=new iu(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,f,y){this.singleTap.touchstart(c,f,y)}touchmove(c,f,y){this.singleTap.touchmove(c,f,y)}touchend(c,f,y){const w=this.singleTap.touchend(c,f,y);if(w){const B=c.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(w)<30;if(B&&R||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class J1{constructor(){this._zoomIn=new bg({numTouches:1,numTaps:2}),this._zoomOut=new bg({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,f,y){this._zoomIn.touchstart(c,f,y),this._zoomOut.touchstart(c,f,y)}touchmove(c,f,y){this._zoomIn.touchmove(c,f,y),this._zoomOut.touchmove(c,f,y)}touchend(c,f,y){const w=this._zoomIn.touchend(c,f,y),B=this._zoomOut.touchend(c,f,y);return w?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(w)},{originalEvent:c})}):B?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(B)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const j0={0:1,2:2};class nu{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,f){return!1}_move(c,f){return{}}mousedown(c,f){if(this._lastPoint)return;const y=q(c);this._correctButton(c,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(c,f){const y=this._lastPoint;if(y){if(c.preventDefault(),this._eventButton!=null&&function(w,B){const R=j0[B];return w.buttons===void 0||(w.buttons&R)!==R}(c,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(c){this._lastPoint&&q(c)===this._eventButton&&(this._moved&&N(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bg extends nu{mousedown(c,f){super.mousedown(c,f),this._lastPoint&&(this._active=!0)}_correctButton(c,f){return f===0&&!c.ctrlKey}_move(c,f){return{around:f,panDelta:f.sub(c)}}}class Sg extends nu{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const y=.8*(f.x-c.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(c){c.preventDefault()}}class Mg extends nu{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const y=-.5*(f.y-c.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(c){c.preventDefault()}}class Ff{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.Point(0,0)}touchstart(c,f,y){return this._calculateTransform(c,f,y)}touchmove(c,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!r.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,f,y)}}touchend(c,f,y){this._calculateTransform(c,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,f,y){y.length>0&&(this._active=!0);const w=kf(y,f),B=new r.Point(0,0),R=new r.Point(0,0);let L=0;for(const j in w){const Y=w[j],ie=this._touches[j];ie&&(B._add(Y),R._add(Y.sub(ie)),L++,w[j]=Y)}if(this._touches=w,L<this._minTouches||!R.mag())return;const U=R.div(L);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:B.div(L),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=C("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class zh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,f,y){return{}}touchstart(c,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(c,f,y){const w=this._firstTwoTouches;if(!w)return;c.preventDefault();const[B,R]=w,L=Uh(y,f,B),U=Uh(y,f,R);if(!L||!U)return;const j=this._aroundCenter?null:L.add(U).div(2);return this._move([L,U],j,c)}touchend(c,f,y){if(!this._firstTwoTouches)return;const[w,B]=this._firstTwoTouches,R=Uh(y,f,w),L=Uh(y,f,B);R&&L||(this._active&&N(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Uh(m,c,f){for(let y=0;y<m.length;y++)if(m[y].identifier===f)return c[y]}function Tg(m,c){return Math.log(m/c)/Math.LN2}class q0 extends zh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,f){const y=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Tg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Tg(this._distance,y),pinchAround:f}}}function Dg(m,c){return 180*m.angleWith(c)/Math.PI}class K0 extends zh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,f){const y=this._vector;if(this._vector=c[0].sub(c[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Dg(this._vector,y),pinchAround:f}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const f=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const w=Dg(c,y);return Math.abs(w)<f}}function al(m){return Math.abs(m.y)>Math.abs(m.x)}class J0 extends zh{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,al(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,f,y){const w=this._lastPoints;if(!w)return;const B=c[0].sub(w[0]),R=c[1].sub(w[1]);return this._map._cooperativeGestures&&!r.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(B,R,y.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(B.y+R.y)/2*-.5})}gestureBeginsVertically(c,f,y){if(this._valid!==void 0)return this._valid;const w=c.mag()>=2,B=f.mag()>=2;if(!w&&!B)return;if(!w||!B)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const R=c.y>0==f.y>0;return al(c)&&al(f)&&R}}const X0={panStep:100,bearingStep:15,pitchStep:10};class X1{constructor(){const c=X0;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let f=0,y=0,w=0,B=0,R=0;switch(c.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:c.shiftKey?y=-1:(c.preventDefault(),B=-1);break;case 39:c.shiftKey?y=1:(c.preventDefault(),B=1);break;case 38:c.shiftKey?w=1:(c.preventDefault(),R=-1);break;case 40:c.shiftKey?w=-1:(c.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:L=>{const U=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:Z0,zoom:f?Math.round(U)+f*(c.shiftKey?2:1):U,bearing:L.getBearing()+y*this._bearingStep,pitch:L.getPitch()+w*this._pitchStep,offset:[-B*this._panStep,-R*this._panStep],center:L.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Z0(m){return m*(2-m)}const Qg=4.000244140625;class $0{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||r.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=c.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const y=r.exported.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%Qg==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(w*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=z(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;this._type==="wheel"&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>Qg?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&j!==0&&(j=1/j);const Y=f(),ie=Math.pow(2,Y),fe=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):ie;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(fe*j))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),w=this._startZoom,B=this._easing;let R,L=!1;if(this._type==="wheel"&&w&&B){const U=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),j=B(U);R=r.number(w,y,j),U<1?this._frameId||(this._frameId=!0):L=!0}else R=y,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:R-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let f=r.ease;if(this._prevEase){const y=this._prevEase,w=(r.exported.now()-y.start)/y.duration,B=y.easing(w+.01)-y.easing(w),R=.27/Math.sqrt(B*B+1e-4)*.01,L=Math.sqrt(.0729-R*R);f=r.bezier(R,L,.25,1)}return this._prevEase={start:r.exported.now(),duration:c,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=C("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ey{constructor(c,f){this._clickZoom=c,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,f){return c.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(c.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Z1{constructor(){this._tap=new bg({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,f,y){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(c,f,y))}touchmove(c,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=f[0],B=w.y-this._swipePoint.y;return this._swipePoint=w,c.preventDefault(),this._active=!0,{zoomDelta:B/128}}}else this._tap.touchmove(c,f,y)}touchend(c,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(c,f,y)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ty{constructor(c,f,y){this._el=c,this._mousePan=f,this._touchPan=y}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $1{constructor(c,f,y){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eI{constructor(c,f,y,w){this._el=c,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const io=m=>m.zoom||m.drag||m.pitch||m.rotate;class iy extends r.Event{}class tI{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,f){const y=r.sub([],f,c);this.radius=r.length(y[2]<0?r.div([],y,this.constants):[y[0],y[1],0])}projectRay(c){r.div(c,c,this.constants),r.normalize(c,c),r.mul$1(c,c,this.constants);const f=r.scale$2([],c,this.radius);if(f[2]>0){const y=r.scale$2([],[0,0,1],r.dot(f,[0,0,1])),w=r.scale$2([],r.normalize([],[f[0],f[1],0]),this.radius),B=r.add([],f,r.scale$2([],r.sub([],r.add([],w,y),f),2));f[0]=B[0],f[1]=B[1]}return f}}function Co(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Wo{constructor(c,f){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new W0(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new tI,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),r.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[w,B,R]of this._listeners)w.addEventListener(B,w===r.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[c,f,y]of this._listeners)c.removeEventListener(f,c===r.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(c){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new wg(f,c));const w=f.boxZoom=new Y0(f,c);this._add("boxZoom",w);const B=new J1,R=new rs;f.doubleClickZoom=new ey(R,B),this._add("tapZoom",B),this._add("clickZoom",R);const L=new Z1;this._add("tapDragZoom",L);const U=f.touchPitch=new J0(f);this._add("touchPitch",U);const j=new Sg(c),Y=new Mg(c);f.dragRotate=new $1(c,j,Y),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const ie=new Bg(c),fe=new Ff(f,c);f.dragPan=new ty(y,ie,fe),this._add("mousePan",ie),this._add("touchPan",fe,["touchZoom","touchRotate"]);const xe=new K0,be=new q0;f.touchZoomRotate=new eI(y,be,xe,L),this._add("touchRotate",xe,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Pf(f));const we=f.scrollZoom=new $0(f,this);this._add("scrollZoom",we,["mousePan"]);const Se=f.keyboard=new X1;this._add("keyboard",Se);for(const ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[ne]&&f[ne].enable(c[ne])}_add(c,f,y){this._handlers.push({handlerName:c,handler:f,allowed:y}),this._handlersById[c]=f}stop(c){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!io(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,f,y){for(const w in c)if(w!==y&&(!f||f.indexOf(w)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const f=[];for(const y of c)this._el.contains(y.target)&&f.push(y);return f}handleEvent(c,f){this._updatingCamera=!0;const y=c.type==="renderFrame",w=y?void 0:c,B={needsRenderFrame:!1},R={},L={},U=c.touches?this._getMapTouches(c.touches):void 0,j=U?X(this._el,U):y?void 0:z(this._el,c);for(const{handlerName:fe,handler:xe,allowed:be}of this._handlers){if(!xe.isEnabled())continue;let we;this._blockedByActive(L,be,fe)?xe.reset():xe[f||c.type]&&(we=xe[f||c.type](c,j,U),this.mergeHandlerResult(B,R,we,fe,w),we&&we.needsRenderFrame&&this._triggerRenderFrame()),(we||xe.isActive())&&(L[fe]=xe)}const Y={};for(const fe in this._previousActiveHandlers)L[fe]||(Y[fe]=w);this._previousActiveHandlers=L,(Object.keys(Y).length||Co(B))&&(this._changes.push([B,R,Y]),this._triggerRenderFrame()),(Object.keys(L).length||Co(B))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=B;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))}mergeHandlerResult(c,f,y,w,B){if(!y)return;r.extend(c,y);const R={handlerName:w,originalEvent:y.originalEvent||B};y.zoomDelta!==void 0&&(f.zoom=R),y.panDelta!==void 0&&(f.drag=R),y.pitchDelta!==void 0&&(f.pitch=R),y.bearingDelta!==void 0&&(f.rotate=R)}_applyChanges(){const c={},f={},y={};for(const[w,B,R]of this._changes)w.panDelta&&(c.panDelta=(c.panDelta||new r.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(c.around=w.around),w.aroundCoord!==void 0&&(c.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(c.pinchAround=w.pinchAround),w.noInertia&&(c.noInertia=w.noInertia),r.extend(f,B),r.extend(y,R);this._updateMapTransform(c,f,y),this._changes=[]}_updateMapTransform(c,f,y){const w=this._map,B=w.transform,R=ve=>[ve.x,ve.y,ve.z];if((ve=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!Co(c)){const ve=B.zoom;B.cameraElevationReference="sea",B.recenterOnTerrain(),B.cameraElevationReference="ground",ve!==B.zoom&&this._map._update(!0)}if(B._isCameraConstrained&&w._stop(!0),!Co(c))return void this._fireEvents(f,y,!0);let{panDelta:L,zoomDelta:U,bearingDelta:j,pitchDelta:Y,around:ie,aroundCoord:fe,pinchAround:xe}=c;B._isCameraConstrained&&(U>0&&(U=0),B._isCameraConstrained=!1),xe!==void 0&&(ie=xe),(U||(ve=>f[ve]&&!this._eventsInProgress[ve])("drag"))&&ie&&(this._dragOrigin=R(B.pointCoordinate3D(ie)),this._trackingEllipsoid.setup(B._camera.position,this._dragOrigin)),B.cameraElevationReference="sea",w._stop(!0),ie=ie||w.transform.centerPoint,j&&(B.bearing+=j),Y&&(B.pitch+=Y),B._updateCameraState();const be=[0,0,0];if(L)if(B.projection.name==="mercator"){const ve=this._trackingEllipsoid.projectRay(B.screenPointToMercatorRay(ie).dir),Pe=this._trackingEllipsoid.projectRay(B.screenPointToMercatorRay(ie.sub(L)).dir);be[0]=Pe[0]-ve[0],be[1]=Pe[1]-ve[1]}else{const ve=B.pointCoordinate(ie);if(B.projection.name==="globe"){L=L.rotate(-B.angle);const Pe=B._pixelsPerMercatorPixel/B.worldSize;be[0]=-L.x*r.mercatorScale(r.latFromMercatorY(ve.y))*Pe,be[1]=-L.y*r.mercatorScale(B.center.lat)*Pe}else{const Pe=B.pointCoordinate(ie.sub(L));ve&&Pe&&(be[0]=Pe.x-ve.x,be[1]=Pe.y-ve.y)}}const we=B.zoom,Se=[0,0,0];if(U){const ve=R(fe||B.pointCoordinate3D(ie)),Pe={dir:r.normalize([],r.sub([],ve,B._camera.position))};if(Pe.dir[2]<0){const ke=B.zoomDeltaToMovement(ve,U);r.scale$2(Se,Pe.dir,ke)}}const ne=r.add(be,be,Se);B._translateCameraConstrained(ne),U&&Math.abs(B.zoom-we)>1e-4&&B.recenterOnTerrain(),B.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,y,!0)}_fireEvents(c,f,y){const w=io(this._eventsInProgress),B=io(c),R={};for(const Y in c){const{originalEvent:ie}=c[Y];this._eventsInProgress[Y]||(R[`${Y}start`]=ie),this._eventsInProgress[Y]=c[Y]}!w&&B&&this._fireEvent("movestart",B.originalEvent);for(const Y in R)this._fireEvent(Y,R[Y]);B&&this._fireEvent("move",B.originalEvent);for(const Y in c){const{originalEvent:ie}=c[Y];this._fireEvent(Y,ie)}const L={};let U;for(const Y in this._eventsInProgress){const{handlerName:ie,originalEvent:fe}=this._eventsInProgress[Y];this._handlersById[ie].isActive()||(delete this._eventsInProgress[Y],U=f[ie]||fe,L[`${Y}end`]=U)}for(const Y in L)this._fireEvent(Y,L[Y]);const j=io(this._eventsInProgress);if(y&&(w||B)&&!j){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ie=fe=>fe!==0&&-this._bearingSnap<fe&&fe<this._bearingSnap;Y?(ie(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:U})):(this._map.fire(new r.Event("moveend",{originalEvent:U})),ie(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,f){this._map.fire(new r.Event(c,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new iy("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Wl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Nf extends r.Evented{constructor(c,f){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,f){return this.jumpTo({center:c},f)}panBy(c,f,y){return c=r.Point.convert(c).mult(-1),this.panTo(this.transform.center,r.extend({offset:c},f),y)}panTo(c,f,y){return this.easeTo(r.extend({center:c},f),y)}getZoom(){return this.transform.zoom}setZoom(c,f){return this.jumpTo({zoom:c},f),this}zoomTo(c,f,y){return this.easeTo(r.extend({zoom:c},f),y)}zoomIn(c,f){return this.zoomTo(this.getZoom()+1,c,f),this}zoomOut(c,f){return this.zoomTo(this.getZoom()-1,c,f),this}getBearing(){return this.transform.bearing}setBearing(c,f){return this.jumpTo({bearing:c},f),this}getPadding(){return this.transform.padding}setPadding(c,f){return this.jumpTo({padding:c},f),this}rotateTo(c,f,y){return this.easeTo(r.extend({bearing:c},f),y)}resetNorth(c,f){return this.rotateTo(0,r.extend({duration:1e3},c),f),this}resetNorthPitch(c,f){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},c),f),this}snapToNorth(c,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,f):this}getPitch(){return this.transform.pitch}setPitch(c,f){return this.jumpTo({pitch:c},f),this}cameraForBounds(c,f){c=r.LngLatBounds.convert(c);const y=f&&f.bearing||0,w=f&&f.pitch||0,B=c.getNorthWest(),R=c.getSouthEast();return this._cameraForBounds(this.transform,B,R,y,w,f)}_extendCameraOptions(c){const f={top:0,bottom:0,right:0,left:0};if(typeof(c=r.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const y=c.padding;c.padding={top:y,bottom:y,right:y,left:y}}return c.padding=r.extend(f,c.padding),c}_minimumAABBFrustumDistance(c,f){const y=f.max[0]-f.min[0],w=f.max[1]-f.min[1];return y/w>c.aspect?y/(2*Math.tan(.5*c.fovX)*c.aspect):w/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,f,y,w,B,R){const L=c.clone(),U=this._extendCameraOptions(R);L.bearing=w,L.pitch=B;const j=r.LngLat.convert(f),Y=r.LngLat.convert(y),ie=.5*(j.lat+Y.lat),fe=.5*(j.lng+Y.lng),xe=r.latLngToECEF(ie,fe),be=r.normalize([],xe),we=r.normalize([],r.cross([],be,[0,1,0])),Se=r.cross([],we,be),ne=[we[0],we[1],we[2],0,Se[0],Se[1],Se[2],0,be[0],be[1],be[2],0,0,0,0,1],ve=[xe,r.latLngToECEF(j.lat,j.lng),r.latLngToECEF(Y.lat,j.lng),r.latLngToECEF(Y.lat,Y.lng),r.latLngToECEF(j.lat,Y.lng),r.latLngToECEF(ie,j.lng),r.latLngToECEF(ie,Y.lng),r.latLngToECEF(j.lat,fe),r.latLngToECEF(Y.lat,fe)];let Pe=r.Aabb.fromPoints(ve.map(jt=>[r.dot(we,jt),r.dot(Se,jt),r.dot(be,jt)]));const ke=r.transformMat4([],Pe.center,ne);r.squaredLength(ke)===0&&r.set(ke,0,0,1),r.normalize(ke,ke),r.scale$2(ke,ke,r.GLOBE_RADIUS),L.center=r.ecefToLatLng(ke);const $e=L.getWorldToCameraMatrix(),tt=r.invert(new Float64Array(16),$e);Pe=r.Aabb.applyTransform(Pe,r.multiply([],$e,ne)),r.transformMat4(ke,ke,$e);const et=.5*(Pe.max[2]-Pe.min[2]),ct=this._minimumAABBFrustumDistance(L,Pe),lt=r.scale$2([],[0,0,1],et),vt=r.add(lt,ke,lt),Zt=ct+(L.pitch===0?0:r.distance(ke,vt)),At=L.globeCenterInViewSpace,zt=r.sub([],ke,[At[0],At[1],At[2]]);r.normalize(zt,zt),r.scale$2(zt,zt,Zt);const bt=r.add([],ke,zt);r.transformMat4(bt,bt,tt);const Jt=r.earthRadius/r.GLOBE_RADIUS,_t=r.length(bt),Nt=r.mercatorZfromAltitude(Math.max(_t*Jt-r.earthRadius,Number.EPSILON),0),ei=Math.min(L.zoomFromMercatorZAdjusted(Nt),U.maxZoom);return ei>.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"mercator"}),L.zoom=ei,this._cameraForBounds(L,f,y,w,B,R)):{center:L.center,zoom:ei,bearing:w,pitch:B}}queryTerrainElevation(c,f){const y=this.transform.elevation;return y?(f=r.extend({},{exaggerated:!0},f),y.getAtPoint(r.MercatorCoordinate.fromLngLat(c),null,f.exaggerated)):null}_cameraForBounds(c,f,y,w,B,R){if(c.projection.name==="globe")return this._cameraForBoundsOnGlobe(c,f,y,w,B,R);const L=c.clone(),U=this._extendCameraOptions(R),j=L.padding;L.bearing=w,L.pitch=B;const Y=r.LngLat.convert(f),ie=r.LngLat.convert(y),fe=new r.LngLat(Y.lng,ie.lat),xe=new r.LngLat(ie.lng,Y.lat),be=L.project(Y),we=L.project(ie),Se=this.queryTerrainElevation(Y),ne=this.queryTerrainElevation(ie),ve=this.queryTerrainElevation(fe),Pe=this.queryTerrainElevation(xe),ke=[[be.x,be.y,Math.min(Se||0,ne||0,ve||0,Pe||0)],[we.x,we.y,Math.max(Se||0,ne||0,ve||0,Pe||0)]];let $e=r.Aabb.fromPoints(ke);const tt=L.getWorldToCameraMatrix(),et=r.invert(new Float64Array(16),tt);$e=r.Aabb.applyTransform($e,tt);const ct=r.sub([],$e.max,$e.min),lt=j.left||0,vt=j.right||0,Zt=j.bottom||0,At=j.top||0,{left:zt,right:bt,top:Jt,bottom:_t}=U.padding,Nt=.5*(lt+vt),ei=.5*(At+Zt),jt=Math.min(L.scaleZoom(L.scale*Math.min((L.width-(lt+vt+zt+bt))/ct[0],(L.height-(Zt+At+_t+Jt))/ct[1])),U.maxZoom),ti=L.scale/L.zoomScale(jt);$e=new r.Aabb([$e.min[0]-(zt+Nt)*ti,$e.min[1]-(_t+ei)*ti,$e.min[2]],[$e.max[0]+(bt+Nt)*ti,$e.max[1]+(Jt+ei)*ti,$e.max[2]]);const bi=.5*ct[2],Ni=this._minimumAABBFrustumDistance(L,$e),Ii=[0,0,1,0];r.transformMat4$1(Ii,Ii,tt),r.normalize$2(Ii,Ii);const Ti=r.scale$2([],Ii,Ni+bi),en=r.add([],$e.center,Ti),Ji=(typeof U.offset.x=="number"&&typeof U.offset.y=="number"?new r.Point(U.offset.x,U.offset.y):r.Point.convert(U.offset)).rotate(-r.degToRad(w));$e.center[0]-=Ji.x*ti,$e.center[1]+=Ji.y*ti,r.transformMat4($e.center,$e.center,et),r.transformMat4(en,en,et);const wi=[$e.center[0],$e.center[1],en[2]*L.pixelsPerMeter];r.scale$2(wi,wi,1/L.worldSize);const yn=r.lngFromMercatorX(wi[0]),Sn=r.latFromMercatorY(wi[1]),Mn=Math.min(L._zoomFromMercatorZ(wi[2]),U.maxZoom),Tn=new r.LngLat(yn,Sn);return L.mercatorFromTransition&&Mn<.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"globe"}),L.zoom=Mn,this._cameraForBounds(L,f,y,w,B,R)):{center:Tn,zoom:Mn,bearing:w,pitch:B}}fitBounds(c,f,y){const w=this.cameraForBounds(c,f);return this._fitInternal(w,f,y)}fitScreenCoordinates(c,f,y,w,B){const R=r.Point.convert(c),L=r.Point.convert(f),U=new r.Point(Math.min(R.x,L.x),Math.min(R.y,L.y)),j=new r.Point(Math.max(R.x,L.x),Math.max(R.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,L))return this;const Y=this.transform.pointLocation3D(U),ie=this.transform.pointLocation3D(j),fe=this.transform.pointLocation3D(new r.Point(U.x,j.y)),xe=this.transform.pointLocation3D(new r.Point(j.x,U.y)),be=[Math.min(Y.lng,ie.lng,fe.lng,xe.lng),Math.min(Y.lat,ie.lat,fe.lat,xe.lat)],we=[Math.max(Y.lng,ie.lng,fe.lng,xe.lng),Math.max(Y.lat,ie.lat,fe.lat,xe.lat)],Se=w&&w.pitch?w.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,be,we,y,Se,w);return this._fitInternal(ne,w,B)}_fitInternal(c,f,y){return c?(delete(f=r.extend(c,f)).padding,f.linear?this.easeTo(f,y):this.flyTo(f,y)):this}jumpTo(c,f){this.stop();const y=c.preloadOnly?this.transform.clone():this.transform;let w=!1,B=!1,R=!1;return"zoom"in c&&y.zoom!==+c.zoom&&(w=!0,y.zoom=+c.zoom),c.center!==void 0&&(y.center=r.LngLat.convert(c.center)),"bearing"in c&&y.bearing!==+c.bearing&&(B=!0,y.bearing=+c.bearing),"pitch"in c&&y.pitch!==+c.pitch&&(R=!0,y.pitch=+c.pitch),c.padding==null||y.isPaddingEqual(c.padding)||(y.padding=c.padding),c.preloadOnly?(this._preloadTiles(y),this):(this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),w&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),B&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),R&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce(Wl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return r.warnOnce(Wl),this;this.stop();const w=y.zoom,B=y.pitch,R=y.bearing;y.setFreeCameraOptions(c);const L=w!==y.zoom,U=B!==y.pitch,j=R!==y.bearing;return this.fire(new r.Event("movestart",f)).fire(new r.Event("move",f)),L&&this.fire(new r.Event("zoomstart",f)).fire(new r.Event("zoom",f)).fire(new r.Event("zoomend",f)),j&&this.fire(new r.Event("rotatestart",f)).fire(new r.Event("rotate",f)).fire(new r.Event("rotateend",f)),U&&this.fire(new r.Event("pitchstart",f)).fire(new r.Event("pitch",f)).fire(new r.Event("pitchend",f)),this.fire(new r.Event("moveend",f)),this}easeTo(c,f){this._stop(!1,c.easeId),((c=r.extend({offset:[0,0],duration:500,easing:r.ease},c)).animate===!1||this._prefersReducedMotion(c))&&(c.duration=0);const y=this.transform,w=this.getZoom(),B=this.getBearing(),R=this.getPitch(),L=this.getPadding(),U="zoom"in c?+c.zoom:w,j="bearing"in c?this._normalizeBearing(c.bearing,B):B,Y="pitch"in c?+c.pitch:R,ie="padding"in c?c.padding:y.padding,fe=r.Point.convert(c.offset);let xe,be,we;if(y.projection.name==="globe"){const lt=r.MercatorCoordinate.fromLngLat(y.center),vt=fe.rotate(-y.angle);lt.x+=vt.x/y.worldSize,lt.y+=vt.y/y.worldSize;const Zt=lt.toLngLat(),At=r.LngLat.convert(c.center||Zt);this._normalizeCenter(At),xe=y.centerPoint.add(vt),be=new r.Point(lt.x,lt.y).mult(y.worldSize),we=new r.Point(r.mercatorXfromLng(At.lng),r.mercatorYfromLat(At.lat)).mult(y.worldSize).sub(be)}else{xe=y.centerPoint.add(fe);const lt=y.pointLocation(xe),vt=r.LngLat.convert(c.center||lt);this._normalizeCenter(vt),be=y.project(lt),we=y.project(vt).sub(be)}const Se=y.zoomScale(U-w);let ne,ve;c.around&&(ne=r.LngLat.convert(c.around),ve=y.locationPoint(ne));const Pe=this._zooming||U!==w,ke=this._rotating||B!==j,$e=this._pitching||Y!==R,tt=!y.isPaddingEqual(ie),et=lt=>vt=>{if(Pe&&(lt.zoom=r.number(w,U,vt)),ke&&(lt.bearing=r.number(B,j,vt)),$e&&(lt.pitch=r.number(R,Y,vt)),tt&&(lt.interpolatePadding(L,ie,vt),xe=lt.centerPoint.add(fe)),ne)lt.setLocationAtPoint(ne,ve);else{const Zt=lt.zoomScale(lt.zoom-w),At=U>w?Math.min(2,Se):Math.max(.5,Se),zt=Math.pow(At,1-vt),bt=lt.unproject(be.add(we.mult(vt*zt)).mult(Zt));lt.setLocationAtPoint(lt.renderWorldCopies?bt.wrap():bt,xe)}return c.preloadOnly||this._fireMoveEvents(f),lt};if(c.preloadOnly){const lt=this._emulate(et,c.duration,y);return this._preloadTiles(lt),this}const ct={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=ke,this._pitching=$e,this._padding=tt,this._easeId=c.easeId,this._prepareEase(f,c.noMoveStart,ct),this._ease(et(y),lt=>{y.recenterOnTerrain(),this._afterEase(f,lt)},c),this}_prepareEase(c,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||y.moving||this.fire(new r.Event("movestart",c)),this._zooming&&!y.zooming&&this.fire(new r.Event("zoomstart",c)),this._rotating&&!y.rotating&&this.fire(new r.Event("rotatestart",c)),this._pitching&&!y.pitching&&this.fire(new r.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new r.Event("move",c)),this._zooming&&this.fire(new r.Event("zoom",c)),this._rotating&&this.fire(new r.Event("rotate",c)),this._pitching&&this.fire(new r.Event("pitch",c))}_afterEase(c,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,w=this._rotating,B=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new r.Event("zoomend",c)),w&&this.fire(new r.Event("rotateend",c)),B&&this.fire(new r.Event("pitchend",c)),this.fire(new r.Event("moveend",c))}flyTo(c,f){if(this._prefersReducedMotion(c)){const jt=r.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(jt,f)}this.stop(),c=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},c);const y=this.transform,w=this.getZoom(),B=this.getBearing(),R=this.getPitch(),L=this.getPadding(),U="zoom"in c?r.clamp(+c.zoom,y.minZoom,y.maxZoom):w,j="bearing"in c?this._normalizeBearing(c.bearing,B):B,Y="pitch"in c?+c.pitch:R,ie="padding"in c?c.padding:y.padding,fe=y.zoomScale(U-w),xe=r.Point.convert(c.offset);let be=y.centerPoint.add(xe);const we=y.pointLocation(be),Se=r.LngLat.convert(c.center||we);this._normalizeCenter(Se);const ne=y.project(we),ve=y.project(Se).sub(ne);let Pe=c.curve;const ke=Math.max(y.width,y.height),$e=ke/fe,tt=ve.mag();if("minZoom"in c){const jt=r.clamp(Math.min(c.minZoom,w,U),y.minZoom,y.maxZoom),ti=ke/y.zoomScale(jt-w);Pe=Math.sqrt(ti/tt*2)}const et=Pe*Pe;function ct(jt){const ti=($e*$e-ke*ke+(jt?-1:1)*et*et*tt*tt)/(2*(jt?$e:ke)*et*tt);return Math.log(Math.sqrt(ti*ti+1)-ti)}function lt(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function vt(jt){return(Math.exp(jt)+Math.exp(-jt))/2}const Zt=ct(0);let At=function(jt){return vt(Zt)/vt(Zt+Pe*jt)},zt=function(jt){return ke*((vt(Zt)*(lt(ti=Zt+Pe*jt)/vt(ti))-lt(Zt))/et)/tt;var ti},bt=(ct(1)-Zt)/Pe;if(Math.abs(tt)<1e-6||!isFinite(bt)){if(Math.abs(ke-$e)<1e-6)return this.easeTo(c,f);const jt=$e<ke?-1:1;bt=Math.abs(Math.log($e/ke))/Pe,zt=function(){return 0},At=function(ti){return Math.exp(jt*Pe*ti)}}c.duration="duration"in c?+c.duration:1e3*bt/("screenSpeed"in c?+c.screenSpeed/Pe:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Jt=B!==j,_t=Y!==R,Nt=!y.isPaddingEqual(ie),ei=jt=>ti=>{const bi=ti*bt,Ni=1/At(bi);jt.zoom=ti===1?U:w+jt.scaleZoom(Ni),Jt&&(jt.bearing=r.number(B,j,ti)),_t&&(jt.pitch=r.number(R,Y,ti)),Nt&&(jt.interpolatePadding(L,ie,ti),be=jt.centerPoint.add(xe));const Ii=ti===1?Se:jt.unproject(ne.add(ve.mult(zt(bi))).mult(Ni));return jt.setLocationAtPoint(jt.renderWorldCopies?Ii.wrap():Ii,be),jt._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(f),jt};if(c.preloadOnly){const jt=this._emulate(ei,c.duration,y);return this._preloadTiles(jt),this}return this._zooming=!0,this._rotating=Jt,this._pitching=_t,this._padding=Nt,this._prepareEase(f,!1),this._ease(ei(y),()=>this._afterEase(f),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!c){const y=this.handlers;y&&y.stop(!1)}return this}_ease(c,f,y){y.animate===!1||y.duration===0?(c(1),f()):(this._easeStart=r.exported.now(),this._easeOptions=y,this._onEaseFrame=c,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,f){c=r.wrap(c,-180,180);const y=Math.abs(c-f);return Math.abs(c-360-f)<y&&(c-=360),Math.abs(c+360-f)<y&&(c+=360),c}_normalizeCenter(c){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const y=c.lng-f.center.lng;c.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&r.exported.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,f,y){const w=Math.ceil(15*f/1e3),B=[],R=c(y.clone());for(let L=0;L<=w;L++){const U=R(L/w);B.push(U.clone())}return B}}class vi{constructor(c={}){this.options=c,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const f=this.options&&this.options.compact;return this._map=c,this._container=C("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=C("button","mapboxgl-ctrl-attrib-button",this._container),C("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=C("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,f){const y=this._map._getUIString(`AttributionControl.${f}`);c.setAttribute("aria-label",y),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(c){const y=f.reduce((w,B,R)=>(B.value&&(w+=`${B.key}=${B.value}${R<f.length-1?"&":""}`),w),"?");c.href=`${r.config.FEEDBACK_URL}/${y}#${Lh(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const f=this._map.style._sourceCaches;for(const w in f){const B=f[w];if(B.used){const R=B.getSource();R.attribution&&c.indexOf(R.attribution)<0&&c.push(R.attribution)}}c.sort((w,B)=>w.length-B.length),c=c.filter((w,B)=>{for(let R=B+1;R<c.length;R++)if(c[R].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const y=c.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,c.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Rg{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=C("div","mapboxgl-ctrl");const f=C("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(Object.entries(c).length===0)return!0;for(const f in c){const y=c[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const f=c[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class Lg{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f}remove(c){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const w of y)if(w.id===c)return void(w.cancelled=!0)}run(c=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ru(m,c,f){if(m=new r.LngLat(m.lng,m.lat),c){const y=new r.LngLat(m.lng-360,m.lat),w=new r.LngLat(m.lng+360,m.lat),B=360*Math.ceil(Math.abs(m.lng-f.center.lng)/360),R=f.locationPoint(m).distSqr(c),L=c.x<0||c.y<0||c.x>f.width||c.y>f.height;f.locationPoint(y).distSqr(c)<R&&(L||Math.abs(y.lng-f.center.lng)<B)?m=y:f.locationPoint(w).distSqr(c)<R&&(L||Math.abs(w.lng-f.center.lng)<B)&&(m=w)}for(;Math.abs(m.lng-f.center.lng)>180;){const y=f.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;m.lng>f.center.lng?m.lng-=360:m.lng+=360}return m}const Yl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class pi extends r.Evented{constructor(c,f){if(super(),(c instanceof r.window.HTMLElement||f)&&(c=r.extend({element:c},f)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=r.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=C("div");const w=41,B=27,R=E("svg",{display:"block",height:w*this._scale+"px",width:B*this._scale+"px",viewBox:`0 0 ${B} ${w}`},this._element),L=E("radialGradient",{id:"shadowGradient"},E("defs",{},R));E("stop",{offset:"10%","stop-opacity":.4},L),E("stop",{offset:"100%","stop-opacity":.05},L),E("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),E("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),E("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),E("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=r.Point.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const y=this._element.classList;for(const w in Yl)y.remove(`mapboxgl-marker-anchor-${w}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=r.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const f=c.code,y=c.charCode||c.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(c){const f=c.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,f=this._pos;if(!c||!f)return!1;const y=c.unproject(f),w=c.getFreeCameraOptions();if(!w.position)return!1;const B=w.position.toLngLat();return B.distanceTo(y)<.9*B.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const f=this._pos;if(!f||f.x<0||f.x>c.transform.width||f.y<0||f.y>c.transform.height)return void this._clearFadeTimer();const y=c.unproject(f);let w;c._showingGlobe()&&r.isLngLatBehindGlobe(c.transform,this._lngLat)?w=0:(w=1-c._queryFogOpacity(y),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${c.x}px,${c.y}px)
            ${Yl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const c=this._pos,f=this._map,y=this.getPitchAlignment();if(!f||!c||y!=="map")return"";if(!f._showingGlobe()){const U=f.getPitch();return U?`rotateX(${U}deg)`:""}const w=r.radToDeg(r.globeTiltAtLngLat(f.transform,this._lngLat)),B=c.sub(r.globeCenterToScreenPoint(f.transform)),R=Math.abs(B.x)+Math.abs(B.y);if(R===0)return"";const L=w/R;return`rotateX(${-B.y*L}deg) rotateY(${B.x*L}deg)`}_calculateZTransform(){const c=this._pos,f=this._map;if(!f||!c)return"";let y=0;const w=this.getRotationAlignment();if(w==="map")if(f._showingGlobe()){const B=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),R=f.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(B);y=r.radToDeg(Math.atan2(R.y,R.x))-90}else y=-f.getBearing();else if(w==="horizon"){const B=r.smoothstep(4,6,f.getZoom()),R=r.globeCenterToScreenPoint(f.transform);R.y+=B*f.transform.height;const L=c.sub(R),U=r.radToDeg(Math.atan2(L.y,L.x));y=(U>90?U-270:U+90)*(1-B)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(c){r.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=ru(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),c===!0?this._updateFrameId=r.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=r.Point.convert(c),this._update(),this}_onMove(c){const f=this._map;if(!f)return;const y=this._pointerdownPos,w=this._positionDelta;if(y&&w){if(!this._isDragging){const B=this._clickTolerance||f._clickTolerance;if(c.point.dist(y)<B)return;this._isDragging=!0}this._pos=c.point.sub(w),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(c){const f=this._map,y=this._pos;f&&y&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(y),this._pointerdownPos=c.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const f=this._map;return f&&(c?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Pg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},iI=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ny(m=new r.Point(0,0),c="bottom"){if(typeof m=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(c){case"top":return new r.Point(0,m);case"top-left":return new r.Point(f,f);case"top-right":return new r.Point(-f,f);case"bottom":return new r.Point(0,-m);case"bottom-left":return new r.Point(f,-f);case"bottom-right":return new r.Point(-f,-f);case"left":return new r.Point(m,0);case"right":return new r.Point(-m,0)}return new r.Point(0,0)}return m instanceof r.Point||Array.isArray(m)?r.Point.convert(m):r.Point.convert(m[c]||[0,0])}class kg{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const f=r.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,f,y){this._start=this.getValue(f),this._end=c,this._startTime=f,this._endTime=f+y}}const ry={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},sy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},nI={showCompass:!0,showZoom:!0,visualizePitch:!1};class rI{constructor(c,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Sg({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,y&&(this.mousePitch=new Mg({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(c,f){this.mouseRotate.mousedown(c,f),this.mousePitch&&this.mousePitch.mousedown(c,f),P()}move(c,f){const y=this.map,w=this.mouseRotate.mousemoveWindow(c,f),B=w&&w.bearingDelta;if(B&&y.setBearing(y.getBearing()+B),this.mousePitch){const R=this.mousePitch.mousemoveWindow(c,f),L=R&&R.pitchDelta;L&&y.setPitch(y.getPitch()+L)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){O(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(r.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),z(this.element,c)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,z(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=X(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Fg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ng={maxWidth:100,unit:"metric"},zg={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},su={version:r.version,supported:g,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends Nf{constructor(m){if(r.LivePerformanceUtils.mark(r.PerformanceMarkers.create),(m=r.extend({},sy,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(m.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new eu(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Lg,this._domRenderTaskQueue=new Lg,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.uniqueId(),this._locale=r.extend({},ry,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new kg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new r.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=r.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Wo(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new Eg(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,r.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new vi({customAttribution:m.customAttribution})),this._logoControl=new Rg,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new r.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new r.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(m,c){if(c===void 0&&(c=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=m.onAdd(this);this._controls.push(m);const y=this._controlPositions[c];return c.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(m);return c>-1&&this._controls.splice(c,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new r.Event("movestart",m)).fire(new r.Event("move",m)),this.fire(new r.Event("resize",m)),c&&this.fire(new r.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?r.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(c=>c==="auto"?r.window.navigator.language:c):m}setLanguage(m){const c=this._parseLanguage(m);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,c=m.projection.name;let f;c==="globe"&&m.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),f=!0):c==="mercator"&&m.zoom<r.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,c){return this._updateProjection(m||c||{name:"mercator"})}_updateProjection(m){let c;if(c=m.name==="globe"&&this.transform.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(r.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(r.Point.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,c,f){if(m==="mouseenter"||m==="mouseover"){let y=!1;const w=R=>{const L=c.filter(j=>this.getLayer(j)),U=L.length?this.queryRenderedFeatures(R.point,{layers:L}):[];U.length?y||(y=!0,f.call(this,new kr(m,this,R.originalEvent,{features:U}))):y=!1},B=()=>{y=!1};return{layers:new Set(c),listener:f,delegates:{mousemove:w,mouseout:B}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;const w=R=>{const L=c.filter(U=>this.getLayer(U));(L.length?this.queryRenderedFeatures(R.point,{layers:L}):[]).length?y=!0:y&&(y=!1,f.call(this,new kr(m,this,R.originalEvent)))},B=R=>{y&&(y=!1,f.call(this,new kr(m,this,R.originalEvent)))};return{layers:new Set(c),listener:f,delegates:{mousemove:w,mouseout:B}}}{const y=w=>{const B=c.filter(L=>this.getLayer(L)),R=B.length?this.queryRenderedFeatures(w.point,{layers:B}):[];R.length&&(w.features=R,f.call(this,w),delete w.features)};return{layers:new Set(c),listener:f,delegates:{[m]:y}}}}on(m,c,f){if(f===void 0)return super.on(m,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(m,c,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(m,c,f){if(f===void 0)return super.once(m,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(m,c,f);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(m,c,f){if(f===void 0)return super.off(m,c);c=new Set(Array.isArray(c)?c:[c]);const y=(B,R)=>{if(B.size!==R.size)return!1;for(const L of B)if(!R.has(L))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[m]:void 0;return w&&(B=>{for(let R=0;R<B.length;R++){const L=B[R];if(L.listener===f&&y(L.layers,c)){for(const U in L.delegates)this.off(U,L.delegates[U]);return B.splice(R,1),this}}})(w),this}queryRenderedFeatures(m,c){return this.style?(c!==void 0||m===void 0||m instanceof r.Point||Array.isArray(m)||(c=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(m,c){return this.style.querySourceFeatures(m,c)}isPointOnSurface(m){const{name:c}=this.transform.projection;return c!=="globe"&&c!=="mercator"&&r.warnOnce(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.Point.convert(m))}setStyle(m,c){return(c=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(m,c))}_getUIString(m){const c=this._locale[m];if(c==null)throw new Error(`Missing UI string '${m}'`);return c}_updateStyle(m,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new Ho(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ho(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,c){if(typeof m=="string"){const f=this._requestManager.normalizeStyleURL(m),y=this._requestManager.transformRequest(f,r.ResourceType.Style);r.getJSON(y,(w,B)=>{w?this.fire(new r.ErrorEvent(w)):B&&this._updateDiff(B,c)})}else typeof m=="object"&&this._updateDiff(m,c)}_updateDiff(m,c){try{this.style.setState(m)&&this._update(!0)}catch(f){r.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(m,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(m,c){return this._lazyInitEmptyStyle(),this.style.addSource(m,c),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const c in m){const f=m[c]._tiles;for(const y in f){const w=f[y];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(m,c,f){this._lazyInitEmptyStyle(),this.style.addSourceType(m,c,f)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,c,{pixelRatio:f=1,sdf:y=!1,stretchX:w,stretchY:B,content:R}={}){if(this._lazyInitEmptyStyle(),c instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&c instanceof r.window.ImageBitmap){const{width:L,height:U,data:j}=r.exported.getImageData(c);this.style.addImage(m,{data:new r.RGBAImage({width:L,height:U},j),pixelRatio:f,stretchX:w,stretchY:B,content:R,sdf:y,version:0})}else if(c.width===void 0||c.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:U}=c,j=c;this.style.addImage(m,{data:new r.RGBAImage({width:L,height:U},new Uint8Array(j.data)),pixelRatio:f,stretchX:w,stretchY:B,content:R,sdf:y,version:0,userImage:j}),j.onAdd&&j.onAdd(this,m)}}updateImage(m,c){const f=this.style.getImage(m);if(!f)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=c instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&c instanceof r.window.ImageBitmap?r.exported.getImageData(c):c,{width:w,height:B}=y;w!==void 0&&B!==void 0?w===f.data.width&&B===f.data.height?(f.data.replace(y.data,!(c instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&c instanceof r.window.ImageBitmap)),this.style.updateImage(m,f)):this.fire(new r.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${B})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,c){r.getImage(this._requestManager.transformRequest(m,r.ResourceType.Image),(f,y)=>{c(f,y instanceof r.window.HTMLImageElement?r.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(m,c){return this._lazyInitEmptyStyle(),this.style.addLayer(m,c),this._update(!0)}moveLayer(m,c){return this.style.moveLayer(m,c),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,c,f){return this.style.setLayerZoomRange(m,c,f),this._update(!0)}setFilter(m,c,f={}){return this.style.setFilter(m,c,f),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,c,f,y={}){return this.style.setPaintProperty(m,c,f,y),this._update(!0)}getPaintProperty(m,c){return this.style.getPaintProperty(m,c)}setLayoutProperty(m,c,f,y={}){return this.style.setLayoutProperty(m,c,f,y),this._update(!0)}getLayoutProperty(m,c){return this.style.getLayoutProperty(m,c)}setLight(m,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(m),this.transform):0}setFeatureState(m,c){return this.style.setFeatureState(m,c),this._update()}removeFeatureState(m,c){return this.style.removeFeatureState(m,c),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let f,y,w,B=this._container;for(;B&&(!y||!w);){const R=r.window.getComputedStyle(B).transform;R&&R!=="none"&&(f=R.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(w=f[3])),B=B.parentElement}this._containerWidth=y?Math.abs(m/y):m,this._containerHeight=w?Math.abs(c/w):c}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=C("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=C("div","mapboxgl-canvas-container",m);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=C("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=C("div","mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=C("div",`mapboxgl-ctrl-${w}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,c){const f=r.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(m),this._canvas.height=f*Math.ceil(c),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${c}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const c=this._markers.indexOf(m);c!==-1&&this._markers.splice(c,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const c=this._popups.indexOf(m);c!==-1&&this._popups.splice(c,1)}_setupPainter(){const m=r.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",m),f=c||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);f?(this._useWebGL2&&!c&&r.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),r.storeAuthState(f,!0),this.painter=new Zc(f,this.transform,!!c),this.on("data",y=>{y.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.exported$1.testSupport(f)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let c;const f=this.painter.context.extTimerQuery,y=r.exported.now();if(this.listens("gpu-timing-frame")&&(c=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],r.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],r.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,U=this.transform.pitch,j=r.exported.now(),Y=new r.EvaluationParameters(L,{now:j,fadeDuration:w,pitch:U,transition:this.style.getTransition()});this.style.update(Y)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let B=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),B=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):B=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const L=r.exported.now()-y;f.endQueryEXT(f.TIME_ELAPSED_EXT,c),setTimeout(()=>{const U=f.getQueryObjectEXT(c,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(c),this.fire(new r.Event("gpu-timing-frame",{cpuTime:L,gpuTime:U})),r.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(L);this.fire(new r.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const L=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(L);this.fire(new r.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||B;if(R||this._repaint)this.triggerRepaint();else{const L=!this.isMoving()&&this.loaded();if(L&&(B=this._updateAverageElevation(y,!0)),B)this.triggerRepaint();else if(this._triggerFrame(!1),L&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,r.LivePerformanceUtils.mark(r.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&r.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const c of this._markers)m&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!m||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(m,c=!1){const f=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((c||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),B=!1;this.transform.elevation&&(B=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=m;const R=Math.abs(y-w);if(R>1){if(this._isInitialLoad||B)return this._averageElevation.jumpTo(w),f(w);this._averageElevation.easeTo(w,m,300)}else if(R>1e-4)return this._averageElevation.jumpTo(w),f(w)}return!!this._averageElevation.isEasing(m)&&f(this._averageElevation.getValue(m))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===r.AUTH_ERR_MSG||m.status===401)){const c=this.painter.context.gl;r.storeAuthState(c,!1),this._logoControl instanceof Rg&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function w(B){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,B,0);const R=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,R),R}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(w(m),c.canvasCopies.map(w),c.timeStamps)}_canvasPixelComparison(m,c,f){let y=f[1]-f[0];const w=m.length/4;for(let B=0;B<c.length;B++){const R=c[B];let L=0;for(let U=0;U<R.length;U+=4)R[U]===m[U]&&R[U+1]===m[U+1]&&R[U+2]===m[U+2]&&R[U+3]===m[U+3]&&(L+=1);y+=(f[B+2]-f[B+1])*(1-L/w)}return y}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1),r.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.exported.frame(c=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(c)}))}_preloadTiles(m){const c=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(c,(f,y)=>f._preloadTiles(m,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){r.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,c){r.setCacheLimits(m,c)}get version(){return r.version}},NavigationControl:class{constructor(m){this.options=r.extend({},nI,m),this._container=C("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),C("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),C("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:c}):f.resetNorth({},{originalEvent:c}))}),this._compassIcon=C("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const c=m.getZoom(),f=c===m.getMaxZoom(),y=c===m.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new rI(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,c){const f=C("button",m,this._container);return f.type="button",f.addEventListener("click",c),f}_setButtonTitle(m,c){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${c}`);m.setAttribute("aria-label",f),m.firstElementChild&&m.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends r.Evented{constructor(m){super(),this.options=r.extend({geolocation:r.window.navigator.geolocation},Fg,m),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=tu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=C("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const c=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,m(f)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then(f=>c(f.state!=="denied")).catch(()=>c()):c()}_isOutOfMapMaxBounds(m){const c=this._map.getMaxBounds(),f=m.coords;return!!c&&(f.longitude<c.getWest()||f.longitude>c.getEast()||f.latitude<c.getSouth()||f.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",m)),this._finish()}}_updateCamera(m){const c=new r.LngLat(m.coords.longitude,m.coords.latitude),f=m.coords.accuracy,y=this._map.getBearing(),w=r.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(f),w,{geolocateSource:!0})}_updateMarker(m){if(m){const c=new r.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,c=r.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,f=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=C("button","mapboxgl-ctrl-geolocate",this._container),C("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=C("div","mapboxgl-user-location"),this._dotElement.appendChild(C("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(C("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new pi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=C("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(c=>{c==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:vi,ScaleControl:class{constructor(m){this.options=r.extend({},Ng,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,c=this._map,f=c._containerHeight/2,y=c._containerWidth/2-m/2,w=c.unproject([y,f]),B=c.unproject([y+m,f]),R=w.distanceTo(B);if(this.options.unit==="imperial"){const L=3.2808*R;L>5280?this._setScale(m,L/5280,"mile"):this._setScale(m,L,"foot")}else this.options.unit==="nautical"?this._setScale(m,R/1852,"nautical-mile"):R>=1e3?this._setScale(m,R/1e3,"kilometer"):this._setScale(m,R,"meter")}_setScale(m,c,f){this._map._requestDomTask(()=>{const y=function(B){const R=Math.pow(10,`${Math.floor(B)}`.length-1);let L=B/R;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(U){const j=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*j)/j}(L),R*L}(c),w=y/c;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(y):`${y}&nbsp;${zg[f]}`,this._container.style.width=m*w+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=C("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof r.window.HTMLElement?this._container=m.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=C("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=C("button","mapboxgl-ctrl-fullscreen",this._controlContainer);C("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(m){super(),this.options=r.extend(Object.create(Pg),m),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(r.window.document.createTextNode(m))}setHTML(m){const c=r.window.document.createDocumentFragment(),f=r.window.document.createElement("body");let y;for(f.innerHTML=m;y=f.firstChild,y;)c.appendChild(y);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=C("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(m),this.options.closeButton){const f=this._closeButton=C("button","mapboxgl-popup-close-button",c);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let c;return this._classList.delete(m)?c=!1:(this._classList.add(m),c=!0),this._updateClassList(),c}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const c=this._map,f=this._container,y=this._pos;if(!c||!f||!y)return"bottom";const w=f.offsetWidth,B=f.offsetHeight,R=y.x<w/2,L=y.x>c.transform.width-w/2;if(y.y+m<B)return R?"top-left":L?"top-right":"top";if(y.y>c.transform.height-B){if(R)return"bottom-left";if(L)return"bottom-right"}return R?"left":L?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),m.className=c.join(" ")}_update(m){const c=this._map,f=this._content;if(!c||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=C("div","mapboxgl-popup",c.getContainer()),this._tip=C("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ru(this._lngLat,this._pos,c.transform)),!this._trackPointer||m){const w=this._pos=this._trackPointer&&m?m:c.project(this._lngLat),B=ny(this.options.offset),R=this._anchor=this._getAnchor(B.y),L=ny(this.options.offset,R),U=w.add(L).round();c._requestDomTask(()=>{this._container&&R&&(this._container.style.transform=`${Yl[R]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&c._showingGlobe()){const w=r.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(iI);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:pi,Style:Ho,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.Point,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:G0,Evented:r.Evented,config:r.config,prewarm:function(){zi().acquire(Ai)},clearPrewarmedResources:function(){const m=ci;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Ai),ci=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(m){r.config.ACCESS_TOKEN=m},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(m){r.config.API_URL=m},get workerCount(){return oi.workerCount},set workerCount(m){oi.workerCount=m},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return su});var h=o;return h})})(ete);const J3=RF(pb),tte=n=>(OA("data-v-e4a2007c"),n=n(),GA(),n),ite={class:"grid flex-1 grid-cols-2"},nte={class:"flex flex-col p-8"},rte={style:{"view-transition-name":"building"},class:"flex w-full flex-col gap-2 rounded-2xl bg-zinc-500/50 p-4 backdrop-blur-md"},ste=tte(()=>Yt("div",{class:"h-80",id:"map"},null,-1)),ote=["onClick"],ate=kn({__name:"BuildingExploreView",emits:["scene-ready"],setup(n,{emit:e}){nr.prototype.raycast=Xee,Oo.prototype.computeBoundsTree=Zee,Oo.prototype.disposeBoundsTree=$ee;const t=A0(),i=Fc(),{getCurrentColor:o}=No(i);let u=Gt(null),h=null,r=null,p=null,g=null,v=null,I=null,C=new Yi;const E=Gt(!1),Q=Gt(),M=Gt();Gt(!1);const D=Gt(),P=X=>{var se;const q=(se=u.value)==null?void 0:se.getBoundingClientRect();if(!q||(C.x=X.clientX/q.width*2-1,C.y=-(X.clientY/q.height)*2+1,!E.value))return;I.setFromCamera(C,h);const H=r.children[1].children.filter(de=>(de.name.startsWith("floor_0")||de.name.startsWith("left_")||de.name.startsWith("right_"))&&de.visible),W=I.intersectObjects(H);W.length>0?Q.value!=W[0].object&&(document.documentElement.style.cursor="pointer",Q.value&&Q.value.material.emissive.setHex(Q.value.currentHex),Q.value=W[0].object,Q.value.currentHex=Q.value.material.emissive.getHex(),Q.value.material.emissive.setHex(16711680)):(document.documentElement.style.cursor="default",Q.value&&Q.value.material.emissive.setHex(Q.value.currentHex),Q.value=null)},O=X=>{Q.value&&(M.value=Q.value)},F=()=>{var q;h=new ds(10,window.innerWidth/2/window.innerHeight,.1,1e4),h.position.z=400,h.position.x=-400,h.position.y=400,r=new C1;const X=new B1;X.setDecoderPath("/libs/draco/"),new S1().setPath("/images/").load("empty_warehouse_01_1k.hdr",H=>{H.mapping=Jd,r.environment=H,N();const W=new b1().setPath("/models/");W.setDRACOLoader(X),W.load("FinalBuildingInterior4.glb",se=>{g=se.scene,g.traverse(Re=>{if(Re.isMesh)if(Re.castShadow=!0,Re.receiveShadow=!0,Re instanceof nr&&(Re.name.includes("left_")||Re.name.includes("right_")||Re.name.includes("apartment_"))){const ye=new ef({transparent:!0,color:65280,roughness:.5,metalness:1,side:fa});Re.material=ye,Re.material.opacity=0,Re.visible=!1}else{const ye=new Tk({transparent:!0,depthWrite:!0,side:fa});Re.material=ye}Re.isGeometry&&Re.geometry.computeVertexNormals(!0)}),g.scale.set(2,2,2);const de=new WA(1e4,1e4,1,1),te=new Rq;te.opacity=.5;const ce=new nr(de,te);ce.rotation.x=-Math.PI/2,ce.receiveShadow=!0,r.add(ce),r.add(g),console.log(g.children),D.value=g.children;const Ee=new qq(16777215,9276813,1);Ee.position.set(0,20,0),r.add(Ee);const Be=new QB(16776960,3);Be.position.set(80,150,50);let De=new rr;De.translateX(0),De.translateY(50),De.translateZ(0),Be.target=De,Be.castShadow=!0,Be.shadow.camera.top=40,Be.shadow.camera.bottom=-40,Be.shadow.camera.left=-50,Be.shadow.camera.right=50,Be.shadow.camera.near=.1,Be.shadow.camera.far=1e5,Be.shadow.mapSize.width=1024,Be.shadow.mapSize.height=1024,r.add(Be),r.add(Be.target),e("scene-ready",!0),E.value=!0,N()})}),I=new cK,p=new y0({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0}),p.setClearColor(0,0),p.setPixelRatio(window.devicePixelRatio),p.setSize(window.innerWidth/2,window.innerHeight),p.shadowMap.enabled=!0,p.shadowMap.type=yB,p.outputEncoding=Cn,(q=u.value)==null||q.appendChild(p.domElement),p.domElement.addEventListener("mousemove",P,!0),p.domElement.addEventListener("click",O,!0),v=new w1(h,p.domElement),v.update(),v.enablePan=!1,v.enableDamping=!0,v.enableZoom=!1,v.dampingFactor=.05,v.minDistance=200,v.maxDistance=1e3,v.maxPolarAngle=Math.PI/3-.1,v.minPolarAngle=Math.PI/3-.1,v.target.set(0,50,0),vee(H=>{h.updateMatrix(),h.updateMatrixWorld(),v.update(),p.render(r,h),Iee(H)}),window.addEventListener("resize",z)},N=()=>{p.render(r,h)},z=()=>{h.aspect=window.innerWidth/2/window.innerHeight,h.updateProjectionMatrix(),p.setSize(window.innerWidth/2,window.innerHeight),N()};return qi(o,X=>{g&&g.traverse(q=>{q.isMesh&&q.material.color.set(Number("0x"+X.slice(1))),q.isGeometry&&q.geometry.computeVertexNormals(!0)})}),qi(M,X=>{if(!X){const te={y:v.target.y,cameraX:h.position.x,cameraY:h.position.y,cameraZ:h.position.z};new Vm(te).to({x:0,y:50,cameraX:-400,cameraY:400,cameraZ:400}).easing(Bl.Quadratic.InOut).onUpdate(()=>{h.position.set(te.cameraX,te.cameraY,te.cameraZ),v.target.set(0,te.y,0)}).start(),r.children[1].children.forEach(ce=>{if(ce.isMesh&&(ce.name.startsWith("floor_")||ce.name==="building_base"||ce.name==="building_roof")&&ce.material.opacity===0){const Ee={opacity:0};new Vm(Ee).to({opacity:1}).easing(Bl.Quadratic.InOut).onUpdate(()=>{ce.material.opacity=Ee.opacity,ce.visible=!0}).start()}});return}const q=M.value.name;t.push({name:"ExploreBuilding",params:{floor:q}});const H=M.value,W={x:v.target.x,y:v.target.y,cameraX:h.position.x,cameraY:h.position.y,cameraZ:h.position.z};new Vm(W).to({x:H.position.x,y:H.position.y+M.value.name.split("_").pop()*4,cameraX:-200,cameraY:250,cameraZ:200}).easing(Bl.Quadratic.InOut).onUpdate(()=>{h.position.set(W.cameraX,W.cameraY,W.cameraZ),v.target.set(W.x,W.y,0)}).start();const se=+M.value.name.split("_").pop(),de=r.children[1].children.filter(te=>{const ce=te.name.split("_");return ce[0]==="apartment"||ce[0]==="left"||ce[0]==="right"?+ce.pop()===se:+ce.pop()<=se});de&&r.children[1].children.forEach(te=>{if(te.isMesh){if(de.includes(te)&&te.material.opacity===0){te.visible=!0;const ce={opacity:0,positionY:te.position.y};new Vm(ce).to({opacity:1}).easing(Bl.Quadratic.InOut).onUpdate(()=>{te.material.opacity=ce.opacity}).start()}else if(!de.includes(te)&&te.name!=="building_base"&&te.material.opacity===1){const ce={opacity:1,positionY:te.position.y};new Vm(ce).to({opacity:0,positionY:te.position.y+30}).easing(Bl.Quadratic.InOut).onUpdate(()=>{te.material.opacity=ce.opacity,te.position.y=ce.positionY}).onComplete(()=>{te.visible=!1,te.position.y=ce.positionY-30}).start()}}})}),Br(()=>{F(),N(),J3.accessToken={}.VITE_MAP_BOX_KEY,new J3.Map({container:"map",style:"mapbox://styles/mapbox/streets-v12",center:[-74.5,40],zoom:9})}),of(()=>{var X;if(window.removeEventListener("click",P),window.removeEventListener("resize",z),v.removeEventListener("change",N),h&&(h=null),r&&(r.traverse(q=>{q instanceof nr&&(q.material&&q.material.dispose(),q.geometry&&q.geometry.dispose())}),r=null),p){const q=p.domElement;(X=q.parentNode)==null||X.removeChild(q),p.dispose(),p=null}g&&(g.traverse(q=>{q instanceof nr&&(q.material&&q.material.dispose(),q.geometry&&q.geometry.dispose())}),r&&r.remove(g),g=null)}),(X,q)=>(Qi(),tn("div",ite,[Yt("div",null,[Yt("div",{ref_key:"bulding",ref:u,class:"fixed left-0 top-0 w-[50vw]"},null,512)]),Yt("div",nte,[Yt("div",rte,[ste,D.value?(Qi(),tn(ir,{key:0},[(Qi(!0),tn(ir,null,s1(D.value.filter(H=>H.name.startsWith("floor_0")),H=>(Qi(),tn("div",{onClick:W=>M.value=H,class:mn(["cursor-pointer rounded-sm bg-background p-2"])},Vd(H.name),9,ote))),256)),Yt("div",{class:"cursor-pointer rounded-sm bg-background p-2",onClick:q[0]||(q[0]=H=>M.value=null)}," deselect ")],64)):rh("",!0)])])]))}});const lte=ns(ate,[["__scopeId","data-v-e4a2007c"]]),cte=kn({__name:"CityExploreView",emits:["scene-ready"],setup(n,{emit:e}){const t=hB(),i=Fc();No(t);const{isMobileDevice:o,getCurrentColor:u}=No(i),h=Gt(null),r=Gt(),p=Gt(),g=Gt(),v=Gt(),I=Gt(),C=Gt({x:0,y:0}),E=P=>{C.value.x=P.pageX-window.innerWidth/2,C.value.y=P.pageY-window.innerHeight/2},Q=()=>{var F;r.value=new ds(10,window.innerWidth/window.innerHeight,.1,1e4),r.value.position.z=500,r.value.position.x=500,r.value.position.y=200,p.value=new C1;const P=new B1;P.setDecoderPath("/libs/draco/"),new S1().setPath("/images/").load("empty_warehouse_01_1k.hdr",N=>{N.mapping=Jd,p.value.environment=N,M();const z=new b1().setPath("/models/");z.setDRACOLoader(P),z.load("cityWeb.glb",X=>{e("scene-ready",!0),v.value=X.scene,v.value.traverse(Ee=>{if(Ee.isMesh&&(Ee.material.transparent=!0,Ee.material.roughness=1,Number(Ee.name.charAt(Ee.name.length-1))===1)){const De=new ef({color:16711680,transparent:!0,opacity:.5});Ee.material=De}Ee.isGeometry&&Ee.geometry.computeVertexNormals(!0)});const q=new DB(1048575,1,1);q.position.set(5,0,1);const H=new WA(1e4,1e4,1,1),W=new ju({color:Number("0x"+u.value.slice(1))}),se=new nr(H,W);se.rotation.x=-Math.PI/2,se.position.y=-1,p.value.add(se);const de=new Xi(0),te=1,ce=3500;p.value.fog=new I1(de,te,ce),p.value.background=de,p.value.add(q),p.value.add(v.value),M()})}),g.value=new y0({antialias:!0,logarithmicDepthBuffer:!0}),g.value.setClearColor(0,0),g.value.setPixelRatio(window.devicePixelRatio),g.value.setSize(window.innerWidth,window.innerHeight),g.value.outputEncoding=Cn,(F=h.value)==null||F.appendChild(g.value.domElement),I.value=new w1(r.value,g.value.domElement),I.value.update(),I.value.enablePan=!0,I.value.enableDamping=!0,I.value.dampingFactor=.05,I.value.minDistance=200,I.value.maxDistance=1e3,I.value.maxPolarAngle=Math.PI/2-.1;const O=()=>{v.value,p.value&&r.value&&(requestAnimationFrame(O),g.value.render(rn(p.value),r.value),I.value.update())};O(),window.addEventListener("resize",D)},M=()=>{r.value.lookAt(p.value.position),g.value.render(rn(p.value),r.value)},D=()=>{r.value.aspect=window.innerWidth/window.innerHeight,r.value.updateProjectionMatrix(),g.value.setSize(window.innerWidth,window.innerHeight),M()};return qi(u,P=>{v.value&&v.value.traverse(O=>{O.isMesh&&O.material.color.set(Number("0x"+P.slice(1))),O.isGeometry&&O.geometry.computeVertexNormals(!0)})}),Br(()=>{Q(),M()}),of(()=>{var P;if(window.removeEventListener("mousemove",E),window.removeEventListener("resize",D),I.value.removeEventListener("change",M),r.value&&(r.value=null),p.value&&(p.value.traverse(O=>{O instanceof nr&&(O.material&&O.material.dispose(),O.geometry&&O.geometry.dispose())}),p.value=null),g.value){const O=g.value.domElement;(P=O.parentNode)==null||P.removeChild(O),g.value.dispose(),g.value=null}v.value&&(v.value.traverse(O=>{O instanceof nr&&(O.material&&O.material.dispose(),O.geometry&&O.geometry.dispose())}),p.value&&p.value.remove(v.value),v.value=null)}),(P,O)=>(Qi(),tn("div",{ref_key:"bulding",ref:h,class:"face-bg"},null,512))}});const ute=ns(cte,[["__scopeId","data-v-6a7b1547"]]),hte={class:"modal"},dte={class:"modal-dialog-inner"},fte={class:"modal-thumb"},pte=["src"],Ate={class:"modal-description"},gte=kn({__name:"ModalDialog",props:{item:null},emits:["close"],setup(n,{emit:e}){const t=()=>{P1({async updateDOM(){L1.push({path:"/flower"})},cleanup(){}})};return(i,o)=>(Qi(),tn("div",hte,[Yt("div",{style:ya(`view-transition-name: card-${i.$route.params.id}`),class:"modal-dialog"},[Yt("div",dte,[Yt("div",fte,[Yt("img",{src:Bi(Nu)[i.$route.params.id].thumb,style:ya(`view-transition-name: card-img-${i.$route.params.id}`),width:"1",height:"1",alt:""},null,12,pte),Di(BF,{class:"modal-headline",item:Bi(Nu)[i.$route.params.id]},null,8,["item"])]),Yt("p",Ate,Vd(Bi(Nu)[i.$route.params.id].description),1)]),Yt("button",{class:"modal-close",onClick:o[0]||(o[0]=u=>t()),"aria-label":"とじる"},"×")],4)]))}});const mte=ns(gte,[["__scopeId","data-v-4a80c8a5"]]);var Ab={},_te={get exports(){return Ab},set exports(n){Ab=n}};(function(n,e){(function(t,i){n.exports=i()})(typeof self<"u"?self:QF,()=>(()=>{var t={75:function(h){(function(){var r,p,g,v,I,C;typeof performance<"u"&&performance!==null&&performance.now?h.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(h.exports=function(){return(r()-I)/1e6},p=process.hrtime,v=(r=function(){var E;return 1e9*(E=p())[0]+E[1]})(),C=1e9*process.uptime(),I=v-C):Date.now?(h.exports=function(){return Date.now()-g},g=Date.now()):(h.exports=function(){return new Date().getTime()-g},g=new Date().getTime())}).call(this)},4087:(h,r,p)=>{for(var g=p(75),v=typeof window>"u"?p.g:window,I=["moz","webkit"],C="AnimationFrame",E=v["request"+C],Q=v["cancel"+C]||v["cancelRequest"+C],M=0;!E&&M<I.length;M++)E=v[I[M]+"Request"+C],Q=v[I[M]+"Cancel"+C]||v[I[M]+"CancelRequest"+C];if(!E||!Q){var D=0,P=0,O=[];E=function(F){if(O.length===0){var N=g(),z=Math.max(0,16.666666666666668-(N-D));D=z+N,setTimeout(function(){var X=O.slice(0);O.length=0;for(var q=0;q<X.length;q++)if(!X[q].cancelled)try{X[q].callback(D)}catch(H){setTimeout(function(){throw H},0)}},Math.round(z))}return O.push({handle:++P,callback:F,cancelled:!1}),P},Q=function(F){for(var N=0;N<O.length;N++)O[N].handle===F&&(O[N].cancelled=!0)}}h.exports=function(F){return E.call(v,F)},h.exports.cancel=function(){Q.apply(v,arguments)},h.exports.polyfill=function(F){F||(F=v),F.requestAnimationFrame=E,F.cancelAnimationFrame=Q}}},i={};function o(h){var r=i[h];if(r!==void 0)return r.exports;var p=i[h]={exports:{}};return t[h].call(p.exports,p,p.exports,o),p.exports}o.n=h=>{var r=h&&h.__esModule?()=>h.default:()=>h;return o.d(r,{a:r}),r},o.d=(h,r)=>{for(var p in r)o.o(r,p)&&!o.o(h,p)&&Object.defineProperty(h,p,{enumerable:!0,get:r[p]})},o.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),o.o=(h,r)=>Object.prototype.hasOwnProperty.call(h,r);var u={};return(()=>{o.d(u,{default:()=>Ee});var h=o(4087),r=o.n(h);const p=function(Be){return new RegExp(/<[a-z][\s\S]*>/i).test(Be)},g=function(Be,De){return Math.floor(Math.random()*(De-Be+1))+Be};var v="TYPE_CHARACTER",I="REMOVE_CHARACTER",C="REMOVE_ALL",E="REMOVE_LAST_VISIBLE_NODE",Q="PAUSE_FOR",M="CALL_FUNCTION",D="ADD_HTML_TAG_ELEMENT",P="CHANGE_DELETE_SPEED",O="CHANGE_DELAY",F="CHANGE_CURSOR",N="PASTE_STRING",z="HTML_TAG";function X(Be){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(De){return typeof De}:function(De){return De&&typeof Symbol=="function"&&De.constructor===Symbol&&De!==Symbol.prototype?"symbol":typeof De},X(Be)}function q(Be,De){var Re=Object.keys(Be);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols(Be);De&&(ye=ye.filter(function(ht){return Object.getOwnPropertyDescriptor(Be,ht).enumerable})),Re.push.apply(Re,ye)}return Re}function H(Be){for(var De=1;De<arguments.length;De++){var Re=arguments[De]!=null?arguments[De]:{};De%2?q(Object(Re),!0).forEach(function(ye){te(Be,ye,Re[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Be,Object.getOwnPropertyDescriptors(Re)):q(Object(Re)).forEach(function(ye){Object.defineProperty(Be,ye,Object.getOwnPropertyDescriptor(Re,ye))})}return Be}function W(Be){return function(De){if(Array.isArray(De))return se(De)}(Be)||function(De){if(typeof Symbol<"u"&&De[Symbol.iterator]!=null||De["@@iterator"]!=null)return Array.from(De)}(Be)||function(De,Re){if(De){if(typeof De=="string")return se(De,Re);var ye=Object.prototype.toString.call(De).slice(8,-1);return ye==="Object"&&De.constructor&&(ye=De.constructor.name),ye==="Map"||ye==="Set"?Array.from(De):ye==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ye)?se(De,Re):void 0}}(Be)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function se(Be,De){(De==null||De>Be.length)&&(De=Be.length);for(var Re=0,ye=new Array(De);Re<De;Re++)ye[Re]=Be[Re];return ye}function de(Be,De){for(var Re=0;Re<De.length;Re++){var ye=De[Re];ye.enumerable=ye.enumerable||!1,ye.configurable=!0,"value"in ye&&(ye.writable=!0),Object.defineProperty(Be,ce(ye.key),ye)}}function te(Be,De,Re){return(De=ce(De))in Be?Object.defineProperty(Be,De,{value:Re,enumerable:!0,configurable:!0,writable:!0}):Be[De]=Re,Be}function ce(Be){var De=function(Re,ye){if(X(Re)!=="object"||Re===null)return Re;var ht=Re[Symbol.toPrimitive];if(ht!==void 0){var oe=ht.call(Re,"string");if(X(oe)!=="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Re)}(Be);return X(De)==="symbol"?De:String(De)}const Ee=function(){function Be(ye,ht){var oe=this;if(function(Fe,st){if(!(Fe instanceof st))throw new TypeError("Cannot call a class as a function")}(this,Be),te(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),te(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),te(this,"setupWrapperElement",function(){oe.state.elements.container&&(oe.state.elements.wrapper.className=oe.options.wrapperClassName,oe.state.elements.cursor.className=oe.options.cursorClassName,oe.state.elements.cursor.innerHTML=oe.options.cursor,oe.state.elements.container.innerHTML="",oe.state.elements.container.appendChild(oe.state.elements.wrapper),oe.state.elements.container.appendChild(oe.state.elements.cursor))}),te(this,"start",function(){return oe.state.eventLoopPaused=!1,oe.runEventLoop(),oe}),te(this,"pause",function(){return oe.state.eventLoopPaused=!0,oe}),te(this,"stop",function(){return oe.state.eventLoop&&((0,h.cancel)(oe.state.eventLoop),oe.state.eventLoop=null),oe}),te(this,"pauseFor",function(Fe){return oe.addEventToQueue(Q,{ms:Fe}),oe}),te(this,"typeOutAllStrings",function(){return typeof oe.options.strings=="string"?(oe.typeString(oe.options.strings).pauseFor(oe.options.pauseFor),oe):(oe.options.strings.forEach(function(Fe){oe.typeString(Fe).pauseFor(oe.options.pauseFor).deleteAll(oe.options.deleteSpeed)}),oe)}),te(this,"typeString",function(Fe){var st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(p(Fe))return oe.typeOutHTMLString(Fe,st);if(Fe){var Et=(oe.options||{}).stringSplitter,Ke=typeof Et=="function"?Et(Fe):Fe.split("");oe.typeCharacters(Ke,st)}return oe}),te(this,"pasteString",function(Fe){var st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return p(Fe)?oe.typeOutHTMLString(Fe,st,!0):(Fe&&oe.addEventToQueue(N,{character:Fe,node:st}),oe)}),te(this,"typeOutHTMLString",function(Fe){var st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Et=arguments.length>2?arguments[2]:void 0,Ke=function(ft){var Ve=document.createElement("div");return Ve.innerHTML=ft,Ve.childNodes}(Fe);if(Ke.length>0)for(var Ne=0;Ne<Ke.length;Ne++){var dt=Ke[Ne],xt=dt.innerHTML;dt&&dt.nodeType!==3?(dt.innerHTML="",oe.addEventToQueue(D,{node:dt,parentNode:st}),Et?oe.pasteString(xt,dt):oe.typeString(xt,dt)):dt.textContent&&(Et?oe.pasteString(dt.textContent,st):oe.typeString(dt.textContent,st))}return oe}),te(this,"deleteAll",function(){var Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"natural";return oe.addEventToQueue(C,{speed:Fe}),oe}),te(this,"changeDeleteSpeed",function(Fe){if(!Fe)throw new Error("Must provide new delete speed");return oe.addEventToQueue(P,{speed:Fe}),oe}),te(this,"changeDelay",function(Fe){if(!Fe)throw new Error("Must provide new delay");return oe.addEventToQueue(O,{delay:Fe}),oe}),te(this,"changeCursor",function(Fe){if(!Fe)throw new Error("Must provide new cursor");return oe.addEventToQueue(F,{cursor:Fe}),oe}),te(this,"deleteChars",function(Fe){if(!Fe)throw new Error("Must provide amount of characters to delete");for(var st=0;st<Fe;st++)oe.addEventToQueue(I);return oe}),te(this,"callFunction",function(Fe,st){if(!Fe||typeof Fe!="function")throw new Error("Callback must be a function");return oe.addEventToQueue(M,{cb:Fe,thisArg:st}),oe}),te(this,"typeCharacters",function(Fe){var st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Fe||!Array.isArray(Fe))throw new Error("Characters must be an array");return Fe.forEach(function(Et){oe.addEventToQueue(v,{character:Et,node:st})}),oe}),te(this,"removeCharacters",function(Fe){if(!Fe||!Array.isArray(Fe))throw new Error("Characters must be an array");return Fe.forEach(function(){oe.addEventToQueue(I)}),oe}),te(this,"addEventToQueue",function(Fe,st){var Et=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return oe.addEventToStateProperty(Fe,st,Et,"eventQueue")}),te(this,"addReverseCalledEvent",function(Fe,st){var Et=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return oe.options.loop?oe.addEventToStateProperty(Fe,st,Et,"reverseCalledEvents"):oe}),te(this,"addEventToStateProperty",function(Fe,st){var Et=arguments.length>2&&arguments[2]!==void 0&&arguments[2],Ke=arguments.length>3?arguments[3]:void 0,Ne={eventName:Fe,eventArgs:st||{}};return oe.state[Ke]=Et?[Ne].concat(W(oe.state[Ke])):[].concat(W(oe.state[Ke]),[Ne]),oe}),te(this,"runEventLoop",function(){oe.state.lastFrameTime||(oe.state.lastFrameTime=Date.now());var Fe=Date.now(),st=Fe-oe.state.lastFrameTime;if(!oe.state.eventQueue.length){if(!oe.options.loop)return;oe.state.eventQueue=W(oe.state.calledEvents),oe.state.calledEvents=[],oe.options=H({},oe.state.initialOptions)}if(oe.state.eventLoop=r()(oe.runEventLoop),!oe.state.eventLoopPaused){if(oe.state.pauseUntil){if(Fe<oe.state.pauseUntil)return;oe.state.pauseUntil=null}var Et,Ke=W(oe.state.eventQueue),Ne=Ke.shift();if(!(st<=(Et=Ne.eventName===E||Ne.eventName===I?oe.options.deleteSpeed==="natural"?g(40,80):oe.options.deleteSpeed:oe.options.delay==="natural"?g(120,160):oe.options.delay))){var dt=Ne.eventName,xt=Ne.eventArgs;switch(oe.logInDevMode({currentEvent:Ne,state:oe.state,delay:Et}),dt){case N:case v:var ft=xt.character,Ve=xt.node,Ye=document.createTextNode(ft),ae=Ye;oe.options.onCreateTextNode&&typeof oe.options.onCreateTextNode=="function"&&(ae=oe.options.onCreateTextNode(ft,Ye)),ae&&(Ve?Ve.appendChild(ae):oe.state.elements.wrapper.appendChild(ae)),oe.state.visibleNodes=[].concat(W(oe.state.visibleNodes),[{type:"TEXT_NODE",character:ft,node:ae}]);break;case I:Ke.unshift({eventName:E,eventArgs:{removingCharacterNode:!0}});break;case Q:var _e=Ne.eventArgs.ms;oe.state.pauseUntil=Date.now()+parseInt(_e);break;case M:var Ze=Ne.eventArgs,nt=Ze.cb,ut=Ze.thisArg;nt.call(ut,{elements:oe.state.elements});break;case D:var ze=Ne.eventArgs,Qt=ze.node,mt=ze.parentNode;mt?mt.appendChild(Qt):oe.state.elements.wrapper.appendChild(Qt),oe.state.visibleNodes=[].concat(W(oe.state.visibleNodes),[{type:z,node:Qt,parentNode:mt||oe.state.elements.wrapper}]);break;case C:var Ut=oe.state.visibleNodes,Dt=xt.speed,Ie=[];Dt&&Ie.push({eventName:P,eventArgs:{speed:Dt,temp:!0}});for(var ue=0,at=Ut.length;ue<at;ue++)Ie.push({eventName:E,eventArgs:{removingCharacterNode:!1}});Dt&&Ie.push({eventName:P,eventArgs:{speed:oe.options.deleteSpeed,temp:!0}}),Ke.unshift.apply(Ke,Ie);break;case E:var St=Ne.eventArgs.removingCharacterNode;if(oe.state.visibleNodes.length){var yt=oe.state.visibleNodes.pop(),Pt=yt.type,Ot=yt.node,Ue=yt.character;oe.options.onRemoveNode&&typeof oe.options.onRemoveNode=="function"&&oe.options.onRemoveNode({node:Ot,character:Ue}),Ot&&Ot.parentNode.removeChild(Ot),Pt===z&&St&&Ke.unshift({eventName:E,eventArgs:{}})}break;case P:oe.options.deleteSpeed=Ne.eventArgs.speed;break;case O:oe.options.delay=Ne.eventArgs.delay;break;case F:oe.options.cursor=Ne.eventArgs.cursor,oe.state.elements.cursor.innerHTML=Ne.eventArgs.cursor}oe.options.loop&&(Ne.eventName===E||Ne.eventArgs&&Ne.eventArgs.temp||(oe.state.calledEvents=[].concat(W(oe.state.calledEvents),[Ne]))),oe.state.eventQueue=Ke,oe.state.lastFrameTime=Fe}}}),ye)if(typeof ye=="string"){var Tt=document.querySelector(ye);if(!Tt)throw new Error("Could not find container element");this.state.elements.container=Tt}else this.state.elements.container=ye;ht&&(this.options=H(H({},this.options),ht)),this.state.initialOptions=H({},this.options),this.init()}var De,Re;return De=Be,(Re=[{key:"init",value:function(){var ye,ht;this.setupWrapperElement(),this.addEventToQueue(F,{cursor:this.options.cursor},!0),this.addEventToQueue(C,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||(ye=".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}",(ht=document.createElement("style")).appendChild(document.createTextNode(ye)),document.head.appendChild(ht),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),this.options.autoStart===!0&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(ye){this.options.devMode&&console.log(ye)}}])&&de(De.prototype,Re),Object.defineProperty(De,"prototype",{writable:!1}),Be}()})(),u.default})())})(_te);const yte=RF(Ab),vte={key:0,class:"height--screen fixed flex w-screen items-center justify-center bg-background"},xte={key:1,class:"max-w-sm text-center text-3xl"},Ite=kn({__name:"HelloMatyldzia",setup(n){const{enter:e}=QP(),t=Gt(null),i=Gt(),o=Gt(),u=Gt(),h=Gt(),r=Gt(),p=Gt(!1),g=Gt(!1),v=Gt(null),I=Gt({x:0,y:0}),C=P=>{I.value.x=P.pageX-window.innerWidth/2,I.value.y=P.pageY-window.innerHeight/2},E=()=>{var F;i.value=new ds(10,window.innerWidth/window.innerHeight,.1,1e4),i.value.position.z=1e3,i.value.position.x=0,i.value.position.y=0,o.value=new C1;const P=new B1;P.setDecoderPath("/libs/draco/"),new S1().setPath("/images/").load("empty_warehouse_01_1k.hdr",N=>{N.mapping=Jd,o.value.environment=N,Q();const z=new ef({color:0,roughness:.4,metalness:.8}),X=new ef({color:16037355,roughness:.4,metalness:.5}),q=new b1().setPath("/models/");q.setDRACOLoader(P),q.load("kuromi.glb",H=>{h.value=H.scene,h.value.traverse(Re=>{Re.isMesh&&(Re.name==="Object_22"||Re.name==="Object_12"||Re.name==="Object_10"||Re.name==="Object_7"?Re.material=z:Re.name==="Object_9"&&(Re.material=X),Re.castShadow=!0,Re.receiveShadow=!0),Re.isGeometry&&Re.geometry.computeVertexNormals(!0)}),h.value.scale.set(20,20,20);const W=new WA(1e4,1e4,1,1),se=new Tk({color:11579568}),de=new nr(W,se);de.rotation.x=-Math.PI/2,de.position.y=-38,de.receiveShadow=!0,o.value.add(de);const te=new Xi(8002669),ce=1,Ee=3500;o.value.fog=new I1(te,ce,Ee),o.value.background=te,o.value.add(h.value);const Be=new QB(12404396,2);Be.position.set(50,100,150);let De=new rr;De.translateX(0),De.translateY(0),De.translateZ(0),Be.target=De,Be.castShadow=!0,Be.shadow.camera.top=40,Be.shadow.camera.bottom=-40,Be.shadow.camera.left=-50,Be.shadow.camera.right=50,Be.shadow.camera.near=.1,Be.shadow.camera.far=1e3,Be.shadow.mapSize.width=1024,Be.shadow.mapSize.height=1024,o.value.add(Be),o.value.add(Be.target),Q()})}),u.value=new y0({antialias:!0,logarithmicDepthBuffer:!0}),u.value.setClearColor(0,0),u.value.setPixelRatio(window.devicePixelRatio),u.value.setSize(window.innerWidth,window.innerHeight),u.value.shadowMap.enabled=!0,u.value.shadowMap.type=yB,u.value.outputEncoding=Cn,(F=t.value)==null||F.appendChild(u.value.domElement),r.value=new w1(i.value,u.value.domElement),r.value.update(),r.value.enablePan=!1,r.value.enableDamping=!0,r.value.dampingFactor=.05,r.value.minDistance=600,r.value.maxDistance=1e3,r.value.maxPolarAngle=Math.PI/2-.1;const O=()=>{o.value&&i.value&&(requestAnimationFrame(O),u.value.render(rn(o.value),i.value),r.value.update())};O(),window.addEventListener("resize",M)},Q=()=>{i.value.lookAt(o.value.position),u.value.render(rn(o.value),i.value)},M=()=>{i.value.aspect=window.innerWidth/window.innerHeight,i.value.updateProjectionMatrix(),u.value.setSize(window.innerWidth,window.innerHeight),Q()},D=()=>{p.value=!0,Gr(()=>{setTimeout(()=>{new yte(v.value,{strings:["Najdroższa Matyldo.","Niezależnie od tego ile wspólnych dni spędzimy,","Niezależnie od tego ile razy wspólnie przyjdzie nam narzekać,","Niezależnie od tego z iloma nam przyjdzie się zmierzyć kłótniami,","Każda chwila z Tobą jest dla mnie jak poranny brzask, który ogrzewa mą skroń,","Każda niedola bezustannie buduje nasz fundament,","Każde tarcie zbliża nas do siebie po poprzedzającym uśmiechu,","Pragnę, aby trwało to ponad wieczność,","Gdzie zawsze będziemy kwitnącym ogrodem, którego owocem jest nasza przyjaźn.","Kocham Cię,","Twój na zawsze,","– Jorduś.","Wszystkiego najlepszego!"],autoStart:!0,delay:40,deleteSpeed:20,pauseFor:2500}).callFunction(()=>{setTimeout(()=>{g.value=!0},500)})},1500)})};return Lb(()=>{e.value&&(g.value=!0)}),Br(()=>{E(),Q()}),of(()=>{var P;if(window.removeEventListener("mousemove",C),window.removeEventListener("resize",M),r.value.removeEventListener("change",Q),i.value&&(i.value=null),o.value&&(o.value.traverse(O=>{O instanceof nr&&(O.material&&O.material.dispose(),O.geometry&&O.geometry.dispose())}),o.value=null),u.value){const O=u.value.domElement;(P=O.parentNode)==null||P.removeChild(O),u.value.dispose(),u.value=null}h.value&&(h.value.traverse(O=>{O instanceof nr&&(O.material&&O.material.dispose(),O.geometry&&O.geometry.dispose())}),o.value&&o.value.remove(h.value),h.value=null)}),(P,O)=>(Qi(),tn(ir,null,[Yt("div",{ref_key:"bulding",ref:t,class:"kuromi"},null,512),Di(AA,null,{default:Fs(()=>[g.value?rh("",!0):(Qi(),tn("div",vte,[Di(AA,{mode:"out-in"},{default:Fs(()=>[p.value?(Qi(),tn("div",xte,[Yt("div",{ref_key:"helloMatyldzia",ref:v},null,512)])):(Qi(),tn("button",{key:0,onClick:D,style:{"view-transition-name":"matyldzia"},class:"animate-bounce rounded-full bg-primary px-6 py-4 font-header text-2xl text-background shadow-lg transition-all hover:bg-slate-300/75"}," Hello Matyldziu "))]),_:1})]))]),_:1})],64))}});const Cte=ns(Ite,[["__scopeId","data-v-3a5edafb"]]),L1=zG({history:iG(),routes:[{path:"/",name:"Home",component:aee},{path:"/flower",name:"Flowers",component:yee},{path:"/head",name:"Head",component:XK},{path:"/flower/:id",name:"Author",component:mte},{path:"/building/:floor?/:apartment?",name:"ExploreBuilding",component:lte},{path:"/city/",name:"Explore City",component:ute},{path:"/hello_matyldzia/",name:"Hello Matyldzia",component:Cte}]});function P1({skipTransition:n=!1,updateDOM:e,cleanup:t}){if(n||!document.startViewTransition){const o=Promise.resolve(e()).then(()=>{});return{ready:Promise.reject(Error("View transitions unsupported")),updateCallbackDone:o,finished:o,skipTransition:()=>{}}}const i=document.startViewTransition(e);return i.finished.finally(()=>{t==null||t()}),i}function Ete(n){P1({async updateDOM(){L1.push(n),await Gr()},cleanup(){}})}function wte(){const n=Gt(new Date);return cn(()=>{const t=n.value.getMonth(),i=n.value.getDate();return t===9&&i===5})}const bte=["content"],Bte={class:"flex h-full w-full items-center justify-between leading-none"},Ste={class:"flex justify-center px-4"},Mte=kn({__name:"HeaderComponent",setup(n){const e=Fc(),{setCurrentColor:t}=e,{isMobileDevice:i,isBottomNav:o,currentColor:u}=No(e),{space:h,escape:r,enter:p}=QP(),g=G8({emitAuto:!0}),v=A0(),I=cn(()=>v.currentRoute.value.path);g.value="auto",pr.registerPlugin(bA);const C=Gt(null),E=Gt(null);Gt(null);const Q=Gt(),M=Gt(),D=Gt(!1),P=Gt(!1),O=wte(),F=Gt([{className:"necuro--mocha",probability:.01,color:"#593d3b"},{className:"necuro--volt",probability:.05,color:"#7f0799"},{className:"necuro--default",probability:.3,color:"#ffffff"},{className:"necuro--beach",probability:.1,color:"#3f88c5"},{className:"necuro--black",probability:.3,color:"#0d0d0d"},{className:"necuro--wine",probability:.08,color:"#612940"},{className:"necuro--fedex",probability:.1,color:"#660099"},{className:"necuro--coca-cola",probability:.07,color:"#b91212"},{className:"necuro--forest",probability:.06,color:"#3e363f"}]),N=se=>{const te=Array.from(se.innerText).map(Ee=>Ee===" "?"<div>&nbsp;</div>":`<div class="relative"><div>${Ee}</div><div class="necuro__logo--line absolute top-0 font-display-line">${Ee}</div></div>`).join("");se.innerHTML=te;const ce=se.querySelectorAll(":scope > div");Q.value=pr.timeline({onComplete:()=>{z(se),X(E.value)}}).staggerFromTo(ce,2,{opacity:0,y:"70%",ease:"elastic.out(1.2, 0.5)"},{opacity:1,y:0,ease:"elastic.out(1.2, 0.5)"},.1),q(Array.from(ce))},z=se=>{pr.to(se,{rotationZ:0,rotationX:0,rotationY:0,ease:"power3.inOut",duration:1.75,fontSize:"3rem"})},X=se=>{pr.to(se,{ease:"power3.inOut",maxHeight:"5rem",duration:1.75,onComplete:()=>{P.value=!0}})},q=se=>bA.create(se,{type:"x,y",onPress:function(){this.startX=this.x,this.startY=this.y,this.update()},onDrag:function(){this.update();const de=this.x-this.startX,te=this.y-this.startY;let Ee=Math.atan2(te,de)*180/Math.PI;Ee>0&&(Ee-=180),Ee+=90,pr.to(this.target,{rotationZ:Ee})},onRelease:function(){pr.to(this.target,{x:0,y:0,rotationZ:0,rotationX:0,rotationY:0,ease:"elastic.out(1, 0.3)",duration:1.75,onComplete:function(){}})}}),H=()=>{const se=F.value.reduce((ce,Ee)=>ce+Ee.probability,0),de=Math.random()*se;let te=0;for(const ce of F.value)if(te+=ce.probability,de<=te)return ce.className;return"necuro--default"},W=se=>{for(let de=se.length-1;de>0;de--){const te=Math.floor(Math.random()*(de+1)),ce=se[de];se[de]=se[te],se[te]=ce}};return Lb(()=>{(h.value||r.value||p.value)&&(Q.value.progress(1),M.value.progress(1))}),Br(()=>{W(F.value),C.value&&(N(C.value),M.value=pr.timeline().set(document.body,{className:F.value[0].className,onUpdate:()=>{t(F.value[0].color)}},"+=0.05").set(document.body,{className:F.value[1].className,onUpdate:()=>{t(F.value[1].color)}},"+=0.10").set(document.body,{className:F.value[2].className,onUpdate:()=>{t(F.value[2].color)}},"+=0.15").set(document.body,{className:F.value[3].className,onUpdate:()=>{t(F.value[3].color)}},"+=0.20").set(document.body,{className:F.value[4].className,onUpdate:()=>{t(F.value[4].color)}},"+=0.25").set(document.body,{className:F.value[5].className,onUpdate:()=>{t(F.value[5].color)}},"+=0.50").set(document.body,{className:H,onUpdate:()=>{const se=F.value.find(de=>de.className===document.body.className);t((se==null?void 0:se.color)||"")}},"+=1.25"))}),(se,de)=>{const te=HA("v-icon");return Qi(),tn(ir,null,[Yt("meta",{name:"theme-color",content:Bi(u)},null,8,bte),Yt("div",{ref_key:"header",ref:E,class:mn(["height--screen fixed z-[999] flex max-h-screen w-full items-start justify-center py-4 backdrop-blur-md",Bi(o)?"bottom-0":"top-0"])},[Yt("div",Bte,[Yt("div",Ste,[Di(te,{onClick:de[0]||(de[0]=ce=>Bi(Ete)("/")),class:mn(["h-12 w-12 cursor-pointer transition-opacity duration-700",P.value&&Bi(I)!=="/"?"opacity-100":"opacity-0",Bi(I)==="/"?"pointer-events-none opacity-0":""]),name:"hi-arrow-sm-left"},null,8,["class"])]),Yt("div",{ref_key:"necuroLogo",ref:C,class:"necuro__logo flex grow items-center justify-center font-display text-8xl sm:text-9xl"},Vd(Bi(O)?"matylda":"necuro"),513),Yt("div",{class:mn(["flex justify-end px-4 transition-[width] duration-500",D.value?"w-1/2":"w-20"])},null,2)])],2)],64)}}});const Tte=ns(Mte,[["__scopeId","data-v-fdb1dd30"]]),Dte=Yt("svg",{class:"fixed bottom-0 left-0 max-w-3xl -z-10 opacity-25",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 413.7 413.7"},[Yt("g",null,[Yt("path",{class:"cls-2",style:{fill:"var(--text-color)"},d:"M0,0C44.2,26.2,88.5,52.4,143.5,67.2c55,14.9,120.8,18.3,149,54s18.8,103.7,32.7,157.8c13.9,54.1,51.2,94.4,88.5,134.7H0V0Z"}),Yt("path",{class:"cls-1",style:{fill:"var(--text-color-secondary)"},d:"M0,206.9c22.1,13.1,44.2,26.2,71.8,33.6,27.5,7.4,60.4,9.1,74.5,26.9,14,17.9,9.3,51.9,16.3,78.9,7,27.1,25.6,47.3,44.2,67.4H0V206.9Z"})])],-1),Qte=Yt("svg",{class:"fixed right-0 top-0 max-w-3xl -z-10 opacity-25",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 413.7 413.7"},[Yt("g",null,[Yt("path",{class:"cls-2",style:{fill:"var(--text-color)"},d:"M413.7,413.7c-54.4-6.8-108.9-13.6-157.3-34-48.4-20.4-90.8-54.5-129.8-92.6S52.1,206.8,31.5,158.3C11,109.8,5.5,54.9,0,0H413.7V413.7Z"}),Yt("path",{class:"cls-1",style:{fill:"var(--text-color-secondary)"},d:"M413.7,206.8c-27.2-3.4-54.4-6.7-78.6-16.9-24.2-10.3-45.4-27.3-64.9-46.4-19.5-19-37.3-40.1-47.6-64.4-10.2-24.2-13-51.7-15.7-79.1h206.8V206.8Z"})])],-1),Rte=kn({__name:"App",setup(n){return(e,t)=>(Qi(),ys(HG,null,{default:Fs(()=>[Di(Tte),Di(Bi(mL)),Dte,Qte]),_:1}))}});const PF=KU();PF.use(sO);const k1=YU(Rte);k1.component("v-icon",dO);k1.use(PF);k1.use(L1);k1.mount("#app");
